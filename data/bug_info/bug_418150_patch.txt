diff --git a/suite/browser/nsBrowserContentHandler.js b/suite/browser/nsBrowserContentHandler.js
--- a/suite/browser/nsBrowserContentHandler.js
+++ b/suite/browser/nsBrowserContentHandler.js
@@ -42,6 +42,7 @@ const nsIChannel             = Component
 const nsIChannel             = Components.interfaces.nsIChannel;
 const nsICommandLine         = Components.interfaces.nsICommandLine;
 const nsICommandLineHandler  = Components.interfaces.nsICommandLineHandler;
+const nsICommandLineValidator = Components.interfaces.nsICommandLineValidator;
 const nsIComponentRegistrar  = Components.interfaces.nsIComponentRegistrar;
 const nsICategoryManager     = Components.interfaces.nsICategoryManager;
 const nsIContentHandler      = Components.interfaces.nsIContentHandler;
@@ -60,6 +61,7 @@ const nsIWindowWatcher       = Component
 const nsIWindowWatcher       = Components.interfaces.nsIWindowWatcher;
 const nsIWebNavigationInfo   = Components.interfaces.nsIWebNavigationInfo;
 
+const NS_ERROR_ABORT = Components.results.NS_ERROR_ABORT;
 const NS_BINDING_ABORTED = 0x804b0002;
 const NS_ERROR_WONT_HANDLE_CONTENT = 0x805d0001;
 
@@ -237,6 +239,7 @@ var nsBrowserContentHandler = {
     if (iid.equals(nsISupports) ||
         iid.equals(nsICommandLineHandler) ||
         iid.equals(nsICommandLine) ||
+        iid.equals(nsICommandLineValidator) ||
         iid.equals(nsIContentHandler) ||
         iid.equals(nsIFactory))
       return this;
@@ -432,6 +435,47 @@ var nsBrowserContentHandler = {
 
   },
 
+  /* nsICommandLineValidator */
+  validate: function bch_validate(cmdLine) {
+    var osintFlagIdx = cmdLine.findFlag("osint", false);
+
+    // Other handlers may use osint so only handle the osint flag if a
+    // flag is also present and the command line is valid.
+    var urlFlagIdx = cmdLine.findFlag("url", false);
+    var newsFlagIdx = cmdLine.findFlag("news", false);
+    var composeFlagIdx = cmdLine.findFlag("compose", false);
+    if (urlFlagIdx == -1 && newsFlagIdx == -1 && composeFlagIdx == -1)
+      return;
+
+    // Handle Browser URLs
+    if (urlFlagIdx > -1 && (osintFlagIdx > -1 ||
+        cmdLine.state == nsICommandLine.STATE_REMOTE_EXPLICIT)) {
+      var urlParam = cmdLine.getArgument(urlFlagIdx + 1);
+      if (cmdLine.length != urlFlagIdx + 2 || /seamonkeyurl:/.test(urlParam)) {
+        throw NS_ERROR_ABORT;
+      }
+      cmdLine.handleFlag("osint", false);
+    }
+
+    // Handle MailNews URLs
+    if ((composeFlagIdx > -1 || newsFlagIdx > -1) && osintFlagIdx > -1) {
+      // If both flags are present use the first flag found so the command line
+      // length test will fail.
+      if (newsFlagIdx > -1 && composeFlagIdx > -1)
+        var actionFlagIdx = newsFlagIdx > composeFlagIdx ? composeFlagIdx : newsFlagIdx;
+      else
+        var actionFlagIdx = newsFlagIdx > -1 ? newsFlagIdx : composeFlagIdx;
+
+      if (actionFlagIdx && (osintFlagIdx > -1)) {
+        var param = cmdLine.getArgument(actionFlagIdx + 1);
+        if (cmdLine.length != actionFlagIdx + 2 ||
+           /seamonkey.url.(mailto|news):/.test(param))
+          throw NS_ERROR_ABORT;
+        cmdLine.handleFlag("osint", false);
+      }
+    }
+  },
+
   helpInfo: "  -browser <url>       Open a browser window.\n" +
             "  -url <url>           Open the specified url.\n" +
             "  -chrome <url>        Open the specified chrome.\n",
@@ -585,6 +629,9 @@ var Module = {
 
     catMan.addCategoryEntry("command-line-handler", "x-default",
                             BROWSER_CONTRACTID, true, true);
+    catMan.addCategoryEntry("command-line-validator",
+                               "b-default",
+                               BROWSER_CONTRACTID, true, true);
   },
     
   unregisterSelf: function unregisterSelf(compMgr, location, type) {
@@ -596,6 +643,8 @@ var Module = {
 
     catMan.deleteCategoryEntry("command-line-handler",
                                "x-default", true);
+    catMan.deleteCategoryEntry("command-line-validator",
+                               "b-default", true);
   },
 
   canUnload: function canUnload(compMgr) {
