{"bug_id":296364,"commitHash":"1ca43db","commit_info":{"sha":"1ca43db890afcd972e6a7b4b5091d3b17f421aaa","commit":{"author":{"name":"bzbarsky%mit.edu","email":"bzbarsky%mit.edu","date":"2005-07-13T16:53:06Z"},"committer":{"name":"bzbarsky%mit.edu","email":"bzbarsky%mit.edu","date":"2005-07-13T16:53:06Z"},"message":"Fix leak due to non-use of already_AddRefed.  Bug 296364, r=kaie, sr=bryner","tree":{"sha":"7feb57639f2fd3b770c1db3a8bd24828b7d5b554","url":"https://api.github.com/repos/mozilla/gecko-dev/git/trees/7feb57639f2fd3b770c1db3a8bd24828b7d5b554"},"url":"https://api.github.com/repos/mozilla/gecko-dev/git/commits/1ca43db890afcd972e6a7b4b5091d3b17f421aaa","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/mozilla/gecko-dev/commits/1ca43db890afcd972e6a7b4b5091d3b17f421aaa","html_url":"https://github.com/mozilla/gecko-dev/commit/1ca43db890afcd972e6a7b4b5091d3b17f421aaa","comments_url":"https://api.github.com/repos/mozilla/gecko-dev/commits/1ca43db890afcd972e6a7b4b5091d3b17f421aaa/comments","author":null,"committer":null,"parents":[{"sha":"6d682be208f59dba234d0ea0c29540625c70e933","url":"https://api.github.com/repos/mozilla/gecko-dev/commits/6d682be208f59dba234d0ea0c29540625c70e933","html_url":"https://github.com/mozilla/gecko-dev/commit/6d682be208f59dba234d0ea0c29540625c70e933"}],"stats":{"total":6,"additions":3,"deletions":3},"files":[{"sha":"01a75f0810a0819d8eadb079965789b8588b0f3c","filename":"security/manager/ssl/src/nsCrypto.cpp","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/mozilla/gecko-dev/blob/1ca43db890afcd972e6a7b4b5091d3b17f421aaa/security/manager/ssl/src/nsCrypto.cpp","raw_url":"https://github.com/mozilla/gecko-dev/raw/1ca43db890afcd972e6a7b4b5091d3b17f421aaa/security/manager/ssl/src/nsCrypto.cpp","contents_url":"https://api.github.com/repos/mozilla/gecko-dev/contents/security/manager/ssl/src/nsCrypto.cpp?ref=1ca43db890afcd972e6a7b4b5091d3b17f421aaa","patch":"@@ -362,7 +362,7 @@ cryptojs_GetFramePrincipal(JSContext *cx, JSStackFrame *fp,\n   return cryptojs_GetFunctionObjectPrincipal(cx, obj, principal);\n }\n \n-nsIPrincipal*\n+already_AddRefed<nsIPrincipal>\n nsCrypto::GetScriptPrincipal(JSContext *cx)\n {\n   JSStackFrame *fp = nsnull;\n@@ -385,7 +385,7 @@ nsCrypto::GetScriptPrincipal(JSContext *cx)\n     nsCOMPtr<nsIScriptObjectPrincipal> globalData =\n       do_QueryInterface(scriptContext->GetGlobalObject());\n     NS_ENSURE_TRUE(globalData, nsnull);\n-    principal = globalData->GetPrincipal();\n+    NS_IF_ADDREF(principal = globalData->GetPrincipal());\n   }\n \n   return principal;"},{"sha":"9520ca1061da433f9373e20d78fcff16ce87d745","filename":"security/manager/ssl/src/nsCrypto.h","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/mozilla/gecko-dev/blob/1ca43db890afcd972e6a7b4b5091d3b17f421aaa/security/manager/ssl/src/nsCrypto.h","raw_url":"https://github.com/mozilla/gecko-dev/raw/1ca43db890afcd972e6a7b4b5091d3b17f421aaa/security/manager/ssl/src/nsCrypto.h","contents_url":"https://api.github.com/repos/mozilla/gecko-dev/contents/security/manager/ssl/src/nsCrypto.h?ref=1ca43db890afcd972e6a7b4b5091d3b17f421aaa","patch":"@@ -92,7 +92,7 @@ class nsCrypto: public nsIDOMCrypto\n   NS_DECL_NSIDOMCRYPTO\n \n private:\n-  static nsIPrincipal* GetScriptPrincipal(JSContext *cx);\n+  static already_AddRefed<nsIPrincipal> GetScriptPrincipal(JSContext *cx);\n \n   PRBool mEnableSmartCardEvents;\n };"}]},"blames":["e4a50bbe","505c6348","abefba90","e4a50bbe","3bf4387d"]}