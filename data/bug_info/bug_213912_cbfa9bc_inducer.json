{"bug_id":213912,"commitHash":"cbfa9bc","commit_info":{"sha":"cbfa9bcf5ade39bc8b8a73429f0f796c750d6b5f","commit":{"author":{"name":"caillon%returnzero.com","email":"caillon%returnzero.com","date":"2003-07-26T08:16:44Z"},"committer":{"name":"caillon%returnzero.com","email":"caillon%returnzero.com","date":"2003-07-26T08:16:44Z"},"message":"Bug 213912\nIf getting the a chrome document's principal fails, handle the error and clean up the navigator object's holder.\nr+sr=bzbarsky@mit.edu","tree":{"sha":"20034da15a509f32af457bef0c1f72d40d7b2175","url":"https://api.github.com/repos/mozilla/gecko-dev/git/trees/20034da15a509f32af457bef0c1f72d40d7b2175"},"url":"https://api.github.com/repos/mozilla/gecko-dev/git/commits/cbfa9bcf5ade39bc8b8a73429f0f796c750d6b5f","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/mozilla/gecko-dev/commits/cbfa9bcf5ade39bc8b8a73429f0f796c750d6b5f","html_url":"https://github.com/mozilla/gecko-dev/commit/cbfa9bcf5ade39bc8b8a73429f0f796c750d6b5f","comments_url":"https://api.github.com/repos/mozilla/gecko-dev/commits/cbfa9bcf5ade39bc8b8a73429f0f796c750d6b5f/comments","author":null,"committer":null,"parents":[{"sha":"3ce796ca635b7e66e8b13698eb04c774f02df7c9","url":"https://api.github.com/repos/mozilla/gecko-dev/commits/3ce796ca635b7e66e8b13698eb04c774f02df7c9","html_url":"https://github.com/mozilla/gecko-dev/commit/3ce796ca635b7e66e8b13698eb04c774f02df7c9"}],"stats":{"total":10,"additions":5,"deletions":5},"files":[{"sha":"aca5da29db4c6d5e7039a679c77c0675d049140f","filename":"dom/src/base/nsGlobalWindow.cpp","status":"modified","additions":5,"deletions":5,"changes":10,"blob_url":"https://github.com/mozilla/gecko-dev/blob/cbfa9bcf5ade39bc8b8a73429f0f796c750d6b5f/dom/src/base/nsGlobalWindow.cpp","raw_url":"https://github.com/mozilla/gecko-dev/raw/cbfa9bcf5ade39bc8b8a73429f0f796c750d6b5f/dom/src/base/nsGlobalWindow.cpp","contents_url":"https://api.github.com/repos/mozilla/gecko-dev/contents/dom/src/base/nsGlobalWindow.cpp?ref=cbfa9bcf5ade39bc8b8a73429f0f796c750d6b5f","patch":"@@ -427,11 +427,11 @@ GlobalWindowImpl::SetNewDocument(nsIDOMDocument* aDocument,\n       NS_ENSURE_TRUE(doc, NS_ERROR_FAILURE);\n \n       nsCOMPtr<nsIPrincipal> newPrincipal;\n-      doc->GetPrincipal(getter_AddRefs(newPrincipal));\n-\n-      nsresult rv =\n-        sSecMan->CheckSameOriginPrincipal(mDocumentPrincipal,\n-                                          newPrincipal);\n+      nsresult rv = doc->GetPrincipal(getter_AddRefs(newPrincipal));\n+      if (NS_SUCCEEDED(rv)) {\n+        rv = sSecMan->CheckSameOriginPrincipal(mDocumentPrincipal,\n+                                               newPrincipal);\n+      }\n \n       if (NS_SUCCEEDED(rv)) {\n         // Same origins.  Notify the navigator object that we are"}]},"blames":["b2badfa9"]}