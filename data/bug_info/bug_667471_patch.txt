# HG changeset patch
# Parent bcb0b42f9068ad85685a47c00680018a9fb20258
# User David Cooper <dcooper16@gmail.com>
Bug 667471 - Pretty print names of ECDSA with SHA-2 algorithms in Certificate Viewer. r=

diff --git a/security/manager/locales/en-US/chrome/pipnss/pipnss.properties b/security/manager/locales/en-US/chrome/pipnss/pipnss.properties
--- a/security/manager/locales/en-US/chrome/pipnss/pipnss.properties
+++ b/security/manager/locales/en-US/chrome/pipnss/pipnss.properties
@@ -105,16 +105,20 @@ CertDumpCertPolicies=Certificate Policie
 CertDumpPolicyMappings=Certificate Policy Mappings
 CertDumpPolicyConstraints=Certificate Policy Constraints
 CertDumpAuthKeyID=Certificate Authority Key Identifier
 CertDumpExtKeyUsage=Extended Key Usage
 CertDumpAuthInfoAccess=Authority Information Access
 CertDumpAnsiX9DsaSignature=ANSI X9.57 DSA Signature
 CertDumpAnsiX9DsaSignatureWithSha1=ANSI X9.57 DSA Signature with SHA1 Digest
 CertDumpAnsiX962ECDsaSignatureWithSha1=ANSI X9.62 ECDSA Signature with SHA1
+CertDumpAnsiX962ECDsaSignatureWithSha224=ANSI X9.62 ECDSA Signature with SHA224
+CertDumpAnsiX962ECDsaSignatureWithSha256=ANSI X9.62 ECDSA Signature with SHA256
+CertDumpAnsiX962ECDsaSignatureWithSha384=ANSI X9.62 ECDSA Signature with SHA384
+CertDumpAnsiX962ECDsaSignatureWithSha512=ANSI X9.62 ECDSA Signature with SHA512
 CertDumpKUSign=Signing
 CertDumpKUNonRep=Non-repudiation
 CertDumpKUEnc=Key Encipherment
 CertDumpKUDEnc=Data Encipherment
 CertDumpKUKA=Key Agreement
 CertDumpKUCertSign=Certificate Signer
 CertDumpKUCRLSigner=CRL Signer
 CertDumpCritical=Critical
diff --git a/security/manager/ssl/src/nsNSSCertHelper.cpp b/security/manager/ssl/src/nsNSSCertHelper.cpp
--- a/security/manager/ssl/src/nsNSSCertHelper.cpp
+++ b/security/manager/ssl/src/nsNSSCertHelper.cpp
@@ -359,19 +359,31 @@ GetOIDText(SECItem *oid, nsINSSComponent
     bundlekey = "CertDumpAuthInfoAccess";
     break;
   case SEC_OID_ANSIX9_DSA_SIGNATURE:
     bundlekey = "CertDumpAnsiX9DsaSignature";
     break;
   case SEC_OID_ANSIX9_DSA_SIGNATURE_WITH_SHA1_DIGEST:
     bundlekey = "CertDumpAnsiX9DsaSignatureWithSha1";
     break;
-  case SEC_OID_ANSIX962_ECDSA_SIGNATURE_WITH_SHA1_DIGEST:
+  case SEC_OID_ANSIX962_ECDSA_SHA1_SIGNATURE:
     bundlekey = "CertDumpAnsiX962ECDsaSignatureWithSha1";
     break;
+  case SEC_OID_ANSIX962_ECDSA_SHA224_SIGNATURE:
+    bundlekey = "CertDumpAnsiX962ECDsaSignatureWithSha224";
+    break;
+  case SEC_OID_ANSIX962_ECDSA_SHA256_SIGNATURE:
+    bundlekey = "CertDumpAnsiX962ECDsaSignatureWithSha256";
+    break;
+  case SEC_OID_ANSIX962_ECDSA_SHA384_SIGNATURE:
+    bundlekey = "CertDumpAnsiX962ECDsaSignatureWithSha384";
+    break;
+  case SEC_OID_ANSIX962_ECDSA_SHA512_SIGNATURE:
+    bundlekey = "CertDumpAnsiX962ECDsaSignatureWithSha512";
+    break;
   case SEC_OID_RFC1274_UID:
     bundlekey = "CertDumpUserID";
     break;
   case SEC_OID_PKCS9_EMAIL_ADDRESS:
     bundlekey = "CertDumpPK9Email";
     break;
   case SEC_OID_ANSIX962_EC_PUBLIC_KEY:
     bundlekey = "CertDumpECPublicKey";
