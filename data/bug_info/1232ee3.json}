{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Bas1232ee3\""},"diff":[{"chunks":[{"content":"@@ -2379,6 +2379,8 @@ nsCanvasRenderingContext2D::GetImageData()","changes":[{"type":"normal","normal":true,"ln1":2379,"ln2":2379,"content":"     ncc->GetArgc(&argc);"},{"type":"normal","normal":true,"ln1":2380,"ln2":2380,"content":"     ncc->GetArgvPtr(&argv);"},{"type":"normal","normal":true,"ln1":2381,"ln2":2381,"content":" "},{"type":"add","add":true,"ln":2382,"content":"+    JSAutoRequest ar(ctx);"},{"type":"add","add":true,"ln":2383,"content":"+"},{"type":"normal","normal":true,"ln1":2382,"ln2":2384,"content":"     int32 x, y, w, h;"},{"type":"normal","normal":true,"ln1":2383,"ln2":2385,"content":"     if (!JS_ConvertArguments (ctx, argc, argv, \"jjjj\", &x, &y, &w, &h))"},{"type":"normal","normal":true,"ln1":2384,"ln2":2386,"content":"         return NS_ERROR_DOM_SYNTAX_ERR;"}],"oldStart":2379,"oldLines":6,"newStart":2379,"newLines":8},{"content":"@@ -2495,6 +2497,8 @@ nsCanvasRenderingContext2D::PutImageData()","changes":[{"type":"normal","normal":true,"ln1":2495,"ln2":2497,"content":"     ncc->GetArgc(&argc);"},{"type":"normal","normal":true,"ln1":2496,"ln2":2498,"content":"     ncc->GetArgvPtr(&argv);"},{"type":"normal","normal":true,"ln1":2497,"ln2":2499,"content":" "},{"type":"add","add":true,"ln":2500,"content":"+    JSAutoRequest ar(ctx);"},{"type":"add","add":true,"ln":2501,"content":"+"},{"type":"normal","normal":true,"ln1":2498,"ln2":2502,"content":"     JSObject *dataObject;"},{"type":"normal","normal":true,"ln1":2499,"ln2":2503,"content":"     int32 x, y;"},{"type":"normal","normal":true,"ln1":2500,"ln2":2504,"content":" "}],"oldStart":2495,"oldLines":6,"newStart":2497,"newLines":8}],"deletions":0,"additions":4,"from":"content/canvas/src/nsCanvasRenderingContext2D.cpp","to":"content/canvas/src/nsCanvasRenderingContext2D.cpp","index":["46321bb..e4cbdc1","100644"]},{"chunks":[{"content":"@@ -317,6 +317,8 @@ nsHTMLCanvasElement::ToDataURL(nsAString& aDataURL)","changes":[{"type":"normal","normal":true,"ln1":317,"ln2":317,"content":"     return ToDataURLImpl(NS_LITERAL_STRING(\"image/png\"), EmptyString(), aDataURL);"},{"type":"normal","normal":true,"ln1":318,"ln2":318,"content":"   }"},{"type":"normal","normal":true,"ln1":319,"ln2":319,"content":" "},{"type":"add","add":true,"ln":320,"content":"+  JSAutoRequest ar(ctx);"},{"type":"add","add":true,"ln":321,"content":"+"},{"type":"normal","normal":true,"ln1":320,"ln2":322,"content":"   // 1-arg case; convert to given mime type"},{"type":"normal","normal":true,"ln1":321,"ln2":323,"content":"   if (argc == 1) {"},{"type":"normal","normal":true,"ln1":322,"ln2":324,"content":"     if (!JSVAL_IS_STRING(argv[0]))"}],"oldStart":317,"oldLines":6,"newStart":317,"newLines":8}],"deletions":0,"additions":2,"from":"content/html/content/src/nsHTMLCanvasElement.cpp","to":"content/html/content/src/nsHTMLCanvasElement.cpp","index":["0dd827f..ef55ba4","100644"]},{"chunks":[{"content":"@@ -1950,6 +1950,7 @@ nsCrypto::GenerateCRMFRequest(nsIDOMCRMFObject** aReturn)","changes":[{"type":"normal","normal":true,"ln1":1950,"ln2":1950,"content":"   JSObject* script_obj = nsnull;"},{"type":"normal","normal":true,"ln1":1951,"ln2":1951,"content":"   nsCOMPtr<nsIXPConnectJSObjectHolder> holder;"},{"type":"normal","normal":true,"ln1":1952,"ln2":1952,"content":" "},{"type":"add","add":true,"ln":1953,"content":"+  JSAutoRequest ar(cx);"},{"type":"normal","normal":true,"ln1":1953,"ln2":1954,"content":" "},{"type":"normal","normal":true,"ln1":1954,"ln2":1955,"content":"   /*"},{"type":"normal","normal":true,"ln1":1955,"ln2":1956,"content":"    * Get all of the parameters."}],"oldStart":1950,"oldLines":6,"newStart":1950,"newLines":7},{"content":"@@ -2663,6 +2664,8 @@ nsCrypto::SignText(const nsAString& aStringToSign, const nsAString& aCaOption,","changes":[{"type":"normal","normal":true,"ln1":2663,"ln2":2664,"content":"     jsval *argv = nsnull;"},{"type":"normal","normal":true,"ln1":2664,"ln2":2665,"content":"     ncc->GetArgvPtr(&argv);"},{"type":"normal","normal":true,"ln1":2665,"ln2":2666,"content":" "},{"type":"add","add":true,"ln":2667,"content":"+    JSAutoRequest ar(cx);"},{"type":"add","add":true,"ln":2668,"content":"+"},{"type":"normal","normal":true,"ln1":2666,"ln2":2669,"content":"     PRUint32 i;"},{"type":"normal","normal":true,"ln1":2667,"ln2":2670,"content":"     for (i = 2; i < argc; ++i) {"},{"type":"normal","normal":true,"ln1":2668,"ln2":2671,"content":"       JSString *caName = JS_ValueToString(cx, argv[i]);"}],"oldStart":2663,"oldLines":6,"newStart":2664,"newLines":8}],"deletions":0,"additions":3,"from":"security/manager/ssl/src/nsCrypto.cpp","to":"security/manager/ssl/src/nsCrypto.cpp","index":["4f1cc44..2632c52","100644"]}]}