Bug 368130 Bogus ^"SSL is disabled^" error when SSL3 is disabled
diff --git a/security/manager/ssl/src/nsNSSIOLayer.cpp b/security/manager/ssl/src/nsNSSIOLayer.cpp
--- a/security/manager/ssl/src/nsNSSIOLayer.cpp
+++ b/security/manager/ssl/src/nsNSSIOLayer.cpp
@@ -1479,7 +1479,15 @@ nsSSLIOLayerHelpers::rememberPossibleTLS
   PRBool currentlyUsesTLS = PR_FALSE;
 
   SSL_OptionGet(ssl_layer_fd, SSL_ENABLE_TLS, &currentlyUsesTLS);
-  if (currentlyUsesTLS) {
+  if (!currentlyUsesTLS)
+    return PR_FALSE;
+
+  PRBool enableSSL3 = PR_FALSE;
+  SSL_OptionGet(ssl_layer_fd, SSL_ENABLE_SSL3, &enableSSL3);
+  PRBool enableSSL2 = PR_FALSE;
+  SSL_OptionGet(ssl_layer_fd, SSL_ENABLE_SSL2, &enableSSL2);
+  if (enableSSL3 || enableSSL2)
+  {
     // Add this site to the list of TLS intolerant sites.
     PRInt32 port;
     nsXPIDLCString host;
