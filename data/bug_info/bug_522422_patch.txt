Index: src/browser/BrowserWindowController.mm
===================================================================
RCS file: /cvsroot/mozilla/camino/src/browser/BrowserWindowController.mm,v
retrieving revision 1.418
diff -u -8 -r1.418 BrowserWindowController.mm
--- src/browser/BrowserWindowController.mm	26 Oct 2009 16:50:14 -0000	1.418
+++ src/browser/BrowserWindowController.mm	26 Oct 2009 21:09:05 -0000
@@ -5040,16 +5040,23 @@
 
 - (void) focusChangedFrom:(NSResponder*) oldResponder to:(NSResponder*) newResponder
 {
   BOOL oldResponderIsGecko = [self isResponderGeckoView:oldResponder];
   BOOL newResponderIsGecko = [self isResponderGeckoView:newResponder];
 
   if (oldResponderIsGecko != newResponderIsGecko && [[self window] isKeyWindow])
     [mBrowserView setBrowserActive:newResponderIsGecko];
+
+  // When the blocked page overlay shows up, Gecko causes us to lose content
+  // focus; manually restore it if that happens.
+  if (newResponder == [self window] && oldResponderIsGecko &&
+      [mBrowserView isBlockedErrorOverlayShowing]) {
+    [[self window] makeFirstResponder:[mBrowserView browserView]];
+  }
 }
 
 //
 // -control:textView:doCommandBySelector:
 // NSControl delegate method
 // 
 // Bring up the search field's menu if the down arrow key is pressed when the
 // caret is at the end of the input text.
