# HG changeset patch
# Parent 59b16cd76fd2cd1e99a58f63b13aeb2a0b7486ec

diff --git a/suite/common/certError.xhtml b/suite/common/certError.xhtml
--- a/suite/common/certError.xhtml
+++ b/suite/common/certError.xhtml
@@ -113,6 +113,13 @@
           toggle('expertContent');
         }
 
+        // if this is a Strict-Transport-Security host and the cert
+        // is bad, don't allow overrides (STS Spec section 7.3).
+        if (getCSSClass() == "badStsCert") {
+          var ec = document.getElementById('expertContent');
+          document.getElementById('errorLongContent').removeChild(ec);
+        }
+
         // Rather than textContent, we need to treat description as HTML
         var sd = document.getElementById("technicalContentText");
         if (!sd)
