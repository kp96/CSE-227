diff --git a/security/manager/ssl/src/nsCertOverrideService.cpp b/security/manager/ssl/src/nsCertOverrideService.cpp
--- a/security/manager/ssl/src/nsCertOverrideService.cpp
+++ b/security/manager/ssl/src/nsCertOverrideService.cpp
@@ -412,28 +412,29 @@ nsCertOverrideService::Write()
 }
 
 static nsresult
 GetCertFingerprintByOidTag(CERTCertificate* nsscert,
                            SECOidTag aOidTag, 
                            nsCString &fp)
 {
   unsigned int hash_len = HASH_ResultLenByOidTag(aOidTag);
-  nsRefPtr<nsStringBuffer> fingerprint = nsStringBuffer::Alloc(hash_len);
+  nsStringBuffer* fingerprint = nsStringBuffer::Alloc(hash_len);
   if (!fingerprint)
     return NS_ERROR_OUT_OF_MEMORY;
 
   PK11_HashBuf(aOidTag, (unsigned char*)fingerprint->Data(), 
                nsscert->derCert.data, nsscert->derCert.len);
 
   SECItem fpItem;
   fpItem.data = (unsigned char*)fingerprint->Data();
   fpItem.len = hash_len;
 
   fp.Adopt(CERT_Hexify(&fpItem, 1));
+  fingerprint->Release();
   return NS_OK;
 }
 
 static nsresult
 GetCertFingerprintByOidTag(nsIX509Cert *aCert,
                            SECOidTag aOidTag, 
                            nsCString &fp)
 {
