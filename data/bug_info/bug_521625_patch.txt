Index: src/security/BrowserSecurityDialogs.mm
===================================================================
RCS file: /cvsroot/mozilla/camino/src/security/BrowserSecurityDialogs.mm,v
retrieving revision 1.8
diff -u -8 -r1.8 BrowserSecurityDialogs.mm
--- src/security/BrowserSecurityDialogs.mm	2 Jun 2009 03:44:49 -0000	1.8
+++ src/security/BrowserSecurityDialogs.mm	11 Oct 2009 04:47:07 -0000
@@ -319,16 +319,20 @@
   NSString* problemDescription = nil;
   if (mCertFailureFlags & CHCertificateOverrideFlagUntrusted) {
     NSString* messageFormat = NSLocalizedStringFromTable(@"InvalidCertMessageFormat", @"CertificateDialogs", nil);
     problemDescription = [NSString stringWithFormat:messageFormat, mSourceHost];
   }
   else if (mCertFailureFlags & CHCertificateOverrideFlagDomainMismatch) {
     NSString* messageFormat = NSLocalizedStringFromTable(@"MismatchedCertMessageFormat", @"CertificateDialogs", nil);
     problemDescription = [NSString stringWithFormat:messageFormat, [certItem commonName], mSourceHost];
+  }
+  else if (mCertFailureFlags & CHCertificateOverrideFlagInvalidTime) {
+    NSString* messageFormat = NSLocalizedStringFromTable(@"ExpiredCertMessageFormat", @"CertificateDialogs", nil);
+    problemDescription = [NSString stringWithFormat:messageFormat, mSourceHost];
   } else {
     NSString* messageFormat = NSLocalizedStringFromTable(@"InvalidCertMessageFormat", @"CertificateDialogs", nil);
     problemDescription = [NSString stringWithFormat:messageFormat, mSourceHost];
   }
   float nibMessageHeight = NSHeight([mMessageField frame]);
   [mMessageField setStringValue:problemDescription];
 
   // Adjust the the sheet and other controls to account for the message change.
