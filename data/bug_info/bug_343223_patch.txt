Index: viewCertDetails.js
===================================================================
RCS file: /cvsroot/mozilla/security/manager/pki/resources/content/viewCertDetails.js,v
retrieving revision 1.28
diff -p -u -1 -0 -r1.28 viewCertDetails.js
--- viewCertDetails.js	4 Apr 2006 13:14:29 -0000	1.28
+++ viewCertDetails.js	6 Jul 2006 23:14:14 -0000
@@ -300,26 +300,22 @@ function updateCertDump()
     var dbKey = item.firstChild.firstChild.getAttribute('display');
     //  Get the cert from the cert database
     var certdb = Components.classes[nsX509CertDB].getService(nsIX509CertDB);
     var cert = certdb.findCertByDBKey(dbKey,null);
     asn1Tree.loadASN1Structure(cert.ASN1Structure);
   }
   displaySelected();
 }
 
 function getProxyOnUIThread(aObject, aInterface) {
-    var eventQSvc = Components.
-            classes["@mozilla.org/event-queue-service;1"].
-            getService(Components.interfaces.nsIEventQueueService);
-
-    var uiQueue = eventQSvc.
-            getSpecialEventQueue(Components.interfaces.
-            nsIEventQueueService.UI_THREAD_EVENT_QUEUE);
+    var mainThread = Components.
+            classes["@mozilla.org/thread-manager;1"].
+            getService().mainThread;
 
     var proxyMgr = Components.
             classes["@mozilla.org/xpcomproxy;1"].
             getService(Components.interfaces.nsIProxyObjectManager);
 
-    return proxyMgr.getProxyForObject(uiQueue,
+    return proxyMgr.getProxyForObject(mainThread,
             aInterface, aObject, 5);
-    // 5 == PROXY_ALWAYS | PROXY_SYNC
+    // 5 == NS_PROXY_ALWAYS | NS_PROXY_SYNC
 }
