Index: mozilla/security/manager/ssl/src/nsCertOverrideService.cpp
===================================================================
RCS file: /cvsroot/mozilla/security/manager/ssl/src/nsCertOverrideService.cpp,v
retrieving revision 1.4
diff -u -u -8 -p -r1.4 nsCertOverrideService.cpp
--- mozilla/security/manager/ssl/src/nsCertOverrideService.cpp	1 Feb 2008 06:04:56 -0000	1.4
+++ mozilla/security/manager/ssl/src/nsCertOverrideService.cpp	18 Feb 2008 12:03:03 -0000
@@ -53,16 +53,17 @@
 #include "nsProxiedService.h"
 #include "nsStringBuffer.h"
 #include "nsAutoLock.h"
 #include "nsAutoPtr.h"
 #include "nspr.h"
 #include "pk11pub.h"
 #include "certdb.h"
 #include "sechash.h"
+#include "ssl.h" // For SSL_ClearSessionCache
 
 #include "nsNSSCleaner.h"
 NSSCleanupAutoPtrClass(CERTCertificate, CERT_DestroyCertificate)
 
 static const char kCertOverrideFileName[] = "cert_override.txt";
 
 void
 nsCertOverride::convertBitsToString(OverrideBits ob, nsACString &str)
@@ -650,16 +651,17 @@ NS_IMETHODIMP
 nsCertOverrideService::ClearValidityOverride(const nsAString & aHostNameWithPort)
 {
   NS_ConvertUTF16toUTF8 hp8(aHostNameWithPort);
   {
     nsAutoMonitor lock(monitor);
     mSettingsTable.RemoveEntry(hp8.get());
     Write();
   }
+  SSL_ClearSessionCache();
   return NS_OK;
 }
 
 NS_IMETHODIMP
 nsCertOverrideService::GetAllOverrideHostsWithPorts(PRUint32 *aCount, 
                                                         PRUnichar ***aHostsWithPortsArray)
 {
   return NS_ERROR_NOT_IMPLEMENTED;
