{"bug_id":194872,"commitHash":"66730e2","commit_info":{"sha":"66730e2ca70b6093eab98718138fe7011774d84d","commit":{"author":{"name":"timeless%mozdev.org","email":"timeless%mozdev.org","date":"2003-06-26T03:27:01Z"},"committer":{"name":"timeless%mozdev.org","email":"timeless%mozdev.org","date":"2003-06-26T03:27:01Z"},"message":"Bug 194872 CAPS vulnerability when doing cross-site-scripting with frames from different origins and different CAPS settings (allAccess, noAccess).\nbustage (const char*)\nsr=jst","tree":{"sha":"2ceeda3256b84b8b08701663da3e2308791298f8","url":"https://api.github.com/repos/mozilla/gecko-dev/git/trees/2ceeda3256b84b8b08701663da3e2308791298f8"},"url":"https://api.github.com/repos/mozilla/gecko-dev/git/commits/66730e2ca70b6093eab98718138fe7011774d84d","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/mozilla/gecko-dev/commits/66730e2ca70b6093eab98718138fe7011774d84d","html_url":"https://github.com/mozilla/gecko-dev/commit/66730e2ca70b6093eab98718138fe7011774d84d","comments_url":"https://api.github.com/repos/mozilla/gecko-dev/commits/66730e2ca70b6093eab98718138fe7011774d84d/comments","author":null,"committer":null,"parents":[{"sha":"c3bfed0b9c875d578770d3fa49a2470d62108730","url":"https://api.github.com/repos/mozilla/gecko-dev/commits/c3bfed0b9c875d578770d3fa49a2470d62108730","html_url":"https://github.com/mozilla/gecko-dev/commit/c3bfed0b9c875d578770d3fa49a2470d62108730"}],"stats":{"total":14,"additions":7,"deletions":7},"files":[{"sha":"faaaa4bb775c5a1107ad1faf76abe58b2a57eecd","filename":"caps/include/nsScriptSecurityManager.h","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/mozilla/gecko-dev/blob/66730e2ca70b6093eab98718138fe7011774d84d/caps/include/nsScriptSecurityManager.h","raw_url":"https://github.com/mozilla/gecko-dev/raw/66730e2ca70b6093eab98718138fe7011774d84d/caps/include/nsScriptSecurityManager.h","contents_url":"https://api.github.com/repos/mozilla/gecko-dev/contents/caps/include/nsScriptSecurityManager.h?ref=66730e2ca70b6093eab98718138fe7011774d84d","patch":"@@ -335,7 +335,7 @@ class nsScriptSecurityManager : public nsIScriptSecurityManager,\n \n     nsresult\n     LookupPolicy(nsIPrincipal* principal,\n-                 char* aClassName, jsval aProperty,\n+                 const char* aClassName, jsval aProperty,\n                  PRUint32 aAction,\n                  ClassPolicy** aCachedClassPolicy,\n                  SecurityLevel* result);"},{"sha":"09ed7d13ba2ef3fddc16b3c82ca9b6561c2d4fdf","filename":"caps/src/nsScriptSecurityManager.cpp","status":"modified","additions":6,"deletions":6,"changes":12,"blob_url":"https://github.com/mozilla/gecko-dev/blob/66730e2ca70b6093eab98718138fe7011774d84d/caps/src/nsScriptSecurityManager.cpp","raw_url":"https://github.com/mozilla/gecko-dev/raw/66730e2ca70b6093eab98718138fe7011774d84d/caps/src/nsScriptSecurityManager.cpp","contents_url":"https://api.github.com/repos/mozilla/gecko-dev/contents/caps/src/nsScriptSecurityManager.cpp?ref=66730e2ca70b6093eab98718138fe7011774d84d","patch":"@@ -154,16 +154,16 @@ class ClassInfoData\n         return GetFlags() & nsIClassInfo::CONTENT_NODE;\n     }\n \n-    char* GetName()\n+    const char* GetName()\n     {\n         if (!mName)\n         {\n             if (mClassInfo)\n                 mClassInfo->GetClassDescription(&mName);\n-            if (mName)\n-                mMustFreeName = PR_TRUE;\n-            else\n-                mName = NS_REINTERPRET_CAST(char*,\"UnnamedClass\");\n+            if (!mName)\n+                return \"UnnamedClass\";\n+\n+            mMustFreeName = PR_TRUE;\n         }\n         return mName;\n     }\n@@ -907,7 +907,7 @@ nsScriptSecurityManager::CheckSameOriginDOMProp(nsIPrincipal* aSubject,\n \n nsresult\n nsScriptSecurityManager::LookupPolicy(nsIPrincipal* aPrincipal,\n-                                     char* aClassName, jsval aProperty,\n+                                     const char* aClassName, jsval aProperty,\n                                      PRUint32 aAction,\n                                      ClassPolicy** aCachedClassPolicy,\n                                      SecurityLevel* result)"}]},"blames":["f7460d02","ddc015e3","d8507f84","32844f77","ddc015e3","5b4b0169","3f22e806"]}