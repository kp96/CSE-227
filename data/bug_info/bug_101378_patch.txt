From: timeless@mozdev.org
Not all psm dialogs need to be modal
r=kaie

diff --git a/security/manager/pki/src/nsNSSDialogHelper.cpp b/security/manager/pki/src/nsNSSDialogHelper.cpp
--- a/security/manager/pki/src/nsNSSDialogHelper.cpp
+++ b/security/manager/pki/src/nsNSSDialogHelper.cpp
@@ -46,13 +46,15 @@
 #include "nsIInterfaceRequestor.h"
 #include "nsIInterfaceRequestorUtils.h"
 
-const char* nsNSSDialogHelper::kDefaultOpenWindowParam = "centerscreen,chrome,modal,titlebar";
+static const char kOpenDialogParam[] = "centerscreen,chrome,modal,titlebar";
+static const char kOpenWindowParam[] = "centerscreen,chrome,titlebar";
 
 nsresult
 nsNSSDialogHelper::openDialog(
     nsIDOMWindowInternal *window,
     const char *url,
-    nsISupports *params)
+    nsISupports *params,
+    PRBool modal)
 {
   nsresult rv;
   nsCOMPtr<nsIWindowWatcher> windowWatcher = 
@@ -75,7 +77,9 @@ nsNSSDialogHelper::openDialog(
   rv = windowWatcher->OpenWindow(parent,
                                  url,
                                  "_blank",
-                                 nsNSSDialogHelper::kDefaultOpenWindowParam,
+                                 modal
+                                 ? kOpenDialogParam
+                                 : kOpenWindowParam,
                                  params,
                                  getter_AddRefs(newWindow));
   return rv;
diff --git a/security/manager/pki/src/nsNSSDialogHelper.h b/security/manager/pki/src/nsNSSDialogHelper.h
--- a/security/manager/pki/src/nsNSSDialogHelper.h
+++ b/security/manager/pki/src/nsNSSDialogHelper.h
@@ -49,12 +49,12 @@
 class nsNSSDialogHelper
 {
 public:
-  const static char *kDefaultOpenWindowParam;
   //The params is going to be either a nsIPKIParamBlock or
   //nsIDialogParamBlock
   static nsresult openDialog(
                   nsIDOMWindowInternal *window,
                   const char *url,
-                  nsISupports *params);
+                  nsISupports *params,
+                  PRBool modal = PR_TRUE);
 };
 
diff --git a/security/manager/pki/src/nsNSSDialogs.cpp b/security/manager/pki/src/nsNSSDialogs.cpp
--- a/security/manager/pki/src/nsNSSDialogs.cpp
+++ b/security/manager/pki/src/nsNSSDialogs.cpp
@@ -189,7 +189,8 @@ nsNSSDialogs::CrlImportStatusDialog(nsII
 
   rv = nsNSSDialogHelper::openDialog(nsnull,
                              "chrome://pippki/content/crlImportDialog.xul",
-                             block);
+                             block,
+                             PR_FALSE);
   return NS_OK;
 }
 
@@ -469,7 +470,8 @@ nsNSSDialogs::ViewCert(nsIInterfaceReque
 
   rv = nsNSSDialogHelper::openDialog(parent,
                                      "chrome://pippki/content/certViewer.xul",
-                                     block);
+                                     block,
+                                     PR_FALSE);
   return rv;
 }
 
@@ -483,7 +485,8 @@ nsNSSDialogs::DisplayGeneratingKeypairIn
 
   rv = nsNSSDialogHelper::openDialog(parent,
                                      "chrome://pippki/content/createCertInfo.xul",
-                                     runnable);
+                                     runnable,
+                                     PR_FALSE);
   return rv;
 }
 
@@ -644,6 +647,7 @@ nsNSSDialogs::ShowCertError(nsIInterface
 
   rv = nsNSSDialogHelper::openDialog(nsnull, 
                                      "chrome://pippki/content/certerror.xul",
-                                     block);
+                                     block,
+                                     PR_FALSE);
   return rv;
 }
