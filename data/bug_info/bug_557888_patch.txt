# HG changeset patch
# Parent d49fa27028bd52fd96f51b24cb97b6c09f8162e7
# User timeless@mozdev.org
Bug 557888 nsCertAlreadyExists always leaks unused arena
r=kaie

diff --git a/security/manager/ssl/src/nsCrypto.cpp b/security/manager/ssl/src/nsCrypto.cpp
--- a/security/manager/ssl/src/nsCrypto.cpp
+++ b/security/manager/ssl/src/nsCrypto.cpp
@@ -2214,15 +2214,9 @@ static PRBool
 nsCertAlreadyExists(SECItem *derCert)
 {
   CERTCertDBHandle *handle = CERT_GetDefaultCertDB();
-  PRArenaPool *arena;
   CERTCertificate *cert;
   PRBool retVal = PR_FALSE;
 
-  arena = PORT_NewArena(DER_DEFAULT_CHUNKSIZE);
-  NS_ASSERTION(arena, "Couldn't allocate an arena!");
-  if (!arena)
-    return PR_FALSE; //What else could we return?
-
   cert = CERT_FindCertByDERCert(handle, derCert);
   if (cert) {
     if (cert->isperm && !cert->nickname && !cert->emailAddr) {
