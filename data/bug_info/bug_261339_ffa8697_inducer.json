{"bug_id":261339,"commitHash":"ffa8697","commit_info":{"sha":"ffa869708f8039b11fdc64840ab3aa10934db87e","commit":{"author":{"name":"timeless%mozdev.org","email":"timeless%mozdev.org","date":"2004-11-05T16:54:09Z"},"committer":{"name":"timeless%mozdev.org","email":"timeless%mozdev.org","date":"2004-11-05T16:54:09Z"},"message":"Bug 261339 Setting capability.policy.default.Window.top to noAccess seems to crash mozilla\nr=caillon sr=dveditz","tree":{"sha":"f384efc3b75ac18d6bad0715cd46f610e153264d","url":"https://api.github.com/repos/mozilla/gecko-dev/git/trees/f384efc3b75ac18d6bad0715cd46f610e153264d"},"url":"https://api.github.com/repos/mozilla/gecko-dev/git/commits/ffa869708f8039b11fdc64840ab3aa10934db87e","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/mozilla/gecko-dev/commits/ffa869708f8039b11fdc64840ab3aa10934db87e","html_url":"https://github.com/mozilla/gecko-dev/commit/ffa869708f8039b11fdc64840ab3aa10934db87e","comments_url":"https://api.github.com/repos/mozilla/gecko-dev/commits/ffa869708f8039b11fdc64840ab3aa10934db87e/comments","author":null,"committer":null,"parents":[{"sha":"37d49383e2bac62e95d1a7f4d222b3c0a0760cd1","url":"https://api.github.com/repos/mozilla/gecko-dev/commits/37d49383e2bac62e95d1a7f4d222b3c0a0760cd1","html_url":"https://github.com/mozilla/gecko-dev/commit/37d49383e2bac62e95d1a7f4d222b3c0a0760cd1"}],"stats":{"total":8,"additions":5,"deletions":3},"files":[{"sha":"af3d14c5f87c63105644796458e007ddea7cc9c2","filename":"caps/src/nsScriptSecurityManager.cpp","status":"modified","additions":5,"deletions":3,"changes":8,"blob_url":"https://github.com/mozilla/gecko-dev/blob/ffa869708f8039b11fdc64840ab3aa10934db87e/caps/src/nsScriptSecurityManager.cpp","raw_url":"https://github.com/mozilla/gecko-dev/raw/ffa869708f8039b11fdc64840ab3aa10934db87e/caps/src/nsScriptSecurityManager.cpp","contents_url":"https://api.github.com/repos/mozilla/gecko-dev/contents/caps/src/nsScriptSecurityManager.cpp?ref=ffa869708f8039b11fdc64840ab3aa10934db87e","patch":"@@ -918,16 +918,18 @@ nsScriptSecurityManager::LookupPolicy(nsIPrincipal* aPrincipal,\n     nsresult rv;\n     result->level = SCRIPT_SECURITY_UNDEFINED_ACCESS;\n \n+    DomainPolicy* dpolicy = nsnull;\n     //-- Initialize policies if necessary\n     if (mPolicyPrefsChanged)\n     {\n         rv = InitPolicies();\n         if (NS_FAILED(rv))\n             return rv;\n     }\n-\n-    DomainPolicy* dpolicy = nsnull;\n-    aPrincipal->GetSecurityPolicy((void**)&dpolicy);\n+    else\n+    {\n+        aPrincipal->GetSecurityPolicy((void**)&dpolicy);\n+    }\n \n     if (!dpolicy && mOriginToPolicyMap)\n     {"}]},"blames":["3f22e806","ddc015e3"]}