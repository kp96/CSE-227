{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Basc773b68\""},"diff":[{"chunks":[{"content":"@@ -230,6 +230,7 @@ void nsAccessibleTreeWalker::UpdateFrame(PRBool aTryFirstChild)","changes":[{"type":"normal","normal":true,"ln1":230,"ln2":230,"content":"     return;"},{"type":"normal","normal":true,"ln1":231,"ln2":231,"content":"   }"},{"type":"normal","normal":true,"ln1":232,"ln2":232,"content":"   if (aTryFirstChild) {"},{"type":"add","add":true,"ln":233,"content":"+    nsIContent *containerContent = mState.frame->GetContent();"},{"type":"normal","normal":true,"ln1":233,"ln2":234,"content":"     mState.frame = mState.frame->GetFirstChild(nsnull);"},{"type":"normal","normal":true,"ln1":234,"ln2":235,"content":" // temporary workaround for Bug 359210. We never want to walk frames."},{"type":"normal","normal":true,"ln1":235,"ln2":236,"content":" // Aaron Leventhal will refix :before and :after content later without walking frames."}],"oldStart":230,"oldLines":6,"newStart":230,"newLines":7},{"content":"@@ -253,6 +254,17 @@ void nsAccessibleTreeWalker::UpdateFrame(PRBool aTryFirstChild)","changes":[{"type":"normal","normal":true,"ln1":253,"ln2":254,"content":"       mState.siblingIndex = eSiblingsWalkFrames;"},{"type":"normal","normal":true,"ln1":254,"ln2":255,"content":"     }"},{"type":"normal","normal":true,"ln1":255,"ln2":256,"content":" #endif"},{"type":"add","add":true,"ln":257,"content":"+    // Special case: <input type=\"file\">"},{"type":"add","add":true,"ln":258,"content":"+    // We should still need to walk frames inside the file control frame"},{"type":"add","add":true,"ln":259,"content":"+    // This special case may turn into a more general rule after Firefox 3,"},{"type":"add","add":true,"ln":260,"content":"+    // if HTML 5 controls use nsIAnonymousContentCreator"},{"type":"add","add":true,"ln":261,"content":"+    if (containerContent->Tag() == nsAccessibilityAtoms::input &&"},{"type":"add","add":true,"ln":262,"content":"+        containerContent->AttrValueIs(kNameSpaceID_None, nsAccessibilityAtoms::type,"},{"type":"add","add":true,"ln":263,"content":"+                                      NS_LITERAL_STRING(\"file\"), eIgnoreCase) &&"},{"type":"add","add":true,"ln":264,"content":"+        mState.frame && mState.siblingIndex < 0)  {"},{"type":"add","add":true,"ln":265,"content":"+      mState.domNode = do_QueryInterface(mState.frame->GetContent());"},{"type":"add","add":true,"ln":266,"content":"+      mState.siblingIndex = eSiblingsWalkFrames;"},{"type":"add","add":true,"ln":267,"content":"+    }"},{"type":"normal","normal":true,"ln1":256,"ln2":268,"content":"   }"},{"type":"normal","normal":true,"ln1":257,"ln2":269,"content":"   else {"},{"type":"normal","normal":true,"ln1":258,"ln2":270,"content":"     mState.frame = mState.frame->GetNextSibling();"}],"oldStart":253,"oldLines":6,"newStart":254,"newLines":17}],"deletions":0,"additions":12,"from":"accessible/src/base/nsAccessibleTreeWalker.cpp","to":"accessible/src/base/nsAccessibleTreeWalker.cpp","index":["f1a0c2e..f2a9770","100755"]},{"chunks":[{"content":"@@ -70,6 +70,9 @@","changes":[{"type":"normal","normal":true,"ln1":70,"ln2":70,"content":" #include \"nsContentCreatorFunctions.h\""},{"type":"normal","normal":true,"ln1":71,"ln2":71,"content":" #include \"nsContentUtils.h\""},{"type":"normal","normal":true,"ln1":72,"ln2":72,"content":" #include \"nsDisplayList.h\""},{"type":"add","add":true,"ln":73,"content":"+#ifdef ACCESSIBILITY"},{"type":"add","add":true,"ln":74,"content":"+#include \"nsIAccessibilityService.h\""},{"type":"add","add":true,"ln":75,"content":"+#endif"},{"type":"normal","normal":true,"ln1":73,"ln2":76,"content":" "},{"type":"normal","normal":true,"ln1":74,"ln2":77,"content":" #define SYNC_TEXT 0x1"},{"type":"normal","normal":true,"ln1":75,"ln2":78,"content":" #define SYNC_BUTTON 0x2"}],"oldStart":70,"oldLines":6,"newStart":70,"newLines":9},{"content":"@@ -598,6 +601,15 @@ nsFileControlFrame::BuildDisplayList(nsDisplayListBuilder*   aBuilder,","changes":[{"type":"normal","normal":true,"ln1":598,"ln2":601,"content":"   return DisplaySelectionOverlay(aBuilder, aLists);"},{"type":"normal","normal":true,"ln1":599,"ln2":602,"content":" }"},{"type":"normal","normal":true,"ln1":600,"ln2":603,"content":" "},{"type":"add","add":true,"ln":604,"content":"+#ifdef ACCESSIBILITY"},{"type":"add","add":true,"ln":605,"content":"+NS_IMETHODIMP nsFileControlFrame::GetAccessible(nsIAccessible** aAccessible)"},{"type":"add","add":true,"ln":606,"content":"+{"},{"type":"add","add":true,"ln":607,"content":"+  // No accessible object for file control, only for child text frame and button"},{"type":"add","add":true,"ln":608,"content":"+  *aAccessible = nsnull;"},{"type":"add","add":true,"ln":609,"content":"+  return NS_ERROR_FAILURE;"},{"type":"add","add":true,"ln":610,"content":"+}"},{"type":"add","add":true,"ln":611,"content":"+#endif"},{"type":"add","add":true,"ln":612,"content":"+"},{"type":"normal","normal":true,"ln1":601,"ln2":613,"content":" ////////////////////////////////////////////////////////////"},{"type":"normal","normal":true,"ln1":602,"ln2":614,"content":" // Mouse listener implementation"},{"type":"normal","normal":true,"ln1":603,"ln2":615,"content":" "}],"oldStart":598,"oldLines":6,"newStart":601,"newLines":15}],"deletions":0,"additions":12,"from":"layout/forms/nsFileControlFrame.cpp","to":"layout/forms/nsFileControlFrame.cpp","index":["f402bad..a89c181","100644"]},{"chunks":[{"content":"@@ -93,6 +93,10 @@ public:","changes":[{"type":"normal","normal":true,"ln1":93,"ln2":93,"content":"   // nsIAnonymousContentCreator"},{"type":"normal","normal":true,"ln1":94,"ln2":94,"content":"   virtual nsresult CreateAnonymousContent(nsTArray<nsIContent*>& aElements);"},{"type":"normal","normal":true,"ln1":95,"ln2":95,"content":" "},{"type":"add","add":true,"ln":96,"content":"+#ifdef ACCESSIBILITY"},{"type":"add","add":true,"ln":97,"content":"+  NS_IMETHOD GetAccessible(nsIAccessible** aAccessible);"},{"type":"add","add":true,"ln":98,"content":"+#endif"},{"type":"add","add":true,"ln":99,"content":"+"},{"type":"normal","normal":true,"ln1":96,"ln2":100,"content":" protected:"},{"type":"normal","normal":true,"ln1":97,"ln2":101,"content":"   class MouseListener;"},{"type":"normal","normal":true,"ln1":98,"ln2":102,"content":"   friend class MouseListener;"}],"oldStart":93,"oldLines":6,"newStart":93,"newLines":10}],"deletions":0,"additions":4,"from":"layout/forms/nsFileControlFrame.h","to":"layout/forms/nsFileControlFrame.h","index":["09d87b6..e23f357","100644"]}]}