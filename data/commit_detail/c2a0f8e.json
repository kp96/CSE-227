{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Basc2a0f8e\""},"diff":"\"c2a0f8e Bug 392793 - invalid (negative) progress percentage displayed in the window title for certain downloads p=Ryan Jones <sciguyryan@gmail.com> r=sdwilsh\\ndiff --git a/toolkit/mozapps/downloads/content/downloads.js b/toolkit/mozapps/downloads/content/downloads.js\\nindex 0ee7a8c..732bb8d 100644\\n--- a/toolkit/mozapps/downloads/content/downloads.js\\n+++ b/toolkit/mozapps/downloads/content/downloads.js\\n@@ -88,7 +88,7 @@ function createDownloadItem(aID, aFile, aTarget, aURI, aState,\\n   dl.setAttribute(\\\"type\\\", \\\"download\\\");\\n   dl.setAttribute(\\\"id\\\", \\\"dl\\\" + aID);\\n   dl.setAttribute(\\\"dlid\\\", aID);\\n-  dl.setAttribute(\\\"image\\\", \\\"moz-icon://\\\" + aFile + \\\"?size=32\\\");\\r\\n+  dl.setAttribute(\\\"image\\\", \\\"moz-icon://\\\" + aFile + \\\"?size=32\\\");\\n   dl.setAttribute(\\\"file\\\", aFile);\\n   dl.setAttribute(\\\"target\\\", aTarget);\\n   dl.setAttribute(\\\"uri\\\", aURI);\\n@@ -381,8 +381,10 @@ function onUpdateProgress()\\n   while (dls.hasMoreElements()) {\\n     let dl = dls.getNext();\\n     dl.QueryInterface(Ci.nsIDownload);\\n-    mean += dl.amountTransferred;\\n-    base += dl.size;\\n+    if (dl.percentComplete < 100 && dl.size > 0) {\\n+      mean += dl.amountTransferred;\\n+      base += dl.size;\\n+    }\\n     numActiveDownloads++;\\n   }\\n \\n\""}