{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Bas1864641\""},"diff":"\"1864641 Bug 175893. Make XUL Tabs focusable -- reopened because when switching tabs we were scrolling to the remembered focus instead of remaining at the last position. r=mconnor, sr=neil\\ndiff --git a/browser/base/content/tabbrowser.xml b/browser/base/content/tabbrowser.xml\\nindex 0243066..9e5b19a 100644\\n--- a/browser/base/content/tabbrowser.xml\\n+++ b/browser/base/content/tabbrowser.xml\\n@@ -492,8 +492,11 @@\\n               }\\n             }\\n \\n-            function setFocus(element) {\\n-               Components.lookupMethod(element, \\\"focus\\\").call(element);\\n+            if (document.commandDispatcher.focusedElement && \\n+                document.commandDispatcher.focusedElement.parentNode == \\n+                this.mCurrentTab.parentNode) {\\n+              // The focus is on a tab in the same tab panel\\n+              return;  // If focus was on a tab, switching tabs focuses the new tab\\n             }\\n             \\n             var whatToFocus = window.content;\\n@@ -510,10 +513,14 @@\\n               whatToFocus = newBrowser.focusedWindow;\\n             }\\n \\n-            document.commandDispatcher.suppressFocusScroll = true;\\n+            function setFocus(element) {\\n+              document.commandDispatcher.suppressFocusScroll = true;\\n+              Components.lookupMethod(element, \\\"focus\\\").call(element);\\n+              document.commandDispatcher.suppressFocusScroll = false;\\n+            }\\n+\\n             // Use setTimeout to avoid focus outline ghosting.\\n             setTimeout(setFocus, 0, whatToFocus);\\n-            document.commandDispatcher.suppressFocusScroll = false;    \\n           ]]>\\n         </body>\\n       </method>\\n\""}