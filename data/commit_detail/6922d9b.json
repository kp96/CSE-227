{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Bas6922d9b\""},"diff":"\"6922d9b wait for signing log to proceed b=392969 r=cf\\ndiff --git a/tools/release/Bootstrap/Step/Sign.pm b/tools/release/Bootstrap/Step/Sign.pm\\nindex bc9b821..62f1831 100644\\n--- a/tools/release/Bootstrap/Step/Sign.pm\\n+++ b/tools/release/Bootstrap/Step/Sign.pm\\n@@ -1,5 +1,5 @@\\n #\\n-# Sign step. Applies digital signatures to builds.\\n+# Sign step. Wait for signed builds to appear.\\n # \\n package Bootstrap::Step::Sign;\\n use Bootstrap::Step;\\n@@ -10,25 +10,27 @@ sub Execute {\\n     my $this = shift;\\n \\n     my $config = new Bootstrap::Config();\\n-    my $logDir = $config->Get(sysvar => 'logDir');\\n+    my $rc = $config->Get(var => 'rc');\\n \\n-    $this->Shell(\\n-      cmd => 'echo',\\n-      cmdArgs => ['sign'],\\n-      logFile => catfile($logDir, 'sign.log'),\\n-    );\\n+    my $signedDir = $config->GetFtpCandidateDir(bitsUnsigned => 0);\\n+\\n+    while (! -f catfile($signedDir . 'win32_signing_rc' . $rc . '.log')) {\\n+        sleep(10);\\n+    }\\n }\\n \\n-sub Verify {\\n+sub Verify {}\\n+\\n+sub Announce {\\n     my $this = shift;\\n \\n     my $config = new Bootstrap::Config();\\n-    my $logDir = $config->Get(sysvar => 'logDir');\\n+    my $product = $config->Get(var => 'product');\\n+    my $version = $config->Get(var => 'version');\\n \\n-    $this->Shell(\\n-      cmd => 'echo',\\n-      cmdArgs => ['Verify sign'],\\n-      logFile => catfile($logDir, 'sign_verify.log'),\\n+    $this->SendAnnouncement(\\n+      subject => \\\"$product $version sign step finished\\\",\\n+      message => \\\"$product $version win32 builds have been signed and copied to the candidates dir.\\\",\\n     );\\n }\\n \\ndiff --git a/tools/release/README b/tools/release/README\\nindex ca4c3ba..d66e1ba 100644\\n--- a/tools/release/README\\n+++ b/tools/release/README\\n@@ -43,9 +43,9 @@ Steps\\n 2) Build \\n 3) Source\\n 4) Repack\\n-5) Updates\\n-6) Stage\\n-7) Sign\\n+5) Sign\\n+6) Updates\\n+7) Stage\\n    \\n Details\\n -----------------\\n@@ -62,6 +62,8 @@ Repack\\n   repack l10n, uses en-US build (based on tag)\\n   push to stage\\n   announce\\n+Sign\\n+  manual\\n Updates\\n   uses patcher\\n   generate partials and AUS config (\\\"snippets\\\")\\n@@ -72,5 +74,3 @@ Stage\\n   create release directory/filename structure\\n   merge updates\\n   announce\\n-Sign\\n-  manual\\ndiff --git a/tools/release/release b/tools/release/release\\nindex fa21feb..e26bfa42 100755\\n--- a/tools/release/release\\n+++ b/tools/release/release\\n@@ -21,10 +21,10 @@ my @allSteps = (\\n     'Build',\\n     'Source',\\n     'Repack',\\n+    'Sign',\\n     'PatcherConfig',\\n     'Updates',\\n     'Stage',\\n-    'Sign',\\n );\\n \\n my %config;\\n\""}