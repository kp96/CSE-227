{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Bas342bd86\""},"diff":"\"342bd86 Bug 393301 - Add UI for downloads in scanning state. r=gavin.sharp, a=mconnor\\ndiff --git a/toolkit/locales/en-US/chrome/mozapps/downloads/downloads.dtd b/toolkit/locales/en-US/chrome/mozapps/downloads/downloads.dtd\\nindex 518c93c..1538319 100644\\n--- a/toolkit/locales/en-US/chrome/mozapps/downloads/downloads.dtd\\n+++ b/toolkit/locales/en-US/chrome/mozapps/downloads/downloads.dtd\\n@@ -9,6 +9,7 @@\\n \\n <!-- 'Parental Controls' label should be capitalized -->\\n <!ENTITY blocked.label                    \\\"Blocked by Parental Controls\\\">\\n+<!ENTITY scanning.label                   \\\"Scanning for viruses...\\\">\\n \\n <!ENTITY downloads.title                  \\\"Downloads\\\">\\n \\ndiff --git a/toolkit/mozapps/downloads/content/download.xml b/toolkit/mozapps/downloads/content/download.xml\\nindex b34ae20..6e17701 100644\\n--- a/toolkit/mozapps/downloads/content/download.xml\\n+++ b/toolkit/mozapps/downloads/content/download.xml\\n@@ -314,4 +314,31 @@\\n       </xul:hbox>\\n     </content>\\n   </binding>\\n+\\n+  <binding id=\\\"download-scanning\\\" extends=\\\"chrome://mozapps/content/downloads/download.xml#download-base\\\">\\n+    <content>\\n+      <xul:hbox flex=\\\"1\\\">\\n+#ifdef SHOW_ICONS\\n+        <xul:vbox pack=\\\"start\\\">\\n+          <xul:image class=\\\"downloadTypeIcon\\\" validate=\\\"always\\\"\\n+                     xbl:inherits=\\\"src=image\\\"/>\\n+        </xul:vbox>\\n+#endif\\n+        <xul:vbox pack=\\\"start\\\" flex=\\\"1\\\">\\n+          <xul:label xbl:inherits=\\\"value=target,tooltiptext=target\\\"\\n+                       crop=\\\"center\\\" flex=\\\"2\\\" class=\\\"name\\\"/>\\n+          <xul:hbox>\\n+            <xul:vbox flex=\\\"1\\\">\\n+              <xul:progressmeter mode=\\\"undetermined\\\" flex=\\\"1\\\" />\\n+            </xul:vbox>\\n+            <xul:button class=\\\"info mini-button\\\" tooltiptext=\\\"&cmd.info.label;\\\"\\n+                        command=\\\"cmd_showInfo\\\" ondblclick=\\\"event.stopPropagation();\\\"\\n+                        anonid=\\\"info\\\"/>\\n+          </xul:hbox>\\n+          <xul:label value=\\\"&scanning.label;\\\" class=\\\"status\\\"/>\\n+          <xul:spacer flex=\\\"1\\\"/>\\n+        </xul:vbox>\\n+      </xul:hbox>\\n+    </content>  \\n+  </binding>\\n </bindings>\\ndiff --git a/toolkit/mozapps/downloads/content/downloads.css b/toolkit/mozapps/downloads/content/downloads.css\\nindex c2c5d3b..f70d46d 100644\\n--- a/toolkit/mozapps/downloads/content/downloads.css\\n+++ b/toolkit/mozapps/downloads/content/downloads.css\\n@@ -27,6 +27,10 @@ richlistitem[type=\\\"download\\\"][state=\\\"6\\\"] {\\n   -moz-binding: url('chrome://mozapps/content/downloads/download.xml#download-blocked');\\n }\\n \\n+richlistitem[type=\\\"download\\\"][state=\\\"7\\\"] {\\n+  -moz-binding: url('chrome://mozapps/content/downloads/download.xml#download-scanning');\\n+}\\n+\\n /* Only focus buttons in the selected item*/\\n richlistitem[type=\\\"download\\\"]:not([selected=\\\"true\\\"]) button {\\n   -moz-user-focus: none;\\ndiff --git a/toolkit/mozapps/downloads/content/downloads.js b/toolkit/mozapps/downloads/content/downloads.js\\nindex c15b333..ef4d688 100644\\n--- a/toolkit/mozapps/downloads/content/downloads.js\\n+++ b/toolkit/mozapps/downloads/content/downloads.js\\n@@ -477,7 +477,9 @@ var gContextMenus = [\\n    \\\"menuitem_copyLocation\\\"],\\n   // DOWNLOAD_BLOCKED\\n   [\\\"menuitem_retry\\\", \\\"menuitem_remove\\\", \\\"menuseparator_copy_location\\\",\\n-   \\\"menuitem_copyLocation\\\"]\\n+   \\\"menuitem_copyLocation\\\"],\\n+  // DOWNLOAD_SCANNING\\n+  [\\\"menuitem_copyLocation\\\"]\\n ];\\n \\n function buildContextMenu(aEvent)\\n\""}