{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Base9e1f65\""},"diff":"\"e9e1f65 Bug 395708: handle invalid IDs passed to nsIDownloadManagerUI::show (makes clicking on the \\\"download complete\\\" notification work when the download manager isn't open), r=sdwilsh\\ndiff --git a/toolkit/components/downloads/src/nsDownloadManagerUI.js b/toolkit/components/downloads/src/nsDownloadManagerUI.js\\nindex 7232b62..77a133b 100644\\n--- a/toolkit/components/downloads/src/nsDownloadManagerUI.js\\n+++ b/toolkit/components/downloads/src/nsDownloadManagerUI.js\\n@@ -72,12 +72,18 @@ nsDownloadManagerUI.prototype = {\\n         window = aWindowContext.getInterface(Ci.nsIDOMWindow);\\n     } catch (e) { /* it's OK to not have a parent window */ }\\n \\n-    // We pass the download manager and the nsIDownload  we want selected\\n+    // We pass the download manager and the nsIDownload we want selected (if any)\\n     var params = Cc[\\\"@mozilla.org/array;1\\\"].createInstance(Ci.nsIMutableArray);\\n     var dm = Cc[\\\"@mozilla.org/download-manager;1\\\"].\\n              getService(Ci.nsIDownloadManager);\\n     params.appendElement(dm, false);\\n-    params.appendElement(dm.getDownload(aID), false);\\n+\\n+    // Don't fail if our passed in ID is invalid\\n+    var download = null;\\n+    try {\\n+      download = dm.getDownload(aID);\\n+    } catch (ex) {}\\n+    params.appendElement(download, false);\\n \\n     var ww = Cc[\\\"@mozilla.org/embedcomp/window-watcher;1\\\"].\\n              getService(Ci.nsIWindowWatcher);\\ndiff --git a/toolkit/components/downloads/src/nsDownloadScanner.cpp b/toolkit/components/downloads/src/nsDownloadScanner.cpp\\nindex 87726d20..f6b8bae 100644\\n--- a/toolkit/components/downloads/src/nsDownloadScanner.cpp\\n+++ b/toolkit/components/downloads/src/nsDownloadScanner.cpp\\n@@ -126,6 +126,7 @@ nsDownloadScanner::FindCLSID()\\n   }\\n   ULONG nReceived;\\n   clsidEnumerator->Next(1, &mScannerCLSID, &nReceived);\\n+  clsidEnumerator->Next(1, &mScannerCLSID, &nReceived);\\n   if (nReceived == 0) {\\n     // No installed Anti Virus program\\n     return -3;\\n\""}