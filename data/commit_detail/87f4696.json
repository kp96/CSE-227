{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Bas87f4696\""},"diff":"\"87f4696 Bug 390887: remove margins on the tab drop indicator when hiding it to prevent it from interfering with tabbar resizing, r=mano\\ndiff --git a/browser/base/content/tabbrowser.xml b/browser/base/content/tabbrowser.xml\\nindex 18cfe83..f99e126 100644\\n--- a/browser/base/content/tabbrowser.xml\\n+++ b/browser/base/content/tabbrowser.xml\\n@@ -1833,12 +1833,12 @@\\n                                   this.boxObject.screenX - halfIndWidth;\\n               }\\n \\n-                // ensure we never place the drop indicator beyond\\n-                // our limits\\n-                if (newMarginLeft < minMarginLeft)\\n-                  newMarginLeft = minMarginLeft;\\n-                else if (newMarginLeft > maxMarginLeft)\\n-                  newMarginLeft = maxMarginLeft;\\n+              // ensure we never place the drop indicator beyond\\n+              // our limits\\n+              if (newMarginLeft < minMarginLeft)\\n+                newMarginLeft = minMarginLeft;\\n+              else if (newMarginLeft > maxMarginLeft)\\n+                newMarginLeft = maxMarginLeft;\\n               }\\n               ind.style.marginLeft = newMarginLeft + 'px';\\n             } else {\\n@@ -1863,17 +1863,17 @@\\n               else if (pixelsToScroll < 0)\\n                 newMarginRight = minMarginRight;\\n               else {\\n-              if (newIndex == this.mTabs.length) {\\n-                  newMarginRight = this.boxObject.width + \\n-                                   this.boxObject.screenX -\\n-                                   this.mTabs[newIndex-1].boxObject.screenX -\\n-                                   halfIndWidth;\\n-              } else {\\n-                  newMarginRight = this.boxObject.width + \\n-                                   this.boxObject.screenX -\\n-                                   this.mTabs[newIndex].boxObject.screenX -\\n-                                   this.mTabs[newIndex].boxObject.width -\\n-                                   halfIndWidth;\\n+                if (newIndex == this.mTabs.length) {\\n+                    newMarginRight = this.boxObject.width + \\n+                                     this.boxObject.screenX -\\n+                                     this.mTabs[newIndex-1].boxObject.screenX -\\n+                                     halfIndWidth;\\n+                } else {\\n+                    newMarginRight = this.boxObject.width + \\n+                                     this.boxObject.screenX -\\n+                                     this.mTabs[newIndex].boxObject.screenX -\\n+                                     this.mTabs[newIndex].boxObject.width -\\n+                                     halfIndWidth;\\n                 }\\n \\n                 // ensure we never place the drop indicator beyond\\n@@ -1960,6 +1960,13 @@\\n                 return;\\n             }\\n             this.mTabDropIndicatorBar.setAttribute('dragging','false');\\n+\\n+            // FIXME: bug 390979 - we need to reset the horizontal margins on the\\n+            // tab-drop indicator here to avoid impacting tabbar resizing. This\\n+            // shouldn't be necessary once we can collapse the indicator.\\n+            var dropIndicator = this.mTabDropIndicatorBar.firstChild;\\n+            dropIndicator.style.marginRight = \\\"0px\\\";\\n+            dropIndicator.style.marginLeft = \\\"0px\\\";\\n           ]]>\\n         </body>\\n       </method>\\n\""}