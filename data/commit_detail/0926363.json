{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Bas0926363\""},"diff":"\"0926363 Address brendan's review comments on bug 391141.  r=brendan  a=not part of release builds\\ndiff --git a/tools/trace-malloc/lib/nsDebugHelpWin32.cpp b/tools/trace-malloc/lib/nsDebugHelpWin32.cpp\\nindex 2f6dec9..85834bc 100644\\n--- a/tools/trace-malloc/lib/nsDebugHelpWin32.cpp\\n+++ b/tools/trace-malloc/lib/nsDebugHelpWin32.cpp\\n@@ -186,18 +186,14 @@ DHWImportHooker::~DHWImportHooker()\\n     mHooking = PR_FALSE;\\n     PatchAllModules();\\n \\n-    if(gHooks == this)\\n-        gHooks = mNext;\\n-    else\\n+    for (DHWImportHooker **cur = &gHooks;\\n+         (PR_ASSERT(*cur), *cur); /* assert that we find this */\\n+         cur = &(*cur)->mNext)\\n     {\\n-        for(DHWImportHooker* cur = gHooks; cur; cur = cur->mNext)\\n+        if (*cur == this)\\n         {\\n-            if(cur->mNext == this)\\n-            {\\n-                cur->mNext = mNext;\\n-                break;\\n-            }\\n-            PR_ASSERT(cur->mNext); //we were not in the list!       \\n+            *cur = mNext;\\n+            break;\\n         }\\n     }\\n \\n\""}