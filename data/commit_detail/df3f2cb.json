{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Basdf3f2cb\""},"diff":"\"df3f2cb Bug 397792 - Widgets rotate in the wrong direction on Mac OS X. r=vlad a1.9=vlad\\ndiff --git a/widget/src/cocoa/nsNativeThemeCocoa.mm b/widget/src/cocoa/nsNativeThemeCocoa.mm\\nindex 6337198..7fc7b4a 100644\\n--- a/widget/src/cocoa/nsNativeThemeCocoa.mm\\n+++ b/widget/src/cocoa/nsNativeThemeCocoa.mm\\n@@ -568,15 +568,15 @@ nsNativeThemeCocoa::DrawWidgetBackground(nsIRenderingContext* aContext, nsIFrame\\n     // If we have a scale, I think we've already lost; so don't round\\n     // anything here\\n     CGContextConcatCTM(cgContext,\\n-                       CGAffineTransformMake(mat.xx, mat.xy,\\n-                                             mat.yx, mat.yy,\\n+                       CGAffineTransformMake(mat.xx, mat.yx,\\n+                                             mat.xy, mat.yy,\\n                                              mat.x0, mat.y0));\\n   } else {\\n     // Otherwise, we round the x0/y0, because otherwise things get rendered badly\\n     // XXX how should we be rounding the x0/y0?\\n     CGContextConcatCTM(cgContext,\\n-                       CGAffineTransformMake(mat.xx, mat.xy,\\n-                                             mat.yx, mat.yy,\\n+                       CGAffineTransformMake(mat.xx, mat.yx,\\n+                                             mat.xy, mat.yy,\\n                                              floor(mat.x0 + 0.5),\\n                                              floor(mat.y0 + 0.5)));\\n   }\\n@@ -585,6 +585,8 @@ nsNativeThemeCocoa::DrawWidgetBackground(nsIRenderingContext* aContext, nsIFrame\\n   if (1 /*aWidgetType == NS_THEME_TEXTFIELD*/) {\\n     fprintf(stderr, \\\"Native theme drawing widget %d [%p] dis:%d in rect [%d %d %d %d]\\\\n\\\",\\n             aWidgetType, aFrame, IsDisabled(aFrame), aRect.x, aRect.y, aRect.width, aRect.height);\\n+    fprintf(stderr, \\\"Cairo matrix: [%f %f %f %f %f %f]\\\\n\\\",\\n+            mat.xx, mat.yx, mat.xy, mat.yy, mat.x0, mat.y0);\\n     fprintf(stderr, \\\"Native theme xform[0]: [%f %f %f %f %f %f]\\\\n\\\",\\n             mm0.a, mm0.b, mm0.c, mm0.d, mm0.tx, mm0.ty);\\n     CGAffineTransform mm = CGContextGetCTM(cgContext);\\n\""}