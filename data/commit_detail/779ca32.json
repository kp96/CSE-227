{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Bas779ca32\""},"diff":"\"779ca32 Typing should deselect autocomplete search engine b=79069 r=KaiRo sr=jag\\ndiff --git a/xpfe/components/autocomplete/resources/content/autocomplete.xml b/xpfe/components/autocomplete/resources/content/autocomplete.xml\\nindex bd41ac2..d384c50 100644\\n--- a/xpfe/components/autocomplete/resources/content/autocomplete.xml\\n+++ b/xpfe/components/autocomplete/resources/content/autocomplete.xml\\n@@ -907,7 +907,7 @@\\n           this.mNeedToComplete = true;\\n           var str = this.value;\\n           this.currentSearchString = str;\\n-          this.resultsPopup.selectedIndex = -1;\\n+          this.resultsPopup.clearSelection();\\n           this.removeAttribute(\\\"noMatchesFound\\\");\\n           \\n           this.mAutoCompleteTimer = setTimeout(this.callListener, this.timeout, this, \\\"startLookup\\\");\\n@@ -1479,6 +1479,12 @@\\n         ]]></body>\\n       </method>\\n \\n+      <method name=\\\"clearSelection\\\">\\n+        <body>\\n+          this.view.selection.clearSelection();\\n+        </body>\\n+      </method>\\n+\\n       <method name=\\\"selectBy\\\">\\n         <parameter name=\\\"aReverse\\\"/>\\n         <parameter name=\\\"aPage\\\"/>\\n@@ -1532,14 +1538,14 @@\\n \\n       <property name=\\\"selectedIndex\\\">\\n         <getter>\\n-          if (!this.view || !this.view.selection || !this.view.selection.count)\\n+          if (!this.view || !this.view.selection.count)\\n             return -1;\\n           var start = {}, end = {};\\n           this.view.selection.getRangeAt(0, start, end);\\n           return start.value;\\n         </getter>\\n-        <setter><![CDATA[\\n-          if (this.view && this.view.selection) {\\n+        <setter>\\n+          if (this.view) {\\n             this.view.selection.select(val);\\n             if (val >= 0) {\\n               this.view.selection.currentIndex = -1;\\n@@ -1547,7 +1553,7 @@\\n             }\\n           }\\n           return val;\\n-        ]]></setter>\\n+        </setter>\\n       </property>\\n \\n       <property name=\\\"popupOpen\\\" onget=\\\"return !!this.input;\\\" readonly=\\\"true\\\"/>\\n@@ -1595,7 +1601,7 @@\\n       <handler event=\\\"popuphiding\\\">\\n         if (this.textbox)\\n           this.textbox.mMenuOpen = false;\\n-        this.selectedIndex = -1;\\n+        this.clearSelection();\\n         this.input = null;\\n       </handler>\\n \\n\""}