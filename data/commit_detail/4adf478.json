{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Bas4adf478\""},"diff":"\"4adf478 [OS/2] Bug 381330: use font resolution instead of screen resolution for system fonts\\ndiff --git a/gfx/src/thebes/nsSystemFontsOS2.cpp b/gfx/src/thebes/nsSystemFontsOS2.cpp\\nindex f1489fb..18cff33 100644\\n--- a/gfx/src/thebes/nsSystemFontsOS2.cpp\\n+++ b/gfx/src/thebes/nsSystemFontsOS2.cpp\\n@@ -195,15 +195,11 @@ nsresult nsSystemFontsOS2::GetSystemFont(nsSystemFontID aID, nsString* aFontName\\n \\n     // determine DPI resolution of screen device to compare compute\\n     // font size in pixels\\n-    gfxFloat vertScreenRes = 120; // assume 120 dpi as default\\n     HPS ps = WinGetScreenPS(HWND_DESKTOP);\\n     HDC dc = GpiQueryDevice(ps);\\n-    LONG lStart = CAPS_FAMILY, lCount = CAPS_CHAR_WIDTH;\\n-    LONG alArray[CAPS_CHAR_WIDTH];\\n-    if (DevQueryCaps(dc, lStart, lCount, alArray)) {\\n-        // system screen resolution is in pels/m, we need DPI\\n-        vertScreenRes = alArray[CAPS_VERTICAL_RESOLUTION] * 0.0254;\\n-    }\\n+    // effective vertical resolution in DPI\\n+    LONG vertScreenRes = 120; // assume 120 dpi as default\\n+    DevQueryCaps(dc, CAPS_VERTICAL_FONT_RES, 1, &vertScreenRes);\\n     WinReleasePS(ps);\\n \\n     // now scale to make pixels from points (1 pt = 1/72in)\\n\""}