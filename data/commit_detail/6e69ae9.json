{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Bas6e69ae9\""},"diff":"\"6e69ae9 Bug 349884 - Fast Find must be disabled when viewing non-text content, patch by Ehsan Akhgari <ehsan.akhgari@gmail.com>, r=mano\\ndiff --git a/toolkit/content/widgets/findbar.xml b/toolkit/content/widgets/findbar.xml\\nindex f5fe0984..90348ec 100644\\n--- a/toolkit/content/widgets/findbar.xml\\n+++ b/toolkit/content/widgets/findbar.xml\\n@@ -26,6 +26,7 @@\\n    -     Ben Basson <contact@cusser.net>\\n    -     Jason Barnabe <jason_barnabe@fastmail.fm>\\n    -     Asaf Romano <mano@mozilla.com>\\n+   -     Ehsan Akhgari <ehsan.akhgari@gmail.com>\\n    -\\n    - Alternatively, the contents of this file may be used under the terms of\\n    - either the GNU General Public License Version 2 or later (the \\\"GPL\\\"), or\\n@@ -894,6 +895,21 @@\\n       </method>\\n \\n       <!--\\n+        - Returns true if |aMimeType| is text-based, or false otherwise.\\n+        -\\n+        - @param aMimeType\\n+        -        The MIME type to check.\\n+        -->\\n+      <method name=\\\"_mimeTypeIsTextBased\\\">\\n+        <parameter name=\\\"aMimeType\\\"/>\\n+        <body><![CDATA[\\n+          return /^text\\\\/|\\\\+xml$/.test(aMimeType) ||\\n+                 aMimeType == \\\"application/x-javascript\\\" ||\\n+                 aMimeType == \\\"application/xml\\\";\\n+        ]]></body>\\n+      </method>\\n+\\n+      <!--\\n         - Returns whether FAYT can be used for the given event in\\n         - the current content state.\\n         -->\\n@@ -904,6 +920,11 @@\\n               aEvent.getPreventDefault())\\n             return false;\\n \\n+          var win = document.commandDispatcher.focusedWindow;\\n+          if (win)\\n+            if (!this._mimeTypeIsTextBased(win.document.contentType))\\n+              return false;\\n+\\n           var elt = document.commandDispatcher.focusedElement;\\n           if (elt) {\\n             if (elt instanceof HTMLInputElement) {\\n@@ -930,7 +951,6 @@\\n           if (url == \\\"about:blank\\\" || url == \\\"about:config\\\")\\n             return false;\\n \\n-          var win = document.commandDispatcher.focusedWindow;\\n           if (win) {\\n             try {\\n               var editingSession = win.QueryInterface(Components.interfaces.nsIInterfaceRequestor)\\n\""}