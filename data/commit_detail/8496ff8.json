{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Bas8496ff8\""},"diff":"\"8496ff8 Adding tests\\ndiff --git a/layout/reftests/bugs/386310-1-ref.html b/layout/reftests/bugs/386310-1-ref.html\\nnew file mode 100644\\nindex 0000000..8b92dbd\\n--- /dev/null\\n+++ b/layout/reftests/bugs/386310-1-ref.html\\n@@ -0,0 +1,6 @@\\n+<!DOCTYPE html>\\n+<html>\\n+  <body>\\n+    <div id=\\\"test\\\">first second third [<span style=\\\"background: yellow\\\">fourth</span>]</div>\\n+  </body>\\n+</html>\\ndiff --git a/layout/reftests/bugs/386310-1a.html b/layout/reftests/bugs/386310-1a.html\\nnew file mode 100644\\nindex 0000000..df18acd\\n--- /dev/null\\n+++ b/layout/reftests/bugs/386310-1a.html\\n@@ -0,0 +1,9 @@\\n+<!DOCTYPE html>\\n+<html>\\n+  <head>\\n+    <script src=\\\"386310-script.js\\\"></script>\\n+  </head>\\n+  <body>\\n+    <div id=\\\"test\\\">first second third [fourth]</div>\\n+  </body>\\n+</html>\\ndiff --git a/layout/reftests/bugs/386310-1b.html b/layout/reftests/bugs/386310-1b.html\\nnew file mode 100644\\nindex 0000000..69b2d2a\\n--- /dev/null\\n+++ b/layout/reftests/bugs/386310-1b.html\\n@@ -0,0 +1,9 @@\\n+<!DOCTYPE html>\\n+<html>\\n+  <head>\\n+    <script src=\\\"386310-script.js\\\"></script>\\n+  </head>\\n+  <body>\\n+    <div id=\\\"test\\\" style=\\\"-moz-binding: url(386310-binding.xml#prepend);\\\">first second third [fourth]</div>\\n+  </body>\\n+</html>\\ndiff --git a/layout/reftests/bugs/386310-1c.html b/layout/reftests/bugs/386310-1c.html\\nnew file mode 100644\\nindex 0000000..fd0c0d5\\n--- /dev/null\\n+++ b/layout/reftests/bugs/386310-1c.html\\n@@ -0,0 +1,9 @@\\n+<!DOCTYPE html>\\n+<html>\\n+  <head>\\n+    <script src=\\\"386310-script.js\\\"></script>\\n+  </head>\\n+  <body>\\n+    <div id=\\\"test\\\" style=\\\"-moz-binding: url(386310-binding.xml#append);\\\">first second third [fourth]</div>\\n+  </body>\\n+</html>\\ndiff --git a/layout/reftests/bugs/386310-1d.html b/layout/reftests/bugs/386310-1d.html\\nnew file mode 100644\\nindex 0000000..2b68339\\n--- /dev/null\\n+++ b/layout/reftests/bugs/386310-1d.html\\n@@ -0,0 +1,9 @@\\n+<!DOCTYPE html>\\n+<html>\\n+  <head>\\n+    <script src=\\\"386310-script.js\\\"></script>\\n+  </head>\\n+  <body>\\n+    <div id=\\\"test\\\" style=\\\"-moz-binding: url(386310-binding.xml#prepend-with-comment-fix);\\\">first second third [fourth]</div>\\n+  </body>\\n+</html>\\ndiff --git a/layout/reftests/bugs/386310-binding.xml b/layout/reftests/bugs/386310-binding.xml\\nnew file mode 100644\\nindex 0000000..cf52566\\n--- /dev/null\\n+++ b/layout/reftests/bugs/386310-binding.xml\\n@@ -0,0 +1,27 @@\\n+<?xml version=\\\"1.0\\\"?>\\n+<bindings xmlns=\\\"http://www.mozilla.org/xbl\\\"\\n+          xmlns:html=\\\"http://www.w3.org/1999/xhtml\\\">\\n+\\n+  <binding id=\\\"prepend\\\">\\n+    <content>\\n+      <span/>\\n+      <children/>\\n+    </content>\\n+  </binding>\\n+\\n+  <binding id=\\\"append\\\">\\n+    <content>\\n+      <children/>\\n+      <span/>\\n+    </content>\\n+  </binding>\\n+\\n+  <binding id=\\\"prepend-with-comment-fix\\\" extends=\\\"#prepend\\\">\\n+    <implementation>\\n+      <constructor>\\n+\\tvar span = document.createComment(\\\"xbl generated comment to prevent bug #36\\\");\\n+\\tthis.insertBefore(span, this.firstChild);\\n+      </constructor>\\n+    </implementation>\\n+  </binding>\\n+</bindings>\\ndiff --git a/layout/reftests/bugs/386310-script.js b/layout/reftests/bugs/386310-script.js\\nnew file mode 100644\\nindex 0000000..2ac39f4\\n--- /dev/null\\n+++ b/layout/reftests/bugs/386310-script.js\\n@@ -0,0 +1,12 @@\\n+function wrapNode() {\\n+  var elm = document.getElementById(\\\"test\\\");\\n+  var span = document.createElement(\\\"span\\\");\\n+  span.setAttribute(\\\"style\\\", \\\"background: yellow\\\");\\n+  var range = document.createRange();\\n+  var start = \\\"first second third [\\\".length;\\n+  range.setStart(elm.lastChild, start);\\n+  range.setEnd(elm.lastChild, start + \\\"fourth\\\".length);\\n+  range.surroundContents(span);\\n+}\\n+\\n+window.addEventListener(\\\"load\\\", wrapNode, false);\\ndiff --git a/layout/reftests/bugs/reftest.list b/layout/reftests/bugs/reftest.list\\nindex b221a65..9e8ff17 100644\\n--- a/layout/reftests/bugs/reftest.list\\n+++ b/layout/reftests/bugs/reftest.list\\n@@ -353,6 +353,10 @@ random-if(MOZ_WIDGET_TOOLKIT==\\\"cocoa\\\") == 379316-2.html 379316-2-ref.html # bug\\n == 386014-1b.html 386014-1-ref.html\\n == 386014-1c.html 386014-1-ref.html\\n == 386147-1.html 386147-1-ref.html\\n+== 386310-1a.html 386310-1-ref.html\\n+fails == 386310-1b.html 386310-1-ref.html\\n+== 386310-1c.html 386310-1-ref.html\\n+fails == 386310-1d.html 386310-1-ref.html\\n == 386470-1a.html 386470-1-ref.html\\n == 386470-1b.html 386470-1-ref.html\\n == 386470-1c.html 386470-1-ref.html\\n\""}