{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Bas66a6a70\""},"diff":"\"66a6a70 Bug 394501 - rendering of prompts with access keys broken in JAWAS virtual buffer as of August 29, patch=aaronlev, r=me, a=dsicore\\ndiff --git a/accessible/src/base/nsAccessible.cpp b/accessible/src/base/nsAccessible.cpp\\nindex 57a1c65..a152694 100644\\n--- a/accessible/src/base/nsAccessible.cpp\\n+++ b/accessible/src/base/nsAccessible.cpp\\n@@ -405,9 +405,12 @@ nsAccessible::GetKeyboardShortcut(nsAString& aAccessKey)\\n     return NS_ERROR_FAILURE;\\n \\n   PRUint32 key = nsAccUtils::GetAccessKeyFor(content);\\n-  if (!key) {\\n+  if (!key && content->IsNodeOfType(nsIContent::eELEMENT)) {\\n+    // Copy access key from label node unless it is labeled\\n+    // via an ancestor <label>, in which case that would be redundant\\n     nsCOMPtr<nsIContent> labelContent(GetLabelContent(content));\\n-    if (labelContent)\\n+    nsCOMPtr<nsIDOMNode> labelNode = do_QueryInterface(labelContent);\\n+    if (labelNode && !nsAccUtils::IsAncestorOf(labelNode, mDOMNode))\\n       key = nsAccUtils::GetAccessKeyFor(labelContent);\\n   }\\n \\n\""}