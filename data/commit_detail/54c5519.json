{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Bas54c5519\""},"diff":"\"54c5519 Bug 395618. UseUserPrefFile should check that user.js exists. r/sr/a=bsmedberg\\ndiff --git a/modules/libpref/src/nsPrefService.cpp b/modules/libpref/src/nsPrefService.cpp\\nindex d4edf63..c30ae6c 100644\\n--- a/modules/libpref/src/nsPrefService.cpp\\n+++ b/modules/libpref/src/nsPrefService.cpp\\n@@ -352,7 +352,13 @@ nsresult nsPrefService::UseUserPrefFile()\\n   if (NS_SUCCEEDED(rv) && aFile) {\\n     rv = aFile->AppendNative(NS_LITERAL_CSTRING(\\\"user.js\\\"));\\n     if (NS_SUCCEEDED(rv)) {\\n-      rv = openPrefFile(aFile);\\n+      PRBool exists = PR_FALSE;\\n+      aFile->Exists(&exists);\\n+      if (exists) {\\n+        rv = openPrefFile(aFile);\\n+      } else {\\n+        rv = NS_ERROR_FILE_NOT_FOUND;\\n+      }\\n     }\\n   }\\n   return rv;\\n\""}