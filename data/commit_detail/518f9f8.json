{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Bas518f9f8\""},"diff":"\"518f9f8 bug 390845 - integrate talos with new pageloader, also covers additions/fixes to make talos easier to set up and configure.  p=anodelman r=bhearsum\\ndiff --git a/testing/performance/talos/base_profile/prefs.js b/testing/performance/talos/base_profile/prefs.js\\nindex 86dc607..7d160e0 100755\\n--- a/testing/performance/talos/base_profile/prefs.js\\n+++ b/testing/performance/talos/base_profile/prefs.js\\n@@ -5,4 +5,7 @@\\n user_pref(\\\"capability.principal.codebase.p0.granted\\\", \\\"UniversalPreferencesWrite UniversalXPConnect UniversalPreferencesRead\\\");\\n user_pref(\\\"capability.principal.codebase.p0.id\\\", \\\"file://\\\");\\n user_pref(\\\"capability.principal.codebase.p0.subjectName\\\", \\\"\\\");\\n+user_pref(\\\"capability.principal.codebase.p1.granted\\\", \\\"UniversalPreferencesWrite UniversalXPConnect UniversalPreferencesRead\\\");\\n+user_pref(\\\"capability.principal.codebase.p1.id\\\", \\\"http://localhost\\\");\\n+user_pref(\\\"capability.principal.codebase.p1.subjectName\\\", \\\"\\\");\\n user_pref(\\\"signed.applets.codebase_principal_support\\\", true);\\ndiff --git a/testing/performance/talos/tp_linux.py b/testing/performance/talos/cmanager_linux.py\\nsimilarity index 99%\\nrename from testing/performance/talos/tp_linux.py\\nrename to testing/performance/talos/cmanager_linux.py\\nindex 563c65c..7b6bcf5 100644\\n--- a/testing/performance/talos/tp_linux.py\\n+++ b/testing/performance/talos/cmanager_linux.py\\n@@ -193,7 +193,7 @@ class CounterManager(threading.Thread):\\n       self.runThread = True\\n       self.start()\\n     except:\\n-      raise\\n+      print 'WARNING: problem starting counter monitor'\\n \\n   def stopMonitor(self):\\n     \\\"\\\"\\\"Stops the monitor\\\"\\\"\\\"\\ndiff --git a/testing/performance/talos/tp_mac.py b/testing/performance/talos/cmanager_mac.py\\nsimilarity index 99%\\nrename from testing/performance/talos/tp_mac.py\\nrename to testing/performance/talos/cmanager_mac.py\\nindex c427826..98eaa98 100644\\n--- a/testing/performance/talos/tp_mac.py\\n+++ b/testing/performance/talos/cmanager_mac.py\\n@@ -185,7 +185,7 @@ class CounterManager(threading.Thread):\\n       self.runThread = True\\n       self.start()\\n     except:\\n-      raise\\n+      print 'WARNING: problem starting counter monitor'\\n \\n   def stopMonitor(self):\\n     \\\"\\\"\\\"Stops the monitor\\\"\\\"\\\"\\ndiff --git a/testing/performance/talos/tp_win32.py b/testing/performance/talos/cmanager_win32.py\\nsimilarity index 100%\\nrename from testing/performance/talos/tp_win32.py\\nrename to testing/performance/talos/cmanager_win32.py\\ndiff --git a/testing/performance/talos/config.py b/testing/performance/talos/config.py\\nindex ac404e6..5c4602d 100644\\n--- a/testing/performance/talos/config.py\\n+++ b/testing/performance/talos/config.py\\n@@ -38,58 +38,16 @@\\n \\\"\\\"\\\"A list of constants containing the paths to programs and files\\n    needed by the performance testing scripts.\\n \\\"\\\"\\\"\\n-\\n __author__ = 'annie.sullivan@gmail.com (Annie Sullivan)'\\n \\n-BROWSER_HEIGHT = 768\\n-BROWSER_WIDTH = 1024\\n-\\n-\\\"\\\"\\\"For some reason, can only get output from dump() in Firefox if\\n-   it's run through cygwin bash.  So here's the path to cygwin.\\n-\\\"\\\"\\\"\\n-CYGWIN = r'c:\\\\cygwin\\\\bin\\\\bash.exe -c'\\n-\\n-\\\"\\\"\\\"The tinderbox scripts run sync between Ts runs, so we do, too.\\\"\\\"\\\"\\n-SYNC = r'c:\\\\cygwin\\\\bin\\\\sync'\\n-\\n-\\\"\\\"\\\"The path to the base profile directory to use for testing.  For the page\\n-   load test to work, this profile should have its hostperm.1 file set to allow\\n-   urls with scheme:file to open in new windows, and the preference to open\\n-   new windows in a tab should be off.\\n-\\\"\\\"\\\"\\n-BASE_PROFILE_DIR = r'C:\\\\talos\\\\base_profile'\\n-\\n-\\\"\\\"\\\"The path to the file url to load when initializing a new profile\\\"\\\"\\\"\\n-INIT_URL = 'file:///c:/talos/initialize.html'\\n-\\n-\\\"\\\"\\\"The path to the file url to load when collecting information from the browser\\\"\\\"\\\"\\n-INFO_URL = 'file:///c:/talos/getInfo.html'\\n-\\n-\\\"\\\"\\\"The path to the file url to load for startup test (Ts)\\\"\\\"\\\"\\n-TS_URL = 'file:///c:/talos/startup_test/startup_test.html?begin='\\n-\\n-\\\"\\\"\\\"Number of times to run startup test (Ts)\\\"\\\"\\\"\\n-TS_NUM_RUNS = 20\\n-\\n-\\\"\\\"\\\"The path to the file url to load for page load test (Tp)\\\"\\\"\\\"\\n-TP_URL = 'http://localhost/page_load_test/framecycler.html'\\n-\\n-\\\"\\\"\\\"Number of times the page load test (Tp) loads each page in the test.\\\"\\\"\\\"\\n-TP_NUM_CYCLES = 5\\n-\\n-\\\"\\\"\\\"Resolution of counter sample data for page load test (Tp), in seconds\\n-   (For example, if TP_RESOLUTION=1, sample counters every 1 second\\\"\\\"\\\"\\n-TP_RESOLUTION = 1\\n-  \\n-\\\"\\\"\\\"Run page load test.\\n-   For possible values of counters argument on Windows, see\\n-   http://technet2.microsoft.com/WindowsServer/en/Library/86b5d116-6fb3-427b-af8c-9077162125fe1033.mspx?mfr=true\\n-   Possible values on Linux and Mac:\\n-     'Private Bytes', '% Processor Time', 'RSS'\\n-\\\"\\\"\\\"\\n-COUNTERS = ['Private Bytes', 'Working Set', '% Processor Time']\\n+\\\"\\\"\\\"The path to the file url to load when initializing/collecting information from the browser\\\"\\\"\\\"\\n+INIT_URL = 'file:///c:/mozilla/testing/performance/talos/getInfo.html'\\n \\n+\\\"\\\"\\\"Dump results locally to csv\\\"\\\"\\\"\\n+TO_CSV = 0\\n+CSV_FILE = r'c:\\\\mozilla\\\\testing\\\\performance\\\\talos\\\\output\\\\out'\\n \\\"\\\"\\\"URL for the results server\\\"\\\"\\\"\\n+TO_GRAPH_SERVER = 1\\n RESULTS_SERVER = 'graphserver.url.here'\\n RESULTS_LINK = '/bulk.cgi'\\n \\ndiff --git a/testing/performance/talos/ffinfo.py b/testing/performance/talos/ffinfo.py\\ndeleted file mode 100644\\nindex b4f0f71..0000000\\n--- a/testing/performance/talos/ffinfo.py\\n+++ /dev/null\\n@@ -1,57 +0,0 @@\\n-# ***** BEGIN LICENSE BLOCK *****\\n-# Version: MPL 1.1/GPL 2.0/LGPL 2.1\\n-#\\n-# The contents of this file are subject to the Mozilla Public License Version\\n-# 1.1 (the \\\"License\\\"); you may not use this file except in compliance with\\n-# the License. You may obtain a copy of the License at\\n-# http://www.mozilla.org/MPL/\\n-#\\n-# Software distributed under the License is distributed on an \\\"AS IS\\\" basis,\\n-# WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License\\n-# for the specific language governing rights and limitations under the\\n-# License.\\n-#\\n-# The Original Code is standalone Firefox Windows performance test.\\n-#\\n-# The Initial Developer of the Original Code is Google Inc.\\n-# Portions created by the Initial Developer are Copyright (C) 2006\\n-# the Initial Developer. All Rights Reserved.\\n-#\\n-# Contributor(s):\\n-#   Alice Nodelman <anodelman@mozilla.com> (original author)\\n-#\\n-# Alternatively, the contents of this file may be used under the terms of\\n-# either the GNU General Public License Version 2 or later (the \\\"GPL\\\"), or\\n-# the GNU Lesser General Public License Version 2.1 or later (the \\\"LGPL\\\"),\\n-# in which case the provisions of the GPL or the LGPL are applicable instead\\n-# of those above. If you wish to allow use of your version of this file only\\n-# under the terms of either the GPL or the LGPL, and not to allow others to\\n-# use your version of this file under the terms of the MPL, indicate your\\n-# decision by deleting the provisions above and replace them with the notice\\n-# and other provisions required by the GPL or the LGPL. If you do not delete\\n-# the provisions above, a recipient may use your version of this file under\\n-# the terms of any one of the MPL, the GPL or the LGPL.\\n-#\\n-# ***** END LICENSE BLOCK *****\\n-\\n-__author__ = 'anodelman@mozilla.com'\\n-\\n-import re\\n-import ffprocess\\n-import config\\n-\\n-PROFILE_REGEX = re.compile('__metrics(.*)')\\n-\\n-def GetMetricsFromBrowser(firefox_path, profile_dir):\\n-  \\\"\\\"\\\"Opens the browser at the specified URL, prints out the information collected from\\n-     the browser\\\"\\\"\\\"\\n-  cmd = ffprocess.GenerateFirefoxCommandLine(firefox_path, profile_dir, config.INFO_URL)\\n-  (match, timed_out) = ffprocess.RunProcessAndWaitForOutput(cmd,\\n-                                                              'firefox',\\n-                                                              PROFILE_REGEX,\\n-                                                              30)\\n-  if (not timed_out):\\n-    print match\\n-  else:\\n-    print \\\"ERROR:no metrics\\\"\\n-\\ndiff --git a/testing/performance/talos/ffprocess.py b/testing/performance/talos/ffprocess.py\\nindex b1802bf1d..854d314 100755\\n--- a/testing/performance/talos/ffprocess.py\\n+++ b/testing/performance/talos/ffprocess.py\\n@@ -58,12 +58,10 @@ elif platform.system() == \\\"Darwin\\\":\\n \\n \\n \\n-def SyncAndSleep():\\n+def Sleep():\\n   \\\"\\\"\\\"Runs sync and sleeps for a few seconds between Firefox runs.\\n      Otherwise \\\"Firefox is already running..\\\" errors occur\\n   \\\"\\\"\\\"\\n-\\n-  os.spawnl(os.P_WAIT, config.SYNC)\\n   time.sleep(5)\\n \\n \\ndiff --git a/testing/performance/talos/ffprocess_linux.py b/testing/performance/talos/ffprocess_linux.py\\nindex cfb562d..7a9154d 100644\\n--- a/testing/performance/talos/ffprocess_linux.py\\n+++ b/testing/performance/talos/ffprocess_linux.py\\n@@ -44,8 +44,7 @@ import config\\n \\n \\n def GenerateFirefoxCommandLine(firefox_path, profile_dir, url):\\n-  \\\"\\\"\\\"Generates the command line for a process to run Firefox, wrapped\\n-     by cygwin so that we can read the output from dump() statements.\\n+  \\\"\\\"\\\"Generates the command line for a process to run Firefox\\n \\n   Args:\\n     firefox_path: String containing the path to the firefox exe to use\\n@@ -57,15 +56,9 @@ def GenerateFirefoxCommandLine(firefox_path, profile_dir, url):\\n   if profile_dir:\\n     profile_arg = '-profile %s' % profile_dir\\n \\n-  url_arg = ''\\n-  if url:\\n-    url_arg = '-url %s' % url\\n-\\n-  cmd = '%s %s %s -width %d -height %d' % (firefox_path,\\n+  cmd = '%s %s %s' % (firefox_path,\\n                       profile_arg,\\n-                      url_arg,\\n-                      config.BROWSER_WIDTH,\\n-                      config.BROWSER_HEIGHT)\\n+                      url)\\n   return cmd\\n \\n \\n@@ -121,8 +114,10 @@ def TerminateProcess(pid):\\n   Args:\\n     pid: integer process id of the process to terminate.\\n   \\\"\\\"\\\"\\n-\\n-  os.kill(pid, signal.SIGTERM)\\n+  try:\\n+    os.kill(pid, signal.SIGTERM)\\n+  except OSError, (errno, strerror):\\n+        print 'WARNING: failed os.kill: %s : %s' % (errno, strerror)\\n \\n \\n def TerminateAllProcesses(process_name):\\ndiff --git a/testing/performance/talos/ffprocess_mac.py b/testing/performance/talos/ffprocess_mac.py\\nindex 8f8dc30..66b5370 100644\\n--- a/testing/performance/talos/ffprocess_mac.py\\n+++ b/testing/performance/talos/ffprocess_mac.py\\n@@ -57,15 +57,9 @@ def GenerateFirefoxCommandLine(firefox_path, profile_dir, url):\\n   if profile_dir:\\n     profile_arg = '-profile %s' % profile_dir\\n \\n-  url_arg = ''\\n-  if url:\\n-    url_arg = '-url %s' % url\\n-\\n-  cmd = '%s %s %s -width %d -height %d' % (firefox_path,\\n+  cmd = '%s %s %s' % (firefox_path,\\n                       profile_arg,\\n-                      url_arg,\\n-                      config.BROWSER_WIDTH,\\n-                      config.BROWSER_HEIGHT)\\n+                      url)\\n   return cmd\\n \\n \\n@@ -120,7 +114,10 @@ def TerminateProcess(pid):\\n   Args:\\n     pid: integer process id of the process to terminate.\\n   \\\"\\\"\\\"\\n-  os.kill(pid, signal.SIGTERM)\\n+  try:\\n+    os.kill(pid, signal.SIGTERM)\\n+  except OSError, (errno, strerror):\\n+    print 'WARNING: failed os.kill: %s : %s' % (errno, strerror)\\n \\n def TerminateAllProcesses(process_name):\\n   \\\"\\\"\\\"Helper function to terminate all processes with the given process name\\ndiff --git a/testing/performance/talos/ffprocess_win32.py b/testing/performance/talos/ffprocess_win32.py\\nindex 9330b051..2cff6b3 100644\\n--- a/testing/performance/talos/ffprocess_win32.py\\n+++ b/testing/performance/talos/ffprocess_win32.py\\n@@ -44,30 +44,8 @@ import msvcrt\\n import config\\n \\n \\n-def GetCygwinPath(dos_path):\\n-  \\\"\\\"\\\"Helper function to get the Cygwin path from a dos path.\\n-     Used to generate a Firefox command line piped through the\\n-     Cygwin bash shell\\n-\\n-  Args:\\n-    dos_path: String containing the dos path\\n-\\n-  Returns:\\n-    String containing the cygwin path\\n-  \\\"\\\"\\\"\\n-\\n-  # Convert the path to a cygwin path. Assumes the path starts with\\n-  # /cygdrive/driveletter\\n-  cygwin_path = '/' + dos_path[3:]                       # Remove 'C:\\\\'\\n-  cygwin_path = cygwin_path.replace('\\\\\\\\', '/')           # Backslashes->slashes\\n-  cygwin_path = cygwin_path.replace(' ', '\\\\\\\\ ')          # Escape spaces\\n-  cygwin_path = '/cygdrive/' + dos_path[0] + cygwin_path # Add drive letter\\n-  return cygwin_path\\n-\\n-\\n def GenerateFirefoxCommandLine(firefox_path, profile_dir, url):\\n-  \\\"\\\"\\\"Generates the command line for a process to run Firefox, wrapped\\n-     by cygwin so that we can read the output from dump() statements.\\n+  \\\"\\\"\\\"Generates the command line for a process to run Firefox\\n \\n   Args:\\n     firefox_path: String containing the path to the firefox exe to use\\n@@ -80,16 +58,9 @@ def GenerateFirefoxCommandLine(firefox_path, profile_dir, url):\\n     profile_dir = profile_dir.replace('\\\\\\\\', '\\\\\\\\\\\\\\\\\\\\\\\\')\\n     profile_arg = '-profile %s' % profile_dir\\n \\n-  url_arg = ''\\n-  if url:\\n-    url_arg = '-url %s' % url\\n-\\n-  cmd = '%s \\\"%s %s %s -width %d -height %d\\\"' % (config.CYGWIN,\\n-                           GetCygwinPath(firefox_path),\\n+  cmd = '%s %s %s' % (firefox_path,\\n                            profile_arg,\\n-                           url_arg,\\n-                           config.BROWSER_WIDTH,\\n-                           config.BROWSER_HEIGHT)\\n+                           url)\\n   return cmd\\n \\n \\ndiff --git a/testing/performance/talos/ffprofile.py b/testing/performance/talos/ffsetup.py\\nold mode 100755\\nnew mode 100644\\nsimilarity index 80%\\nrename from testing/performance/talos/ffprofile.py\\nrename to testing/performance/talos/ffsetup.py\\nindex 95b25ac..aa2dec8\\n--- a/testing/performance/talos/ffprofile.py\\n+++ b/testing/performance/talos/ffsetup.py\\n@@ -19,6 +19,7 @@\\n #\\n # Contributor(s):\\n #   Annie Sullivan <annie.sullivan@gmail.com> (original author)\\n+#   Alice Nodelman <anodelman@mozilla.com>\\n #\\n # Alternatively, the contents of this file may be used under the terms of\\n # either the GNU General Public License Version 2 or later (the \\\"GPL\\\"), or\\n@@ -34,13 +35,9 @@\\n #\\n # ***** END LICENSE BLOCK *****\\n \\n-\\\"\\\"\\\"A set of functions to set up a Firefox profile with the correct\\n+\\\"\\\"\\\"A set of functions to set up a Firefox browser with the correct\\n    preferences and extensions in the given directory.\\n \\n-   Sets up the profile by copying from a base directory, editing the\\n-   prefs.js file to set the prefs, and creating a file to link to each\\n-   extension.  The profile is run with Firefox to make sure it is fully\\n-   initialized and won't cause extra startup time on the first run.\\n \\\"\\\"\\\"\\n \\n __author__ = 'annie.sullivan@gmail.com (Annie Sullivan)'\\n@@ -52,6 +49,7 @@ import re\\n import shutil\\n import tempfile\\n import time\\n+import glob\\n \\n import utils\\n import ffprocess\\n@@ -128,6 +126,20 @@ def CreateTempProfileDir(source_profile, prefs, extensions):\\n \\n   return profile_dir\\n \\n+def InstallInBrowser(firefox_path, dir_path):\\n+  \\\"\\\"\\\"\\n+    Take the given directory and copies it to appropriate location in the given\\n+    firefox install\\n+  \\\"\\\"\\\"\\n+  # add the provided directory to the given firefox install\\n+  fromfiles = glob.glob(os.path.join(dir_path, '*'))\\n+  todir = os.path.join(os.path.dirname(firefox_path), os.path.basename(os.path.normpath(dir_path)))\\n+  for fromfile in fromfiles:\\n+      if not os.path.isfile(os.path.join(todir, os.path.basename(fromfile))):\\n+          shutil.copy(fromfile, todir)\\n+          utils.debug(\\\"installed \\\" + fromfile)\\n+      else:\\n+          utils.debug(\\\"WARNING: file already installed (\\\" + fromfile + \\\")\\\")\\n \\n def InitializeNewProfile(firefox_path, profile_dir):\\n   \\\"\\\"\\\"Runs Firefox with the new profile directory, to negate any performance\\n@@ -139,19 +151,16 @@ def InitializeNewProfile(firefox_path, profile_dir):\\n     firefox_path: String containing the path to the Firefox exe\\n     profile_dir: The full path to the profile directory to load\\n   \\\"\\\"\\\"\\n-\\n-  # Run Firefox with the new profile directory\\n+  PROFILE_REGEX = re.compile('__metrics(.*)__metrics', re.DOTALL|re.MULTILINE)\\n+  res = 1\\n   cmd = ffprocess.GenerateFirefoxCommandLine(firefox_path, profile_dir, config.INIT_URL)\\n-  handle = os.popen(cmd)\\n-\\n-  # Wait for Firefox to shut down and restart with the new profile,\\n-  # then kill the new instance if it doesn't close itself.\\n-  time_elapsed = 0\\n-  while time_elapsed < 30:\\n-    time_elapsed += 5\\n-    time.sleep(5)\\n-    if not ffprocess.ProcessesWithNameExist(\\\"firefox\\\"):\\n-      return\\n-  utils.debug(\\\"terminating firefox process\\\")\\n-  ffprocess.TerminateAllProcesses(\\\"firefox\\\")\\n-  ffprocess.SyncAndSleep()\\n+  (match, timed_out) = ffprocess.RunProcessAndWaitForOutput(cmd,\\n+                                                              'firefox',\\n+                                                              PROFILE_REGEX,\\n+                                                              30)\\n+  if (not timed_out):\\n+    print match\\n+  else:\\n+    res = 0\\n+    print \\\"ERROR: no metrics\\\"\\n+  return res\\ndiff --git a/testing/performance/talos/getInfo.html b/testing/performance/talos/getInfo.html\\nindex fcbf50b..d365e39 100644\\n--- a/testing/performance/talos/getInfo.html\\n+++ b/testing/performance/talos/getInfo.html\\n@@ -45,7 +45,7 @@\\n \\n   <body onload=\\\"\\n \\tif (window.dump) {\\n-\\t\\tdump('__metricsScreen width:' + screen.width + ' Screen height:' + screen.height + ' colorDepth:' + screen.colorDepth + '\\\\n\\\\n');\\n+            dump('__metrics\\\\tScreen width/height:' + screen.width + '/' + screen.height + '\\\\n\\\\tcolorDepth:' + screen.colorDepth + '\\\\n\\\\tBrowser inner width/height: ' + window.innerWidth + '/' + window.innerHeight + '\\\\n\\\\tBrowser outer width/height: ' + window.outerWidth + '/' + window.outerHeight + '__metrics')\\n \\t}\\n \\tgoQuitApplication();\\n \\twindow.close();\\ndiff --git a/testing/performance/talos/initialize.html b/testing/performance/talos/initialize.html\\ndeleted file mode 100755\\nindex 2d689a5..0000000\\n--- a/testing/performance/talos/initialize.html\\n+++ /dev/null\\n@@ -1,50 +0,0 @@\\n-<!-- ***** BEGIN LICENSE BLOCK *****\\n-   - Version: MPL 1.1/GPL 2.0/LGPL 2.1\\n-   -\\n-   - The contents of this file are subject to the Mozilla Public License Version\\n-   - 1.1 (the \\\"License\\\"); you may not use this file except in compliance with\\n-   - the License. You may obtain a copy of the License at\\n-   - http://www.mozilla.org/MPL/\\n-   -\\n-   - Software distributed under the License is distributed on an \\\"AS IS\\\" basis,\\n-   - WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License\\n-   - for the specific language governing rights and limitations under the\\n-   - License.\\n-   -\\n-   - The Original Code is Windows performance test.\\n-   -\\n-   - The Initial Developer of the Original Code is\\n-   - Google Inc.\\n-   - Portions created by the Initial Developer are Copyright (C) 1999\\n-   - the Initial Developer. All Rights Reserved.\\n-   -\\n-   - Contributor(s):\\n-   - Annie Sullivan <annie.sullivan@gmail.com>\\n-   -\\n-   - Alternatively, the contents of this file may be used under the terms of\\n-   - either the GNU General Public License Version 2 or later (the \\\"GPL\\\"), or\\n-   - the GNU Lesser General Public License Version 2.1 or later (the \\\"LGPL\\\"),\\n-   - in which case the provisions of the GPL or the LGPL are applicable instead\\n-   - of those above. If you wish to allow use of your version of this file only\\n-   - under the terms of either the GPL or the LGPL, and not to allow others to\\n-   - use your version of this file under the terms of the MPL, indicate your\\n-   - decision by deleting the provisions above and replace them with the notice\\n-   - and other provisions required by the LGPL or the GPL. If you do not delete\\n-   - the provisions above, a recipient may use your version of this file under\\n-   - the terms of any one of the MPL, the GPL or the LGPL.\\n-   -\\n-   - ***** END LICENSE BLOCK ***** -->\\n-\\n-<!DOCTYPE HTML PUBLIC \\\"-//W3C//DTD HTML 4.01 Transitional//EN\\\">\\n-<html>\\n-  <head>\\n-    <script language=\\\"Javascript\\\" type=\\\"text/javascript\\\" src=\\\"page_load_test/quit.js\\\"></script>\\n-    <title>shutdown script</title>\\n-  </head>\\n-\\n-  <body onload=\\\"goQuitApplication(); window.close();\\\">\\n-    This page should close Firefox.  If it does not, please make sure that\\n-    the dom.allow_scripts_to_close_windows preference is set to true in\\n-    <a href=\\\"about:config\\\">about:config</a>\\n-  </body>\\n-</html>\\ndiff --git a/testing/performance/talos/page_load_test/framecycler.html b/testing/performance/talos/page_load_test/framecycler.html\\nindex 57e4290..bfaa7d2 100644\\n--- a/testing/performance/talos/page_load_test/framecycler.html\\n+++ b/testing/performance/talos/page_load_test/framecycler.html\\n@@ -5,7 +5,7 @@\\n \\n   var NUM_PAGES;\\n   var NUM_CYCLES;\\n-  var DEFAULT_TIMEOUT = 25000; //how long any given page can take to load\\n+  var DEFAULT_TIMEOUT = 55000; //how long any given page can take to load\\n   var QUIT; // whether to quit the app (with quit.js) after the tests\\n   var t; \\n \\n@@ -134,9 +134,9 @@\\n \\n     var r = getArrayStats(all);\\n     dump(\\n-      \\\"__start_tp_report\\\\n\\\" + \\n+      \\\"__start_report\\\\n\\\" + \\n       \\\"_x_x_mozilla_page_load,\\\"+avgmed+\\\",\\\"+r.max+\\\",\\\"+r.min+\\\"\\\\n\\\"+\\n-      \\\"_x_x_mozilla_page_load_details,avgmedian|\\\"+avgmed+\\\"|average|\\\"+avg.toFixed(2)+\\\"|minimum|\\\"+r.min+\\\"|maximum|\\\"+r.max+\\\"|stddev|\\\"+r.stdd.toFixed(2)+\\\"\\\\n\\\"\\n+      \\\"_x_x_mozilla_page_load_details,avgmedian|\\\"+avgmed+\\\"|average|\\\"+avg.toFixed(2)+\\\"|minimum|\\\"+r.min+\\\"|maximum|\\\"+r.max+\\\"|stddev|\\\"+r.stdd.toFixed(2)\\n     );\\n \\n     for (var i = 0; i < timeVals.length; ++i) {\\n@@ -160,7 +160,7 @@\\n       }\\n       dump(\\\"\\\\n\\\")\\n     } \\n-    dump(\\\"__end_tp_report\\\\n\\\\n\\\");\\n+    dump(\\\"__end_report\\\\n\\\\n\\\");\\n     //rstring += \\\"__end_page_load_report\\\";\\n     //alert(rstring);\\n     //dump(rstring);\\n@@ -194,6 +194,9 @@\\n \\n   function loadFail() {\\n     dump(\\\"__FAILtimeout:\\\" + frames[\\\"content\\\"].document.location.href + \\\"__FAIL\\\");\\n+    if (QUIT) {\\n+      goQuitApplication();\\n+    }\\n     window.close();\\n   }\\n \\n@@ -211,7 +214,7 @@\\n       \\n       // use quit.js to quit the app if the quit param is true and \\n       // we have universalxpconnect privs:\\n-      if (QUIT && canQuitApplication()) {\\n+      if (QUIT) {\\n         goQuitApplication();\\n       }\\n       \\ndiff --git a/testing/performance/talos/page_load_test/manifest.txt b/testing/performance/talos/page_load_test/manifest.txt\\nnew file mode 100644\\nindex 0000000..2a460c2\\n--- /dev/null\\n+++ b/testing/performance/talos/page_load_test/manifest.txt\\n@@ -0,0 +1,395 @@\\n+http://localhost/page_load_test/pages/www.yahoo.com/www.yahoo.com/index.html\\n+http://localhost/page_load_test/pages/www.msn.com/www.msn.com/index.html\\n+http://localhost/page_load_test/pages/www.google.com/www.google.com/index.html\\n+http://localhost/page_load_test/pages/www.baidu.com/www.baidu.com/index.html\\n+http://localhost/page_load_test/pages/www.myspace.com/www.myspace.com/index.html\\n+http://localhost/page_load_test/pages/www.qq.com/www.qq.com/index.html\\n+http://localhost/page_load_test/pages/www.live.com/www.live.com/index.html\\n+http://localhost/page_load_test/pages/www.ebay.com/www.ebay.com/index.html\\n+http://localhost/page_load_test/pages/www.wikipedia.org/www.wikipedia.org/index.html\\n+http://localhost/page_load_test/pages/www.163.com/www.163.com/index.html\\n+http://localhost/page_load_test/pages/www.microsoft.com/www.microsoft.com/index.html\\n+http://localhost/page_load_test/pages/www.blogger.com/www.blogger.com/start.html\\n+http://localhost/page_load_test/pages/www.yahoo.com.cn/cn.yahoo.com/index.html\\n+http://localhost/page_load_test/pages/www.amazon.com/www.amazon.com/index.html\\n+http://localhost/page_load_test/pages/www.google.co.uk/www.google.co.uk/index.html\\n+http://localhost/page_load_test/pages/www.taobao.com/www.taobao.com/index.html\\n+http://localhost/page_load_test/pages/www.google.de/www.google.de/index.html\\n+http://localhost/page_load_test/pages/www.google.co.jp/www.google.co.jp/index.html\\n+http://localhost/page_load_test/pages/www.wretch.cc/www.wretch.cc/index.html\\n+http://localhost/page_load_test/pages/www.google.com.br/www.google.com.br/index.html\\n+http://localhost/page_load_test/pages/www.bbc.co.uk/www.bbc.co.uk/index.html\\n+http://localhost/page_load_test/pages/www.uol.com.br/www.uol.com.br/index.html\\n+http://localhost/page_load_test/pages/www.fotolog.net/www.fotolog.com/index.html\\n+http://localhost/page_load_test/pages/www.passport.net/accountservices.passport.net/ppnetworkhome.srf@vv=450&lc=1033.html\\n+http://localhost/page_load_test/pages/www.craigslist.org/sfbay.craigslist.org/index.html\\n+http://localhost/page_load_test/pages/www.cnn.com/www.cnn.com/index.html\\n+http://localhost/page_load_test/pages/www.google.com.mx/www.google.com.mx/index.html\\n+http://localhost/page_load_test/pages/www.imdb.com/www.imdb.com/index.html\\n+http://localhost/page_load_test/pages/www.flickr.com/www.flickr.com/index.html\\n+http://localhost/page_load_test/pages/www.mail.ru/www.mail.ru/index.html\\n+http://localhost/page_load_test/pages/www.xanga.com/www.xanga.com/index.html\\n+http://localhost/page_load_test/pages/www.aol.com/www.aol.com/index.html\\n+http://localhost/page_load_test/pages/www.google.es/www.google.es/index.html\\n+http://localhost/page_load_test/pages/www.yandex.ru/www.yandex.ru/index.html\\n+http://localhost/page_load_test/pages/www.google.co.in/www.google.co.in/index.html\\n+#//\\\"http://localhost/page_load_test/pages/www.discuss.com.hk/www.discuss.com.hk/index.html\\n+http://localhost/page_load_test/pages/www.ebay.co.uk/www.ebay.co.uk/index.html\\n+http://localhost/page_load_test/pages/www.mixi.jp/mixi.jp/index.html\\n+http://localhost/page_load_test/pages/www.naver.com/www.naver.com/index.html\\n+http://localhost/page_load_test/pages/www.friendster.com/www.friendster.com/index.html\\n+http://localhost/page_load_test/pages/www.google.fr/www.google.fr/index.html\\n+http://localhost/page_load_test/pages/www.facebook.com/www.facebook.com/index.html\\n+http://localhost/page_load_test/pages/www.google.pl/www.google.pl/index.html\\n+http://localhost/page_load_test/pages/www.google.ca/www.google.ca/index.html\\n+http://localhost/page_load_test/pages/www.google.com.tr/www.google.com.tr/index.html\\n+http://localhost/page_load_test/pages/www.onet.pl/www.onet.pl/index.html\\n+http://localhost/page_load_test/pages/www.google.cl/www.google.cl/index.html\\n+http://localhost/page_load_test/pages/www.pchome.com.tw/www.pchome.com.tw/index.html\\n+http://localhost/page_load_test/pages/www.terra.com.br/www.terra.com.br/capa/index.html\\n+http://localhost/page_load_test/pages/www.imageshack.us/www.imageshack.us/index.html\\n+http://localhost/page_load_test/pages/www.google.com.sa/www.google.com.sa/index.html\\n+http://localhost/page_load_test/pages/www.rakuten.co.jp/www.rakuten.co.jp/index.html\\n+http://localhost/page_load_test/pages/www.geocities.com/geocities.yahoo.com/index.html\\n+http://localhost/page_load_test/pages/www.vnet.cn/www.vnet.cn/default.aspx.html\\n+http://localhost/page_load_test/pages/www.ebay.de/www.ebay.de/index.html\\n+http://localhost/page_load_test/pages/www.uwants.com/www.uwants.com/index.html\\n+http://localhost/page_load_test/pages/www.rediff.com/www.rediff.com/index.html\\n+http://localhost/page_load_test/pages/www.photobucket.com/photobucket.com/index.html\\n+http://localhost/page_load_test/pages/www.soso.com/www.soso.com/index.html\\n+http://localhost/page_load_test/pages/www.google.com.ar/www.google.com.ar/index.html\\n+http://localhost/page_load_test/pages/www.adultfriendfinder.com/www.adultfriendfinder.com/index.html\\n+http://localhost/page_load_test/pages/www.apple.com/www.apple.com/index.html\\n+http://localhost/page_load_test/pages/www.livedoor.com/www.livedoor.com/index.html\\n+http://localhost/page_load_test/pages/www.sogou.com/www.sogou.com/index.html\\n+http://localhost/page_load_test/pages/www.google.cn/www.google.cn/index.html\\n+http://localhost/page_load_test/pages/www.newsgroup.la/www.newsgroup.la/index.html\\n+http://localhost/page_load_test/pages/www.chinaren.com/www.chinaren.com/index.html\\n+http://localhost/page_load_test/pages/www.sourceforge.net/sourceforge.net/index.php.html\\n+http://localhost/page_load_test/pages/www.digg.com/www.digg.com/index.html\\n+http://localhost/page_load_test/pages/www.126.com/www.126.com/index.html\\n+http://localhost/page_load_test/pages/www.daum.net/www.daum.net/index.html\\n+http://localhost/page_load_test/pages/www.xinhuanet.com/www.xinhuanet.com/index.html\\n+http://localhost/page_load_test/pages/www.about.com/www.about.com/index.html\\n+http://localhost/page_load_test/pages/www.nate.com/www.nate.com/index.html\\n+http://localhost/page_load_test/pages/www.rambler.ru/www.rambler.ru/index.html\\n+http://localhost/page_load_test/pages/www.google.it/www.google.it/index.html\\n+http://localhost/page_load_test/pages/www.comcast.net/www.comcast.net/index.html\\n+http://localhost/page_load_test/pages/www.badongo.com/www.badongo.com/index.html\\n+http://localhost/page_load_test/pages/www.free.fr/www.free.fr/index.html\\n+http://localhost/page_load_test/pages/www.3721.com/www.3721.com/wlsm/index.htm.html\\n+http://localhost/page_load_test/pages/www.ebay.com.cn/www.ebay.com.cn/index.html\\n+http://localhost/page_load_test/pages/www.hinet.net/www.hinet.net/index.html\\n+http://localhost/page_load_test/pages/www.statcounter.com/www.statcounter.com/index.html\\n+http://localhost/page_load_test/pages/www.adobe.com/www.adobe.com/index.html\\n+http://localhost/page_load_test/pages/www.google.com.au/www.google.com.au/index.html\\n+http://localhost/page_load_test/pages/www.mop.com/www.mop.com/index.html\\n+http://localhost/page_load_test/pages/www.ig.com.br/www.ig.com.br/index.html\\n+http://localhost/page_load_test/pages/www.starware.com/www.starware.com/2.0.0.0/index.html\\n+http://localhost/page_load_test/pages/www.google.co.il/www.google.co.il/index.html\\n+#//\\\"http://localhost/page_load_test/pages/www.hkjc.com/www.hkjc.com/index.html\\n+http://localhost/page_load_test/pages/www.china.com/www.china.com/index.html\\n+http://localhost/page_load_test/pages/www.dell.com/www.dell.com/index.html\\n+http://localhost/page_load_test/pages/www.51.com/www.51.com/index.html\\n+http://localhost/page_load_test/pages/www.digitalpoint.com/www.digitalpoint.com/index.html\\n+http://localhost/page_load_test/pages/www.flurl.com/www.flurl.com/index.html\\n+http://localhost/page_load_test/pages/www.goo.ne.jp/www.goo.ne.jp/index.html\\n+http://localhost/page_load_test/pages/www.atnext.com/www.atnext.com/index.html\\n+http://localhost/page_load_test/pages/www.download.com/www.download.com/index.html\\n+http://localhost/page_load_test/pages/www.cnnic.cn/www.cnnic.cn/index.html\\n+http://localhost/page_load_test/pages/www.cmfu.com/www.cmfu.com/index.html\\n+http://localhost/page_load_test/pages/www.mediaplex.com/www.mediaplex.com/index.html\\n+http://localhost/page_load_test/pages/www.googlesyndication.com/www.googlesyndication.com/index.html\\n+http://localhost/page_load_test/pages/www.mapquest.com/www.mapquest.com/index.html\\n+http://localhost/page_load_test/pages/www.globo.com/www.globo.com/index.html\\n+http://localhost/page_load_test/pages/www.weather.com/www.weather.com/index.html\\n+http://localhost/page_load_test/pages/www.imagevenue.com/www.imagevenue.com/index.html\\n+http://localhost/page_load_test/pages/www.overture.com/www.content.overture.com/d/index.html\\n+http://localhost/page_load_test/pages/www.theplanet.com/www.theplanet.com/index.html\\n+http://localhost/page_load_test/pages/www.icio.us/\\n+http://localhost/page_load_test/pages/www.pconline.com.cn/www.pconline.com.cn/index.html\\n+http://localhost/page_load_test/pages/www.mywebsearch.com/search.mywebsearch.com/mywebsearch/default.jhtml.html\\n+http://localhost/page_load_test/pages/www.sendspace.com/www.sendspace.com/index.html\\n+http://localhost/page_load_test/pages/www.typepad.com/www.typepad.com/index.html\\n+http://localhost/page_load_test/pages/www.amazon.co.jp/www.amazon.co.jp/index.html\\n+http://localhost/page_load_test/pages/www.infoseek.co.jp/www.infoseek.co.jp/index.html\\n+http://localhost/page_load_test/pages/www.21cn.com/www.21cn.com/index.html\\n+http://localhost/page_load_test/pages/www.gamer.com.tw/www.gamer.com.tw/index.html\\n+http://localhost/page_load_test/pages/www.tianya.cn/www.tianya.cn/index.html\\n+http://localhost/page_load_test/pages/www.google.com.eg/www.google.com.eg/index.html\\n+http://localhost/page_load_test/pages/www.deviantart.com/www.deviantart.com/index.html\\n+http://localhost/page_load_test/pages/www.metacafe.com/www.metacafe.com/index.html\\n+http://localhost/page_load_test/pages/www.265.com/www.265.com/index.html\\n+http://localhost/page_load_test/pages/www.google.com.tw/www.google.com.tw/index.html\\n+http://localhost/page_load_test/pages/www.match.com/www.match.com/index.html\\n+http://localhost/page_load_test/pages/www.php.net/www.php.net/index.html\\n+http://localhost/page_load_test/pages/www.spiegel.de/www.spiegel.de/index.html\\n+http://localhost/page_load_test/pages/www.neopets.com/www.neopets.com/index.html\\n+http://localhost/page_load_test/pages/www.phoenixtv.com/www.phoenixtv.com/index.html\\n+http://localhost/page_load_test/pages/www.hp.com/www.hp.com/index.html\\n+http://localhost/page_load_test/pages/www.google.nl/www.google.nl/index.html\\n+http://localhost/page_load_test/pages/www.nifty.com/www.nifty.com/index.html\\n+http://localhost/page_load_test/pages/www.sina.com.hk/www.sina.com.hk/index.html\\n+http://localhost/page_load_test/pages/www.sexyono.com/www.sexyono.com/index.html\\n+http://localhost/page_load_test/pages/www.paipai.com/www.paipai.com/index.html\\n+http://localhost/page_load_test/pages/www.amazon.co.uk/www.amazon.co.uk/index.html\\n+http://localhost/page_load_test/pages/www.chinahr.com/www.chinahr.com/index.html\\n+http://localhost/page_load_test/pages/www.tripod.com/www.tripod.lycos.com/index.html\\n+http://localhost/page_load_test/pages/www.google.co.ve/www.google.co.ve/index.html\\n+http://localhost/page_load_test/pages/www.yam.com/www.yam.com/index.html\\n+http://localhost/page_load_test/pages/www.google.com.pe/www.google.com.pe/index.html\\n+http://localhost/page_load_test/pages/www.reference.com/www.reference.com/index.html\\n+http://localhost/page_load_test/pages/www.maktoob.com/www.maktoob.com/index.html\\n+http://localhost/page_load_test/pages/www.wordpress.com/wordpress.com/index.html\\n+http://localhost/page_load_test/pages/www.gmx.net/www.gmx.net/index.html\\n+http://localhost/page_load_test/pages/www.google.com.co/www.google.com.co/index.html\\n+http://localhost/page_load_test/pages/www.sexuploader.com/www.megarotic.com/index.html\\n+http://localhost/page_load_test/pages/www.webs-tv.net/www.webs-tv.net/index.html\\n+http://localhost/page_load_test/pages/www.narod.ru/narod.yandex.ru/index.html\\n+http://localhost/page_load_test/pages/www.aebn.net/www.aebn.net/index.html\\n+http://localhost/page_load_test/pages/www.mozilla.com/www.mozilla.com/en-US/index.html\\n+http://localhost/page_load_test/pages/www.invisionfree.com/www.invisionfree.com/index.html\\n+http://localhost/page_load_test/pages/www.gamespot.com/www.gamespot.com/index.html\\n+http://localhost/page_load_test/pages/www.nastydollars.com/www.nastydollars.com/index.html\\n+http://localhost/page_load_test/pages/www.wefong.com/www.wefong.com/index.html\\n+http://localhost/page_load_test/pages/www.homeway.com.cn/www.hexun.com/index.html\\n+http://localhost/page_load_test/pages/www.rapidshare.com/www.rapidshare.com/index.html\\n+http://localhost/page_load_test/pages/www.vnexpress.net/www.vnexpress.net/Vietnam/Home/index.html\\n+http://localhost/page_load_test/pages/www.ask.com/www.ask.com/index.html\\n+http://localhost/page_load_test/pages/www.uusee.com/www.uusee.com/index.html\\n+http://localhost/page_load_test/pages/www.linkedin.com/www.linkedin.com/index.html\\n+http://localhost/page_load_test/pages/www.yesky.com/www.yesky.com/index.html\\n+http://localhost/page_load_test/pages/www.information.com/www.information.com/index.html\\n+http://localhost/page_load_test/pages/www.msn.com.br/br.msn.com/index.html\\n+http://localhost/page_load_test/pages/www.51job.com/www.51job.com/index.html\\n+http://localhost/page_load_test/pages/www.people.com.cn/www.people.com.cn/index.html\\n+http://localhost/page_load_test/pages/www.verycd.com/www.verycd.com/index.html\\n+http://localhost/page_load_test/pages/www.sportsline.com/www.sportsline.com/index.html\\n+http://localhost/page_load_test/pages/www.youthwant.com.tw/www.youthwant.com.tw/index.html\\n+http://localhost/page_load_test/pages/www.skyblog.com/www.skyblog.com/index.html\\n+http://localhost/page_load_test/pages/www.technorati.com/www.technorati.com/index.html\\n+http://localhost/page_load_test/pages/www.google.co.th/www.google.co.th/index.html\\n+http://localhost/page_load_test/pages/www.google.com.vn/www.google.com.vn/index.html\\n+http://localhost/page_load_test/pages/www.hatena.ne.jp/www.hatena.ne.jp/index.html\\n+http://localhost/page_load_test/pages/www.yourfilehost.com/www.yourfilehost.com/index.html\\n+http://localhost/page_load_test/pages/www.amazon.de/www.amazon.de/index.html\\n+http://localhost/page_load_test/pages/www.chinamobile.com/www.chinamobile.com/index.html\\n+http://localhost/page_load_test/pages/www.centrum.cz/www.centrum.cz/index.html\\n+http://localhost/page_load_test/pages/www.flogao.com.br/www.flogao.com/index.html\\n+http://localhost/page_load_test/pages/www.myway.com/www.myway.com/index.html\\n+http://localhost/page_load_test/pages/www.xuite.net/www.xuite.net/index.html\\n+http://localhost/page_load_test/pages/www.msn.com.cn/cn.msn.com/index.html\\n+http://localhost/page_load_test/pages/www.kooora.com/www.kooora.com/index.html\\n+http://localhost/page_load_test/pages/www.godaddy.com/www.godaddy.com/gdshop/default.asp.html\\n+http://localhost/page_load_test/pages/www.google.com.sg/www.google.com.sg/index.html\\n+http://localhost/page_load_test/pages/www.4399.com/www.4399.com/index.html\\n+http://localhost/page_load_test/pages/www.earthlink.net/www.earthlink.net/index.html\\n+http://localhost/page_load_test/pages/www.torrentspy.com/www.torrentspy.com/index.html\\n+http://localhost/page_load_test/pages/www.pornotube.com/www.pornotube.com/index.html\\n+http://localhost/page_load_test/pages/www.aweber.com/www.aweber.com/index.html\\n+http://localhost/page_load_test/pages/www.slashdot.org/slashdot.org/index.html\\n+http://localhost/page_load_test/pages/www.2ch.net/www.2ch.net/index.html\\n+http://localhost/page_load_test/pages/www.ev1servers.net/www.ev1servers.net/index.html\\n+http://localhost/page_load_test/pages/www.webshots.com/www.webshots.com/index.html\\n+http://localhost/page_load_test/pages/www.webmasterworld.com/www.webmasterworld.com/index.html\\n+http://localhost/page_load_test/pages/www.google.se/www.google.se/index.html\\n+http://localhost/page_load_test/pages/www.biglobe.ne.jp/www.biglobe.ne.jp/index.html\\n+http://localhost/page_load_test/pages/www.domaintools.com/www.domaintools.com/index.html\\n+http://localhost/page_load_test/pages/www.mininova.org/www.mininova.org/index.html\\n+http://localhost/page_load_test/pages/www.elmundo.es/www.elmundo.es/index.html\\n+http://localhost/page_load_test/pages/www.google.ro/www.google.ro/index.html\\n+http://localhost/page_load_test/pages/www.google.ae/www.google.ae/index.html\\n+http://localhost/page_load_test/pages/www.clubbox.co.kr/www.clubbox.co.kr/index.html\\n+http://localhost/page_load_test/pages/www.w3.org/www.w3.org/index.html\\n+http://localhost/page_load_test/pages/www.qihoo.com/www.qihoo.com/index.html\\n+http://localhost/page_load_test/pages/www.google.ru/www.google.ru/index.html\\n+http://localhost/page_load_test/pages/www.miniclip.com/www.miniclip.com/games/en/index.html\\n+http://localhost/page_load_test/pages/www.milliyet.com.tr/www.milliyet.com.tr/2006/12/05/index.html\\n+http://localhost/page_load_test/pages/www.google.com.my/www.google.com.my/index.html\\n+http://localhost/page_load_test/pages/www.bebo.com/www.bebo.com/index.html\\n+http://localhost/page_load_test/pages/www.dmm.co.jp/www.dmm.co.jp/index.html\\n+http://localhost/page_load_test/pages/www.orange.fr/www.orange.fr/index.html\\n+http://localhost/page_load_test/pages/www.bta.net.cn/www.bta.net.cn/index.html\\n+http://localhost/page_load_test/pages/www.istockphoto.com/www.istockphoto.com/index.php.html\\n+http://localhost/page_load_test/pages/www.qianlong.com/www.qianlong.com/index.html\\n+http://localhost/page_load_test/pages/www.ebay.com.au/www.ebay.com.au/index.html\\n+http://localhost/page_load_test/pages/www.chinaz.com/www.chinaz.com/index.html\\n+http://localhost/page_load_test/pages/www.adbrite.com/www.adbrite.com/index.html\\n+http://localhost/page_load_test/pages/www.sitepoint.com/www.sitepoint.com/index.html\\n+http://localhost/page_load_test/pages/www.zhongsou.com/www.zhongsou.com/index.html\\n+http://localhost/page_load_test/pages/www.ups.com/www.ups.com/index.html\\n+http://localhost/page_load_test/pages/www.wwe.com/www.wwe.com/index.html\\n+http://localhost/page_load_test/pages/www.netflix.com/www.netflix.com/Register.html\\n+http://localhost/page_load_test/pages/www.target.com/www.target.com/gp/homepage.html\\n+http://localhost/page_load_test/pages/www.it.com.cn/www.it.com.cn/index.html\\n+http://localhost/page_load_test/pages/www.washingtonpost.com/www.washingtonpost.com/index.html\\n+http://localhost/page_load_test/pages/www.usps.com/www.usps.com/index.html\\n+http://localhost/page_load_test/pages/www.iask.com/www.iask.com/index.html\\n+http://localhost/page_load_test/pages/www.google.com.hk/www.google.com.hk/index.html\\n+http://localhost/page_load_test/pages/www.ibm.com/www.ibm.com/us/index.html\\n+http://localhost/page_load_test/pages/www.google.gr/www.google.gr/index.html\\n+http://localhost/page_load_test/pages/www.6park.com/www.6park.com/index.html\\n+http://localhost/page_load_test/pages/www.sex141.com/www.sex141.com/index.html\\n+http://localhost/page_load_test/pages/www.excite.co.jp/www.excite.co.jp/index.html\\n+http://localhost/page_load_test/pages/www.sakura.ne.jp/www.sakura.ne.jp/index.html\\n+http://localhost/page_load_test/pages/www.icq.com/www.icq.com/index.html\\n+http://localhost/page_load_test/pages/www.bangbros1.com/www.bangbros1.com/index.html\\n+http://localhost/page_load_test/pages/www.answers.com/www.answers.com/index.html\\n+http://localhost/page_load_test/pages/www.foxsports.com/msn.foxsports.com/index.html\\n+http://localhost/page_load_test/pages/www.clickbank.com/www.clickbank.com/index.html\\n+http://localhost/page_load_test/pages/www.skype.com/www.skype.com/index.html\\n+http://localhost/page_load_test/pages/www.mofile.com/tv.mofile.com/cn/index/main.do.html\\n+http://localhost/page_load_test/pages/www.mlb.com/mlb.mlb.com/NASApp/mlb/index.jsp.html\\n+http://localhost/page_load_test/pages/www.89.com/www.89.com/index.html\\n+http://localhost/page_load_test/pages/www.nba.com/www.nba.com/index.html\\n+http://localhost/page_load_test/pages/www.pornaccess.com/www.pornaccess.com/index.html\\n+http://localhost/page_load_test/pages/www.imagefap.com/www.imagefap.com/index.html\\n+http://localhost/page_load_test/pages/www.pcpop.com/www.pcpop.com/index.html\\n+http://localhost/page_load_test/pages/www.hurriyet.com.tr/www.hurriyet.com.tr/anasayfa/index.html\\n+http://localhost/page_load_test/pages/www.t-online.de/www.t-online.de/index.html\\n+http://localhost/page_load_test/pages/www.google.pt/www.google.pt/index.html\\n+http://localhost/page_load_test/pages/www.no-ip.com/www.no-ip.com/index.html\\n+http://localhost/page_load_test/pages/www.ocn.ne.jp/www.ocn.ne.jp/index.html\\n+http://localhost/page_load_test/pages/www.it168.com/www.it168.com/index.html\\n+http://localhost/page_load_test/pages/www.seesaa.net/tag.seesaa.jp/index.html\\n+http://localhost/page_load_test/pages/www.nih.gov/www.nih.gov/index.html\\n+http://localhost/page_load_test/pages/www.raaga.com/www.raaga.com/index.html\\n+http://localhost/page_load_test/pages/www.lide.cz/www.lide.cz/index.html\\n+http://localhost/page_load_test/pages/www.indiatimes.com/in.indiatimes.com/usdefault.cms.html\\n+http://localhost/page_load_test/pages/www.doubleclick.com/www.doubleclick.com/us/index.html\\n+http://localhost/page_load_test/pages/www.reuters.com/today.reuters.com/news/home.aspx.html\\n+http://localhost/page_load_test/pages/www.dantri.com.vn/www19.dantri.com.vn/news/index.html\\n+http://localhost/page_load_test/pages/www.fotka.pl/www.fotka.pl/index.html\\n+http://localhost/page_load_test/pages/www.miarroba.com/miarroba.com/index.html\\n+http://localhost/page_load_test/pages/www.readnovel.com/www.readnovel.com/index.html\\n+http://localhost/page_load_test/pages/www.hawaaworld.com/www.hawaaworld.com/index.html\\n+http://localhost/page_load_test/pages/www.expedia.com/www.expedia.com/Default.asp@CCheck=1&.html\\n+http://localhost/page_load_test/pages/www.msn.co.uk/uk.msn.com/index.html\\n+http://localhost/page_load_test/pages/www.104.com.tw/www.104.com.tw/index.html\\n+http://localhost/page_load_test/pages/www.eastmoney.com/www.eastmoney.com/index.html\\n+http://localhost/page_load_test/pages/www.fares.net/www.fares.net/index.html\\n+http://localhost/page_load_test/pages/www.zhaopin.com/www.zhaopin.com/index.html\\n+http://localhost/page_load_test/pages/www.clarin.com/www.clarin.com/index.html\\n+http://localhost/page_load_test/pages/www.dreamwiz.com/www.dreamwiz.com/index.html\\n+http://localhost/page_load_test/pages/www.ameblo.jp/www.ameba.jp/index.html\\n+http://localhost/page_load_test/pages/www.dailymotion.com/www.dailymotion.com/index.html\\n+http://localhost/page_load_test/pages/www.ikea.com/www.ikea.com/index.html\\n+http://localhost/page_load_test/pages/www.constantcontact.com/www.constantcontact.com/index.jsp.html\\n+http://localhost/page_load_test/pages/www.mainichi-msn.co.jp/www.mainichi-msn.co.jp/index.html\\n+http://localhost/page_load_test/pages/www.xnxx.com/www.xnxx.com/index.html\\n+http://localhost/page_load_test/pages/www.dnsstuff.com/www.dnsstuff.com/index.html\\n+http://localhost/page_load_test/pages/www.tigerdirect.com/www.tigerdirect.com/index.html\\n+http://localhost/page_load_test/pages/www.nikkei.co.jp/www.nikkei.co.jp/index.html\\n+http://localhost/page_load_test/pages/www.liveinternet.ru/www.liveinternet.ru/index.html\\n+http://localhost/page_load_test/pages/www.forbes.com/www.forbes.com/index.html\\n+http://localhost/page_load_test/pages/www.linksynergy.com/\\n+http://localhost/page_load_test/pages/www.yousendit.com/www.yousendit.com/index.html\\n+http://localhost/page_load_test/pages/www.6rb.com/www.6rb.com/index.html\\n+http://localhost/page_load_test/pages/www.nfl.com/www.nfl.com/index.html\\n+http://localhost/page_load_test/pages/www.bestbuy.com/www.bestbuy.com/index.html\\n+http://localhost/page_load_test/pages/www.iwiw.hu/www.iwiw.hu/pages/user/login.jsp.html\\n+http://localhost/page_load_test/pages/www.aim.com/www.aim.com/index.html\\n+http://localhost/page_load_test/pages/www.zaobao.com/www.zaobao.com/index.html\\n+http://localhost/page_load_test/pages/www.gamefaqs.com/www.gamefaqs.com/index.html\\n+http://localhost/page_load_test/pages/www.whenu.com/www.whenu.com/index.html\\n+http://localhost/page_load_test/pages/www.pogo.com/www.pogo.com/home/home.do@sls=2&site=pogo.html\\n+http://localhost/page_load_test/pages/www.online.sh.cn/www.online.sh.cn/index.html\\n+http://localhost/page_load_test/pages/www.sanook.com/www.sanook.com/index.html\\n+http://localhost/page_load_test/pages/www.blog.cz/blog.cz/index.html\\n+http://localhost/page_load_test/pages/www.feedburner.com/www.feedburner.com/fb/a/home.html\\n+http://localhost/page_load_test/pages/www.msn.ca/sympatico.msn.ca/index.html\\n+http://localhost/page_load_test/pages/www.libero.it/www.libero.it/index.html\\n+http://localhost/page_load_test/pages/72.14.235.104/72.14.235.104/index.html\\n+http://localhost/page_load_test/pages/www.excite.com/www.excite.com/index.html\\n+http://localhost/page_load_test/pages/www.leo.org/www.leo.org/index.html\\n+http://localhost/page_load_test/pages/www.ebay.fr/www.ebay.fr/index.html\\n+http://localhost/page_load_test/pages/www.ctrip.com/www.ctrip.com/index.html\\n+http://localhost/page_load_test/pages/www.last.fm/www.last.fm/index.html\\n+http://localhost/page_load_test/pages/www.gamebase.com.tw/www.gamebase.com.tw/index.html\\n+http://localhost/page_load_test/pages/www.ebay.ca/www.ebay.ca/index.html\\n+http://localhost/page_load_test/pages/www.yimg.com/\\n+http://localhost/page_load_test/pages/www.vietnamnet.vn/www.vietnamnet.vn/index.html\\n+http://localhost/page_load_test/pages/www.uploading.com/www.uploading.com/index.html\\n+http://localhost/page_load_test/pages/www.sapo.pt/www.sapo.pt/index.html\\n+http://localhost/page_load_test/pages/www.usatoday.com/www.usatoday.com/index.html\\n+http://localhost/page_load_test/pages/www.pplive.com/www.pplive.com/zh-cn/index.html\\n+http://localhost/page_load_test/pages/www.multiply.com/multiply.com/index.html\\n+http://localhost/page_load_test/pages/www.jobsdb.com/www.jobsdb.com/default.htm@58518.html\\n+http://localhost/page_load_test/pages/www.4399.net/www.4399.net/index.html\\n+http://localhost/page_load_test/pages/www.ynet.com/www.ynet.com/index.html\\n+http://localhost/page_load_test/pages/www.google.ch/www.google.ch/index.html\\n+http://localhost/page_load_test/pages/www.mac.com/www.apple.com/dotmac/index.html\\n+http://localhost/page_load_test/pages/www.joomla.org/www.joomla.org/index.html\\n+http://localhost/page_load_test/pages/www.dyndns.org/www.dyndns.com/index.html\\n+http://localhost/page_load_test/pages/www.voyeurweb.com/www.voyeurweb.com/index.html\\n+http://localhost/page_load_test/pages/www.wuhan.net.cn/www.wuhan.net.cn/index.html\\n+http://localhost/page_load_test/pages/www.piczo.com/www.piczo.com/index.html@cr=4&rfm=y.html\\n+http://localhost/page_load_test/pages/www.google.be/www.google.be/index.html\\n+http://localhost/page_load_test/pages/www.panet.co.il/www.panet.co.il/index.html\\n+http://localhost/page_load_test/pages/www.google.co.ma/www.google.co.ma/index.html\\n+http://localhost/page_load_test/pages/72.14.221.104/72.14.221.104/index.html\\n+http://localhost/page_load_test/pages/www.msn.com.tw/tw.msn.com/index.html\\n+http://localhost/page_load_test/pages/www.wangyou.com/www.wangyou.com/index.html\\n+http://localhost/page_load_test/pages/www.6arab.com/www.6arab.com/index.html\\n+http://localhost/page_load_test/pages/www.wordpress.org/wordpress.org/index.html\\n+http://localhost/page_load_test/pages/www.onlinedown.net/www.onlinedown.net/index.html\\n+http://localhost/page_load_test/pages/www.drudgereport.com/www.drudgereport.com/index.html\\n+http://localhost/page_load_test/pages/www.joyo.com/www.joyo.com/index.html\\n+http://localhost/page_load_test/pages/www.skycn.com/www.skycn.com/index.html\\n+http://localhost/page_load_test/pages/www.zedo.com/www.zedo.com/index.html\\n+http://localhost/page_load_test/pages/www.i-part.com.cn/www.i-part.com.cn/index.html\\n+http://localhost/page_load_test/pages/www.w3schools.com/www.w3schools.com/index.html\\n+http://localhost/page_load_test/pages/www.payserve.com/www.payserve.com/index.html\\n+http://localhost/page_load_test/pages/www.macromedia.com/www.adobe.com/index.html\\n+http://localhost/page_load_test/pages/www.usercash.com/www.usercash.com/index.html\\n+http://localhost/page_load_test/pages/www.51.la/www.51.la/index.html\\n+http://localhost/page_load_test/pages/www.chinacars.com/www.chinacars.com/index.html\\n+http://localhost/page_load_test/pages/www.cj.com/www.cj.com/index.html\\n+http://localhost/page_load_test/pages/www.isohunt.com/www.isohunt.com/index.html\\n+http://localhost/page_load_test/pages/www.engadget.com/www.engadget.com/index.html\\n+http://localhost/page_load_test/pages/www.nikkansports.com/www.nikkansports.com/index.html\\n+http://localhost/page_load_test/pages/www.fedex.com/www.fedex.com/index.html\\n+http://localhost/page_load_test/pages/www.mobile.de/www.mobile.de/index.html\\n+http://localhost/page_load_test/pages/www.cams.com/www.cams.com/index.html\\n+http://localhost/page_load_test/pages/www.kinghost.com/www.kinghost.com/index.html\\n+http://localhost/page_load_test/pages/www.made-in-china.com/www.made-in-china.com/index.html\\n+http://localhost/page_load_test/pages/www.24h.com.vn/www14.24h.com.vn/index.php.html\\n+http://localhost/page_load_test/pages/www.sxc.hu/www.sxc.hu/index.html\\n+http://localhost/page_load_test/pages/www.tv.com/www.tv.com/index.html\\n+http://localhost/page_load_test/pages/www.nextag.com/www.nextag.com/index.html\\n+http://localhost/page_load_test/pages/www.jrj.com.cn/www.jrj.com.cn/index.html\\n+http://localhost/page_load_test/pages/www.msn.es/es.msn.com/index.html\\n+http://localhost/page_load_test/pages/www.terra.com.ar/www.terra.com.ar/index.html\\n+http://localhost/page_load_test/pages/www.wikimedia.org/www.wikimedia.org/index.html\\n+http://localhost/page_load_test/pages/www.google.lt/www.google.lt/index.html\\n+http://localhost/page_load_test/pages/www.aftonbladet.se/www.aftonbladet.se/index.html\\n+http://localhost/page_load_test/pages/72.14.209.104/72.14.209.104/index.html\\n+http://localhost/page_load_test/pages/www.xrea.com/www.xrea.com/index.html\\n+http://localhost/page_load_test/pages/www.mysql.com/www.mysql.com/index.html\\n+http://localhost/page_load_test/pages/www.overstock.com/www.overstock.com/index.html\\n+http://localhost/page_load_test/pages/www.sitemeter.com/www.sitemeter.com/index.html\\n+http://localhost/page_load_test/pages/www.yok.com/www.yok.com/index.html\\n+http://localhost/page_load_test/pages/www.met-art.com/www.met-art.com/index.html\\n+http://localhost/page_load_test/pages/www.sun.com/www.sun.com/index.html\\n+http://localhost/page_load_test/pages/www.tripadvisor.com/www.tripadvisor.com/index.html\\n+http://localhost/page_load_test/pages/www.gc.ca/www.gc.ca/index.html\\n+http://localhost/page_load_test/pages/www.realtor.com/www.realtor.com/Default.asp@poe=realtor.html\\n+http://localhost/page_load_test/pages/www.spoluzaci.cz/www.spoluzaci.cz/index.html\\n+http://localhost/page_load_test/pages/www.netscape.com/www.netscape.com/index.html\\n+http://localhost/page_load_test/pages/www.asahi.com/www.asahi.com/index.html\\n+http://localhost/page_load_test/pages/www.fanfiction.net/www.fanfiction.net/index.html\\n+http://localhost/page_load_test/pages/www.msn.com.hk/www.msn.com.hk/Default.asp.html\\n+http://localhost/page_load_test/pages/www.travelocity.com/www.travelocity.com/index.html\\n+http://localhost/page_load_test/pages/www.ninemsn.com.au/ninemsn.com.au/index.html\\n+http://localhost/page_load_test/pages/www.stumbleupon.com/www.stumbleupon.com/index.html\\n+http://localhost/page_load_test/pages/www.cafepress.com/www.cafepress.com/index.html\\n+http://localhost/page_load_test/pages/www.livejasmin.com/www.2.livejasmin.com/index.php.html\\n+http://localhost/page_load_test/pages/www.ezinearticles.com/www.ezinearticles.com/index.html\\n+http://localhost/page_load_test/pages/www.pricegrabber.com/www.pricegrabber.com/index.html\\n+http://localhost/page_load_test/pages/www.sina.com/www.sina.com/index.html\\n+http://localhost/page_load_test/pages/www.lycos.com/www.lycos.com/index.html\\n+http://localhost/page_load_test/pages/www.apache.org/www.apache.org/index.html\\n+http://localhost/page_load_test/pages/www.ringo.com/www.ringo.com/index.html\\n+http://localhost/page_load_test/pages/www.videosz.com/www.videosz.com/index.html\\n+http://localhost/page_load_test/pages/www.fotop.net/www.fotop.net/index.html\\n+http://localhost/page_load_test/pages/www.fatwallet.com/www.fatwallet.com/index.html\\ndiff --git a/testing/performance/talos/run_tests.py b/testing/performance/talos/run_tests.py\\nindex 40719aa..4c5884d 100755\\n--- a/testing/performance/talos/run_tests.py\\n+++ b/testing/performance/talos/run_tests.py\\n@@ -61,8 +61,7 @@ socket.setdefaulttimeout(480)\\n import utils\\n import config\\n import post_file\\n-import tp\\n-import ts\\n+import ttest\\n \\n def shortNames(name):\\n   if name == \\\"tp_loadtime\\\":\\n@@ -84,6 +83,142 @@ def process_Request(post):\\n         str += line.split(\\\":\\\")[3] + \\\":\\\" + shortNames(line.split(\\\":\\\")[1]) + \\\":\\\" + line.split(\\\":\\\")[2] + '\\\\n'\\n   return str\\n \\n+def send_to_csv(results):\\n+  import csv\\n+  for res in results:\\n+    browser_dump, counter_dump = results[res]\\n+    writer = csv.writer(open(config.CSV_FILE + '_' +  res, \\\"wb\\\"))\\n+    if res == 'ts':\\n+      i = 0\\n+      writer.writerow(['i', 'val'])\\n+      for val in browser_dump:\\n+        writer.writerow([i, val])\\n+        i += 1\\n+    if (res.find('tp') > -1) or (res == 'tdhmtl'):\\n+      writer.writerow(['i', 'page', 'median', 'mean', 'min' , 'max', 'runs'])\\n+      for bd in browser_dump:\\n+        bd.rstrip('\\\\n')\\n+        page_results = bd.splitlines()\\n+        i = 0\\n+        for mypage in page_results[2:]:\\n+          r = mypage.split(';')\\n+          if r[1].find('/') > -1 :\\n+             page = r[1].split('/')[1]\\n+          else:\\n+             page = r[1]\\n+          writer.writerow([i, page, r[2], r[3], r[4], r[5], '|'.join(r[6:])])\\n+          i += 1\\n+    for cd in counter_dump:\\n+      for count_type in cd:\\n+        writer = csv.writer(open(config.CSV_FILE + '_' + res + '_' + count_type, \\\"wb\\\"))\\n+        writer.writerow(['i', 'value'])\\n+        i = 0\\n+        for val in cd[count_type]:\\n+          writer.writerow([i, val])\\n+          i += 1\\n+\\n+def post_chunk(id, filename):\\n+  tmpf = open(filename, \\\"r\\\")\\n+  file_data = tmpf.read()\\n+  while True:\\n+    try:\\n+      ret = post_file.post_multipart(config.RESULTS_SERVER, config.RESULTS_LINK, [(\\\"key\\\", \\\"value\\\")], [(\\\"filename\\\", filename, file_data)])\\n+    except IOError:\\n+      print \\\"FAIL: IOError on sending data to the graph server\\\"\\n+    else:\\n+      break\\n+  links = process_Request(ret)\\n+  utils.debug(id + \\\": sent results\\\")\\n+  return links\\n+\\n+def chunk_list(val_list):\\n+  \\\"\\\"\\\" \\n+    divide up a list into manageable chunks\\n+    currently set at length 500 \\n+    this is for a failure on mac os x with python 2.4.4 \\n+  \\\"\\\"\\\"\\n+  chunks = []\\n+  end = 500\\n+  while (val_list != []):\\n+    chunks.append(val_list[0:end])\\n+    val_list = val_list[end:len(val_list)]\\n+  return chunks\\n+\\n+def send_to_graph(title, date, browser_config, results):\\n+  tbox = title\\n+  url_format = \\\"http://%s/%s\\\"\\n+  link_format= \\\"<a href = \\\\\\\"%s\\\\\\\">%s</a>\\\"\\n+  #value, testname, tbox, timeval, date, branch, buildid, type, data\\n+  result_format = \\\"%.2f,%s,%s,%d,%d,%s,%s,%s,%s,\\\\n\\\"\\n+  result_format2 = \\\"%.2f,%s,%s,%d,%d,%s,%s,%s,\\\\n\\\"\\n+  links = ''\\n+\\n+  for res in results:\\n+    filename = tempfile.mktemp()\\n+    tmpf = open(filename, \\\"w\\\")\\n+    browser_dump, counter_dump = results[res]\\n+    filename = tempfile.mktemp()\\n+    tmpf = open(filename, \\\"w\\\")\\n+    if res == 'ts':\\n+       i = 0\\n+       for val in browser_dump:\\n+         tmpf.write(result_format % (float(val), res, tbox, i, date, browser_config['branch'], browser_config['buildid'], \\\"discrete\\\", \\\"ms\\\"))\\n+         i += 1\\n+    if (res.find('tp') > -1)  or (res == 'tdhtml'):\\n+       # each line of the string is of the format i;page_name;median;mean;min;max;time vals\\\\n\\n+      for bd in browser_dump:\\n+        bd.rstrip('\\\\n')\\n+        page_results = bd.splitlines()\\n+        i = 0\\n+        for mypage in page_results[2:]:\\n+          r = mypage.split(';')\\n+          if r[1].find('/') > -1 :\\n+             page = r[1].split('/')[1]\\n+          else:\\n+             page = r[1]\\n+          try:\\n+            val = float(r[2])\\n+          except ValueError:\\n+            print 'WARNING: value error for median in tp'\\n+            val = 0\\n+          tmpf.write(result_format % (val, res, tbox, i, date, browser_config['branch'], browser_config['buildid'], \\\"discrete\\\", page))\\n+          i += 1\\n+    tmpf.flush()\\n+    tmpf.close()\\n+    links += post_chunk(res, filename)\\n+    os.remove(filename)\\n+    for cd in counter_dump:\\n+      for count_type in cd:\\n+        val_list = cd[count_type]\\n+        chunks = chunk_list(val_list)\\n+        chunk_link = ''\\n+        for chunk in chunks:\\n+          filename = tempfile.mktemp()\\n+          tmpf = open(filename, \\\"w\\\")\\n+          i = 0\\n+          for val in chunk:\\n+              tmpf.write(result_format2 % (float(val), res + \\\"_\\\" + count_type.replace(\\\"%\\\", \\\"Percent\\\"), tbox, i, date, browser_config['branch'], browser_config['buildid'], \\\"discrete\\\"))\\n+              i += 1\\n+          tmpf.flush()\\n+          tmpf.close()\\n+          chunk_link = post_chunk('%s_%s (%d values)' % (res, count_type, len(chunk)), filename)\\n+          os.remove(filename)\\n+        links += chunk_link\\n+    \\n+  lines = links.split('\\\\n')\\n+  for line in lines:\\n+    if line == \\\"\\\":\\n+      continue\\n+    values = line.split(\\\":\\\")\\n+    linkName = values[1]\\n+    if float(values[2]) > 0:\\n+      linkName += \\\"_T: \\\" + values[2]\\n+    else:\\n+      linkName += \\\"_1\\\"\\n+    url = url_format % (config.RESULTS_SERVER, values[0],)\\n+    link = link_format % (url, linkName,)\\n+    print \\\"RETURN: \\\" + link\\n+\\n def test_file(filename):\\n   \\\"\\\"\\\"Runs the Ts and Tp tests on the given config file and generates a report.\\n   \\n@@ -91,11 +226,11 @@ def test_file(filename):\\n     filename: the name of the file to run the tests on\\n   \\\"\\\"\\\"\\n   \\n-  test_configs = []\\n-  test_names = []\\n+  browser_config = []\\n+  tests = []\\n   title = ''\\n-  filename_prefix = ''\\n   testdate = ''\\n+  results = {}\\n   \\n   # Read in the profile info from the YAML config file\\n   config_file = open(filename, 'r')\\n@@ -104,130 +239,40 @@ def test_file(filename):\\n   for item in yaml_config:\\n     if item == 'title':\\n       title = yaml_config[item]\\n-    elif item == 'filename':\\n-      filename_prefix = yaml_config[item]\\n     elif item == 'testdate':\\n       testdate = yaml_config[item]\\n-    else:\\n-      new_config = [yaml_config[item]['preferences'],\\n-                    yaml_config[item]['extensions'],\\n-                    yaml_config[item]['firefox'],\\n-                    yaml_config[item]['branch'],\\n-                    yaml_config[item]['branchid'],\\n-                    yaml_config[item]['profile_path'],\\n-                    yaml_config[item]['env']]\\n-      test_configs.append(new_config)\\n-      test_names.append(item)\\n+  browser_config = {'preferences'  : yaml_config['preferences'],\\n+                    'extensions'   : yaml_config['extensions'],\\n+                    'firefox'      : yaml_config['firefox'],\\n+                    'branch'       : yaml_config['branch'],\\n+                    'buildid'      : yaml_config['buildid'],\\n+                    'profile_path' : yaml_config['profile_path'],\\n+                    'env'          : yaml_config['env'],\\n+                    'dirs'         : yaml_config['dirs']}\\n+  tests = yaml_config['tests']\\n   config_file.close()\\n-\\n-  print test_configs\\n-  sys.stdout.flush()\\n   if (testdate != ''):\\n     date = int(time.mktime(time.strptime(testdate, '%a, %d %b %Y %H:%M:%S GMT')))\\n   else:\\n     date = int(time.time()) #TODO get this into own file\\n-  print \\\"using testdate: %d\\\" % date\\n-  print \\\"actual date: %d\\\" % int(time.time())\\n- \\n-\\n-  # Run startup time test\\n-  ts_times = ts.RunStartupTests(test_configs,\\n-                                config.TS_NUM_RUNS)\\n-\\n-  print \\\"finished ts\\\"\\n-  sys.stdout.flush()\\n-  for ts_set in ts_times:\\n-    if len(ts_set) == 0:\\n-\\tprint \\\"FAIL:no ts results, build failed to run:BAD BUILD\\\"\\n-\\tsys.exit(0)\\n-\\n-  (res, r_strings, tp_times, tp_counters) = tp.RunPltTests(test_configs,\\n-                                           config.TP_NUM_CYCLES,\\n-                                           config.COUNTERS,\\n-                                           config.TP_RESOLUTION)\\n-\\n-  print \\\"finished tp\\\"\\n-  sys.stdout.flush()\\n-\\n-  if not res:\\n-    print \\\"FAIL:tp did not run to completion\\\"\\n-    print \\\"FAIL:\\\" + r_strings[0]\\n-    sys.exit(0)\\n-\\n-  #TODO: place this in its own file\\n-  #send results to the graph server\\n-  # each line of the string is of the format i;page_name;median;mean;min;max;time vals\\\\n\\n-  tbox = title\\n-  url_format = \\\"http://%s/%s\\\"\\n-  link_format= \\\"<a href = \\\\\\\"%s\\\\\\\">%s</a>\\\"\\n-  #value, testname, tbox, timeval, date, branch, branchid, type, data\\n-  result_format = \\\"%.2f,%s,%s,%d,%d,%s,%s,%s,%s,\\\\n\\\"\\n-  result_format2 = \\\"%.2f,%s,%s,%d,%d,%s,%s,%s,\\\\n\\\"\\n-  filename = tempfile.mktemp()\\n-  tmpf = open(filename, \\\"w\\\")\\n-\\n-  testname = \\\"ts\\\"\\n-  print \\\"formating results for: ts\\\"\\n-  print \\\"# of values: %d\\\" % len(ts_times)\\n-  for index in range(len(ts_times)):\\n-    i = 0\\n-    for tstime in ts_times[index]:\\n-      tmpf.write(result_format % (float(tstime), testname, tbox, i, date, test_configs[index][3], test_configs[index][4], \\\"discrete\\\", \\\"ms\\\"))\\n-      i = i+1\\n-\\n-  testname = \\\"tp\\\"\\n-  for index in range(len(r_strings)):\\n-    r_strings[index].strip('\\\\n')\\n-    page_results = r_strings[index].splitlines()\\n-    i = 0\\n-    print \\\"formating results for: loadtime\\\"\\n-    print \\\"# of values: %d\\\" % len(page_results)\\n-    for mypage in page_results[3:]:\\n-      r = mypage.split(';')\\n-      tmpf.write(result_format % (float(r[2]), testname + \\\"_loadtime\\\", tbox, i, date, test_configs[index][3], test_configs[index][4], \\\"discrete\\\", r[1]))\\n-      i = i+1\\n-\\n-  for index in range(len(tp_counters)):\\n-    for count_type in config.COUNTERS:\\n-      i = 0\\n-      print \\\"formating results for: \\\" + count_type\\n-      print \\\"# of values: %d\\\" % len(tp_counters[index][count_type])\\n-      for value in tp_counters[index][count_type]:\\n-        tmpf.write(result_format2 % (float(value), testname + \\\"_\\\" + count_type.replace(\\\"%\\\", \\\"Percent\\\"), tbox, i, date, test_configs[index][3], test_configs[index][4], \\\"discrete\\\"))\\n-        i = i+1\\n+  utils.debug(\\\"using testdate: %d\\\" % date)\\n+  utils.debug(\\\"actual date: %d\\\" % int(time.time()))\\n \\n+  for test in tests:\\n+    print \\\"Running test: \\\" + test\\n+    res, browser_dump, counter_dump = ttest.runTest(browser_config, tests[test])\\n+    if not res:\\n+      print 'FAIL: failure to complete test: ' + test\\n+      sys.exit(0)\\n+    results[test] = [browser_dump, counter_dump]\\n+    print \\\"Completed test: \\\" + test\\n \\n-  print \\\"finished formating results\\\"\\n-  tmpf.flush()\\n-  tmpf.close()\\n-  tmpf = open(filename, \\\"r\\\")\\n-  file_data = tmpf.read()\\n-  while True:\\n-    try:\\n-      ret = post_file.post_multipart(config.RESULTS_SERVER, config.RESULTS_LINK, [(\\\"key\\\", \\\"value\\\")], [(\\\"filename\\\", filename, file_data)\\n-   ])\\n-    except IOError:\\n-      print \\\"IOError\\\"\\n-    else:\\n-      break\\n-  print \\\"completed sending results\\\"\\n-  links = process_Request(ret)\\n-  tmpf.close()\\n-  os.remove(filename)\\n-\\n-  lines = links.split('\\\\n')\\n-  for line in lines:\\n-    if line == \\\"\\\":\\n-      continue\\n-    values = line.split(\\\":\\\")\\n-    linkName = values[1]\\n-    if float(values[2]) > 0:\\n-      linkName += \\\"_T: \\\" + values[2]\\n-    else:\\n-      linkName += \\\"_1\\\"\\n-    url = url_format % (config.RESULTS_SERVER, values[0],)\\n-    link = link_format % (url, linkName,)\\n-    print \\\"RETURN: \\\" + link\\n+  #process the results\\n+  if config.TO_GRAPH_SERVER:\\n+    #send results to the graph server\\n+    send_to_graph(title, date, browser_config, results)\\n+  if config.TO_CSV:\\n+    send_to_csv(results)\\n   \\n if __name__=='__main__':\\n \\ndiff --git a/testing/performance/talos/sample.config b/testing/performance/talos/sample.config\\nindex 858b4da..068926b 100755\\n--- a/testing/performance/talos/sample.config\\n+++ b/testing/performance/talos/sample.config\\n@@ -1,48 +1,84 @@\\n # Sample Talos configuration file\\r\\n \\r\\n-# Filename will be appended to the timestamp in the report filename.\\r\\n-# Use letters and underscores only\\r\\n-filename: testfilename \\r\\n-\\r\\n # The title of the report\\r\\n-title: testtitle\\r\\n-\\r\\n-# Name of profile to test\\r\\n-Test profile 1:\\r\\n-  # Path to Firefox to test\\r\\n-  firefox: C:\\\\cygwin\\\\tmp\\\\test\\\\firefox\\\\firefox.exe\\r\\n-\\r\\n-  branch: testbranch\\r\\n-\\r\\n-  branchid: testbranchid\\r\\n-\\r\\n-  profile_path: C:\\\\talos\\\\base_profile\\r\\n-\\r\\n-  # Preferences to set in the test (use \\\"preferences : {}\\\" for no prefs)\\r\\n-  preferences : \\r\\n-    browser.shell.checkDefaultBrowser : false\\r\\n-    dom.allow_scripts_to_close_windows : true\\r\\n-    dom.disable_open_during_load: false\\r\\n-    browser.dom.window.dump.enabled: true\\r\\n-    network.proxy.type : 1\\r\\n-    network.proxy.http : localhost\\r\\n-    network.proxy.http_port : 80\\r\\n-    dom.disable_window_flip : true\\r\\n-    dom.disable_window_move_resize : true\\r\\n-    security.enable_java : false\\r\\n-    extensions.checkCompatibility : false\\r\\n-    extensions.update.notifyUser: false\\r\\n-    capability.principal.codebase.p0.granted : UniversalPreferencesWrite UniversalXPConnect UniversalPreferencesRead\\r\\n-    capability.principal.codebase.p0.id : file://\\r\\n-    capability.principal.codebase.p1.granted : UniversalXPConnect\\r\\n-\\r\\n-  # Extensions to install in test (use \\\"extensions: {}\\\" for none)\\r\\n-  # Need quotes around guid because of curly braces\\r\\n-  # extensions : \\r\\n-  #     \\\"{12345678-1234-1234-1234-abcd12345678}\\\" : c:\\\\path\\\\to\\\\unzipped\\\\xpi\\r\\n-  #     foo@sample.com : c:\\\\path\\\\to\\\\other\\\\unzipped\\\\xpi\\r\\n-  extensions : {}\\r\\n+title: firefox_testing\\r\\n+\\r\\n+# Path to Firefox to test\\r\\n+firefox: C:\\\\mozilla\\\\testing\\\\performance\\\\firefox\\\\firefox.exe\\r\\n+\\r\\n+branch: testbranch\\r\\n+\\r\\n+buildid: testbuildid\\r\\n+\\r\\n+profile_path: C:\\\\mozilla\\\\testing\\\\performance\\\\talos\\\\base_profile\\r\\n+\\r\\n+# Preferences to set in the test (use \\\"preferences : {}\\\" for no prefs)\\r\\n+preferences : \\r\\n+  browser.shell.checkDefaultBrowser : false\\r\\n+  browser.warnOnQuit : false\\r\\n+  dom.allow_scripts_to_close_windows : true\\r\\n+  dom.disable_open_during_load: false\\r\\n+  dom.max_script_run_time : 0\\r\\n+  browser.dom.window.dump.enabled: true\\r\\n+  network.proxy.type : 1\\r\\n+  network.proxy.http : localhost\\r\\n+  network.proxy.http_port : 80\\r\\n+  dom.disable_window_flip : true\\r\\n+  dom.disable_window_move_resize : true\\r\\n+  security.enable_java : false\\r\\n+  extensions.checkCompatibility : false\\r\\n+  extensions.update.notifyUser: false\\r\\n+  capability.principal.codebase.p0.granted : UniversalPreferencesWrite UniversalXPConnect UniversalPreferencesRead\\r\\n+  capability.principal.codebase.p0.id : file://\\r\\n+  capability.principal.codebase.p1.granted : UniversalXPConnect\\r\\n+\\r\\n+# Extensions to install in test (use \\\"extensions: {}\\\" for none)\\r\\n+# Need quotes around guid because of curly braces\\r\\n+# extensions : \\r\\n+#     \\\"{12345678-1234-1234-1234-abcd12345678}\\\" : c:\\\\path\\\\to\\\\unzipped\\\\xpi\\r\\n+#     foo@sample.com : c:\\\\path\\\\to\\\\other\\\\unzipped\\\\xpi\\r\\n+extensions : {}\\r\\n+\\r\\n+#any directories whose contents need to be installed in the browser before running the tests\\r\\n+# this assumes that the directories themselves already exist in the firefox path\\r\\n+dirs:\\r\\n+  chrome : page_load_test\\\\chrome\\r\\n+  components : page_load_test\\\\components\\r\\n+\\r\\n+# Environment variables to set during test (use env: {} for none)\\r\\n+env : \\r\\n+  NO_EM_RESTART : 1\\r\\n+# Tests to run\\r\\n+#  url       : (REQUIRED) url to load into the given firefox browser\\r\\n+#  url_mod   : (OPTIONAL) a bit of code to be evaled and added to the given url during each cycle of the test\\r\\n+#  resolution: (REQUIRED) how long (in seconds) to pause between counter sampling\\r\\n+#  cycles    : (REQUIRED) how many times to run the test\\r\\n+#  counters  : (REQUIRED) types of system activity to monitor during test run, can be empty \\r\\n+#            For possible values of counters argument on Windows, see\\r\\n+#            http://technet2.microsoft.com/WindowsServer/en/Library/86b5d116-6fb3-427b-af8c-9077162125fe1033.mspx?mfr=true\\r\\n+#            Possible values on Linux and Mac:\\r\\n+#            counters : ['Private Bytes', 'RSS']\\r\\n+#            Standard windows values:\\r\\n+#            counters : ['Working Set', 'Private Bytes', '% Processor Time']\\r\\n+\\r\\n+# to set up a new test it must have the correct configuration options and drop information in a standard format\\r\\n+# the format is seen in the regular expressions in ttest.py\\r\\n+# to see how the data passed from the browser is processed see send_to_graph and send_to_csv in run_tests.py\\r\\n+tests :\\r\\n+  ts :\\r\\n+    url : file:///c:/mozilla/testing/performance/talos/startup_test/startup_test.html?begin=\\r\\n+    url_mod : str(int(time.time()*1000))\\r\\n+    resolution : 1 \\r\\n+    cycles : 20\\r\\n+    counters : []\\r\\n+  tp: \\r\\n+    url :  '-tp c:\\\\\\\\\\\\mozilla\\\\\\\\\\\\testing\\\\\\\\\\\\performance\\\\\\\\\\\\talos\\\\\\\\\\\\page_load_test\\\\\\\\\\\\manifest.txt -tpchrome -tpformat tinderbox -tpcycles 5'\\r\\n+    resolution : 1\\r\\n+    cycles : 1\\r\\n+    counters : ['Working Set', 'Private Bytes', '% Processor Time']\\r\\n+  tp_js: \\r\\n+    url : '\\\"http://localhost/page_load_test/framecycler.html?quit=1&cycles=5\\\"'\\r\\n+    resolution : 1\\r\\n+    cycles : 1\\r\\n+    counters : ['Working Set', 'Private Bytes', '% Processor Time']\\r\\n   \\r\\n-  # Environment variables to set during test (use env: {} for none)\\r\\n-  env : \\r\\n-    NO_EM_RESTART : 1\\r\\ndiff --git a/testing/performance/talos/startup_test/startup_test.html b/testing/performance/talos/startup_test/startup_test.html\\nindex 59e01ec..5e647f7 100755\\n--- a/testing/performance/talos/startup_test/startup_test.html\\n+++ b/testing/performance/talos/startup_test/startup_test.html\\n@@ -46,7 +46,7 @@\\n     var startupTime = now - begin;\\n \\tdocument.write('\\\\n\\\\nStartup time = ' + startupTime + ' ms<br>');\\n     if (window.dump) {\\n-      dump('__startuptime,' + startupTime + '\\\\n\\\\n');\\n+      dump('__start_report' + startupTime + '__end_report\\\\n\\\\n');\\n     }\\n     window.close();\\n \\\">\\ndiff --git a/testing/performance/talos/tp.py b/testing/performance/talos/tp.py\\ndeleted file mode 100755\\nindex 61033c8d..0000000\\n--- a/testing/performance/talos/tp.py\\n+++ /dev/null\\n@@ -1,199 +0,0 @@\\n-# ***** BEGIN LICENSE BLOCK *****\\n-# Version: MPL 1.1/GPL 2.0/LGPL 2.1\\n-#\\n-# The contents of this file are subject to the Mozilla Public License Version\\n-# 1.1 (the \\\"License\\\"); you may not use this file except in compliance with\\n-# the License. You may obtain a copy of the License at\\n-# http://www.mozilla.org/MPL/\\n-#\\n-# Software distributed under the License is distributed on an \\\"AS IS\\\" basis,\\n-# WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License\\n-# for the specific language governing rights and limitations under the\\n-# License.\\n-#\\n-# The Original Code is standalone Firefox Windows performance test.\\n-#\\n-# The Initial Developer of the Original Code is Google Inc.\\n-# Portions created by the Initial Developer are Copyright (C) 2006\\n-# the Initial Developer. All Rights Reserved.\\n-#\\n-# Contributor(s):\\n-#   Annie Sullivan <annie.sullivan@gmail.com> (original author)\\n-#   Ben Hearsum    <bhearsum@wittydomain.com> (OS independence)\\n-#\\n-# Alternatively, the contents of this file may be used under the terms of\\n-# either the GNU General Public License Version 2 or later (the \\\"GPL\\\"), or\\n-# the GNU Lesser General Public License Version 2.1 or later (the \\\"LGPL\\\"),\\n-# in which case the provisions of the GPL or the LGPL are applicable instead\\n-# of those above. If you wish to allow use of your version of this file only\\n-# under the terms of either the GPL or the LGPL, and not to allow others to\\n-# use your version of this file under the terms of the MPL, indicate your\\n-# decision by deleting the provisions above and replace them with the notice\\n-# and other provisions required by the GPL or the LGPL. If you do not delete\\n-# the provisions above, a recipient may use your version of this file under\\n-# the terms of any one of the MPL, the GPL or the LGPL.\\n-#\\n-# ***** END LICENSE BLOCK *****\\n-\\n-\\\"\\\"\\\"A set of functions to run the Tp test.\\n-\\n-   The Tp test measures page load times in Firefox.  It does this with a\\n-   JavaScript script that opens a new window and cycles through page loads\\n-   from the local disk, timing each one.  The script dumps the sum of the\\n-   mean times to open each page, and the standard deviation, to standard out.\\n-   We can also measure performance attributes during the test.  See\\n-   http://technet2.microsoft.com/WindowsServer/en/Library/86b5d116-6fb3-427b-af8c-9077162125fe1033.mspx?mfr=true\\n-   for a description of what can be measured.\\n-\\\"\\\"\\\"\\n-\\n-__author__ = 'annie.sullivan@gmail.com (Annie Sullivan)'\\n-\\n-\\n-import platform\\n-import os\\n-import re\\n-import shutil\\n-import time\\n-import sys\\n-import subprocess\\n-import utils\\n-\\n-import ffprocess\\n-import ffprofile\\n-import ffinfo\\n-import config\\n-\\n-if platform.system() == \\\"Linux\\\":\\n-    from tp_linux import *\\n-elif platform.system() == \\\"Windows\\\":\\n-    from tp_win32 import *\\n-elif platform.system() == \\\"Darwin\\\":\\n-    from tp_mac import *\\n-\\n-\\n-# Regular expression to get stats for page load test (Tp)\\n-TP_REGEX = re.compile('__start_tp_report(.*)__end_tp_report',\\n-                      re.DOTALL | re.MULTILINE)\\n-TP_REGEX_FAIL = re.compile('__FAIL(.*)__FAIL', re.DOTALL|re.MULTILINE)\\n-\\n-\\n-def RunPltTests(profile_configs,\\n-                num_cycles,\\n-                counters,\\n-                resolution):\\n-  \\\"\\\"\\\"Runs the Page Load tests with profiles created from the given\\n-     base diectory and list of configuations.\\n-  \\n-  Args:\\n-    profile_configs:  Array of configuration options for each profile.\\n-      These are of the format:\\n-      [{prefname:prevalue,prefname2:prefvalue2},\\n-       {extensionguid:path_to_extension}],[{prefname...\\n-    num_cycles: Number of times to cycle through all the urls on each test.\\n-    counters: Array of counters (\\\"% Processor Time\\\", \\\"Working Set\\\", etc)\\n-              See http://technet2.microsoft.com/WindowsServer/en/Library/86b5d116-6fb3-427b-af8c-9077162125fe1033.mspx?mfr=true\\n-              for a list of available counters and their descriptions.\\n-    resolution: Time (in seconds) between collecting counters\\n-  \\n-  Returns:\\n-    A tuple containing:\\n-      An array of plt results for each run.  For example:\\n-        [\\\"mean: 150.30\\\\nstdd:34.2\\\", \\\"mean 170.33\\\\nstdd:22.4\\\"]\\n-      An array of counter data from each run.  For example:\\n-        [{\\\"counter1\\\": [1, 2, 3], \\\"counter2\\\":[4,5,6]},\\n-         {\\\"counter1\\\":[1,3,5], \\\"counter2\\\":[2,4,6]}]\\n-  \\\"\\\"\\\"\\n- \\n-  res = 0\\n-  counter_data = []\\n-  plt_results = []\\n-  results_string = []\\n-  for pconfig in profile_configs:\\n-    utils.debug(\\\"running pageload tests\\\")\\n-    print pconfig\\n-    sys.stdout.flush()\\n-    rstring = \\\"\\\"\\n-    utils.setEnvironmentVars(pconfig[6])\\n-    # Create the new profile\\n-    profile_dir = ffprofile.CreateTempProfileDir(pconfig[5],\\n-                                                 pconfig[0],\\n-                                                 pconfig[1])\\n-    print \\\"created profile\\\" \\n-    # Run Firefox once with new profile so initializing it doesn't cause\\n-    # a performance hit, and the second Firefox that gets created is properly\\n-    # terminated.\\n-    ffprofile.InitializeNewProfile(pconfig[2], profile_dir)\\n-    ffinfo.GetMetricsFromBrowser(pconfig[2], profile_dir)\\n-    print \\\"initialized firefox\\\"\\n-    sys.stdout.flush()\\n-    ffprocess.SyncAndSleep()\\n-\\n-    # Run the plt test for this profile\\n-    timeout = 10000\\n-    total_time = 0\\n-    output = ''\\n-    url = config.TP_URL + '?quit=1&cycles=' + str(num_cycles)\\n-    command_line = ffprocess.GenerateFirefoxCommandLine(pconfig[2], profile_dir, url)\\n-    process = subprocess.Popen(command_line, stdout=subprocess.PIPE, universal_newlines=True, shell=True, bufsize=0, env=os.environ)\\n-    handle = process.stdout\\n-    # give firefox a chance to open\\n-    time.sleep(1)\\n-\\n-    cm = CounterManager(\\\"firefox\\\", counters)\\n-\\n-    cm.startMonitor()\\n-\\n-    counts = {}\\n-    for counter in counters:\\n-      counts[counter] = []\\n-    \\n-    while total_time < timeout:\\n-    \\n-      # Sleep for [resolution] seconds\\n-      time.sleep(resolution)\\n-      total_time += resolution\\n-      \\n-      # Get the output from all the possible counters\\n-      for count_type in counters:\\n-        val = cm.getCounterValue(count_type)\\n-\\n-        if (val):\\n-          counts[count_type].append(val)\\n-\\n-      # Check to see if page load times were outputted\\n-      (bytes, current_output) = ffprocess.NonBlockingReadProcessOutput(handle)\\n-      output += current_output\\n-      match = TP_REGEX.search(output)\\n-      if match:\\n-        rstring += match.group(1)\\n-        plt_results.append(match.group(1))\\n-\\tres = 1\\n-        break\\n-      match = TP_REGEX_FAIL.search(output)\\n-      if match:\\n-        rstring += match.group(1)\\n-        plt_results.append(match.group(1))\\n-        break\\n-\\n-    cm.stopMonitor()\\n-   \\n-    print \\\"got tp results from browser\\\" \\n-\\n-    # Firefox should have exited cleanly, but close it if it doesn't\\n-    # after 2 seconds.\\n-    time.sleep(2)\\n-    ffprocess.TerminateAllProcesses(\\\"firefox\\\")\\n-    ffprocess.SyncAndSleep()\\n-    \\n-    # Delete the temp profile directory  Make it writeable first,\\n-    # because every once in a while Firefox seems to drop a read-only\\n-    # file into it.\\n-    ffprofile.MakeDirectoryContentsWritable(profile_dir)\\n-    shutil.rmtree(profile_dir)\\n-    \\n-    utils.restoreEnvironmentVars()\\n-    \\n-    counter_data.append(counts)\\n-    results_string.append(rstring)\\n-\\n-  return (res, results_string, plt_results, counter_data)\\ndiff --git a/testing/performance/talos/ts.py b/testing/performance/talos/ts.py\\ndeleted file mode 100755\\nindex 2d36e69..0000000\\n--- a/testing/performance/talos/ts.py\\n+++ /dev/null\\n@@ -1,163 +0,0 @@\\n-# ***** BEGIN LICENSE BLOCK *****\\n-# Version: MPL 1.1/GPL 2.0/LGPL 2.1\\n-#\\n-# The contents of this file are subject to the Mozilla Public License Version\\n-# 1.1 (the \\\"License\\\"); you may not use this file except in compliance with\\n-# the License. You may obtain a copy of the License at\\n-# http://www.mozilla.org/MPL/\\n-#\\n-# Software distributed under the License is distributed on an \\\"AS IS\\\" basis,\\n-# WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License\\n-# for the specific language governing rights and limitations under the\\n-# License.\\n-#\\n-# The Original Code is standalone Firefox Windows performance test.\\n-#\\n-# The Initial Developer of the Original Code is Google Inc.\\n-# Portions created by the Initial Developer are Copyright (C) 2006\\n-# the Initial Developer. All Rights Reserved.\\n-#\\n-# Contributor(s):\\n-#   Annie Sullivan <annie.sullivan@gmail.com> (original author)\\n-#   Alice Nodelman <anodelman@mozilla.com>\\n-#\\n-# Alternatively, the contents of this file may be used under the terms of\\n-# either the GNU General Public License Version 2 or later (the \\\"GPL\\\"), or\\n-# the GNU Lesser General Public License Version 2.1 or later (the \\\"LGPL\\\"),\\n-# in which case the provisions of the GPL or the LGPL are applicable instead\\n-# of those above. If you wish to allow use of your version of this file only\\n-# under the terms of either the GPL or the LGPL, and not to allow others to\\n-# use your version of this file under the terms of the MPL, indicate your\\n-# decision by deleting the provisions above and replace them with the notice\\n-# and other provisions required by the GPL or the LGPL. If you do not delete\\n-# the provisions above, a recipient may use your version of this file under\\n-# the terms of any one of the MPL, the GPL or the LGPL.\\n-#\\n-# ***** END LICENSE BLOCK *****\\n-\\n-\\\"\\\"\\\"A set of functions to run the Ts test.\\n-\\n-   The Ts test measures startup time for Firefox.  It does this by running\\n-   Firefox with a special page that takes an argument containing the current\\n-   time, and when the page loads (and Firefox is fully started), it writes\\n-   the difference between that time and the now-current time to stdout.  The\\n-   test is run a few times for different profiles, so we can tell if our\\n-   extension affects startup time.\\n-\\\"\\\"\\\"\\n-\\n-__author__ = 'annie.sullivan@gmail.com (Annie Sullivan)'\\n-\\n-\\n-import re\\n-import shutil\\n-import time\\n-\\n-import utils\\n-import ffprocess\\n-import ffprofile\\n-import ffinfo\\n-import config\\n-\\n-\\n-# Regular expression to get the time for startup test (Ts)\\n-TS_REGEX = re.compile('__startuptime,(\\\\d*)')\\n-\\n-\\n-def IsInteger(number):\\n-  \\\"\\\"\\\"Helper function to determine if a variable is an integer\\\"\\\"\\\"\\n-  try:\\n-    int(number)\\n-  except:\\n-    return False\\n-\\n-  return True\\n-\\n-\\n-def RunStartupTest(firefox_path, profile_dir, num_runs, timeout):\\n-  \\\"\\\"\\\"Runs the Firefox startup test (Ts) for the given number\\n-     of times and returns the output.  If running with a brand\\n-     new profile, make sure to call InitializeNewProfile() first.\\n-\\n-  Args:\\n-    firefox_path: The path to the firefox exe to run\\n-    profile_dir: The directory of the profile to use\\n-    num_runs: The number of times to run the startup test\\n-              (1 extra dummy run at the beginning will be thrown out)\\n-    timeout:  The time in seconds to wait before failing and terminating Firefox\\n-\\n-  Returns:\\n-    Array containing startup times in milliseconds\\n-  \\\"\\\"\\\"\\n-\\n-  startup_times = []\\n-  for i in range(-1, num_runs):\\n-    # Make sure we don't get \\\"Firefox is already running...\\\" errors\\n-    utils.debug(\\\"syncing and sleeping\\\")\\n-    ffprocess.SyncAndSleep()\\n-\\n-    # Create a command line that passes in the url of the startup test\\n-    # with the current time as the begin_time argument\\n-    time_arg = int(time.time() * 1000)\\n-    url = config.TS_URL + str(time_arg)\\n-    command_line = ffprocess.GenerateFirefoxCommandLine(firefox_path, profile_dir, url)\\n-    utils.debug(\\\"about to run ts test iteration\\\")\\n-    (match, timed_out) = ffprocess.RunProcessAndWaitForOutput(command_line,\\n-                                                              'firefox',\\n-                                                              TS_REGEX,\\n-                                                              timeout)\\n-    if match > 0:\\n-      utils.debug(\\\"ts output match is \\\" + match)\\n-    else:\\n-      utils.debug(\\\"ts failed to match\\\")\\n-    if timed_out or not IsInteger(match):\\n-      match = None\\n-    if i > -1 and match and match > 0:\\n-      startup_times.append(match)\\n-  return startup_times\\n-\\n-\\n-def RunStartupTests(profile_configs, num_runs):\\n-  \\\"\\\"\\\"Runs the startup tests with profiles created from the\\n-     given base profile directory and list of configurations.\\n-\\n-  Args:\\n-    profile_configs:  Array of configuration options for each profile.\\n-      These are of the format:\\n-      [{prefname:prevalue,prefname2:prefvalue2},{extensionguid:path_to_extension}],[{prefname...\\n-    num_runs: Number of times to run startup tests for each profile\\n-\\n-  Returns:\\n-    Array of arrays of startup times, one for each profile.\\n-  \\\"\\\"\\\"\\n-  utils.debug(\\\"Running startup time tests\\\")\\n-  all_times = []\\n-  for config in profile_configs:\\n-    utils.setEnvironmentVars(config[6])\\n-    # Create the new profile\\n-    profile_dir = ffprofile.CreateTempProfileDir(config[5],\\n-                                                 config[0],\\n-                                                 config[1])\\n-    utils.debug(\\\"temp profile dir \\\" + profile_dir + \\\" created\\\")\\n-    # Run Firefox once with new profile so initializing it doesn't\\n-    # cause a performance hit, and the second Firefox that gets\\n-    # created is properly terminated.\\n-    utils.debug(\\\"initializing new profile\\\")\\n-    ffprofile.InitializeNewProfile(config[2], profile_dir)\\n-    \\n-    utils.debug(\\\"getting configuration metrics from browser\\\")\\n-    ffinfo.GetMetricsFromBrowser(config[2], profile_dir)\\n-\\n-    # Run the startup tests for this profile and log the results.\\n-    times = RunStartupTest(config[2], profile_dir, num_runs, 10)\\n-    all_times.append(times)\\n-\\n-    # Delete the temp profile directory.  Make it writeable first,\\n-    # because every once in a while Firefox seems to drop a read-only\\n-    # file into it.\\n-    ffprocess.SyncAndSleep()\\n-    ffprofile.MakeDirectoryContentsWritable(profile_dir)\\n-    shutil.rmtree(profile_dir)\\n-    \\n-    utils.restoreEnvironmentVars()\\n-\\n-  return all_times\\ndiff --git a/testing/performance/talos/ttest.py b/testing/performance/talos/ttest.py\\nnew file mode 100644\\nindex 0000000..571070c\\n--- /dev/null\\n+++ b/testing/performance/talos/ttest.py\\n@@ -0,0 +1,195 @@\\n+# ***** BEGIN LICENSE BLOCK *****\\n+# Version: MPL 1.1/GPL 2.0/LGPL 2.1\\n+#\\n+# The contents of this file are subject to the Mozilla Public License Version\\n+# 1.1 (the \\\"License\\\"); you may not use this file except in compliance with\\n+# the License. You may obtain a copy of the License at\\n+# http://www.mozilla.org/MPL/\\n+#\\n+# Software distributed under the License is distributed on an \\\"AS IS\\\" basis,\\n+# WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License\\n+# for the specific language governing rights and limitations under the\\n+# License.\\n+#\\n+# The Original Code is standalone Firefox Windows performance test.\\n+#\\n+# The Initial Developer of the Original Code is Google Inc.\\n+# Portions created by the Initial Developer are Copyright (C) 2006\\n+# the Initial Developer. All Rights Reserved.\\n+#\\n+# Contributor(s):\\n+#   Annie Sullivan <annie.sullivan@gmail.com> (original author)\\n+#   Ben Hearsum    <bhearsum@wittydomain.com> (OS independence)\\n+#   Alice Nodelman <anodelman@mozilla.com>\\n+#\\n+# Alternatively, the contents of this file may be used under the terms of\\n+# either the GNU General Public License Version 2 or later (the \\\"GPL\\\"), or\\n+# the GNU Lesser General Public License Version 2.1 or later (the \\\"LGPL\\\"),\\n+# in which case the provisions of the GPL or the LGPL are applicable instead\\n+# of those above. If you wish to allow use of your version of this file only\\n+# under the terms of either the GPL or the LGPL, and not to allow others to\\n+# use your version of this file under the terms of the MPL, indicate your\\n+# decision by deleting the provisions above and replace them with the notice\\n+# and other provisions required by the GPL or the LGPL. If you do not delete\\n+# the provisions above, a recipient may use your version of this file under\\n+# the terms of any one of the MPL, the GPL or the LGPL.\\n+#\\n+# ***** END LICENSE BLOCK *****\\n+\\n+\\\"\\\"\\\"A generic means of running an URL based browser test\\n+   follows the following steps\\n+     - creates a profile\\n+     - tests the profile\\n+     - gets metrics for the current test environment\\n+     - loads the url\\n+     - collects info on any counters while test runs\\n+     - waits for a 'dump' from the browser\\n+\\\"\\\"\\\"\\n+\\n+__author__ = 'annie.sullivan@gmail.com (Annie Sullivan)'\\n+\\n+\\n+import platform\\n+import os\\n+import re\\n+import shutil\\n+import time\\n+import sys\\n+import subprocess\\n+import utils\\n+\\n+import ffprocess\\n+import ffsetup\\n+\\n+if platform.system() == \\\"Linux\\\":\\n+    from cmanager_linux import *\\n+elif platform.system() == \\\"Windows\\\":\\n+    from cmanager_win32 import *\\n+elif platform.system() == \\\"Darwin\\\":\\n+    from cmanager_mac import *\\n+\\n+\\n+# Regula expression for getting results from most tests\\n+RESULTS_REGEX = re.compile('__start_report(.*)__end_report',\\n+                      re.DOTALL | re.MULTILINE)\\n+# Regular expression to get stats for page load test (Tp) - should go away once data passing is standardized\\n+RESULTS_TP_REGEX = re.compile('__start_tp_report(.*)__end_tp_report',\\n+                      re.DOTALL | re.MULTILINE)\\n+RESULTS_REGEX_FAIL = re.compile('__FAIL(.*)__FAIL', re.DOTALL|re.MULTILINE)\\n+\\n+\\n+def runTest(browser_config, test_config):\\n+  \\\"\\\"\\\"\\n+  Runs an url based test on the browser as specified in the browser_config dictionary\\n+  \\n+  Args:\\n+    browser_config:  Dictionary of configuration options for the browser (paths, prefs, etc)\\n+    test_config   :  Dictionary of configuration for the given test (url, cycles, counters, etc)\\n+  \\n+  \\\"\\\"\\\"\\n+ \\n+  res = 0\\n+  counters = test_config['counters']\\n+  resolution = test_config['resolution']\\n+  all_browser_results = []\\n+  all_counter_results = []\\n+  utils.setEnvironmentVars(browser_config['env'])\\n+\\n+  # add any provided directories to the installed firefox\\n+  for dir in browser_config['dirs']:\\n+    ffsetup.InstallInBrowser(browser_config['firefox'], browser_config['dirs'][dir])\\n+  # Create the new profile\\n+  profile_dir = ffsetup.CreateTempProfileDir(browser_config['profile_path'],\\n+                                               browser_config['preferences'],\\n+                                               browser_config['extensions'])\\n+  utils.debug(\\\"created profile\\\") \\n+  # Run Firefox once with new profile so initializing it doesn't cause\\n+  # a performance hit, and the second Firefox that gets created is properly\\n+  # terminated.\\n+  res = ffsetup.InitializeNewProfile(browser_config['firefox'], profile_dir)\\n+  if not res:\\n+    print \\\"FAIL: couldn't initialize firefox\\\"\\n+    return (res, all_browser_results, all_counter_results)\\n+  res = 0\\n+\\n+  utils.debug(\\\"initialized firefox\\\")\\n+  sys.stdout.flush()\\n+  ffprocess.Sleep()\\n+\\n+  for i in range(test_config['cycles']):\\n+    # Run the test \\n+    browser_results = \\\"\\\"\\n+    timeout = 18000 # 5 hours\\n+    total_time = 0\\n+    output = ''\\n+    url = test_config['url']\\n+    if 'url_mod' in test_config:\\n+      url += eval(test_config['url_mod']) \\n+    command_line = ffprocess.GenerateFirefoxCommandLine(browser_config['firefox'], profile_dir, url)\\n+    process = subprocess.Popen(command_line, stdout=subprocess.PIPE, universal_newlines=True, shell=True, bufsize=0, env=os.environ)\\n+    handle = process.stdout\\n+\\n+    #give firefox a chance to open\\n+    # this could mean that we are losing the first couple of data points as the tests starts, but if we don't provide\\n+    # some time for the browser to start we have trouble connecting the CounterManager to it\\n+    ffprocess.Sleep()\\n+    #set up the counters for this test\\n+    cm = CounterManager(\\\"firefox\\\", counters)\\n+    cm.startMonitor()\\n+    counter_results = {}\\n+    for counter in counters:\\n+      counter_results[counter] = []\\n+    \\n+    while total_time < timeout:\\n+      # Sleep for [resolution] seconds\\n+      time.sleep(resolution)\\n+      total_time += resolution\\n+      \\n+      # Get the output from all the possible counters\\n+      for count_type in counters:\\n+        val = cm.getCounterValue(count_type)\\n+\\n+        if (val):\\n+          counter_results[count_type].append(val)\\n+\\n+      # Check to see if page load times were outputted\\n+      (bytes, current_output) = ffprocess.NonBlockingReadProcessOutput(handle)\\n+      output += current_output\\n+      match = RESULTS_REGEX.search(output)\\n+      if match:\\n+        browser_results += match.group(1)\\n+        res = 1\\n+        break\\n+      #TODO: this a stop gap until all of the tests start outputting the same format\\n+      match = RESULTS_TP_REGEX.search(output)\\n+      if match:\\n+        browser_results += match.group(1)\\n+        res = 1\\n+        break\\n+      match = RESULTS_REGEX_FAIL.search(output)\\n+      if match:\\n+        browser_results += match.group(1)\\n+        print \\\"FAIL: \\\" + match.group(1)\\n+        break\\n+\\n+    if total_time > timeout:\\n+      print \\\"FAIL: timeout from test\\\"\\n+\\n+    #stop the counter manager since this test is complete\\n+    cm.stopMonitor()\\n+\\n+    #kill any remaining firefox processes\\n+    ffprocess.TerminateAllProcesses(\\\"firefox\\\")\\n+    all_browser_results.append(browser_results)\\n+    all_counter_results.append(counter_results)\\n+    \\n+  # Delete the temp profile directory  Make it writeable first,\\n+  # because every once in a while Firefox seems to drop a read-only\\n+  # file into it.\\n+  ffprocess.Sleep()\\n+  ffsetup.MakeDirectoryContentsWritable(profile_dir)\\n+  shutil.rmtree(profile_dir)\\n+    \\n+  utils.restoreEnvironmentVars()\\n+    \\n+  return (res, all_browser_results, all_counter_results)\\n\""}