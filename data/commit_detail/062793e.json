{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Bas062793e\""},"diff":"\"062793e Part of the backout of bug 261074 that was missed in the previous backout at 2007-06-17.\\ndiff --git a/widget/src/windows/nsWindow.cpp b/widget/src/windows/nsWindow.cpp\\nindex e8f8f15..6100e06 100644\\n--- a/widget/src/windows/nsWindow.cpp\\n+++ b/widget/src/windows/nsWindow.cpp\\n@@ -4661,16 +4661,12 @@ PRBool nsWindow::ProcessMessage(UINT msg, WPARAM wParam, LPARAM lParam, LRESULT\\n #endif\\n \\n     case WM_SETFOCUS:\\n-      {\\n-        nsWindow* topWindow = GetNSWindowPtr(::GetAncestor(mWnd, GA_ROOT));\\n-\\n-        result = DispatchFocus(NS_GOTFOCUS, PR_TRUE);\\n-        \\n-        if ((HWND)wParam == NULL || \\n-            (topWindow && topWindow->mWnd != ::GetAncestor((HWND)wParam, GA_ROOT))) {\\n-          result = DispatchFocus(NS_ACTIVATE, PR_TRUE);\\n-        }\\n-      }  \\n+      result = DispatchFocus(NS_GOTFOCUS, PR_TRUE);\\r\\n+      if (gJustGotActivate) {\\r\\n+        gJustGotActivate = PR_FALSE;\\r\\n+        gJustGotDeactivate = PR_FALSE;\\r\\n+        result = DispatchFocus(NS_ACTIVATE, PR_TRUE);\\r\\n+      }\\n \\n #ifdef ACCESSIBILITY\\n       if (nsWindow::gIsAccessibilityOn) {\\n\""}