{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Bas544a101\""},"diff":"\"544a101 Bug 378594  Closing takes very long after deleting a livemark (places) (r=sspitzer)\\ndiff --git a/toolkit/components/places/src/nsNavBookmarks.cpp b/toolkit/components/places/src/nsNavBookmarks.cpp\\nindex 7d4312c..f804b93 100644\\n--- a/toolkit/components/places/src/nsNavBookmarks.cpp\\n+++ b/toolkit/components/places/src/nsNavBookmarks.cpp\\n@@ -1269,6 +1269,9 @@ nsNavBookmarks::GetParentAndIndexOfFolder(PRInt64 aFolder, PRInt64* aParent,\\n NS_IMETHODIMP\\n nsNavBookmarks::RemoveFolder(PRInt64 aFolder)\\n {\\n+  mozIStorageConnection *dbConn = DBConn();\\n+  mozStorageTransaction transaction(dbConn, PR_FALSE);\\n+\\n   // First, remove item annotations\\n   nsAnnotationService* annosvc = nsAnnotationService::GetAnnotationService();\\n   NS_ENSURE_TRUE(annosvc, NS_ERROR_OUT_OF_MEMORY);\\n@@ -1310,9 +1313,6 @@ nsNavBookmarks::RemoveFolder(PRInt64 aFolder)\\n   // Remove all of the folder's children\\n   RemoveFolderChildren(aFolder);\\n \\n-  mozIStorageConnection *dbConn = DBConn();\\n-  mozStorageTransaction transaction(dbConn, PR_FALSE);\\n-\\n   // Remove the folder from its parent\\n   nsCAutoString buffer;\\n   buffer.AssignLiteral(\\\"DELETE FROM moz_bookmarks WHERE id = \\\");\\n\""}