{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Bas209de66\""},"diff":"\"209de66 Bug 387748  add a tag column in the organizer center pane, for tagged items (for christineyen+bugs@gmail.com, r=mano)\\ndiff --git a/browser/components/places/content/places.xul b/browser/components/places/content/places.xul\\nindex 3c87f70..4f81e50 100755\\n--- a/browser/components/places/content/places.xul\\n+++ b/browser/components/places/content/places.xul\\n@@ -381,6 +381,9 @@\\n               <treecol label=\\\"&col.title.label;\\\" id=\\\"title\\\" flex=\\\"5\\\" primary=\\\"true\\\" \\n                        persist=\\\"width hidden ordinal sortActive sortDirection\\\"/>\\n               <splitter class=\\\"tree-splitter\\\"/>\\n+              <treecol label=\\\"&col.tags.label;\\\" id=\\\"tags\\\" flex=\\\"2\\\"\\n+                       persist=\\\"width hidden ordinal sortActive sortDirection\\\"/>\\n+              <splitter class=\\\"tree-splitter\\\"/>\\n               <treecol label=\\\"&col.url.label;\\\" id=\\\"url\\\" flex=\\\"5\\\" \\n                        persist=\\\"width hidden ordinal sortActive sortDirection\\\"/>\\n               <splitter class=\\\"tree-splitter\\\"/>\\ndiff --git a/browser/components/places/content/treeView.js b/browser/components/places/content/treeView.js\\nindex 553122e..e845467 100644\\n--- a/browser/components/places/content/treeView.js\\n+++ b/browser/components/places/content/treeView.js\\n@@ -425,6 +425,7 @@ PlacesTreeView.prototype = {\\n   COLUMN_TYPE_DESCRIPTION: 6,\\n   COLUMN_TYPE_DATEADDED: 7,\\n   COLUMN_TYPE_LASTMODIFIED: 8,\\n+  COLUMN_TYPE_TAGS: 9,\\n \\n   _getColumnType: function PTV__getColumnType(aColumn) {\\n     var columnType = aColumn.id || aColumn.element.getAttribute(\\\"anonid\\\");\\n@@ -445,6 +446,8 @@ PlacesTreeView.prototype = {\\n         return this.COLUMN_TYPE_DATEADDED;\\n       case \\\"lastModified\\\":\\n         return this.COLUMN_TYPE_LASTMODIFIED;\\n+      case \\\"tags\\\":\\n+        return this.COLUMN_TYPE_TAGS;\\n     }\\n     return this.COLUMN_TYPE_UNKNOWN;\\n   },\\n@@ -1020,6 +1023,14 @@ PlacesTreeView.prototype = {\\n         if (PlacesUtils.nodeIsSeparator(node))\\n           return \\\"\\\";\\n         return node.title || PlacesUtils.getString(\\\"noTitle\\\");\\n+      case this.COLUMN_TYPE_TAGS:\\n+        if (PlacesUtils.nodeIsURI(node)) {\\n+          var tagsvc = PlacesUtils.tagging;\\n+          var uri = PlacesUtils._uri(node.uri);\\n+          var tags = tagsvc.getTagsForURI(uri, {});\\n+          return tags.join(\\\", \\\");\\n+        }\\n+        return \\\"\\\";\\n       case this.COLUMN_TYPE_URI:\\n         if (PlacesUtils.nodeIsURI(node))\\n           return node.uri;\\n@@ -1105,6 +1116,10 @@ PlacesTreeView.prototype = {\\n     if (!this._result)\\n       throw Cr.NS_ERROR_UNEXPECTED;\\n \\n+    // Currently cannot sort by tags\\n+    if (aColumn.id == \\\"tags\\\")\\n+      return;\\n+\\n     this._enumerateObservers(\\\"onCycleHeader\\\", [aColumn]);\\n \\n     // Sometimes you want a tri-state sorting, and sometimes you don't. This\\ndiff --git a/browser/locales/en-US/chrome/browser/places/places.dtd b/browser/locales/en-US/chrome/browser/places/places.dtd\\nindex 4a664bb..2ac9509 100644\\n--- a/browser/locales/en-US/chrome/browser/places/places.dtd\\n+++ b/browser/locales/en-US/chrome/browser/places/places.dtd\\n@@ -197,6 +197,8 @@\\n \\n <!ENTITY col.title.label\\n   \\\"Name\\\">\\n+<!ENTITY col.tags.label\\n+  \\\"Tags\\\">\\n <!ENTITY col.url.label\\n   \\\"Location\\\">\\n <!ENTITY col.lastvisit.label\\n\""}