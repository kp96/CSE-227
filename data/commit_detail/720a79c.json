{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Bas720a79c\""},"diff":"\"720a79c Bug 395923. The whole page's contents are repeated inside an anchor with no href. r=evan.yan, a=dsicore\\ndiff --git a/accessible/src/base/nsBaseWidgetAccessible.cpp b/accessible/src/base/nsBaseWidgetAccessible.cpp\\nindex 80803c5..a2fc23b 100644\\n--- a/accessible/src/base/nsBaseWidgetAccessible.cpp\\n+++ b/accessible/src/base/nsBaseWidgetAccessible.cpp\\n@@ -226,6 +226,11 @@ void nsLinkableAccessible::CacheActionContent()\\n   for (nsCOMPtr<nsIContent> walkUpContent(do_QueryInterface(mDOMNode));\\n        walkUpContent;\\n        walkUpContent = walkUpContent->GetParent()) {\\n+    if (nsAccUtils::HasListener(walkUpContent, NS_LITERAL_STRING(\\\"click\\\"))) {\\n+      mActionContent = walkUpContent;\\n+      mIsOnclick = PR_TRUE;\\n+      break;\\n+    }\\n     nsIAtom *tag = walkUpContent->Tag();\\n     if ((tag == nsAccessibilityAtoms::a || tag == nsAccessibilityAtoms::area) &&\\n         walkUpContent->IsNodeOfType(nsINode::eHTML)) {\\n@@ -242,11 +247,13 @@ void nsLinkableAccessible::CacheActionContent()\\n           break;\\n         }\\n       }\\n-    }\\n-    if (nsAccUtils::HasListener(walkUpContent, NS_LITERAL_STRING(\\\"click\\\"))) {\\n-      mActionContent = walkUpContent;\\n-      mIsOnclick = PR_TRUE;\\n-      break;\\n+      if (SameCOMIdentity(mDOMNode, walkUpContent)) {\\n+        // This is the element that caused the creation of a linkable accessible\\n+        // Don't let it keep walking up, otherwise we may report the wrong container\\n+        // as the action node\\n+        mActionContent = walkUpContent;\\n+        break;\\n+      }\\n     }\\n   }\\n }\\n\""}