{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Bas716ed86\""},"diff":"\"716ed86 Bug 391643 - \\\"Remove GetAlphaBytesPerRow from imgContainer.cpp\\\" [p=alfredkayser@nl.ibm.com (Alfred Kayser) r=stuart sr=tor a1.9=stuart]\\ndiff --git a/modules/libpr0n/src/imgContainer.cpp b/modules/libpr0n/src/imgContainer.cpp\\nindex 5a90d3a..00baaf4 100644\\n--- a/modules/libpr0n/src/imgContainer.cpp\\n+++ b/modules/libpr0n/src/imgContainer.cpp\\n@@ -578,9 +578,10 @@ nsresult imgContainer::DoComposite(gfxIImageFrame** aFrameToUse,\\n                             nextFrameRect.width == mSize.width &&\\n                             nextFrameRect.height == mSize.height);\\n \\n-  PRBool nextFrameHasAlpha;\\n-  PRUint32 aBPR;\\n-  nextFrameHasAlpha = NS_SUCCEEDED(aNextFrame->GetAlphaBytesPerRow(&aBPR));\\n+  gfx_format nextFormat;\\n+  aNextFrame->GetFormat(&nextFormat);\\n+  PRBool nextFrameHasAlpha = (nextFormat != gfxIFormats::RGB) &&\\n+                             (nextFormat != gfxIFormats::BGR);\\n \\n   // Optimization: Skip compositing if this frame is the same size as the\\n   //               container and it's fully drawing over prev frame (no alpha)\\n\""}