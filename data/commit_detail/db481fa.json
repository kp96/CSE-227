{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Basdb481fa\""},"diff":"\"db481fa only malware check nsHttpChannel for now, should fix orange.  b=384941, r+sr=biesi\\ndiff --git a/docshell/base/nsDocShell.cpp b/docshell/base/nsDocShell.cpp\\nindex 74faa69..0a166bf 100644\\n--- a/docshell/base/nsDocShell.cpp\\n+++ b/docshell/base/nsDocShell.cpp\\n@@ -9102,25 +9102,12 @@ nsClassifierCallback::Run()\\n     nsresult rv = channel->GetURI(getter_AddRefs(uri));\\n     NS_ENSURE_SUCCESS(rv, rv);\\n \\n-    // Don't bother checking certain types of URIs.\\n-    PRBool hasFlags;\\n-    rv = NS_URIChainHasFlags(uri,\\n-                             nsIProtocolHandler::URI_DANGEROUS_TO_LOAD,\\n-                             &hasFlags);\\n-    NS_ENSURE_SUCCESS(rv, rv);\\n-    if (hasFlags) return NS_OK;\\n-\\n-    rv = NS_URIChainHasFlags(uri,\\n-                             nsIProtocolHandler::URI_IS_LOCAL_FILE,\\n-                             &hasFlags);\\n-    NS_ENSURE_SUCCESS(rv, rv);\\n-    if (hasFlags) return NS_OK;\\n-\\n-    rv = NS_URIChainHasFlags(uri,\\n-                             nsIProtocolHandler::URI_IS_UI_RESOURCE,\\n-                             &hasFlags);\\n-    NS_ENSURE_SUCCESS(rv, rv);\\n-    if (hasFlags) return NS_OK;\\n+    // XXX: we need to audit other channels to make sure they can handle\\n+    // being suspended directly after AsyncOpen()\\n+    nsCOMPtr<nsIHttpChannel> httpChannel = do_QueryInterface(channel);\\n+    if (!httpChannel) {\\n+        return NS_OK;\\n+    }\\n \\n     nsCOMPtr<nsIURIClassifier> uriClassifier =\\n         do_GetService(NS_URICLASSIFIERSERVICE_CONTRACTID, &rv);\\n\""}