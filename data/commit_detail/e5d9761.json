{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Base5d9761\""},"diff":"\"e5d9761 Make sure to not think we're in the middle of firing unload just because we created an about:blank content viewer.  Bug 388579, r=biesi, sr=jst\\ndiff --git a/docshell/base/nsDocShell.cpp b/docshell/base/nsDocShell.cpp\\nindex 626fc8c..a8d1ceb 100644\\n--- a/docshell/base/nsDocShell.cpp\\n+++ b/docshell/base/nsDocShell.cpp\\n@@ -5037,6 +5037,12 @@ nsDocShell::CreateAboutBlankContentViewer(nsIPrincipal* aPrincipal)\\n     (void) FirePageHideNotification(!mSavingOldViewer);\\n   }\\n \\n+  // Now make sure we don't think we're in the middle of firing unload after\\n+  // this point.  This will make us fire unload when the about:blank document\\n+  // unloads... but that's ok, more or less.  Would be nice if it fired load\\n+  // too, of course.\\n+  mFiredUnloadEvent = PR_FALSE;\\n+\\n   // one helper factory, please\\n   nsCOMPtr<nsICategoryManager> catMan(do_GetService(NS_CATEGORYMANAGER_CONTRACTID));\\n   if (!catMan)\\n\""}