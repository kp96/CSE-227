{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Bas0377ccf\""},"diff":"\"0377ccf Bug 347363 - Implement smooth scroll for the tab bar. Patch by Michael Ventnor <ventnor.bugzilla@yahoo.com.au> and Dao Gottwald <dao@design-noir.de>, r=enndeakin ui-r=beltzner\\ndiff --git a/browser/base/content/tabbrowser.xml b/browser/base/content/tabbrowser.xml\\nindex f99e126..706bf35 100644\\n--- a/browser/base/content/tabbrowser.xml\\n+++ b/browser/base/content/tabbrowser.xml\\n@@ -2581,7 +2581,8 @@\\n   <binding id=\\\"tabbrowser-tabs\\\"\\n            extends=\\\"chrome://global/content/bindings/tabbox.xml#tabs\\\">\\n     <content>\\n-      <xul:arrowscrollbox anonid=\\\"arrowscrollbox\\\" orient=\\\"horizontal\\\" flex=\\\"1\\\" style=\\\"min-width: 1px;\\\" class=\\\"tabbrowser-arrowscrollbox\\\">\\n+      <xul:arrowscrollbox anonid=\\\"arrowscrollbox\\\" class=\\\"tabbrowser-arrowscrollbox\\\" flex=\\\"1\\\"\\n+                          xbl:inherits=\\\"smoothscroll\\\" orient=\\\"horizontal\\\" style=\\\"min-width: 1px;\\\">\\n         <children includes=\\\"tab\\\"/>\\n       </xul:arrowscrollbox>\\n       <xul:stack align=\\\"center\\\" pack=\\\"end\\\" class=\\\"tabs-alltabs-stack\\\">\\n@@ -2631,18 +2632,7 @@\\n           pb2.addObserver(\\\"browser.tabs.closeButtons\\\", \\n                           this._prefObserver, false);\\n \\n-          var self = this;\\n-          function onResize() {\\n-            var width = self.mTabstrip.boxObject.width;\\n-            if (width != self.mTabstripWidth) {\\n-              self.adjustTabstrip();\\n-              self.mTabstrip.scrollByIndex(1);\\n-              self.mTabstrip.scrollBoxObject\\n-                            .ensureElementIsVisible(self.selectedItem);\\n-              self.mTabstripWidth = width;\\n-            }\\n-          }\\n-          window.addEventListener(\\\"resize\\\", onResize, false);\\n+          window.addEventListener(\\\"resize\\\", this, false);\\n \\n           // Listen to overflow/underflow events on the tabstrip,\\n           // we cannot put these as xbl handlers on the entire binding because\\n@@ -2757,8 +2747,7 @@\\n         \\n       <method name=\\\"_handleTabSelect\\\">\\n         <body><![CDATA[\\n-          this.mTabstrip.scrollBoxObject\\n-                        .ensureElementIsVisible(this.selectedItem);\\n+          this.mTabstrip.ensureElementIsVisible(this.selectedItem);\\n         ]]></body>\\n       </method>\\n \\n@@ -2774,6 +2763,16 @@\\n             case \\\"underflow\\\":\\n               this.removeAttribute(\\\"overflow\\\");\\n               break;\\n+            case \\\"resize\\\":\\n+              var width = this.mTabstrip.boxObject.width;\\n+              if (width != this.mTabstripWidth) {\\n+                this.adjustTabstrip();\\n+                // XXX without this line the tab bar won't budge\\n+                this.mTabstrip.scrollByPixels(1);\\n+                this._handleTabSelect();\\n+                this.mTabstripWidth = width;\\n+              }\\n+              break;\\n           }\\n         ]]></body>\\n       </method>\\n\""}