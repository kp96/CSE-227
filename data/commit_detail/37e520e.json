{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Bas37e520e\""},"diff":"\"37e520e Bug 373696 - style toolbar separators natively p=Simon Bunzli (busy) <zeniko@gmail.com> r=emaijala, sr=neil, a=dsicore\\ndiff --git a/toolkit/themes/winstripe/global/toolbar.css b/toolkit/themes/winstripe/global/toolbar.css\\nindex 2480238..463762f 100644\\n--- a/toolkit/themes/winstripe/global/toolbar.css\\n+++ b/toolkit/themes/winstripe/global/toolbar.css\\n@@ -86,10 +86,13 @@ toolbar[mode=\\\"text\\\"] .toolbarbutton-text {\\n /* ::::: toolbar decorations ::::: */\\n \\n toolbarseparator {\\n-  margin : 2px 0.2em;\\n-  border-right : 1px solid ThreeDHighlight;\\n-  border-left : 1px solid ThreeDShadow;\\n-  width : 2px;\\n+  -moz-appearance: separator;\\n+  border-top: 2px solid transparent;\\n+  border-bottom: 2px solid transparent;\\n+  border-left: 3px solid transparent;\\n+  border-right: 3px solid transparent;\\n+  -moz-border-left-colors  : transparent transparent ThreeDShadow;\\n+  -moz-border-right-colors : transparent transparent ThreeDHighlight;\\n }\\n \\n toolbarspacer {\\ndiff --git a/widget/src/windows/nsNativeThemeWin.cpp b/widget/src/windows/nsNativeThemeWin.cpp\\nindex b6cd0ee..04561ea 100644\\n--- a/widget/src/windows/nsNativeThemeWin.cpp\\n+++ b/widget/src/windows/nsNativeThemeWin.cpp\\n@@ -85,6 +85,9 @@\\n #define TKP_FOCUSED   4\\n #define TKP_DISABLED  5\\n \\n+// Toolbar constants\\n+#define TP_SEPARATOR 5\\n+\\n // Toolbarbutton constants\\n #define TB_CHECKED       5\\n #define TB_HOVER_CHECKED 6\\n@@ -461,7 +464,8 @@ nsNativeThemeWin::GetTheme(PRUint8 aWidgetType)\\n       return mRebarTheme;\\n     }\\n     case NS_THEME_TOOLBAR:\\n-    case NS_THEME_TOOLBAR_BUTTON: {\\n+    case NS_THEME_TOOLBAR_BUTTON:\\n+    case NS_THEME_TOOLBAR_SEPARATOR: {\\n       if (!mToolbarTheme)\\n         mToolbarTheme = openTheme(NULL, L\\\"Toolbar\\\");\\n       return mToolbarTheme;\\n@@ -734,6 +738,11 @@ nsNativeThemeWin::GetThemePartAndState(nsIFrame* aFrame, PRUint8 aWidgetType,\\n      \\n       return NS_OK;\\n     }\\n+    case NS_THEME_TOOLBAR_SEPARATOR: {\\n+      aPart = TP_SEPARATOR;\\n+      aState = TS_NORMAL;\\n+      return NS_OK;\\n+    }\\n     case NS_THEME_SCROLLBAR_BUTTON_UP:\\n     case NS_THEME_SCROLLBAR_BUTTON_DOWN:\\n     case NS_THEME_SCROLLBAR_BUTTON_LEFT:\\n@@ -1312,7 +1321,8 @@ nsNativeThemeWin::GetWidgetBorder(nsIDeviceContext* aContext,\\n       aWidgetType == NS_THEME_SCROLLBAR_TRACK_VERTICAL ||\\n       aWidgetType == NS_THEME_MENUITEM || aWidgetType == NS_THEME_CHECKMENUITEM ||\\n       aWidgetType == NS_THEME_RADIOMENUITEM || aWidgetType == NS_THEME_MENUPOPUP ||\\n-      aWidgetType == NS_THEME_MENUIMAGE || aWidgetType == NS_THEME_MENUITEMTEXT)\\n+      aWidgetType == NS_THEME_MENUIMAGE || aWidgetType == NS_THEME_MENUITEMTEXT ||\\n+      aWidgetType == NS_THEME_TOOLBAR_SEPARATOR)\\n     return NS_OK; // Don't worry about it.\\n \\n   if (!getThemeContentRect)\\n@@ -1513,6 +1523,12 @@ nsNativeThemeWin::GetMinimumWidgetSize(nsIRenderingContext* aContext, nsIFrame*\\n       aWidgetType == NS_THEME_SCALE_THUMB_VERTICAL) {\\n       *aIsOverridable = PR_FALSE;\\n   }\\n+  else if (aWidgetType == NS_THEME_TOOLBAR_SEPARATOR) {\\n+    // that's 2px left margin, 2px right margin and 2px separator\\n+    // (the margin is drawn as part of the separator, though)\\n+    aResult->width = 6;\\n+    return NS_OK;\\n+  }\\n \\n   PRInt32 part, state;\\n   nsresult rv = GetThemePartAndState(aFrame, aWidgetType, part, state);\\n@@ -1563,7 +1579,8 @@ nsNativeThemeWin::WidgetStateChanged(nsIFrame* aFrame, PRUint8 aWidgetType,\\n       aWidgetType == NS_THEME_PROGRESSBAR_VERTICAL ||\\n       aWidgetType == NS_THEME_TOOLTIP ||\\n       aWidgetType == NS_THEME_TAB_PANELS ||\\n-      aWidgetType == NS_THEME_TAB_PANEL) {\\n+      aWidgetType == NS_THEME_TAB_PANEL ||\\n+      aWidgetType == NS_THEME_TOOLBAR_SEPARATOR) {\\n     *aShouldRepaint = PR_FALSE;\\n     return NS_OK;\\n   }\\n\""}