{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Bas2558a95\""},"diff":"\"2558a95 Bug 305828: Changes to tabbrowser.xml for sessionsaver extension, patch by Christian Schmidt <bugzilla.mozilla.org@chsc.dk>, r=vlad\\ndiff --git a/browser/base/content/tabbrowser.xml b/browser/base/content/tabbrowser.xml\\nindex 8bf16b2..e44c3be 100644\\n--- a/browser/base/content/tabbrowser.xml\\n+++ b/browser/base/content/tabbrowser.xml\\n@@ -155,7 +155,7 @@\\n         null\\n       </field>\\n       <field name=\\\"mProgressListeners\\\">\\n-        null\\n+        new Array()\\n       </field>\\n       <field name=\\\"mTabListeners\\\">\\n         new Array()\\n@@ -940,12 +940,10 @@\\n             }\\n \\n             // Remove all our progress listeners from the active browser's filter.\\n-            if (this.mProgressListeners) {\\n-              for (var i = 0; i < this.mProgressListeners.length; i++) {\\n-                var p = this.mProgressListeners[i];\\n-                if (p)\\n-                  filter.removeProgressListener(p);\\n-              }\\n+            for (var i = 0; i < this.mProgressListeners.length; i++) {\\n+              var p = this.mProgressListeners[i];\\n+              if (p)\\n+                filter.removeProgressListener(p);\\n             }\\n \\n             // Wire up a progress listener to our filter.\\n@@ -1314,18 +1312,6 @@\\n         <parameter name=\\\"aMask\\\"/>\\n         <body>\\n           <![CDATA[\\n-            if (!this.mProgressListeners) {\\n-              this.mProgressListeners = [];\\n-              var autoHide = this.mPrefs.getBoolPref(\\\"browser.tabs.autoHide\\\");\\n-              var forceHide = this.mPrefs.getBoolPref(\\\"browser.tabs.forceHide\\\");\\n-              var tabStripHide = !window.toolbar.visible;\\n-              if (!autoHide && !forceHide && !tabStripHide)\\n-                this.setStripVisibilityTo(true);\\n-\\n-              // Hook up a listener for <link>s.\\n-              this.mPanelContainer.addEventListener(\\\"DOMLinkAdded\\\", this.onLinkAdded, false);\\n-            }\\n-\\n             if (!this.mTabbedMode && this.mProgressListeners.length == 1) {\\n               // If we are adding a 2nd progress listener, we need to enter tabbed mode\\n               // because the browser status filter can only handle one progress listener.\\n@@ -1358,7 +1344,6 @@\\n         <parameter name=\\\"aListener\\\"/>\\n         <body>\\n           <![CDATA[\\n-            if (!this.mProgressListeners) return;\\n             for (var i = 0; i < this.mProgressListeners.length; i++) {\\n               if (this.mProgressListeners[i] == aListener) {\\n                 this.mProgressListeners.splice(i, 1);\\n@@ -2010,6 +1995,14 @@\\n           this.mTabContainer.childNodes[0].linkedPanel = uniqueId;\\n           this.mTabContainer.childNodes[0]._tPos = 0;\\n           this.mTabContainer.childNodes[0].linkedBrowser = this.mPanelContainer.childNodes[0].firstChild.nextSibling;\\n+\\n+          var autoHide = this.mPrefs.getBoolPref(\\\"browser.tabs.autoHide\\\");\\n+          var forceHide = this.mPrefs.getBoolPref(\\\"browser.tabs.forceHide\\\");\\n+          if (!autoHide && !forceHide)\\n+            this.setStripVisibilityTo(true);\\n+\\n+          // Hook up a listener for <link>s.\\n+          this.mPanelContainer.addEventListener(\\\"DOMLinkAdded\\\", this.onLinkAdded, false);\\n         ]]>\\n       </constructor>\\n \\n\""}