{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Bas1359bb6\""},"diff":"\"1359bb6 Bug 297903: Extension updates should link to further information. r=robstrong\\ndiff --git a/toolkit/locales/en-US/chrome/mozapps/extensions/extensions.dtd b/toolkit/locales/en-US/chrome/mozapps/extensions/extensions.dtd\\nindex 5ecf47c..6c89d59 100644\\n--- a/toolkit/locales/en-US/chrome/mozapps/extensions/extensions.dtd\\n+++ b/toolkit/locales/en-US/chrome/mozapps/extensions/extensions.dtd\\n@@ -76,6 +76,12 @@\\n <!ENTITY cmd.installUpdate.label          \\\"Install Update\\\">\\n <!ENTITY cmd.installUpdate.accesskey      \\\"I\\\">\\n <!ENTITY cmd.installUpdate.tooltip        \\\"Install an update for this Add-on\\\">\\n+<!ENTITY cmd.showUpdateInfo.label         \\\"Show Information\\\">\\n+<!ENTITY cmd.showUpdateInfo.accesskey     \\\"S\\\">\\n+<!ENTITY cmd.showUpdateInfo.tooltip       \\\"Show more information about these updates\\\">\\n+<!ENTITY cmd.hideUpdateInfo.label         \\\"Hide Information\\\">\\n+<!ENTITY cmd.hideUpdateInfo.accesskey     \\\"H\\\">\\n+<!ENTITY cmd.hideUpdateInfo.tooltip       \\\"Hide information about these updates\\\">\\n <!-- The selected add-on's cancel action button label -->\\n <!ENTITY cancel.label                     \\\"Cancel\\\">\\n <!ENTITY cancel.accesskey                 \\\"C\\\">\\n@@ -114,6 +120,9 @@\\n <!ENTITY previewNoThemeSelected.label     \\\"No Theme Selected\\\">\\n <!ENTITY previewNoPreviewImage.label      \\\"This Theme does not have a Preview Image\\\">\\n <!ENTITY moreInfo.label                   \\\"More Information\\\">\\n+<!ENTITY infoNoAddonSelected.label        \\\"No Update Selected\\\">\\n+<!ENTITY infoNoUpdateInfo.label           \\\"This update does not have any additional information\\\">\\n+<!ENTITY infoUpdateInfoError.label        \\\"There was an error loading the information about this update\\\">\\n \\n <!ENTITY updateSuccess.label              \\\"Update completed successfully.\\\">\\n <!ENTITY installSuccess.label             \\\"Install completed successfully.\\\">\\ndiff --git a/toolkit/mozapps/extensions/content/extensions.js b/toolkit/mozapps/extensions/content/extensions.js\\nindex b915fe9..829d53c 100644\\n--- a/toolkit/mozapps/extensions/content/extensions.js\\n+++ b/toolkit/mozapps/extensions/content/extensions.js\\n@@ -22,7 +22,8 @@\\n #   Ben Goodger <ben@mozilla.org>\\n #   Robert Strong <robert.bugzilla@gmail.com>\\n #   DÃ£o Gottwald <dao@design-noir.de>\\n-#\\n+#   Dave Townsend <dtownsend@oxymoronical.com>\\n+# \\n # Alternatively, the contents of this file may be used under the terms of\\n # either the GNU General Public License Version 2 or later (the \\\"GPL\\\"), or\\n # the GNU Lesser General Public License Version 2.1 or later (the \\\"LGPL\\\"),\\n@@ -78,10 +79,11 @@ const PREF_EM_LAST_SELECTED_SKIN            = \\\"extensions.lastSelectedSkin\\\";\\n const PREF_GENERAL_SKINS_SELECTEDSKIN       = \\\"general.skins.selectedSkin\\\";\\n const PREF_UPDATE_NOTIFYUSER                = \\\"extensions.update.notifyUser\\\";\\n \\n-const RDFURI_ITEM_ROOT  = \\\"urn:mozilla:item:root\\\";\\n-const PREFIX_ITEM_URI   = \\\"urn:mozilla:item:\\\";\\n-const PREFIX_NS_EM      = \\\"http://www.mozilla.org/2004/em-rdf#\\\";\\n-const kXULNSURI         = \\\"http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul\\\";\\n+const RDFURI_ITEM_ROOT    = \\\"urn:mozilla:item:root\\\";\\n+const PREFIX_ITEM_URI     = \\\"urn:mozilla:item:\\\";\\n+const PREFIX_NS_EM        = \\\"http://www.mozilla.org/2004/em-rdf#\\\";\\n+const kXULNSURI           = \\\"http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul\\\";\\n+const XMLURI_PARSE_ERROR  = \\\"http://www.mozilla.org/newlayout/xml/parsererror.xml\\\"\\n \\n const OP_NONE                         = \\\"\\\";\\n const OP_NEEDS_INSTALL                = \\\"needs-install\\\";\\n@@ -315,6 +317,7 @@ function showView(aView) {\\n       bindingList = [ [\\\"aboutURL\\\", \\\"?aboutURL\\\"],\\n                       [\\\"availableUpdateURL\\\", \\\"?availableUpdateURL\\\"],\\n                       [\\\"availableUpdateVersion\\\", \\\"?availableUpdateVersion\\\"],\\n+                      [\\\"availableUpdateInfo\\\", \\\"?availableUpdateInfo\\\"],\\n                       [\\\"blocklisted\\\", \\\"?blocklisted\\\"],\\n                       [\\\"homepageURL\\\", \\\"?homepageURL\\\"],\\n                       [\\\"iconURL\\\", \\\"?iconURL\\\"],\\n@@ -406,6 +409,8 @@ function showView(aView) {\\n   document.getElementById(\\\"continueDialogButton\\\").hidden = !showContinue;\\n   document.getElementById(\\\"themePreviewArea\\\").hidden = !isThemes;\\n   document.getElementById(\\\"themeSplitter\\\").hidden = !isThemes;\\n+  document.getElementById(\\\"showUpdateInfoButton\\\").hidden = aView != \\\"updates\\\";\\n+  document.getElementById(\\\"hideUpdateInfoButton\\\").hidden = true;\\n \\n   AddonsViewBuilder.updateView(types, \\\"richlistitem\\\", bindingList, null);\\n \\n@@ -1111,24 +1116,146 @@ function onAddonSelect(aEvent)\\n \\n   if (!document.getElementById(\\\"themePreviewArea\\\").hidden) {\\n     var previewImageDeck = document.getElementById(\\\"previewImageDeck\\\");\\n-    var previewImage = document.getElementById(\\\"previewImage\\\");\\n-    if (!gExtensionsView.selectedItem) {\\n-      previewImageDeck.setAttribute(\\\"selectedIndex\\\", \\\"0\\\");\\n-      if (previewImage.hasAttribute(\\\"src\\\"))\\n-        previewImage.removeAttribute(\\\"src\\\");\\n-    }\\n-    else {\\n-      var url = gExtensionsView.selectedItem.getAttribute(\\\"previewImage\\\");\\n-      if (url) {\\n-        previewImageDeck.setAttribute(\\\"selectedIndex\\\", \\\"2\\\");\\n-        previewImage.setAttribute(\\\"src\\\", url);\\n-      }\\n-      else {\\n-        previewImageDeck.setAttribute(\\\"selectedIndex\\\", \\\"1\\\");\\n+    if (gView == \\\"themes\\\") {\\n+      var previewImage = document.getElementById(\\\"previewImage\\\");\\n+      if (!gExtensionsView.selectedItem) {\\n+        previewImageDeck.selectedIndex = 0;\\n         if (previewImage.hasAttribute(\\\"src\\\"))\\n           previewImage.removeAttribute(\\\"src\\\");\\n       }\\n+      else {\\n+        var url = gExtensionsView.selectedItem.getAttribute(\\\"previewImage\\\");\\n+        if (url) {\\n+          previewImageDeck.selectedIndex = 2;\\n+          previewImage.setAttribute(\\\"src\\\", url);\\n+        }\\n+        else {\\n+          previewImageDeck.selectedIndex = 1;\\n+          if (previewImage.hasAttribute(\\\"src\\\"))\\n+            previewImage.removeAttribute(\\\"src\\\");\\n+        }\\n+      }\\n+    }\\n+    else if (gView == \\\"updates\\\") {\\n+      UpdateInfoLoader.cancelLoad();\\n+      if (!gExtensionsView.selectedItem)\\n+        previewImageDeck.selectedIndex = 3;\\n+      else if (!gExtensionsView.selectedItem.hasAttribute(\\\"availableUpdateInfo\\\"))\\n+        previewImageDeck.selectedIndex = 4;\\n+      else\\n+        UpdateInfoLoader.loadInfo(gExtensionsView.selectedItem.getAttribute(\\\"availableUpdateInfo\\\"));\\n+    }\\n+  }\\n+}\\n+\\n+/**\\n+ * Manages the retrieval of update information and the xsl stylesheet\\n+ * used to format the inforation into chrome.\\n+ */\\n+var UpdateInfoLoader = {\\n+  _stylesheet: null,\\n+  _styleRequest: null,\\n+  _infoDocument: null,\\n+  _infoRequest: null,\\n+  \\n+  // Called once both stylesheet and info requests have completed\\n+  displayInfo: function()\\n+  {\\n+    var processor = Components.classes[\\\"@mozilla.org/document-transformer;1?type=xslt\\\"]\\n+                              .createInstance(Components.interfaces.nsIXSLTProcessor);\\n+    processor.flags |= Components.interfaces.nsIXSLTProcessorPrivate.DISABLE_ALL_LOADS;\\n+    \\n+    processor.importStylesheet(this._stylesheet);\\n+    var fragment = processor.transformToFragment(this._infoDocument, document);\\n+    document.getElementById(\\\"infoDisplay\\\").appendChild(fragment);\\n+    document.getElementById(\\\"previewImageDeck\\\").selectedIndex = 7;\\n+  },\\n+  \\n+  onStylesheetLoaded: function(event)\\n+  {\\n+    var request = event.target;\\n+    this._styleRequest = null;\\n+    this._stylesheet = request.responseXML;\\n+\\n+    if (!this._stylesheet ||\\n+        this._stylesheet.documentElement.namespaceURI == XMLURI_PARSE_ERROR ||\\n+        (request.status != 200 && request.status != 0)) {\\n+      // The stylesheet load failing is a bad sign\\n+      document.getElementById(\\\"previewImageDeck\\\").selectedIndex = 6;\\n+      return;\\n+    }\\n+\\n+    if (this._infoDocument)\\n+      this.displayInfo();\\n+  },\\n+  \\n+  onInfoLoaded: function(event)\\n+  {\\n+    var request = event.target;\\n+    this._infoRequest = null;\\n+    this._infoDocument = request.responseXML;\\n+    \\n+    if (!this._infoDocument ||\\n+        this._infoDocument.documentElement.namespaceURI == XMLURI_PARSE_ERROR ||\\n+        (request.status != 200 && request.status != 0)) {\\n+      // Should attempt to parse request.responseText with the html parser\\n+      document.getElementById(\\\"previewImageDeck\\\").selectedIndex = 6;\\n+      return;\\n     }\\n+\\n+    if (this._stylesheet)\\n+      this.displayInfo();\\n+  },\\n+  \\n+  onError: function(event)\\n+  {\\n+    if (event.request == this._infoRequest)\\n+      this._infoRequest = null;\\n+    else // Means the stylesheet load has failed which is pretty bad news\\n+      this.cancelRequest();\\n+\\n+    document.getElementById(\\\"previewImageDeck\\\").selectedIndex = 6;\\n+  },\\n+  \\n+  loadInfo: function(url)\\n+  {\\n+    this.cancelLoad();\\n+    this._infoDocument = null;\\n+    document.getElementById(\\\"previewImageDeck\\\").selectedIndex = 5;\\n+    var display = document.getElementById(\\\"infoDisplay\\\");\\n+    while (display.lastChild)\\n+      display.removeChild(display.lastChild);\\n+\\n+    this._infoRequest = Components.classes[\\\"@mozilla.org/xmlextras/xmlhttprequest;1\\\"]\\n+                                  .createInstance(Components.interfaces.nsIXMLHttpRequest);\\n+    this._infoRequest.open(\\\"GET\\\", url, true);\\n+    \\n+    var self = this;\\n+    this._infoRequest.onerror = function(event) { self.onError(event); };\\n+    this._infoRequest.onload = function(event) { self.onInfoLoaded(event); };\\n+    this._infoRequest.send(null);\\n+\\n+    // We may have the stylesheet cached from a previous load, or may still be\\n+    // loading it.\\n+    if (this._stylesheet || this._styleRequest)\\n+      return;\\n+\\n+    this._styleRequest = Components.classes[\\\"@mozilla.org/xmlextras/xmlhttprequest;1\\\"]\\n+                                   .createInstance(Components.interfaces.nsIXMLHttpRequest);\\n+    this._styleRequest.open(\\\"GET\\\", \\\"chrome://mozapps/content/extensions/updateinfo.xsl\\\", true);\\n+    this._styleRequest.overrideMimeType(\\\"text/xml\\\");\\n+    \\n+    this._styleRequest.onerror = function(event) { self.onError(event); };\\n+    this._styleRequest.onload = function(event) { self.onStylesheetLoaded(event); };\\n+    this._styleRequest.send(null);\\n+  },\\n+  \\n+  cancelLoad: function()\\n+  {\\n+    // Leave the stylesheet loader running, there's a good chance we'll need it\\n+    if (this._infoRequest)\\n+      this._infoRequest.abort();\\n+    this._infoRequest = null;\\n   }\\n }\\n \\n@@ -1531,6 +1658,24 @@ function updateGlobalCommands() {\\n   setElementDisabledByID(\\\"cmd_installFile\\\", disableInstallFile);\\n }\\n \\n+function showUpdateInfo()\\n+{\\n+  document.getElementById(\\\"themePreviewArea\\\").hidden = false;\\n+  document.getElementById(\\\"themeSplitter\\\").hidden = false;\\n+  document.getElementById(\\\"showUpdateInfoButton\\\").hidden = true;\\n+  document.getElementById(\\\"hideUpdateInfoButton\\\").hidden = false;\\n+  onAddonSelect();\\n+}\\n+\\n+function hideUpdateInfo()\\n+{\\n+  UpdateInfoLoader.cancelLoad();\\n+  document.getElementById(\\\"themePreviewArea\\\").hidden = true;\\n+  document.getElementById(\\\"themeSplitter\\\").hidden = true;\\n+  document.getElementById(\\\"showUpdateInfoButton\\\").hidden = false;\\n+  document.getElementById(\\\"hideUpdateInfoButton\\\").hidden = true;\\n+}\\n+\\n function checkUpdatesAll() {\\n   if (isOffline(\\\"offlineUpdateMsg\\\"))\\n     return;\\ndiff --git a/toolkit/mozapps/extensions/content/extensions.xml b/toolkit/mozapps/extensions/content/extensions.xml\\nindex e85ec7c..dd2b57d 100644\\n--- a/toolkit/mozapps/extensions/content/extensions.xml\\n+++ b/toolkit/mozapps/extensions/content/extensions.xml\\n@@ -481,12 +481,12 @@\\n           <xul:hbox>\\n             <xul:description xbl:inherits=\\\"value=updateAvailableMsg\\\" flex=\\\"1\\\" crop=\\\"end\\\"/>\\n           </xul:hbox>\\n+          <xul:hbox pack=\\\"end\\\" align=\\\"end\\\">\\n+            <xul:checkbox anonid=\\\"includeUpdate\\\" class=\\\"includeUpdate\\\" checked=\\\"true\\\"\\n+            label=\\\"&includeUpdate.label;\\\" tooltiptext=\\\"&includeUpdate.tooltip;\\\"\\n+            includeUpdateAccesskey=\\\"&includeUpdate.accesskey;\\\" accesskey=\\\"&includeUpdate.accesskey;\\\"/>\\n+          </xul:hbox>\\n         </xul:vbox>\\n-        <xul:hbox pack=\\\"end\\\" align=\\\"end\\\">\\n-          <xul:checkbox anonid=\\\"includeUpdate\\\" class=\\\"includeUpdate\\\" checked=\\\"true\\\"\\n-          label=\\\"&includeUpdate.label;\\\" tooltiptext=\\\"&includeUpdate.tooltip;\\\"\\n-          includeUpdateAccesskey=\\\"&includeUpdate.accesskey;\\\" accesskey=\\\"&includeUpdate.accesskey;\\\"/>\\n-        </xul:hbox>\\n       </xul:hbox>\\n     </content>\\n \\ndiff --git a/toolkit/mozapps/extensions/content/extensions.xul b/toolkit/mozapps/extensions/content/extensions.xul\\nindex 8998d9b..5e911d0 100644\\n--- a/toolkit/mozapps/extensions/content/extensions.xul\\n+++ b/toolkit/mozapps/extensions/content/extensions.xul\\n@@ -110,6 +110,8 @@\\n     <command id=\\\"cmd_restartApp\\\" oncommand=\\\"restartApp();\\\"/>\\n     <command id=\\\"cmd_continue\\\" oncommand=\\\"closeEM();\\\" disabled=\\\"true\\\"/>\\n     <command id=\\\"cmd_close\\\" oncommand=\\\"closeEM();\\\"/>\\n+    <command id=\\\"cmd_showUpdateInfo\\\" oncommand=\\\"showUpdateInfo();\\\"/>\\n+    <command id=\\\"cmd_hideUpdateInfo\\\" oncommand=\\\"hideUpdateInfo();\\\"/>\\n   </commandset>\\n \\n   <vbox id=\\\"addonContextMenuPalette\\\" hidden=\\\"true\\\">\\n@@ -193,6 +195,20 @@\\n               <image id=\\\"previewImage\\\"/>\\n             </description>\\n           </vbox>\\n+          <vbox id=\\\"infoNoAddonSelected\\\" align=\\\"center\\\" pack=\\\"center\\\">\\n+            <label class=\\\"previewText\\\">&infoNoAddonSelected.label;</label>\\n+          </vbox>\\n+          <vbox id=\\\"infoNoUpdateInfo\\\" align=\\\"center\\\" pack=\\\"center\\\">\\n+            <label class=\\\"previewText\\\">&infoNoUpdateInfo.label;</label>\\n+          </vbox>\\n+          <vbox id=\\\"infoLoadingInfo\\\" align=\\\"center\\\" pack=\\\"center\\\">\\n+            <image class=\\\"addonThrobber\\\"/>\\n+          </vbox>\\n+          <vbox id=\\\"infoUpdateInfoError\\\" align=\\\"center\\\" pack=\\\"center\\\">\\n+            <label class=\\\"previewText\\\">&infoUpdateInfoError.label;</label>\\n+          </vbox>\\n+          <vbox id=\\\"infoDisplay\\\">\\n+          </vbox>\\n         </deck>\\n       </vbox>\\n     </hbox>\\n@@ -208,6 +224,14 @@\\n               accesskey=\\\"&cmd.installUpdatesAll.accesskey;\\\"\\n               tooltiptext=\\\"&cmd.installUpdatesAll.tooltip;\\\"\\n               command=\\\"cmd_installUpdatesAll\\\"/>\\n+      <button id=\\\"showUpdateInfoButton\\\" label=\\\"&cmd.showUpdateInfo.label;\\\"\\n+              accesskey=\\\"&cmd.showUpdateInfo.accesskey;\\\"\\n+              tooltiptext=\\\"&cmd.showUpdateInfo.tooltip;\\\"\\n+              command=\\\"cmd_showUpdateInfo\\\"/>\\n+      <button id=\\\"hideUpdateInfoButton\\\" label=\\\"&cmd.hideUpdateInfo.label;\\\"\\n+              accesskey=\\\"&cmd.hideUpdateInfo.accesskey;\\\"\\n+              tooltiptext=\\\"&cmd.hideUpdateInfo.tooltip;\\\"\\n+              command=\\\"cmd_hideUpdateInfo\\\"/>\\n       <button id=\\\"checkUpdatesAllButton\\\" label=\\\"&cmd.checkUpdatesAll.label;\\\"\\n               accesskey=\\\"&cmd.checkUpdatesAll.accesskey;\\\"\\n               tooltiptextaddons=\\\"&cmd.checkUpdatesAllAddon.tooltip;\\\"\\ndiff --git a/toolkit/mozapps/extensions/content/updateinfo.xsl b/toolkit/mozapps/extensions/content/updateinfo.xsl\\nnew file mode 100644\\nindex 0000000..fb6119f\\n--- /dev/null\\n+++ b/toolkit/mozapps/extensions/content/updateinfo.xsl\\n@@ -0,0 +1,38 @@\\n+<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?>\\n+<xsl:stylesheet version=\\\"1.0\\\" xmlns:xhtml=\\\"http://www.w3.org/1999/xhtml\\\"\\n+                              xmlns:xsl=\\\"http://www.w3.org/1999/XSL/Transform\\\">\\n+\\n+  <xsl:template match=\\\"text()\\\">\\n+  </xsl:template>\\n+  \\n+  <xsl:template match=\\\"text()\\\" mode=\\\"list\\\">\\n+  </xsl:template>\\n+  \\n+  <xsl:template match=\\\"text()\\\" mode=\\\"text\\\">\\n+    <xsl:value-of select=\\\".\\\"/>\\n+  </xsl:template>\\n+  \\n+  <xsl:template match=\\\"xhtml:script\\\" mode=\\\"text\\\">\\n+  </xsl:template>\\n+  \\n+  <xsl:template match=\\\"xhtml:b|xhtml:i|xhtml:em|xhtml:strong\\\" mode=\\\"text\\\">\\n+    <xsl:copy><xsl:apply-templates mode=\\\"text\\\"/></xsl:copy>\\n+  </xsl:template>\\n+  \\n+  <xsl:template match=\\\"xhtml:h1|xhtml:h2|xhtml:h3|xhtml:p\\\">\\n+    <xsl:copy><xsl:apply-templates mode=\\\"text\\\"/></xsl:copy>\\n+  </xsl:template>\\n+\\n+  <xsl:template match=\\\"xhtml:li\\\" mode=\\\"list\\\">\\n+    <xsl:copy><xsl:apply-templates mode=\\\"text\\\"/></xsl:copy>\\n+  </xsl:template>\\n+\\n+  <xsl:template match=\\\"xhtml:ul|xhtml:ol\\\">\\n+    <xsl:copy><xsl:apply-templates mode=\\\"list\\\"/></xsl:copy>\\n+  </xsl:template>\\n+  \\n+  <xsl:template match=\\\"/\\\">\\n+    <xhtml:body><xsl:apply-templates/></xhtml:body>\\n+  </xsl:template>\\n+  \\n+</xsl:stylesheet>\\ndiff --git a/toolkit/mozapps/extensions/jar.mn b/toolkit/mozapps/extensions/jar.mn\\nindex 8866ba3..bb0cdff 100755\\n--- a/toolkit/mozapps/extensions/jar.mn\\n+++ b/toolkit/mozapps/extensions/jar.mn\\n@@ -3,6 +3,7 @@ toolkit.jar:\\n * content/mozapps/extensions/extensions.xul                     (content/extensions.xul)\\n * content/mozapps/extensions/extensions.js                      (content/extensions.js)\\n * content/mozapps/extensions/extensions.xml                     (content/extensions.xml)\\n+  content/mozapps/extensions/updateinfo.xsl                     (content/updateinfo.xsl)\\n   content/mozapps/extensions/extensions.css                     (content/extensions.css)\\n * content/mozapps/extensions/about.xul                          (content/about.xul)\\n * content/mozapps/extensions/about.js                           (content/about.js)\\ndiff --git a/toolkit/mozapps/extensions/src/nsExtensionManager.js.in b/toolkit/mozapps/extensions/src/nsExtensionManager.js.in\\nindex eba7114..fa1fb9d 100644\\n--- a/toolkit/mozapps/extensions/src/nsExtensionManager.js.in\\n+++ b/toolkit/mozapps/extensions/src/nsExtensionManager.js.in\\n@@ -4480,7 +4480,8 @@ ExtensionManager.prototype = {\\n                   type            : EM_I(type),\\n                   availableUpdateURL    : null,\\n                   availableUpdateHash   : null,\\n-                  availableUpdateVersion: null };\\n+                  availableUpdateVersion: null,\\n+                  availableUpdateInfo   : null };\\n     for (var p in props)\\n       ds.setItemProperty(id, EM_R(p), props[p]);\\n     ds.updateProperty(id, \\\"availableUpdateURL\\\");\\n@@ -4520,7 +4521,8 @@ ExtensionManager.prototype = {\\n                   newVersion      : EM_L(getManifestProperty(installManifest, \\\"version\\\")),\\n                   availableUpdateURL      : null,\\n                   availableUpdateHash     : null,\\n-                  availableUpdateVersion  : null };\\n+                  availableUpdateVersion  : null,\\n+                  availableUpdateInfo     : null };\\n     for (var p in props)\\n       ds.setItemProperty(id, EM_R(p), props[p]);\\n     ds.updateProperty(id, \\\"availableUpdateURL\\\");\\n@@ -5392,6 +5394,7 @@ ExtensionManager.prototype = {\\n         ds.setItemProperty(id, EM_R(\\\"availableUpdateURL\\\"), null);\\n         ds.setItemProperty(id, EM_R(\\\"availableUpdateHash\\\"), null);\\n         ds.setItemProperty(id, EM_R(\\\"availableUpdateVersion\\\"), null);\\n+        ds.setItemProperty(id, EM_R(\\\"availableUpdateInfo\\\"), null);\\n         ds.updateProperty(id, \\\"availableUpdateURL\\\");\\n         ds.updateProperty(id, \\\"updateable\\\");\\n       }\\n@@ -6474,6 +6477,15 @@ RDFItemUpdater.prototype = {\\n                                  appID);\\n \\n       if (this._updater._isValidUpdate(aLocalItem, updatedItem)) {\\n+        if (aUpdateCheckType == nsIExtensionManager.UPDATE_CHECK_NEWVERSION) {\\n+          var infourl = this._getPropertyFromResource(aDataSource, targetApp,\\n+                                                      \\\"updateInfoURL\\\");\\n+          if (infourl)\\n+            infourl = EM_L(infourl);\\n+          this._updater._emDS.setItemProperty(aLocalItem.id,\\n+                                              EM_R(\\\"availableUpdateInfo\\\"),\\n+                                              infourl);\\n+        }\\n         if (appID == this._updater._appID) {\\n           // App takes precedence over toolkit.  If we found the app, bail out.\\n           return updatedItem;\\ndiff --git a/toolkit/themes/pinstripe/mozapps/extensions/extensions.css b/toolkit/themes/pinstripe/mozapps/extensions/extensions.css\\nindex b12db03..a0f3ae9 100644\\n--- a/toolkit/themes/pinstripe/mozapps/extensions/extensions.css\\n+++ b/toolkit/themes/pinstripe/mozapps/extensions/extensions.css\\n@@ -284,3 +284,45 @@ radio#installs-view:hover, radio#installs-view[selected=\\\"true\\\"] {\\n richlistitem[selected=\\\"true\\\"] .includeUpdate {\\n   -moz-user-focus: normal;\\n }\\n+\\n+#infoDisplay {\\n+  overflow-y: auto;\\n+}\\n+\\n+#infoDisplay body {\\n+  padding: 5px;\\n+}\\n+\\n+#infoDisplay h1,\\n+#infoDisplay h2,\\n+#infoDisplay h3 {\\n+  text-align: left;\\n+  font-weight: bold;\\n+  margin: 0 0 0.7em 0;\\n+}\\n+\\n+#infoDisplay h1 {\\n+  font-size: 150%;\\n+}\\n+\\n+#infoDisplay h2 {\\n+  font-size: 125%;\\n+}\\n+\\n+#infoDisplay h3 {\\n+  font-size: 100%;\\n+}\\n+\\n+#infoDisplay ol,\\n+#infoDisplay ul {\\n+  margin: 0 0 0.7em 0;\\n+}\\n+\\n+#infoDisplay li {\\n+  text-align: left;\\n+}\\n+\\n+#infoDisplay p {\\n+  text-align: justify;\\n+  margin: 0 0 0.7em 0;\\n+}\\ndiff --git a/toolkit/themes/winstripe/mozapps/extensions/extensions.css b/toolkit/themes/winstripe/mozapps/extensions/extensions.css\\nindex 77cdbca..1358310 100644\\n--- a/toolkit/themes/winstripe/mozapps/extensions/extensions.css\\n+++ b/toolkit/themes/winstripe/mozapps/extensions/extensions.css\\n@@ -48,7 +48,7 @@ margin-top: -12px;\\n   -moz-image-region: rect(21px, 84px, 42px, 63px);\\n }\\n \\n-#checkUpdatesAllButton {\\n+#checkUpdatesAllButton, #showUpdateInfoButton, #hideUpdateInfoButton {\\n   -moz-image-region: rect(0px, 63px, 21px, 42px);\\n }\\n #checkUpdatesAllButton[disabled=\\\"true\\\"] {\\n@@ -351,3 +351,45 @@ radio#installs-view:hover, radio#installs-view[selected=\\\"true\\\"] {\\n richlistitem[selected=\\\"true\\\"] .includeUpdate {\\n   -moz-user-focus: normal;\\n }\\n+\\n+#infoDisplay {\\n+  overflow-y: auto;\\n+}\\n+\\n+#infoDisplay body {\\n+  padding: 5px;\\n+}\\n+\\n+#infoDisplay h1,\\n+#infoDisplay h2,\\n+#infoDisplay h3 {\\n+  text-align: left;\\n+  font-weight: bold;\\n+  margin: 0 0 0.7em 0;\\n+}\\n+\\n+#infoDisplay h1 {\\n+  font-size: 150%;\\n+}\\n+\\n+#infoDisplay h2 {\\n+  font-size: 125%;\\n+}\\n+\\n+#infoDisplay h3 {\\n+  font-size: 100%;\\n+}\\n+\\n+#infoDisplay ol,\\n+#infoDisplay ul {\\n+  margin: 0 0 0.7em 0;\\n+}\\n+\\n+#infoDisplay li {\\n+  text-align: left;\\n+}\\n+\\n+#infoDisplay p {\\n+  text-align: justify;\\n+  margin: 0 0 0.7em 0;\\n+}\\n\""}