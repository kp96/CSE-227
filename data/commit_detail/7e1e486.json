{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Bas7e1e486\""},"diff":"\"7e1e486 #384186 r=sayrer, moa=bsmedberg, a=mconnor Initial Microformats API checkin\\ndiff --git a/toolkit/components/microformats/Makefile.in b/toolkit/components/microformats/Makefile.in\\nnew file mode 100644\\nindex 0000000..d466ea8\\n--- /dev/null\\n+++ b/toolkit/components/microformats/Makefile.in\\n@@ -0,0 +1,51 @@\\n+# ***** BEGIN LICENSE BLOCK *****\\n+# Version: MPL 1.1/GPL 2.0/LGPL 2.1\\n+#\\n+# The contents of this file are subject to the Mozilla Public License Version\\n+# 1.1 (the \\\"License\\\"); you may not use this file except in compliance with\\n+# the License. You may obtain a copy of the License at\\n+# http://www.mozilla.org/MPL/\\n+#\\n+# Software distributed under the License is distributed on an \\\"AS IS\\\" basis,\\n+# WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License\\n+# for the specific language governing rights and limitations under the\\n+# License.\\n+#\\n+# The Original Code is Microformats.\\n+#\\n+# The Initial Developer of the Original Code is IBM Corporation.\\n+# Portions created by the Initial Developer are Copyright (C) 2007\\n+# the Initial Developer. All Rights Reserved.\\n+#\\n+# Contributor(s):\\n+#   Mike Kaply\\n+#\\n+# Alternatively, the contents of this file may be used under the terms of\\n+# either the GNU General Public License Version 2 or later (the \\\"GPL\\\"), or\\n+# the GNU Lesser General Public License Version 2.1 or later (the \\\"LGPL\\\"),\\n+# in which case the provisions of the GPL or the LGPL are applicable instead\\n+# of those above. If you wish to allow use of your version of this file only\\n+# under the terms of either the GPL or the LGPL, and not to allow others to\\n+# use your version of this file under the terms of the MPL, indicate your\\n+# decision by deleting the provisions above and replace them with the notice\\n+# and other provisions required by the GPL or the LGPL. If you do not delete\\n+# the provisions above, a recipient may use your version of this file under\\n+# the terms of any one of the MPL, the GPL or the LGPL.\\n+#\\n+# ***** END LICENSE BLOCK *****\\n+\\n+DEPTH     = ../../..\\n+topsrcdir = @top_srcdir@\\n+srcdir    = @srcdir@\\n+VPATH     = @srcdir@\\n+\\n+include $(DEPTH)/config/autoconf.mk\\n+\\n+DIRS = src\\n+\\n+ifdef MOZ_MOCHITEST\\n+DIRS += tests\\n+endif\\n+\\n+include $(topsrcdir)/config/rules.mk\\n+\\ndiff --git a/toolkit/components/microformats/src/Makefile.in b/toolkit/components/microformats/src/Makefile.in\\nnew file mode 100644\\nindex 0000000..510fcda\\n--- /dev/null\\n+++ b/toolkit/components/microformats/src/Makefile.in\\n@@ -0,0 +1,48 @@\\n+# ***** BEGIN LICENSE BLOCK *****\\n+# Version: MPL 1.1/GPL 2.0/LGPL 2.1\\n+#\\n+# The contents of this file are subject to the Mozilla Public License Version\\n+# 1.1 (the \\\"License\\\"); you may not use this file except in compliance with\\n+# the License. You may obtain a copy of the License at\\n+# http://www.mozilla.org/MPL/\\n+#\\n+# Software distributed under the License is distributed on an \\\"AS IS\\\" basis,\\n+# WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License\\n+# for the specific language governing rights and limitations under the\\n+# License.\\n+#\\n+# The Original Code is Microformats.\\n+#\\n+# The Initial Developer of the Original Code IBM Corporation.\\n+# Portions created by the Initial Developer are Copyright (C) 2007\\n+# the Initial Developer. All Rights Reserved.\\n+#\\n+# Contributor(s):\\n+#   Mike Kaply\\n+#\\n+# Alternatively, the contents of this file may be used under the terms of\\n+# either the GNU General Public License Version 2 or later (the \\\"GPL\\\"), or\\n+# the GNU Lesser General Public License Version 2.1 or later (the \\\"LGPL\\\"),\\n+# in which case the provisions of the GPL or the LGPL are applicable instead\\n+# of those above. If you wish to allow use of your version of this file only\\n+# under the terms of either the GPL or the LGPL, and not to allow others to\\n+# use your version of this file under the terms of the MPL, indicate your\\n+# decision by deleting the provisions above and replace them with the notice\\n+# and other provisions required by the GPL or the LGPL. If you do not delete\\n+# the provisions above, a recipient may use your version of this file under\\n+# the terms of any one of the MPL, the GPL or the LGPL.\\n+#\\n+# ***** END LICENSE BLOCK *****\\n+\\n+DEPTH     = ../../../..\\n+topsrcdir = @top_srcdir@\\n+srcdir    = @srcdir@\\n+VPATH     = @srcdir@\\n+\\n+include $(DEPTH)/config/autoconf.mk\\n+\\n+MODULE = microformats\\n+\\n+EXTRA_JS_MODULES = Microformats.js\\n+\\n+include $(topsrcdir)/config/rules.mk\\ndiff --git a/toolkit/components/microformats/src/Microformats.js b/toolkit/components/microformats/src/Microformats.js\\nnew file mode 100644\\nindex 0000000..c94e64c\\n--- /dev/null\\n+++ b/toolkit/components/microformats/src/Microformats.js\\n@@ -0,0 +1,1658 @@\\n+var EXPORTED_SYMBOLS = [\\\"Microformats\\\", \\\"adr\\\", \\\"tag\\\", \\\"hCard\\\", \\\"hCalendar\\\", \\\"geo\\\"];\\n+\\n+var Microformats = {\\n+  version: 0.8,\\n+  /* When a microformat is added, the name is placed in this list */\\n+  list: [],\\n+  /* Custom iterator so that microformats can be enumerated as */\\n+  /* for (i in Microformats) */\\n+  __iterator__: function () {\\n+    for (let i=0; i < this.list.length; i++) {\\n+      yield this.list[i];\\n+    }\\n+  },\\n+  /**\\n+   * Retrieves microformats objects of the given type from a document\\n+   * \\n+   * @param  name          The name of the microformat (required)\\n+   * @param  rootElement   The DOM element at which to start searching (required)\\n+   * @param  recurseFrames Whether or not to search child frames for microformats (optional - defaults to true)\\n+   * @param  targetArray  An array of microformat objects to which is added the results (optional)\\n+   * @return A new array of microformat objects or the passed in microformat \\n+   *         object array with the new objects added\\n+   */\\n+  get: function(name, rootElement, recurseFrames, targetArray) {\\n+    if (!Microformats[name]) {\\n+      return;\\n+    }\\n+    targetArray = targetArray || [];\\n+\\n+    rootElement = rootElement || content.document;\\n+\\n+    /* If recurseFrames is undefined or true, look through all child frames for microformats */\\n+    if ((recurseFrames == undefined) || (recurseFrames == true)) {\\n+      if (rootElement.defaultView && rootElement.defaultView.frames.length > 0) {\\n+        for (let i=0; i < rootElement.defaultView.frames.length; i++) {\\n+          Microformats.get(name, rootElement.defaultView.frames[i].document, recurseFrames, targetArray);\\n+        }\\n+      }\\n+    }\\n+\\n+    /* Get the microformat nodes for the document */\\n+    var microformatNodes = [];\\n+    if (Microformats[name].className) {\\n+      microformatNodes = Microformats.getElementsByClassName(rootElement,\\n+                                        Microformats[name].className);\\n+      /* alternateClassName is for cases where a parent microformat is inferred by the children */\\n+      /* If we find alternateClassName, the entire document becomes the microformat */\\n+      if ((microformatNodes.length == 0) && Microformats[name].alternateClassName) {\\n+        var altClass = Microformats.getElementsByClassName(rootElement, Microformats[name].alternateClassName);\\n+        if (altClass.length > 0) {\\n+          microformatNodes.push(rootElement); \\n+        }\\n+      }\\n+    } else if (Microformats[name].attributeValues) {\\n+      microformatNodes =\\n+        Microformats.getElementsByAttribute(rootElement,\\n+                                            Microformats[name].attributeName,\\n+                                            Microformats[name].attributeValues);\\n+      \\n+    }\\n+    /* Create objects for the microformat nodes and put them into the microformats */\\n+    /* array */\\n+    for (let i = 0; i < microformatNodes.length; i++) {\\n+      targetArray.push(new Microformats[name].mfObject(microformatNodes[i]));\\n+    }\\n+    return targetArray;\\n+  },\\n+  /**\\n+   * Counts microformats objects of the given type from a document\\n+   * \\n+   * @param  name          The name of the microformat (required)\\n+   * @param  rootElement   The DOM element at which to start searching (required)\\n+   * @param  recurseFrames Whether or not to search child frames for microformats (optional - defaults to true)\\n+   * @return The new count\\n+   */\\n+  count: function(name, rootElement, recurseFrames) {\\n+    if (!Microformats[name]) {\\n+      return;\\n+    }\\n+    var count = 0;\\n+\\n+    rootElement = rootElement || content.document;\\n+\\n+    /* If recurseFrames is undefined or true, look through all child frames for microformats */\\n+    if (recurseFrames || recurseFrames === undefined) {\\n+      if (rootElement.defaultView && rootElement.defaultView.frames.length > 0) {\\n+        for (let i=0; i < rootElement.defaultView.frames.length; i++) {\\n+          count += Microformats.count(name, rootElement.defaultView.frames[i].document, recurseFrames);\\n+        }\\n+      }\\n+    }\\n+\\n+    /* Get the microformat nodes for the document */\\n+    var microformatNodes = [];\\n+    if (Microformats[name].className) {\\n+      microformatNodes = Microformats.getElementsByClassName(rootElement,\\n+                                        Microformats[name].className);\\n+      /* alternateClassName is for cases where a parent microformat is inferred by the children */\\n+      /* If we find alternateClassName, the entire document becomes the microformat */\\n+      if ((microformatNodes.length == 0) && Microformats[name].alternateClassName) {\\n+        var altClass = Microformats.getElementsByClassName(rootElement, Microformats[name].alternateClassName);\\n+        if (altClass.length > 0) {\\n+          microformatNodes.push(rootElement); \\n+        }\\n+      }\\n+    } else if (Microformats[name].attributeValues) {\\n+      microformatNodes = \\n+        Microformats.getElementsByAttribute(rootElement,\\n+                                            Microformats[name].attributeName,\\n+                                            Microformats[name].attributeValues);\\n+    }\\n+    count += microformatNodes.length;\\n+    return count;\\n+  },\\n+  /**\\n+   * Returns true if the passed in node is a microformat. Does NOT return true\\n+   * if the passed in node is a child of a microformat.\\n+   *\\n+   * @param  node          DOM node to check\\n+   * @return true if the node is a microformat, false if it is not\\n+   */\\n+  isMicroformat: function(node) {\\n+    for (let i in Microformats)\\n+    {\\n+      if (Microformats[i].className) {\\n+        if (Microformats.matchClass(node, Microformats[i].className)) {\\n+            return true;\\n+        }\\n+      } else {\\n+        var attribute;\\n+        if (attribute = node.getAttribute(Microformats[i].attributeName)) {\\n+          var attributeList = Microformats[i].attributeValues.split(\\\" \\\");\\n+          for (let j=0; j < attributeList.length; j++) {\\n+            if (attribute.match(\\\"(^|\\\\\\\\s)\\\" + attributeList[j] + \\\"(\\\\\\\\s|$)\\\")) {\\n+              return true;\\n+            }\\n+          }\\n+        }\\n+      }\\n+    }\\n+    return false;\\n+  },\\n+  /**\\n+   * This function searches a given nodes ancestors looking for a microformat\\n+   * and if it finds it, returns it. It does NOT include self, so if the passed\\n+   * in node is a microformat, it will still search ancestors for a microformat.\\n+   *\\n+   * @param  node          DOM node to check\\n+   * @return If the node is contained in a microformat, it returns the parent\\n+   *         DOM node, otherwise returns null\\n+   */\\n+  getParent: function(node) {\\n+    var xpathExpression;\\n+    var xpathResult;\\n+    var mfname;\\n+    for (let i in Microformats)\\n+    {\\n+      mfname = i;\\n+      if (Microformats[mfname]) {\\n+        if (Microformats[mfname].className) {\\n+          xpathExpression = \\\"ancestor::*[contains(concat(' ', @class, ' '), ' \\\" + Microformats[mfname].className + \\\" ')]\\\";\\n+        } else if (Microformats[mfname].attributeValues) {\\n+          xpathExpression = \\\"ancestor::*[\\\";\\n+          var attributeList = Microformats[i].attributeValues.split(\\\" \\\");\\n+          for (let j=0; j < attributeList.length; j++) {\\n+            if (j != 0) {\\n+              xpathExpression += \\\" or \\\";\\n+            }\\n+            xpathExpression += \\\"contains(concat(' ', @\\\" + Microformats[mfname].attributeName + \\\", ' '), ' \\\" + attributeList[j] + \\\" ')\\\";\\n+          }\\n+          xpathExpression += \\\"]\\\"; \\n+        } else {\\n+          continue;\\n+        }\\n+        xpathResult = (node.ownerDocument || node).evaluate(xpathExpression, node, null,  Components.interfaces.nsIDOMXPathResult.FIRST_ORDERED_NODE_TYPE, null);\\n+        if (xpathResult.singleNodeValue) {\\n+          xpathResult.singleNodeValue.microformat = mfname;\\n+          return xpathResult.singleNodeValue;\\n+        }\\n+      }\\n+    }\\n+    return null;\\n+  },\\n+  /**\\n+   * If the passed in node is a microformat, this function returns a space \\n+   * separated list of the microformat names that correspond to this node\\n+   *\\n+   * @param  node          DOM node to check\\n+   * @return If the node is a microformat, a space separated list of microformat\\n+   *         names, otherwise returns nothing\\n+   */\\n+  getNamesFromNode: function(node) {\\n+    var microformatNames = [];\\n+    var xpathExpression;\\n+    var xpathResult;\\n+    for (let i in Microformats)\\n+    {\\n+      if (Microformats[i]) {\\n+        if (Microformats[i].className) {\\n+          if (Microformats.matchClass(node, Microformats[i].className)) {\\n+            microformatNames.push(i);\\n+            continue;\\n+          }\\n+        } else if (Microformats[i].attributeValues) {\\n+          var attribute;\\n+          if (attribute = node.getAttribute(Microformats[i].attributeName)) {\\n+            var attributeList = Microformats[i].attributeValues.split(\\\" \\\");\\n+            for (let j=0; j < attributeList.length; j++) {\\n+              /* If we match any attribute, we've got a microformat */\\n+              if (attribute.match(\\\"(^|\\\\\\\\s)\\\" + attributeList[j] + \\\"(\\\\\\\\s|$)\\\")) {\\n+                microformatNames.push(i);\\n+                break;\\n+              }\\n+            }\\n+          }\\n+        }\\n+      }\\n+    }\\n+    return microformatNames.join(\\\" \\\");\\n+  },\\n+  /**\\n+   * Outputs the contents of a microformat object for debug purposes.\\n+   *\\n+   * @param  microformatObject JavaScript object that represents a microformat\\n+   * @return string containing a visual representation of the contents of the microformat\\n+   */\\n+  debug: function debug(microformatObject) {\\n+    function dumpObject(item, indent)\\n+    {\\n+      if (!indent) {\\n+        indent = \\\"\\\";\\n+      }\\n+      var toreturn = \\\"\\\";\\n+      var testArray = [];\\n+      \\n+      for (let i in item)\\n+      {\\n+        if (testArray[i]) {\\n+          continue;\\n+        }\\n+        if (typeof item[i] == \\\"object\\\") {\\n+          if ((i != \\\"node\\\") && (i != \\\"resolvedNode\\\")) {\\n+            if (item[i] && item[i].semanticType) {\\n+              toreturn += indent + item[i].semanticType + \\\" [\\\" + i + \\\"] { \\\\n\\\";\\n+            } else {\\n+              toreturn += indent + \\\"object \\\" + i + \\\" { \\\\n\\\";\\n+            }\\n+            toreturn += dumpObject(item[i], indent + \\\"\\\\t\\\");\\n+            toreturn += indent + \\\"}\\\\n\\\";\\n+          }\\n+        } else if ((typeof item[i] != \\\"function\\\") && (i != \\\"semanticType\\\")) {\\n+          if (item[i]) {\\n+            toreturn += indent + i + \\\"=\\\" + item[i] + \\\"\\\\n\\\";\\n+          }\\n+        }\\n+      }\\n+      if (!toreturn && item) {\\n+        toreturn = item.toString();\\n+      }\\n+      return toreturn;\\n+    }\\n+    return dumpObject(microformatObject);\\n+  },\\n+  add: function add(microformat, microformatDefinition) {\\n+    /* We always replace an existing definition with the new one */\\n+    if (microformatDefinition.mfVersion == Microformats.version) {\\n+      if (!Microformats[microformat]) {\\n+        Microformats.list.push(microformat);\\n+      }\\n+      Microformats[microformat] = microformatDefinition;\\n+      microformatDefinition.mfObject.prototype.debug =\\n+        function(microformatObject) {\\n+          return Microformats.debug(microformatObject)\\n+        };\\n+    }\\n+  },\\n+  /* All parser specific functions are contained in this object */\\n+  parser: {\\n+    /**\\n+     * Uses the microformat patterns to decide what the correct text for a\\n+     * given microformat property is. This includes looking at things like\\n+     * abbr, img/alt, area/alt and value excerpting.\\n+     *\\n+     * @param  propnode   The DOMNode to check\\n+     * @param  parentnode The parent node of the property. If it is a subproperty,\\n+     *                    this is the parent property node. If it is not, this is the\\n+     *                    microformat node.\\n+     & @param  datatype   HTML/text - whether to use innerHTML or innerText - defaults to text\\n+     * @return A string with the value of the property\\n+     */\\n+    defaultGetter: function(propnode, parentnode, datatype) {\\n+      if (((((propnode.localName.toLowerCase() == \\\"abbr\\\") || (propnode.localName.toLowerCase() == \\\"html:abbr\\\")) && !propnode.namespaceURI) || \\n+         ((propnode.localName.toLowerCase() == \\\"abbr\\\") && (propnode.namespaceURI == \\\"http://www.w3.org/1999/xhtml\\\"))) && (propnode.getAttribute(\\\"title\\\"))) {\\n+        return propnode.getAttribute(\\\"title\\\");\\n+      } else if ((propnode.nodeName.toLowerCase() == \\\"img\\\") && (propnode.getAttribute(\\\"alt\\\"))) {\\n+        return propnode.getAttribute(\\\"alt\\\");\\n+      } else if ((propnode.nodeName.toLowerCase() == \\\"area\\\") && (propnode.getAttribute(\\\"alt\\\"))) {\\n+        return propnode.getAttribute(\\\"alt\\\");\\n+      } else if ((propnode.nodeName.toLowerCase() == \\\"textarea\\\") ||\\n+                 (propnode.nodeName.toLowerCase() == \\\"select\\\") ||\\n+                 (propnode.nodeName.toLowerCase() == \\\"input\\\")) {\\n+        return propnode.value;\\n+      } else {\\n+        var values = Microformats.getElementsByClassName(propnode, \\\"value\\\");\\n+        if (values.length > 0) {\\n+          var value = \\\"\\\";\\n+          for (let j=0;j<values.length;j++) {\\n+            value += Microformats.parser.defaultGetter(values[j], propnode, datatype);\\n+          }\\n+          return value;\\n+        } else {\\n+          var s;\\n+          if (datatype == \\\"HTML\\\") {\\n+            s = propnode.innerHTML;\\n+          } else {\\n+            if (propnode.innerText) {\\n+              s = propnode.innerText;\\n+            } else {\\n+              s = propnode.textContent;\\n+            }\\n+          }\\n+          /* If we are processing a value node, don't remove whitespace */\\n+          if (!Microformats.matchClass(propnode, \\\"value\\\")) {\\n+            /* Remove new lines, carriage returns and tabs */\\n+            s\\t= s.replace(/[\\\\n\\\\r\\\\t]/gi, ' ');\\n+            /* Replace any double spaces with single spaces */\\n+            s\\t= s.replace(/\\\\s{2,}/gi, ' ');\\n+            /* Remove any double spaces that are left */\\n+            s\\t= s.replace(/\\\\s{2,}/gi, '');\\n+            /* Remove any spaces at the beginning */\\n+            s\\t= s.replace(/^\\\\s+/, '');\\n+            /* Remove any spaces at the end */\\n+            s\\t= s.replace(/\\\\s+$/, '');\\n+          }\\n+          if (s.length > 0) {\\n+            return s;\\n+          }\\n+        }\\n+      }\\n+    },\\n+    /**\\n+     * Used to specifically retrieve a date in a microformat node.\\n+     * After getting the default text, it normalizes it to an ISO8601 date.\\n+     *\\n+     * @param  propnode   The DOMNode to check\\n+     * @param  parentnode The parent node of the property. If it is a subproperty,\\n+     *                    this is the parent property node. If it is not, this is the\\n+     *                    microformat node.\\n+     * @return A string with the normalized date.\\n+     */\\n+    dateTimeGetter: function(propnode, parentnode) {\\n+      var date = Microformats.parser.textGetter(propnode, parentnode);\\n+      if (date) {\\n+        return Microformats.parser.normalizeISO8601(date);\\n+      }\\n+    },\\n+    /**\\n+     * Used to specifically retrieve a URI in a microformat node. This includes\\n+     * looking at an href/img/object/area to get the fully qualified URI.\\n+     *\\n+     * @param  propnode   The DOMNode to check\\n+     * @param  parentnode The parent node of the property. If it is a subproperty,\\n+     *                    this is the parent property node. If it is not, this is the\\n+     *                    microformat node.\\n+     * @return A string with the fully qualified URI.\\n+     */\\n+    uriGetter: function(propnode, parentnode) {\\n+      var pairs = {\\\"a\\\":\\\"href\\\", \\\"img\\\":\\\"src\\\", \\\"object\\\":\\\"data\\\", \\\"area\\\":\\\"href\\\"};\\n+      var name = propnode.nodeName.toLowerCase();\\n+      if (pairs.hasOwnProperty(name)) {\\n+        return propnode[pairs[name]];\\n+      }\\n+      return Microformats.parser.textGetter(propnode, parentnode);\\n+    },\\n+    /**\\n+     * Used to specifically retrieve a telephone number in a microformat node.\\n+     * Basically this is to handle the face that telephone numbers use value\\n+     * as the name as one of their subproperties, but value is also used for\\n+     * value excerpting (http://microformats.org/wiki/hcard#Value_excerpting)\\n+     \\n+     * @param  propnode   The DOMNode to check\\n+     * @param  parentnode The parent node of the property. If it is a subproperty,\\n+     *                    this is the parent property node. If it is not, this is the\\n+     *                    microformat node.\\n+     * @return A string with the telephone number\\n+     */\\n+    telGetter: function(propnode, parentnode) {\\n+      /* Special case - if this node is a value, use the parent node to get all the values */\\n+      if (Microformats.matchClass(propnode, \\\"value\\\")) {\\n+        return Microformats.parser.textGetter(parentnode, parentnode);\\n+      } else {\\n+        return Microformats.parser.textGetter(propnode, parentnode);\\n+      }\\n+    },\\n+    /**\\n+     * Used to specifically retrieve an email address in a microformat node.\\n+     * This includes at an href, as well as removing subject if specified and\\n+     * the mailto prefix.\\n+     *\\n+     * @param  propnode   The DOMNode to check\\n+     * @param  parentnode The parent node of the property. If it is a subproperty,\\n+     *                    this is the parent property node. If it is not, this is the\\n+     *                    microformat node.\\n+     * @return A string with the email address.\\n+     */\\n+    emailGetter: function(propnode, parentnode) {\\n+      if ((propnode.nodeName.toLowerCase() == \\\"a\\\") || (propnode.nodeName.toLowerCase() == \\\"area\\\")) {\\n+        var mailto = propnode.href;\\n+        /* IO Service won't fully parse mailto, so we do it manually */\\n+        if (mailto.indexOf('?') > 0) {\\n+          return unescape(mailto.substring(\\\"mailto:\\\".length, mailto.indexOf('?')));\\n+        } else {\\n+          return unescape(mailto.substring(\\\"mailto:\\\".length));\\n+        }\\n+      } else {\\n+        /* Special case - if this node is a value, use the parent node to get all the values */\\n+        /* If this case gets executed, per the value design pattern, the result */\\n+        /* will be the EXACT email address with no extra parsing required */\\n+        if (Microformats.matchClass(propnode, \\\"value\\\")) {\\n+          return Microformats.parser.textGetter(parentnode, parentnode);\\n+        } else {\\n+          return Microformats.parser.textGetter(propnode, parentnode);\\n+        }\\n+      }\\n+    },\\n+    /**\\n+     * Used when a caller needs the text inside a particular DOM node.\\n+     * It calls defaultGetter to handle all the subtleties of getting\\n+     * text from a microformat.\\n+     *\\n+     * @param  propnode   The DOMNode to check\\n+     * @param  parentnode The parent node of the property. If it is a subproperty,\\n+     *                    this is the parent property node. If it is not, this is the\\n+     *                    microformat node.\\n+     * @return A string with just the text including all tags.\\n+     */\\n+    textGetter: function(propnode, parentnode) {\\n+      return Microformats.parser.defaultGetter(propnode, parentnode, \\\"text\\\");\\n+    },\\n+    /**\\n+     * Used when a caller needs the HTML inside a particular DOM node.\\n+     *\\n+     * @param  propnode   The DOMNode to check\\n+     * @param  parentnode The parent node of the property. If it is a subproperty,\\n+     *                    this is the parent property node. If it is not, this is the\\n+     *                    microformat node.\\n+     * @return An object with function to access the string and the HTML\\n+     *         Note that because this is an object, you can't do string functions\\n+     *         so i faked a couple string functions that might be useful.\\n+     */\\n+    HTMLGetter: function(propnode, parentnode) {\\n+      return {\\n+        toString: function () {\\n+          return Microformats.parser.defaultGetter(propnode, parentnode, \\\"text\\\");\\n+        },\\n+        toHTML: function () {\\n+          return Microformats.parser.defaultGetter(propnode, parentnode, \\\"HTML\\\"); \\n+        },\\n+        replace: function (a, b) {\\n+          return this.toString().replace(a,b);\\n+        },\\n+        match: function (a) {\\n+          return this.toString().match(a);\\n+        }\\n+      };\\n+    },\\n+    /**\\n+     * Internal parser API used to determine which getter to call based on the\\n+     * datatype specified in the microformat definition.\\n+     *\\n+     * @param  prop       The microformat property in the definition\\n+     * @param  propnode   The DOMNode to check\\n+     * @param  parentnode The parent node of the property. If it is a subproperty,\\n+     *                    this is the parent property node. If it is not, this is the\\n+     *                    microformat node.\\n+     * @return A string with the property value.\\n+     */\\n+    datatypeHelper: function(prop, node, parentnode) {\\n+      var result;\\n+      switch (prop.datatype) {\\n+        case \\\"dateTime\\\":\\n+          result = Microformats.parser.dateTimeGetter(node, parentnode);\\n+          break;\\n+        case \\\"anyURI\\\":\\n+          result = Microformats.parser.uriGetter(node, parentnode);\\n+          break;\\n+        case \\\"email\\\":\\n+          result = Microformats.parser.emailGetter(node, parentnode);\\n+          break;\\n+        case \\\"tel\\\":\\n+          result = Microformats.parser.telGetter(node, parentnode);\\n+          break;\\n+        case \\\"HTML\\\":\\n+          result = Microformats.parser.HTMLGetter(node, parentnode);\\n+          break;\\n+        case \\\"float\\\":\\n+          result = parseFloat(Microformats.parser.textGetter(node, parentnode));\\n+          break;\\n+        case \\\"custom\\\":\\n+          result = prop.customGetter(node, parentnode);\\n+          break;\\n+        case \\\"microformat\\\":\\n+          try {\\n+            result = new Microformats[prop.microformat].mfObject(node);\\n+          } catch (ex) {\\n+            /* We can swallow this exception. If the creation of the */\\n+            /* mf object fails, then the node isn't a microformat */\\n+          }\\n+          if (result) {\\n+            if (prop.microformat_property) {\\n+              result = result[prop.microformat_property];\\n+            }\\n+            break;\\n+          }\\n+        default:\\n+          result = Microformats.parser.textGetter(node, parentnode);\\n+          if ((prop.implied) && (result)) {\\n+            var temp = result;\\n+            result = {};\\n+            result[prop.implied] = temp;\\n+          }\\n+          break;\\n+      }\\n+      if (result && prop.types) {\\n+        var validType = false;\\n+        for (let type in prop.types) {\\n+          if (result.toLowerCase() == prop.types[type]) {\\n+            validType = true;\\n+            break;\\n+          }\\n+        }\\n+        if (!validType) {\\n+          return;\\n+        }\\n+      }\\n+      return result;\\n+    },\\n+    newMicroformat: function(object, in_node, microformat) {\\n+      /* check to see if we are even valid */\\n+      if (!Microformats[microformat]) {\\n+        throw(\\\"Invalid microformat - \\\" + microformat);\\n+      }\\n+      if (in_node.ownerDocument) {\\n+        if (Microformats[microformat].attributeName) {\\n+          if (!(in_node.getAttribute(Microformats[microformat].attributeName))) {\\n+            throw(\\\"Node is not a microformat (\\\" + microformat + \\\")\\\");\\n+          }\\n+        } else {\\n+          if (!Microformats.matchClass(in_node, Microformats[microformat].className)) {\\n+            throw(\\\"Node is not a microformat (\\\" + microformat + \\\")\\\");\\n+          }\\n+        }\\n+      }\\n+      var node = in_node;\\n+      if ((Microformats[microformat].className) && in_node.ownerDocument) {\\n+        node = Microformats.parser.preProcessMicroformat(in_node);\\n+      }\\n+\\n+      for (let i in Microformats[microformat].properties) {\\n+        object.__defineGetter__(i, Microformats.parser.getMicroformatPropertyGenerator(node, microformat, i, object));\\n+      }\\n+      \\n+      /* The node in the object should be the original node */\\n+      object.node = in_node;\\n+      /* we also store the node that has been \\\"resolved\\\" */\\n+      object.resolvedNode = node; \\n+      object.semanticType = microformat;\\n+    },\\n+    getMicroformatPropertyGenerator: function getMicroformatPropertyGenerator(node, name, property, microformat)\\n+    {\\n+      return function() {\\n+        var result = Microformats.parser.getMicroformatProperty(node, name, property);\\n+//        delete microformat[property];\\n+//        microformat[property] = result; \\n+        return result;\\n+      };\\n+    },\\n+    getPropertyInternal: function getPropertyInternal(propnode, parentnode, propobj, propname, mfnode) {\\n+      var result;\\n+      if (propobj.subproperties) {\\n+        for (let subpropname in propobj.subproperties) {\\n+          var subpropnodes;\\n+          var subpropobj = propobj.subproperties[subpropname];\\n+          if (subpropobj.rel == true) {\\n+            subpropnodes = Microformats.getElementsByAttribute(propnode, \\\"rel\\\", subpropname);\\n+          } else {\\n+            subpropnodes = Microformats.getElementsByClassName(propnode, subpropname);\\n+          }\\n+          var resultArray = [];\\n+          var subresult;\\n+          for (let i = 0; i < subpropnodes.length; i++) {\\n+            subresult = Microformats.parser.getPropertyInternal(subpropnodes[i], propnode,\\n+                                                                subpropobj,\\n+                                                                subpropname, mfnode);\\n+            if (subresult) {\\n+              resultArray.push(subresult);\\n+              /* If we're not a plural property, don't bother getting more */\\n+              if (!subpropobj.plural) {\\n+                break;\\n+              }\\n+            }\\n+          }\\n+          if (resultArray.length == 0) {\\n+            subresult = Microformats.parser.getPropertyInternal(propnode, null,\\n+                                                                subpropobj,\\n+                                                                subpropname, mfnode);\\n+            if (subresult) {\\n+              resultArray.push(subresult);\\n+            }\\n+          }\\n+          if (resultArray.length > 0) {\\n+            result = result || {};\\n+            if (subpropobj.plural) {\\n+              result[subpropname] = resultArray;\\n+            } else {\\n+              result[subpropname] = resultArray[0];\\n+            }\\n+          }\\n+        }\\n+      }\\n+      if (!parentnode || (!result && propobj.subproperties)) {\\n+        if (propobj.virtual) {\\n+          if (propobj.virtualGetter) {\\n+            result = propobj.virtualGetter(mfnode || propnode);\\n+          } else {\\n+            result = Microformats.parser.datatypeHelper(propobj, propnode);\\n+          }\\n+        } else if (propobj.implied) {\\n+          result = Microformats.parser.datatypeHelper(propobj, propnode);\\n+        }\\n+      } else if (!result) {\\n+        result = Microformats.parser.datatypeHelper(propobj, propnode, parentnode);\\n+      }\\n+      return result;\\n+    },\\n+    getMicroformatProperty: function getMicroformatProperty(in_mfnode, mfname, propname) {\\n+      var mfnode = in_mfnode;\\n+      /* If the node has not been preprocessed, the requested microformat */\\n+      /* is a class based microformat and the passed in node is not the */\\n+      /* entire document, preprocess it. Preprocessing the node involves */\\n+      /* creating a duplicate of the node and taking care of things like */\\n+      /* the include and header design patterns */\\n+      if (!in_mfnode.origNode && Microformats[mfname].className && in_mfnode.ownerDocument) {\\n+        mfnode = Microformats.parser.preProcessMicroformat(in_mfnode);\\n+      }\\n+      /* propobj is the corresponding property object in the microformat */\\n+      var propobj;\\n+      /* If there is a corresponding property in the microformat, use it */\\n+      if (Microformats[mfname].properties[propname]) {\\n+        propobj = Microformats[mfname].properties[propname];\\n+      } else {\\n+        /* If we didn't get a property, bail */\\n+        return;\\n+      }\\n+      /* Query the correct set of nodes (rel or class) based on the setting */\\n+      /* in the property */\\n+      var propnodes;\\n+      if (propobj.rel == true) {\\n+        propnodes = Microformats.getElementsByAttribute(mfnode, \\\"rel\\\", propname);\\n+      } else {\\n+        propnodes = Microformats.getElementsByClassName(mfnode, propname);\\n+      }\\n+      if (propnodes.length > 0) {\\n+        var resultArray = [];\\n+        for (let i = 0; i < propnodes.length; i++) {\\n+          var subresult = Microformats.parser.getPropertyInternal(propnodes[i],\\n+                                                                  mfnode,\\n+                                                                  propobj,\\n+                                                                  propname);\\n+          if (subresult) {\\n+            resultArray.push(subresult);\\n+            /* If we're not a plural property, don't bother getting more */\\n+            if (!propobj.plural) {\\n+              return resultArray[0];\\n+            }\\n+          }\\n+        }\\n+        if (resultArray.length > 0) {\\n+          return resultArray;\\n+        }\\n+      } else {\\n+        /* If we didn't find any class nodes, check to see if this property */\\n+        /* is virtual and if so, call getPropertyInternal again */\\n+        if (propobj.virtual) {\\n+          return Microformats.parser.getPropertyInternal(mfnode, null,\\n+                                                         propobj, propname);\\n+        }\\n+      }\\n+      return;\\n+    },\\n+    /**\\n+     * Internal parser API used to resolve includes and headers. Includes are\\n+     * resolved by simply cloning the node and replacing it in a clone of the\\n+     * original DOM node. Headers are resolved by creating a span and then copying\\n+     * the innerHTML and the class name.\\n+     *\\n+     * @param  in_mfnode The node to preProcess.\\n+     * @return If the node had includes or headers, a cloned node otherwise\\n+     *         the original node. You can check to see if the node was cloned\\n+     *         by looking for .origNode in the new node.\\n+     */\\n+    preProcessMicroformat: function preProcessMicroformat(in_mfnode) {\\n+      var mfnode;\\n+      var includes = Microformats.getElementsByClassName(in_mfnode, \\\"include\\\");\\n+      if ((includes.length > 0) || ((in_mfnode.nodeName.toLowerCase() == \\\"td\\\") && (in_mfnode.getAttribute(\\\"headers\\\")))) {\\n+        mfnode = in_mfnode.cloneNode(true);\\n+        mfnode.origNode = in_mfnode;\\n+        if (includes.length > 0) {\\n+          includes = Microformats.getElementsByClassName(mfnode, \\\"include\\\");\\n+          var includeId;\\n+          var include_length = includes.length;\\n+          for (let i = include_length -1; i >= 0; i--) {\\n+            if (includes[i].nodeName.toLowerCase() == \\\"a\\\") {\\n+              includeId = includes[i].getAttribute(\\\"href\\\").substr(1);\\n+            }\\n+            if (includes[i].nodeName.toLowerCase() == \\\"object\\\") {\\n+              includeId = includes[i].getAttribute(\\\"data\\\").substr(1);\\n+            }\\n+            includes[i].parentNode.replaceChild(in_mfnode.ownerDocument.getElementById(includeId).cloneNode(true), includes[i]);\\n+          }\\n+        } else {\\n+          var headers = in_mfnode.getAttribute(\\\"headers\\\").split(\\\" \\\");\\n+          for (let i = 0; i < headers.length; i++) {\\n+            var tempNode = in_mfnode.ownerDocument.createElement(\\\"span\\\");\\n+            var headerNode = in_mfnode.ownerDocument.getElementById(headers[i]);\\n+            tempNode.innerHTML = headerNode.innerHTML;\\n+            tempNode.className = headerNode.className;\\n+            mfnode.appendChild(tempNode);\\n+          }\\n+        }\\n+      } else {\\n+        mfnode = in_mfnode;\\n+      }\\n+      return mfnode;\\n+    },\\n+    validate: function validate(mfnode, mfname, error) {\\n+      if (Microformats[mfname].validate) {\\n+        return Microformats[mfname].validate(mfnode, error);\\n+      } else {\\n+        var mfobject = new Microformats[mfname].mfObject(mfnode);\\n+        if (Microformats[mfname].required) {\\n+          error.message = \\\"\\\";\\n+          for (let i=0;i<Microformats[mfname].required.length;i++) {\\n+            if (!mfobject[Microformats[mfname].required[i]]) {\\n+              error.message += \\\"Required property \\\" + Microformats[mfname].required[i] + \\\" not specified\\\\n\\\";\\n+            }\\n+          }\\n+          if (error.message.length > 0) {\\n+            return false;\\n+          }\\n+        } else {\\n+          if (!mfobject.toString()) {\\n+            error.message = \\\"Unable to create microformat\\\";\\n+            return false;\\n+          }\\n+        }\\n+        return true;\\n+      }\\n+    },\\n+    /* This function normalizes an ISO8601 date by adding punctuation and */\\n+    /* ensuring that hours and seconds have values */\\n+    normalizeISO8601: function normalizeISO8601(string)\\n+    {\\n+      var dateArray = string.match(/(\\\\d\\\\d\\\\d\\\\d)(?:-?(\\\\d\\\\d)(?:-?(\\\\d\\\\d)(?:[T ](\\\\d\\\\d)(?::?(\\\\d\\\\d)(?::?(\\\\d\\\\d)(?:\\\\.(\\\\d+))?)?)?(?:([-+Z])(?:(\\\\d\\\\d)(?::?(\\\\d\\\\d))?)?)?)?)?)?/);\\n+  \\n+      var dateString;\\n+      var tzOffset = 0;\\n+      if (!dateArray) {\\n+        return;\\n+      }\\n+      if (dateArray[1]) {\\n+        dateString = dateArray[1];\\n+        if (dateArray[2]) {\\n+          dateString += \\\"-\\\" + dateArray[2];\\n+          if (dateArray[3]) {\\n+            dateString += \\\"-\\\" + dateArray[3];\\n+            if (dateArray[4]) {\\n+              dateString += \\\"T\\\" + dateArray[4];\\n+              if (dateArray[5]) {\\n+                dateString += \\\":\\\" + dateArray[5];\\n+              } else {\\n+                dateString += \\\":\\\" + \\\"00\\\";\\n+              }\\n+              if (dateArray[6]) {\\n+                dateString += \\\":\\\" + dateArray[6];\\n+              } else {\\n+                dateString += \\\":\\\" + \\\"00\\\";\\n+              }\\n+              if (dateArray[7]) {\\n+                dateString += \\\".\\\" + dateArray[7];\\n+              }\\n+              if (dateArray[8]) {\\n+                dateString += dateArray[8];\\n+                if ((dateArray[8] == \\\"+\\\") || (dateArray[8] == \\\"-\\\")) {\\n+                  if (dateArray[9]) {\\n+                    dateString += dateArray[9];\\n+                    if (dateArray[10]) {\\n+                      dateString += dateArray[10];\\n+                    }\\n+                  }\\n+                }\\n+              }\\n+            }\\n+          }\\n+        }\\n+      }\\n+      return dateString;\\n+    }\\n+  },\\n+  /**\\n+   * Converts an ISO8601 date into a JavaScript date object, honoring the TZ\\n+   * offset and Z if present to convert the date to local time\\n+   * NOTE: I'm using an extra parameter on the date object for this function.\\n+   * I set date.time to true if there is a date, otherwise date.time is false.\\n+   * \\n+   * @param  string ISO8601 formatted date\\n+   * @return JavaScript date object that represents the ISO date. \\n+   */\\n+  dateFromISO8601: function dateFromISO8601(string) {\\n+    var dateArray = string.match(/(\\\\d\\\\d\\\\d\\\\d)(?:-?(\\\\d\\\\d)(?:-?(\\\\d\\\\d)(?:[T ](\\\\d\\\\d)(?::?(\\\\d\\\\d)(?::?(\\\\d\\\\d)(?:\\\\.(\\\\d+))?)?)?(?:([-+Z])(?:(\\\\d\\\\d)(?::?(\\\\d\\\\d))?)?)?)?)?)?/);\\n+  \\n+    var date = new Date(dateArray[1], 0, 1);\\n+    date.time = false;\\n+\\n+    if (dateArray[2]) {\\n+      date.setMonth(dateArray[2] - 1);\\n+    }\\n+    if (dateArray[3]) {\\n+      date.setDate(dateArray[3]);\\n+    }\\n+    if (dateArray[4]) {\\n+      date.setHours(dateArray[4]);\\n+      date.time = true;\\n+      if (dateArray[5]) {\\n+        date.setMinutes(dateArray[5]);\\n+        if (dateArray[6]) {\\n+          date.setSeconds(dateArray[6]);\\n+          if (dateArray[7]) {\\n+            date.setMilliseconds(Number(\\\"0.\\\" + dateArray[7]) * 1000);\\n+          }\\n+        }\\n+      }\\n+    }\\n+    if (dateArray[8]) {\\n+      if (dateArray[8] == \\\"-\\\") {\\n+        if (dateArray[9] && dateArray[10]) {\\n+          date.setHours(date.getHours() + parseInt(dateArray[9], 10));\\n+          date.setMinutes(date.getMinutes() + parseInt(dateArray[10], 10));\\n+        }\\n+      } else if (dateArray[8] == \\\"+\\\") {\\n+        if (dateArray[9] && dateArray[10]) {\\n+          date.setHours(date.getHours() - parseInt(dateArray[9], 10));\\n+          date.setMinutes(date.getMinutes() - parseInt(dateArray[10], 10));\\n+        }\\n+      }\\n+      /* at this point we have the time in gmt */\\n+      /* convert to local if we had a Z - or + */\\n+      if (dateArray[8]) {\\n+        var tzOffset = date.getTimezoneOffset();\\n+        if (tzOffset < 0) {\\n+          date.setMinutes(date.getMinutes() + tzOffset); \\n+        } else if (tzOffset > 0) {\\n+          date.setMinutes(date.getMinutes() - tzOffset); \\n+        }\\n+      }\\n+    }\\n+    return date;\\n+  },\\n+  /**\\n+   * Converts a Javascript date object into an ISO 8601 formatted date\\n+   * NOTE: I'm using an extra parameter on the date object for this function.\\n+   * If date.time is NOT true, this function only outputs the date.\\n+   * \\n+   * @param  date        Javascript Date object\\n+   * @param  punctuation true if the date should have -/:\\n+   * @return string with the ISO date. \\n+   */\\n+  iso8601FromDate: function iso8601FromDate(date, punctuation) {\\n+    var string = date.getFullYear().toString();\\n+    if (punctuation) {\\n+      string += \\\"-\\\";\\n+    }\\n+    string += (date.getMonth() + 1).toString().replace(/\\\\b(\\\\d)\\\\b/g, '0$1');\\n+    if (punctuation) {\\n+      string += \\\"-\\\";\\n+    }\\n+    string += date.getDate().toString().replace(/\\\\b(\\\\d)\\\\b/g, '0$1');\\n+    if (date.time) {\\n+      string += \\\"T\\\";\\n+      string += date.getHours().toString().replace(/\\\\b(\\\\d)\\\\b/g, '0$1');\\n+      if (punctuation) {\\n+        string += \\\":\\\";\\n+      }\\n+      string += date.getMinutes().toString().replace(/\\\\b(\\\\d)\\\\b/g, '0$1');\\n+      if (punctuation) {\\n+        string += \\\":\\\";\\n+      }\\n+      string += date.getSeconds().toString().replace(/\\\\b(\\\\d)\\\\b/g, '0$1');\\n+      if (date.getMilliseconds() > 0) {\\n+        if (punctuation) {\\n+          string += \\\".\\\";\\n+        }\\n+        string += date.getMilliseconds().toString();\\n+      }\\n+    }\\n+    return string;\\n+  },\\n+  simpleEscape: function simpleEscape(s)\\n+  {\\n+    s = s.replace(/\\\\&/g, '%26');\\n+    s = s.replace(/\\\\#/g, '%23');\\n+    s = s.replace(/\\\\+/g, '%2B');\\n+    s = s.replace(/\\\\-/g, '%2D');\\n+    s = s.replace(/\\\\=/g, '%3D');\\n+    s = s.replace(/\\\\'/g, '%27');\\n+    s = s.replace(/\\\\,/g, '%2C');\\n+//    s = s.replace(/\\\\r/g, '%0D');\\n+//    s = s.replace(/\\\\n/g, '%0A');\\n+    s = s.replace(/ /g, '+');\\n+    return s;\\n+  },\\n+  /**\\n+   * Not intended for external consumption. Microformat implementations might use it.\\n+   *\\n+   * Retrieve elements matching all classes listed in a space-separated string.\\n+   * I had to implement my own because I need an Array, not an nsIDomNodeList\\n+   * \\n+   * @param  rootElement      The DOM element at which to start searching (optional)\\n+   * @param  className        A space separated list of classenames\\n+   * @return microformatNodes An array of DOM Nodes, each representing a\\n+                              microformat in the document.\\n+   */\\n+  getElementsByClassName: function getElementsByClassName(rootNode, className)\\n+  {\\n+    var returnElements = [];\\n+\\n+    if ((rootNode.ownerDocument || rootNode).getElementsByClassName) {\\n+    /* Firefox 3 - native getElementsByClassName */\\n+      var col = rootNode.getElementsByClassName(className);\\n+      for (let i = 0; i < col.length; i++) {\\n+        returnElements[i] = col[i];\\n+      }\\n+    } else if ((rootNode.ownerDocument || rootNode).evaluate) {\\n+    /* Firefox 2 and below - XPath */\\n+      var xpathExpression;\\n+      xpathExpression = \\\".//*[contains(concat(' ', @class, ' '), ' \\\" + className + \\\" ')]\\\";\\n+      var xpathResult = (rootNode.ownerDocument || rootNode).evaluate(xpathExpression, rootNode, null, 0, null);\\n+\\n+      var node;\\n+      while (node = xpathResult.iterateNext()) {\\n+        returnElements.push(node);\\n+      }\\n+    } else {\\n+    /* Slow fallback for testing */\\n+      className = className.replace(/\\\\-/g, \\\"\\\\\\\\-\\\");\\n+      var elements = rootNode.getElementsByTagName(\\\"*\\\");\\n+      for (let i=0;i<elements.length;i++) {\\n+        if (elements[i].className.match(\\\"(^|\\\\\\\\s)\\\" + className + \\\"(\\\\\\\\s|$)\\\")) {\\n+          returnElements.push(elements[i]);\\n+        }\\n+      }\\n+    }\\n+    return returnElements;\\n+  },\\n+  /**\\n+   * Not intended for external consumption. Microformat implementations might use it.\\n+   *\\n+   * Retrieve elements matching an attribute and an attribute list in a space-separated string.\\n+   * \\n+   * @param  rootElement      The DOM element at which to start searching (optional)\\n+   * @param  atributeName     The attribute name to match against\\n+   * @param  attributeValues  A space separated list of attribute values\\n+   * @return microformatNodes An array of DOM Nodes, each representing a\\n+                              microformat in the document.\\n+   */\\n+  getElementsByAttribute: function getElementsByAttribute(rootNode, attributeName, attributeValues)\\n+  {\\n+    var attributeList = attributeValues.split(\\\" \\\");\\n+\\n+    var returnElements = [];\\n+\\n+    if ((rootNode.ownerDocument || rootNode).evaluate) {\\n+    /* Firefox 3 and below - XPath */\\n+      /* Create an XPath expression based on the attribute list */\\n+      var xpathExpression = \\\".//*[\\\";\\n+      for (let i = 0; i < attributeList.length; i++) {\\n+        if (i != 0) {\\n+          xpathExpression += \\\" or \\\";\\n+        }\\n+        xpathExpression += \\\"contains(concat(' ', @\\\" + attributeName + \\\", ' '), ' \\\" + attributeList[i] + \\\" ')\\\";\\n+      }\\n+      xpathExpression += \\\"]\\\"; \\n+\\n+      var xpathResult = (rootNode.ownerDocument || rootNode).evaluate(xpathExpression, rootNode, null, 0, null);\\n+\\n+      var node;\\n+      while (node = xpathResult.iterateNext()) {\\n+        returnElements.push(node);\\n+      }\\n+    } else {\\n+    /* Need Slow fallback for testing */\\n+    }\\n+    return returnElements;\\n+  },\\n+  matchClass: function matchClass(node, className) {\\n+    var classValue = node.getAttribute(\\\"class\\\");\\n+    return (classValue && classValue.match(\\\"(^|\\\\\\\\s)\\\" + className + \\\"(\\\\\\\\s|$)\\\"));\\n+  }\\n+};\\n+\\n+/* MICROFORMAT DEFINITIONS BEGIN HERE */\\n+\\n+function adr(node) {\\n+  if (node) {\\n+    Microformats.parser.newMicroformat(this, node, \\\"adr\\\");\\n+  }\\n+}\\n+\\n+adr.prototype.toString = function() {\\n+  var address_text = \\\"\\\";\\n+  var start_parens = false;\\n+  if (this[\\\"street-address\\\"]) {\\n+    address_text += this[\\\"street-address\\\"][0];\\n+    address_text += \\\" \\\";\\n+  }\\n+  if (this[\\\"locality\\\"]) {\\n+    if (this[\\\"street-address\\\"]) {\\n+      address_text += \\\"(\\\";\\n+      start_parens = true;\\n+    }\\n+    address_text += this[\\\"locality\\\"];\\n+  }\\n+  if (this[\\\"region\\\"]) {\\n+    if ((this[\\\"street-address\\\"]) && (!start_parens)) {\\n+      address_text += \\\"(\\\";\\n+      start_parens = true;\\n+    } else if (this[\\\"locality\\\"]) {\\n+      address_text += \\\", \\\";\\n+    }\\n+    address_text += this[\\\"region\\\"];\\n+  }\\n+  if (this[\\\"country-name\\\"]) {\\n+    if ((this[\\\"street-address\\\"]) && (!start_parens)) {\\n+      address_text += \\\"(\\\";\\n+      start_parens = true;\\n+      address_text += this[\\\"country-name\\\"];\\n+    } else if ((!this[\\\"locality\\\"]) && (!this[\\\"region\\\"])) {\\n+      address_text += this[\\\"country-name\\\"];\\n+    } else if (((!this[\\\"locality\\\"]) && (this[\\\"region\\\"])) || ((this[\\\"locality\\\"]) && (!this[\\\"region\\\"]))) {\\n+      address_text += \\\", \\\";\\n+      address_text += this[\\\"country-name\\\"];\\n+    }\\n+  }\\n+  if (start_parens) {\\n+    address_text += \\\")\\\";\\n+  }\\n+  return address_text;\\n+}\\n+\\n+var adr_definition = {\\n+  mfVersion: 0.8,\\n+  mfObject: adr,\\n+  className: \\\"adr\\\",\\n+  properties: {\\n+    \\\"type\\\" : {\\n+      plural: true,\\n+      types: [\\\"work\\\", \\\"home\\\", \\\"pref\\\", \\\"postal\\\", \\\"dom\\\", \\\"intl\\\", \\\"parcel\\\"]\\n+    },\\n+    \\\"post-office-box\\\" : {\\n+    },\\n+    \\\"street-address\\\" : {\\n+      plural: true\\n+    },\\n+    \\\"extended-address\\\" : {\\n+    },\\n+    \\\"locality\\\" : {\\n+    },\\n+    \\\"region\\\" : {\\n+    },\\n+    \\\"postal-code\\\" : {\\n+    },\\n+    \\\"country-name\\\" : {\\n+    }\\n+  }\\n+};\\n+\\n+Microformats.add(\\\"adr\\\", adr_definition);\\n+\\n+function hCard(node) {\\n+  if (node) {\\n+    Microformats.parser.newMicroformat(this, node, \\\"hCard\\\");\\n+  }\\n+}\\n+hCard.prototype.toString = function() {\\n+  if (this.resolvedNode) {\\n+    /* If this microformat has an include pattern, put the */\\n+    /* organization-name in parenthesis after the fn to differentiate */\\n+    /* them. */\\n+    var fns = Microformats.getElementsByClassName(this.node, \\\"fn\\\");\\n+    if (fns.length === 0) {\\n+      if (this.fn) {\\n+        if (this.org && this.org[0][\\\"organization-name\\\"] && (this.fn != this.org[0][\\\"organization-name\\\"])) {\\n+          return this.fn + \\\" (\\\" + this.org[0][\\\"organization-name\\\"] + \\\")\\\";\\n+        }\\n+      }\\n+    }\\n+  }\\n+  return this.fn;\\n+}\\n+\\n+var hCard_definition = {\\n+  mfVersion: 0.8,\\n+  mfObject: hCard,\\n+  className: \\\"vcard\\\",\\n+  required: [\\\"fn\\\"],\\n+  properties: {\\n+    \\\"adr\\\" : {\\n+      plural: true,\\n+      datatype: \\\"microformat\\\",\\n+      microformat: \\\"adr\\\"\\n+    },\\n+    \\\"agent\\\" : {\\n+      plural: true\\n+    },\\n+    \\\"bday\\\" : {\\n+      datatype: \\\"dateTime\\\"\\n+    },\\n+    \\\"class\\\" : {\\n+    },\\n+    \\\"category\\\" : {\\n+      plural: true,\\n+      datatype: \\\"microformat\\\",\\n+      microformat: \\\"tag\\\",\\n+      microformat_property: \\\"tag\\\"\\n+    },\\n+    \\\"email\\\" : {\\n+      subproperties: {\\n+        \\\"type\\\" : {\\n+          plural: true,\\n+          types: [\\\"internet\\\", \\\"x400\\\", \\\"pref\\\"]\\n+        },\\n+        \\\"value\\\" : {\\n+          datatype: \\\"email\\\",\\n+          virtual: true\\n+        }\\n+      },\\n+      plural: true   \\n+    },\\n+    \\\"fn\\\" : {\\n+      required: true\\n+    },\\n+    \\\"geo\\\" : {\\n+      value: \\\"geo\\\",\\n+      datatype: \\\"microformat\\\",\\n+      microformat: \\\"geo\\\"\\n+    },\\n+    \\\"key\\\" : {\\n+      plural: true\\n+    },\\n+    \\\"label\\\" : {\\n+      plural: true\\n+    },\\n+    \\\"logo\\\" : {\\n+      plural: true,\\n+      datatype: \\\"anyURI\\\"\\n+    },\\n+    \\\"mailer\\\" : {\\n+      plural: true\\n+    },\\n+    \\\"n\\\" : {\\n+      subproperties: {\\n+        \\\"honorific-prefix\\\" : {\\n+          plural: true\\n+        },\\n+        \\\"given-name\\\" : {\\n+        },\\n+        \\\"additional-name\\\" : {\\n+          plural: true\\n+        },\\n+        \\\"family-name\\\" : {\\n+        },\\n+        \\\"honorific-suffix\\\" : {\\n+          plural: true\\n+        }\\n+      },\\n+      virtual: true,\\n+      /*  Implied \\\"n\\\" Optimization */\\n+      /* http://microformats.org/wiki/hcard#Implied_.22n.22_Optimization */\\n+      virtualGetter: function(mfnode) {\\n+        var fn = Microformats.parser.getMicroformatProperty(mfnode, \\\"hCard\\\", \\\"fn\\\");\\n+        var orgs = Microformats.parser.getMicroformatProperty(mfnode, \\\"hCard\\\", \\\"org\\\");\\n+        var given_name;\\n+        var family_name;\\n+        if (fn && (!orgs || (orgs.length > 1) || (fn != orgs[0][\\\"organization-name\\\"]))) {\\n+          var fns = fn.split(\\\" \\\");\\n+          if (fns.length === 2) {\\n+            if (fns[0].charAt(fns[0].length-1) == ',') {\\n+              given_name = fns[1];\\n+              family_name = fns[0].substr(0, fns[0].length-1);\\n+            } else if (fns[1].length == 1) {\\n+              given_name = fns[1];\\n+              family_name = fns[0];\\n+            } else if ((fns[1].length == 2) && (fns[1].charAt(fns[1].length-1) == '.')) {\\n+              given_name = fns[1];\\n+              family_name = fns[0];\\n+            } else {\\n+              given_name = fns[0];\\n+              family_name = fns[1];\\n+            }\\n+            return {\\\"given-name\\\" : given_name, \\\"family-name\\\" : family_name};\\n+          }\\n+        }\\n+      }\\n+    },\\n+    \\\"nickname\\\" : {\\n+      plural: true,\\n+      virtual: true,\\n+      /* Implied \\\"nickname\\\" Optimization */\\n+      /* http://microformats.org/wiki/hcard#Implied_.22nickname.22_Optimization */\\n+      virtualGetter: function(mfnode) {\\n+        var fn = Microformats.parser.getMicroformatProperty(mfnode, \\\"hCard\\\", \\\"fn\\\");\\n+        var orgs = Microformats.parser.getMicroformatProperty(mfnode, \\\"hCard\\\", \\\"org\\\");\\n+        var given_name;\\n+        var family_name;\\n+        if (fn && (!orgs || (orgs.length) > 1 || (fn != orgs[0][\\\"organization-name\\\"]))) {\\n+          var fns = fn.split(\\\" \\\");\\n+          if (fns.length === 1) {\\n+            return [fns[0]];\\n+          }\\n+        }\\n+        return;\\n+      }\\n+    },\\n+    \\\"note\\\" : {\\n+      plural: true,\\n+      datatype: \\\"HTML\\\"\\n+    },\\n+    \\\"org\\\" : {\\n+      subproperties: {\\n+        \\\"organization-name\\\" : {\\n+        },\\n+        \\\"organization-unit\\\" : {\\n+          plural: true\\n+        }\\n+      },\\n+      plural: true,\\n+      implied: \\\"organization-name\\\"\\n+    },\\n+    \\\"photo\\\" : {\\n+      plural: true,\\n+      datatype: \\\"anyURI\\\"\\n+    },\\n+    \\\"rev\\\" : {\\n+      datatype: \\\"dateTime\\\"\\n+    },\\n+    \\\"role\\\" : {\\n+      plural: true\\n+    },\\n+    \\\"sequence\\\" : {\\n+    },\\n+    \\\"sort-string\\\" : {\\n+    },\\n+    \\\"sound\\\" : {\\n+      plural: true\\n+    },\\n+    \\\"title\\\" : {\\n+      plural: true\\n+    },\\n+    \\\"tel\\\" : {\\n+      subproperties: {\\n+        \\\"type\\\" : {\\n+          plural: true,\\n+          types: [\\\"msg\\\", \\\"home\\\", \\\"work\\\", \\\"pref\\\", \\\"voice\\\", \\\"fax\\\", \\\"cell\\\", \\\"video\\\", \\\"pager\\\", \\\"bbs\\\", \\\"car\\\", \\\"isdn\\\", \\\"pcs\\\"]\\n+        },\\n+        \\\"value\\\" : {\\n+          datatype: \\\"tel\\\"\\n+        }\\n+      },\\n+      plural: true,\\n+      implied: \\\"value\\\"\\n+    },\\n+    \\\"tz\\\" : {\\n+    },\\n+    \\\"uid\\\" : {\\n+      datatype: \\\"anyURI\\\"\\n+    },\\n+    \\\"url\\\" : {\\n+      plural: true,\\n+      datatype: \\\"anyURI\\\"\\n+    }\\n+  }\\n+};\\n+\\n+Microformats.add(\\\"hCard\\\", hCard_definition);\\n+\\n+function hCalendar(node) {\\n+  if (node) {\\n+    Microformats.parser.newMicroformat(this, node, \\\"hCalendar\\\");\\n+  }\\n+}\\n+hCalendar.prototype.toString = function() {\\n+  if (this.resolvedNode) {\\n+    /* If this microformat has an include pattern, put the */\\n+    /* dtstart in parenthesis after the summary to differentiate */\\n+    /* them. */\\n+    var summaries = Microformats.getElementsByClassName(this.node, \\\"summary\\\");\\n+    if (summaries.length === 0) {\\n+      if (this.summary) {\\n+        if (this.dtstart) {\\n+          return this.summary + \\\" (\\\" + Microformats.dateFromISO8601(this.dtstart).toLocaleString() + \\\")\\\";\\n+        }\\n+      }\\n+    }\\n+  }\\n+  if (this.dtstart) {\\n+    return this.summary;\\n+  }\\n+  return;\\n+}\\n+\\n+var hCalendar_definition = {\\n+  mfVersion: 0.8,\\n+  mfObject: hCalendar,\\n+  className: \\\"vevent\\\",\\n+  required: [\\\"summary\\\", \\\"dtstart\\\"],\\n+  properties: {\\n+    \\\"category\\\" : {\\n+      plural: true,\\n+      datatype: \\\"microformat\\\",\\n+      microformat: \\\"tag\\\",\\n+      microformat_property: \\\"tag\\\"\\n+    },\\n+    \\\"class\\\" : {\\n+      types: [\\\"public\\\", \\\"private\\\", \\\"confidential\\\"]\\n+    },\\n+    \\\"description\\\" : {\\n+      datatype: \\\"HTML\\\"\\n+    },\\n+    \\\"dtstart\\\" : {\\n+      datatype: \\\"dateTime\\\"\\n+    },\\n+    \\\"dtend\\\" : {\\n+      datatype: \\\"dateTime\\\"\\n+    },\\n+    \\\"dtstamp\\\" : {\\n+      datatype: \\\"dateTime\\\"\\n+    },\\n+    \\\"duration\\\" : {\\n+    },\\n+    \\\"geo\\\" : {\\n+      value: \\\"geo\\\",\\n+      datatype: \\\"microformat\\\",\\n+      microformat: \\\"geo\\\"\\n+    },\\n+    \\\"location\\\" : {\\n+      datatype: \\\"microformat\\\",\\n+      microformat: \\\"hCard\\\"\\n+    },\\n+    \\\"status\\\" : {\\n+      types: [\\\"tentative\\\", \\\"confirmed\\\", \\\"cancelled\\\"]\\n+    },\\n+    \\\"summary\\\" : {},\\n+    \\\"transp\\\" : {\\n+      types: [\\\"opaque\\\", \\\"transparent\\\"]\\n+    },\\n+    \\\"uid\\\" : {\\n+      datatype: \\\"anyURI\\\"\\n+    },\\n+    \\\"url\\\" : {\\n+      datatype: \\\"anyURI\\\"\\n+    },\\n+    \\\"last-modified\\\" : {\\n+      datatype: \\\"dateTime\\\"\\n+    },\\n+    \\\"rrule\\\" : {\\n+      subproperties: {\\n+        \\\"interval\\\" : {\\n+          virtual: true,\\n+          /* This will only be called in the virtual case */\\n+          virtualGetter: function(mfnode) {\\n+            return Microformats.hCalendar.properties.rrule.retrieve(mfnode, \\\"interval\\\");\\n+          }\\n+        },\\n+        \\\"freq\\\" : {\\n+          virtual: true,\\n+          /* This will only be called in the virtual case */\\n+          virtualGetter: function(mfnode) {\\n+            return Microformats.hCalendar.properties.rrule.retrieve(mfnode, \\\"freq\\\");\\n+          }\\n+        },\\n+        \\\"bysecond\\\" : {\\n+          virtual: true,\\n+          /* This will only be called in the virtual case */\\n+          virtualGetter: function(mfnode) {\\n+            return Microformats.hCalendar.properties.rrule.retrieve(mfnode, \\\"bysecond\\\");\\n+          }\\n+        },\\n+        \\\"byminute\\\" : {\\n+          virtual: true,\\n+          /* This will only be called in the virtual case */\\n+          virtualGetter: function(mfnode) {\\n+            return Microformats.hCalendar.properties.rrule.retrieve(mfnode, \\\"byminute\\\");\\n+          }\\n+        },\\n+        \\\"byhour\\\" : {\\n+          virtual: true,\\n+          /* This will only be called in the virtual case */\\n+          virtualGetter: function(mfnode) {\\n+            return Microformats.hCalendar.properties.rrule.retrieve(mfnode, \\\"byhour\\\");\\n+          }\\n+        },\\n+        \\\"bymonthday\\\" : {\\n+          virtual: true,\\n+          /* This will only be called in the virtual case */\\n+          virtualGetter: function(mfnode) {\\n+            return Microformats.hCalendar.properties.rrule.retrieve(mfnode, \\\"bymonthday\\\");\\n+          }\\n+        },\\n+        \\\"byyearday\\\" : {\\n+          virtual: true,\\n+          /* This will only be called in the virtual case */\\n+          virtualGetter: function(mfnode) {\\n+            return Microformats.hCalendar.properties.rrule.retrieve(mfnode, \\\"byyearday\\\");\\n+          }\\n+        },\\n+        \\\"byweekno\\\" : {\\n+          virtual: true,\\n+          /* This will only be called in the virtual case */\\n+          virtualGetter: function(mfnode) {\\n+            return Microformats.hCalendar.properties.rrule.retrieve(mfnode, \\\"byweekno\\\");\\n+          }\\n+        },\\n+        \\\"bymonth\\\" : {\\n+          virtual: true,\\n+          /* This will only be called in the virtual case */\\n+          virtualGetter: function(mfnode) {\\n+            return Microformats.hCalendar.properties.rrule.retrieve(mfnode, \\\"bymonth\\\");\\n+          }\\n+        },\\n+        \\\"byday\\\" : {\\n+          virtual: true,\\n+          /* This will only be called in the virtual case */\\n+          virtualGetter: function(mfnode) {\\n+            return Microformats.hCalendar.properties.rrule.retrieve(mfnode, \\\"byday\\\");\\n+          }\\n+        },\\n+        \\\"until\\\" : {\\n+          virtual: true,\\n+          /* This will only be called in the virtual case */\\n+          virtualGetter: function(mfnode) {\\n+            return Microformats.hCalendar.properties.rrule.retrieve(mfnode, \\\"until\\\");\\n+          }\\n+        },\\n+        \\\"count\\\" : {\\n+          virtual: true,\\n+          /* This will only be called in the virtual case */\\n+          virtualGetter: function(mfnode) {\\n+            return Microformats.hCalendar.properties.rrule.retrieve(mfnode, \\\"count\\\");\\n+          }\\n+        }\\n+      },\\n+      retrieve: function(mfnode, property) {\\n+        var value = Microformats.parser.textGetter(mfnode);\\n+        var rrule;\\n+        rrule = value.split(';');\\n+        for (let i=0; i < rrule.length; i++) {\\n+          if (rrule[i].match(property)) {\\n+            return rrule[i].split('=')[1];\\n+          }\\n+        }\\n+      }\\n+    }\\n+  }\\n+};\\n+\\n+Microformats.add(\\\"hCalendar\\\", hCalendar_definition);\\n+\\n+function geo(node) {\\n+  if (node) {\\n+    Microformats.parser.newMicroformat(this, node, \\\"geo\\\");\\n+  }\\n+}\\n+geo.prototype.toString = function() {\\n+  if (this.latitude && this.longitude) {\\n+    var s;\\n+    if ((this.node.localName.toLowerCase() != \\\"abbr\\\") && (this.node.localName.toLowerCase() == \\\"html:abbr\\\")) {\\n+      s = Microformats.parser.textGetter(this.node);\\n+    } else {\\n+      s = this.node.textContent;\\n+    }\\n+\\n+    /* FIXME - THIS IS FIREFOX SPECIFIC */\\n+    /* check if geo is contained in a vcard */\\n+    var xpathExpression = \\\"ancestor::*[contains(concat(' ', @class, ' '), ' vcard ')]\\\";\\n+    var xpathResult = this.node.ownerDocument.evaluate(xpathExpression, this.node, null,  Components.interfaces.nsIDOMXPathResult.FIRST_ORDERED_NODE_TYPE, null);\\n+    if (xpathResult.singleNodeValue) {\\n+      var hcard = new hCard(xpathResult.singleNodeValue);\\n+      if (hcard.fn) {\\n+        return hcard.fn;\\n+      }\\n+    }\\n+    /* check if geo is contained in a vevent */\\n+    xpathExpression = \\\"ancestor::*[contains(concat(' ', @class, ' '), ' vevent ')]\\\";\\n+    xpathResult = this.node.ownerDocument.evaluate(xpathExpression, this.node, null,  Components.interfaces.nsIDOMXPathResult.FIRST_ORDERED_NODE_TYPE, xpathResult);\\n+    if (xpathResult.singleNodeValue) {\\n+      var hcal = new hCalendar(xpathResult.singleNodeValue);\\n+      if (hcal.summary) {\\n+        return hcal.summary;\\n+      }\\n+    }\\n+    if (s) {\\n+      return s;\\n+    } else {\\n+      return this.latitude + \\\", \\\" + this.longitude;\\n+    }\\n+  }\\n+}\\n+\\n+var geo_definition = {\\n+  mfVersion: 0.8,\\n+  mfObject: geo,\\n+  className: \\\"geo\\\",\\n+  required: [\\\"latitude\\\",\\\"longitude\\\"],\\n+  properties: {\\n+    \\\"latitude\\\" : {\\n+      datatype: \\\"float\\\",\\n+      virtual: true,\\n+      /* This will only be called in the virtual case */\\n+      virtualGetter: function(mfnode) {\\n+        var value = Microformats.parser.textGetter(mfnode);\\n+        var latlong;\\n+        if (value.match(';')) {\\n+          latlong = value.split(';');\\n+          if (latlong[0]) {\\n+            return parseFloat(latlong[0]);\\n+          }\\n+        }\\n+      }\\n+    },\\n+    \\\"longitude\\\" : {\\n+      datatype: \\\"float\\\",\\n+      virtual: true,\\n+      /* This will only be called in the virtual case */\\n+      virtualGetter: function(mfnode) {\\n+        var value = Microformats.parser.textGetter(mfnode);\\n+        var latlong;\\n+        if (value.match(';')) {\\n+          latlong = value.split(';');\\n+          if (latlong[1]) {\\n+            return parseFloat(latlong[1]);\\n+          }\\n+        }\\n+      }\\n+    }\\n+  }\\n+};\\n+\\n+Microformats.add(\\\"geo\\\", geo_definition);\\n+\\n+function tag(node) {\\n+  if (node) {\\n+    Microformats.parser.newMicroformat(this, node, \\\"tag\\\");\\n+  }\\n+}\\n+tag.prototype.toString = function() {\\n+//  if (!this.tag) {\\n+//    return this.text;\\n+//  }\\n+  return this.tag;\\n+}\\n+\\n+var tag_definition = {\\n+  mfVersion: 0.8,\\n+  mfObject: tag,\\n+  attributeName: \\\"rel\\\",\\n+  attributeValues: \\\"tag\\\",\\n+  properties: {\\n+    \\\"tag\\\" : {\\n+      virtual: true,\\n+      virtualGetter: function(mfnode) {\\n+        if (mfnode.href) {\\n+          var ioService = Components.classes[\\\"@mozilla.org/network/io-service;1\\\"].\\n+                                     getService(Components.interfaces.nsIIOService);\\n+          var uri = ioService.newURI(mfnode.href, null, null);\\n+          var url_array = uri.path.split(\\\"/\\\");\\n+          for(let i=url_array.length-1; i > 0; i--) {\\n+            if (url_array[i] !== \\\"\\\") {\\n+              var tag\\n+              if (tag = Microformats.tag.validTagName(url_array[i].replace(/\\\\+/g, ' '))) {\\n+                try {\\n+                  return decodeURIComponent(tag);\\n+                } catch (ex) {\\n+                  return unescape(tag);\\n+                }\\n+              }\\n+            }\\n+          }\\n+        }\\n+        return null;\\n+      }\\n+    },\\n+    \\\"link\\\" : {\\n+      virtual: true,\\n+      datatype: \\\"anyURI\\\"\\n+    },\\n+    \\\"text\\\" : {\\n+      virtual: true\\n+    }\\n+  },\\n+  validTagName: function(tag)\\n+  {\\n+    var returnTag = tag;\\n+    if (tag.indexOf('?') != -1) {\\n+      if (tag.indexOf('?') === 0) {\\n+        return false;\\n+      } else {\\n+        returnTag = tag.substr(0, tag.indexOf('?'));\\n+      }\\n+    }\\n+    if (tag.indexOf('#') != -1) {\\n+      if (tag.indexOf('#') === 0) {\\n+        return false;\\n+      } else {\\n+        returnTag = tag.substr(0, tag.indexOf('#'));\\n+      }\\n+    }\\n+    if (tag.indexOf('.html') != -1) {\\n+      if (tag.indexOf('.html') == tag.length - 5) {\\n+        return false;\\n+      }\\n+    }\\n+    return returnTag;\\n+  },\\n+  validate: function(node, error) {\\n+    var tag = Microformats.parser.getMicroformatProperty(node, \\\"tag\\\", \\\"tag\\\");\\n+    if (!tag) {\\n+      if (node.href) {\\n+        var url_array = node.getAttribute(\\\"href\\\").split(\\\"/\\\");\\n+        for(let i=url_array.length-1; i > 0; i--) {\\n+          if (url_array[i] !== \\\"\\\") {\\n+            if (error) {\\n+              error.message = \\\"Invalid tag name (\\\" + url_array[i] + \\\")\\\";\\n+            }\\n+            return false;\\n+          }\\n+        }\\n+      } else {\\n+        if (error) {\\n+          error.message = \\\"No href specified on tag\\\";\\n+        }\\n+        return false;\\n+      }\\n+    }\\n+    return true;\\n+  }\\n+};\\n+\\n+Microformats.add(\\\"tag\\\", tag_definition);\\ndiff --git a/toolkit/components/microformats/tests/Makefile.in b/toolkit/components/microformats/tests/Makefile.in\\nnew file mode 100644\\nindex 0000000..8612cdf\\n--- /dev/null\\n+++ b/toolkit/components/microformats/tests/Makefile.in\\n@@ -0,0 +1,54 @@\\n+# ***** BEGIN LICENSE BLOCK *****\\n+# Version: MPL 1.1/GPL 2.0/LGPL 2.1\\n+#\\n+# The contents of this file are subject to the Mozilla Public License Version\\n+# 1.1 (the \\\"License\\\"); you may not use this file except in compliance with\\n+# the License. You may obtain a copy of the License at\\n+# http://www.mozilla.org/MPL/\\n+#\\n+# Software distributed under the License is distributed on an \\\"AS IS\\\" basis,\\n+# WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License\\n+# for the specific language governing rights and limitations under the\\n+# License.\\n+#\\n+# The Original Code is Microformats.\\n+#\\n+# The Initial Developer of the Original Code IBM Corporation.\\n+# Portions created by the Initial Developer are Copyright (C) 2007\\n+# the Initial Developer. All Rights Reserved.\\n+#\\n+# Contributor(s):\\n+#   Mike Kaply\\n+#\\n+# Alternatively, the contents of this file may be used under the terms of\\n+# either the GNU General Public License Version 2 or later (the \\\"GPL\\\"), or\\n+# the GNU Lesser General Public License Version 2.1 or later (the \\\"LGPL\\\"),\\n+# in which case the provisions of the GPL or the LGPL are applicable instead\\n+# of those above. If you wish to allow use of your version of this file only\\n+# under the terms of either the GPL or the LGPL, and not to allow others to\\n+# use your version of this file under the terms of the MPL, indicate your\\n+# decision by deleting the provisions above and replace them with the notice\\n+# and other provisions required by the GPL or the LGPL. If you do not delete\\n+# the provisions above, a recipient may use your version of this file under\\n+# the terms of any one of the MPL, the GPL or the LGPL.\\n+#\\n+# ***** END LICENSE BLOCK *****\\n+\\n+DEPTH     = ../../../..\\n+topsrcdir = @top_srcdir@\\n+srcdir    = @srcdir@\\n+VPATH     = @srcdir@\\n+\\n+include $(DEPTH)/config/autoconf.mk\\n+\\n+include $(topsrcdir)/config/rules.mk\\n+\\n+_TEST_FILES = \\\\\\n+\\t\\ttest_Microformats.html \\\\\\n+\\t\\ttest_Microformats_hCard.html \\\\\\n+\\t\\ttest_Microformats_geo.html \\\\\\n+\\t\\ttest_Microformats_hCalendar.html \\\\\\n+\\t\\t$(NULL)\\n+\\n+libs::\\t$(_TEST_FILES)\\n+\\t$(INSTALL) $^ $(DEPTH)/_tests/testing/mochitest/tests/browser/microformats/test\\ndiff --git a/toolkit/components/microformats/tests/test_Microformats.html b/toolkit/components/microformats/tests/test_Microformats.html\\nnew file mode 100644\\nindex 0000000..d7e96b3\\n--- /dev/null\\n+++ b/toolkit/components/microformats/tests/test_Microformats.html\\n@@ -0,0 +1,51 @@\\n+<html>\\n+<head>\\n+  <title>Testing Microformats.js</title>\\n+  <script type=\\\"text/javascript\\\" src=\\\"/MochiKit/MochiKit.js\\\"></script>\\n+  <script type=\\\"text/javascript\\\" src=\\\"/tests/SimpleTest/SimpleTest.js\\\"></script>\\n+  <script type=\\\"text/javascript\\\" src=\\\"/tests/SimpleTest/EventUtils.js\\\"></script>\\n+  <link rel=\\\"stylesheet\\\" type=\\\"text/css\\\" href=\\\"/tests/SimpleTest/test.css\\\"></link>\\n+</head>\\n+<body>\\n+<div id=\\\"content\\\" style=\\\"display: none\\\">\\n+  <div class=\\\"vcard\\\" id=\\\"vcard1_node\\\">\\n+   <a class=\\\"url fn\\\" href=\\\"http://tantek.com/\\\">Tantek Çelik</a>\\n+   <div id=\\\"vcard1_org\\\" class=\\\"org\\\">Technorati</div>\\n+  </div>  \\n+</div>\\n+<pre id=\\\"test\\\">\\n+<script class=\\\"testbody\\\" type=\\\"text/javascript\\\">\\n+\\n+test_Microformats();\\n+test_hCard();\\n+\\n+function test_Microformats() {\\n+  netscape.security.PrivilegeManager.enablePrivilege(\\\"UniversalXPConnect\\\");\\n+\\n+  Components.utils.import(\\\"resource://gre/modules/Microformats.js\\\");\\n+  \\n+  ok(Microformats, \\\"Check global access to Microformats\\\");\\n+  var hCards = Microformats.get(\\\"hCard\\\", document, false);\\n+  is(hCards.length, 1, \\\"Check Microformats.get\\\");\\n+  is(Microformats.count(\\\"hCard\\\", document, false), 1, \\\"Check Microformats.count\\\");\\n+  ok(Microformats.isMicroformat(document.getElementById(\\\"vcard1_node\\\")), \\\"Check isMicroformat\\\");\\n+  is(Microformats.getParent(document.getElementById(\\\"vcard1_org\\\")), document.getElementById(\\\"vcard1_node\\\"), \\\"Check getParent\\\");\\n+  is(Microformats.getNamesFromNode(document.getElementById(\\\"vcard1_node\\\")), \\\"hCard\\\", \\\"Check getNamesFromNode\\\");\\n+  \\n+}\\n+\\n+function test_hCard() {\\n+  netscape.security.PrivilegeManager.enablePrivilege(\\\"UniversalXPConnect\\\");\\n+\\n+  Components.utils.import(\\\"resource://gre/modules/Microformats.js\\\");\\n+  \\n+  var hCards = Microformats.get(\\\"hCard\\\", document, false); \\n+  \\n+  is(hCards[0].fn, \\\"Tantek Çelik\\\", \\\"Check for fn on test vcard\\\");\\n+  is(hCards[0].url, \\\"http://tantek.com/\\\", \\\"Check for url on test vcard\\\");\\n+}\\n+\\n+</script>\\n+</pre>\\n+</body>\\n+</html>\\ndiff --git a/toolkit/components/microformats/tests/test_Microformats_geo.html b/toolkit/components/microformats/tests/test_Microformats_geo.html\\nnew file mode 100644\\nindex 0000000..70cbfa4\\n--- /dev/null\\n+++ b/toolkit/components/microformats/tests/test_Microformats_geo.html\\n@@ -0,0 +1,67 @@\\n+<html>\\n+<head>\\n+  <meta http-equiv=\\\"Content-type\\\" content=\\\"text/html; charset=utf-8\\\" />\\n+  <title>Testing Microformats.js (geo)</title>\\n+  <script type=\\\"text/javascript\\\" src=\\\"/MochiKit/MochiKit.js\\\"></script>\\n+  <script type=\\\"text/javascript\\\" src=\\\"/tests/SimpleTest/SimpleTest.js\\\"></script>\\n+  <script type=\\\"text/javascript\\\" src=\\\"/tests/SimpleTest/EventUtils.js\\\"></script>\\n+  <link rel=\\\"stylesheet\\\" type=\\\"text/css\\\" href=\\\"/tests/SimpleTest/test.css\\\"></link>\\n+</head>\\n+<body>\\n+<div id=\\\"content\\\" style=\\\"display: none\\\">\\n+\\n+    <span class=\\\"geo\\\" id=\\\"01-geo-basic\\\">\\n+      <span class=\\\"latitude\\\">37.77</span>\\n+      <span class=\\\"longitude\\\">-122.411</span>\\n+    </span>\\n+\\n+\\n+    <span class=\\\"geo\\\" id=\\\"01-geo-abbr-latlong\\\" >\\n+      <abbr class=\\\"latitude\\\" title=\\\"37.77\\\">Northern</abbr>\\n+      <abbr class=\\\"longitude\\\" title=\\\"-122.41\\\">California</abbr>\\n+    </span>\\n+\\n+    <abbr class=\\\"geo\\\" id=\\\"01-geo-abbr\\\" title=\\\"30.267991;-97.739568\\\">Paradise</abbr>\\n+  \\n+</div>\\n+<pre id=\\\"test\\\">\\n+<script class=\\\"testbody\\\" type=\\\"text/javascript\\\">\\n+\\n+test_Microformats();\\n+test_geo();\\n+\\n+function test_Microformats() {\\n+  netscape.security.PrivilegeManager.enablePrivilege(\\\"UniversalXPConnect\\\");\\n+\\n+  Components.utils.import(\\\"resource://gre/modules/Microformats.js\\\");\\n+\\n+  ok(Microformats, \\\"Check global access to Microformats\\\");\\n+};\\n+\\n+function test_geo() {\\n+  netscape.security.PrivilegeManager.enablePrivilege(\\\"UniversalXPConnect\\\");\\n+\\n+  Components.utils.import(\\\"resource://gre/modules/Microformats.js\\\");\\n+\\n+  var Geo;\\n+\\n+  Geo = new geo(document.getElementById(\\\"01-geo-basic\\\"));\\n+\\n+  is(Geo.latitude, \\\"37.77\\\", \\\"01-geo-basic - latitude\\\");\\n+  is(Geo.longitude, \\\"-122.411\\\", \\\"01-geo-basic - longitude\\\");\\n+\\n+  Geo = new geo(document.getElementById(\\\"01-geo-abbr-latlong\\\"));\\n+\\n+  is(Geo.latitude, \\\"37.77\\\", \\\"02-geo-abbr-latlong - latitude\\\");\\n+  is(Geo.longitude, \\\"-122.41\\\", \\\"02-geo-abbr-latlong - longitude\\\");\\n+\\n+  Geo = new geo(document.getElementById(\\\"01-geo-abbr\\\"));\\n+\\n+  is(Geo.latitude, \\\"30.267991\\\", \\\"01-geo-abbr - latitude\\\");\\n+  is(Geo.longitude, \\\"-97.739568\\\", \\\"01-geo-abbr - longitude\\\");\\n+}\\n+\\n+</script>\\n+</pre>\\n+</body>\\n+</html>\\ndiff --git a/toolkit/components/microformats/tests/test_Microformats_hCalendar.html b/toolkit/components/microformats/tests/test_Microformats_hCalendar.html\\nnew file mode 100644\\nindex 0000000..bf30f14\\n--- /dev/null\\n+++ b/toolkit/components/microformats/tests/test_Microformats_hCalendar.html\\n@@ -0,0 +1,303 @@\\n+<html>\\n+<head>\\n+  <meta http-equiv=\\\"Content-type\\\" content=\\\"text/html; charset=utf-8\\\" />\\n+  <title>Testing Microformats.js (hCalendar)</title>\\n+  <script type=\\\"text/javascript\\\" src=\\\"/MochiKit/MochiKit.js\\\"></script>\\n+  <script type=\\\"text/javascript\\\" src=\\\"/tests/SimpleTest/SimpleTest.js\\\"></script>\\n+  <script type=\\\"text/javascript\\\" src=\\\"/tests/SimpleTest/EventUtils.js\\\"></script>\\n+  <link rel=\\\"stylesheet\\\" type=\\\"text/css\\\" href=\\\"/tests/SimpleTest/test.css\\\"></link>\\n+</head>\\n+<body>\\n+<div id=\\\"content\\\" style=\\\"display: none\\\">\\n+\\n+  From http://hg.microformats.org/tests\\n+\\n+  <div class=\\\"vevent\\\" id=\\\"01-component-vevent-dtstart-date\\\">\\n+    <div>Dates: <abbr class=\\\"dtstart\\\" title=\\\"19970903\\\">September 3, 1997</abbr></div>\\n+  </div>\\n+\\n+  <div class=\\\"vevent\\\" id=\\\"02-component-vevent-dtstart-datetime\\\">\\n+    <div>Dates: <abbr class=\\\"dtstart\\\" title=\\\"19970903T163000Z\\\">September 3, 1997, 16:30</abbr></div>\\n+  </div>\\n+\\n+  <div class=\\\"vevent\\\" id=\\\"03-component-vevent-dtend-date\\\">\\n+    <div>Dates: <abbr class=\\\"dtstart\\\" title=\\\"19970903\\\">September 3, 1997</abbr>\\n+    <abbr class=\\\"dtend\\\" title=\\\"19970904\\\">( all day )</abbr></div>\\n+  </div>\\n+\\n+  <div class=\\\"vevent\\\" id=\\\"04-component-vevent-dtend-datetime\\\">\\n+    <div>Date: <abbr class=\\\"dtstart\\\" title=\\\"19970903T160000Z\\\">September 3, 1997 at 4pm</abbr>\\n+    <abbr class=\\\"dtend\\\" title=\\\"19970903T180000Z\\\"> for 2 hours.</abbr></div>\\n+  </div>\\n+\\n+  <div class=\\\"vcalendar\\\">\\n+    <span class=\\\"vevent\\\" id=\\\"05-calendar-simple\\\">\\n+      <a class=\\\"url\\\" href=\\\"http://www.web2con.com/\\\">\\n+        <span class=\\\"summary\\\">Web 2.0 Conference</span>: \\n+        <abbr class=\\\"dtstart\\\" title=\\\"2005-10-05\\\">October 5</abbr>-\\n+        <abbr class=\\\"dtend\\\" title=\\\"2005-10-08\\\">7</abbr>,\\n+        at the <span class=\\\"location\\\">Argent Hotel, San Francisco, CA</span>\\n+      </a>\\n+    </span>\\n+  </div>\\n+\\n+  <p class=\\\"vevent\\\" id=\\\"06-component-vevent-uri-relative\\\">\\n+    <a class=\\\"url summary\\\" href=\\\"/squidlist/calendar/12279/2006/1/15\\\">Bad Movie Night - Gigli (blame mike spiegelman)</a>\\n+    <br />\\n+    <abbr class=\\\"dtstart\\\" title=\\\"20060115T000000\\\">Sun, Jan 15 : 8pm</abbr>\\n+    <br />\\n+  </p>\\n+\\n+  <div class=\\\"vevent\\\" id=\\\"07-component-vevent-description-simple\\\">\\n+    <div class=\\\"description\\\">Project xyz Review Meeting Minutes</div>\\n+  </div>\\n+\\n+  <div class=\\\"aaa vevent\\\" id=\\\"08-component-vevent-multiple-classes\\\">\\n+    <a class=\\\"bbb url\\\" href=\\\"http://www.web2con.com/\\\">\\n+      <span class=\\\"ccc summary\\\">Web 2.0 Conference</span>: \\n+      <abbr class=\\\"ddd dtstart\\\" title=\\\"2005-10-05\\\">October 5</abbr>-\\n+      <abbr class=\\\"eee dtend\\\" title=\\\"2005-10-08\\\">7</abbr>,\\n+      at the <span class=\\\"fff location\\\">Argent Hotel, San Francisco, CA</span>\\n+    </a>\\n+  </div>\\n+\\n+  <ul>\\n+    <li class=\\\"vevent\\\" id=\\\"09-component-vevent-summary-in-img-alt\\\">\\n+     <a class=\\\"url\\\" href=\\\"http://conferences.oreillynet.com/et2006/\\\">\\n+      <img style=\\\"display:block\\\" class=\\\"summary\\\" \\n+       src=\\\"http://conferences.oreillynet.com/images/et2005/logo_sm.gif\\\"\\n+       alt=\\\"O'Reilly Emerging Technology Conference\\\" />\\n+      <abbr class=\\\"dtstart\\\" title=\\\"20060306\\\">\\n+        3/6</abbr>-<abbr class=\\\"dtend\\\" title=\\\"20060310\\\">9</abbr>\\n+      @\\n+      <span class=\\\"location\\\">\\n+         Manchester Grand Hyatt in San Diego, CA\\n+       </span>\\n+     </a>\\n+    </li>\\n+  </ul>\\n+\\n+  <div class=\\\"vcalendar\\\">\\n+    <div class=\\\"vevent\\\" id=\\\"10-component-vevent-entity\\\">\\n+      <div class=\\\"summary\\\">Cricket &amp; Tennis Centre</div>\\n+      <div class=\\\"description\\\">Melbourne&apos;s Cricket &amp; Tennis Centres are in the heart of the city</div>\\n+    </div>\\n+  </div>\\n+\\n+  <p class=\\\"schedule vevent\\\" id=\\\"11-component-vevent-summary-in-subelements\\\">\\n+    <span class=\\\"summary\\\">\\n+      <span style=\\\"font-weight:bold; color: #3E4876;\\\">Welcome!</span>\\n+      <a href=\\\"/cs/web2005/view/e_spkr/1852\\\">John Battelle</a>,\\n+      <a href=\\\"/cs/web2005/view/e_spkr/416\\\">Tim O'Reilly</a>\\n+    </span>\\n+    <br />\\n+    <b>Time:</b>\\n+    <abbr class=\\\"dtstart\\\" title=\\\"20051005T1630-0700\\\">4:30pm</abbr>-\\n+    <abbr class=\\\"dtend\\\" title=\\\"20051005T1645-0700\\\">4:45pm\\n+    </abbr>\\n+  </p>\\n+\\n+  <p class=\\\"vevent\\\" id=\\\"12-component-vevent-summary-url-in-same-class\\\">\\n+    <a class=\\\"url summary\\\" href=\\\"http://www.laughingsquid.com/squidlist/calendar/12377/2006/1/25\\\">Art Reception for Tom Schultz and Felix Macnee</a>\\n+    <br />\\n+    <abbr class=\\\"dtstart\\\" title=\\\"20060125T000000\\\">Wed, Jan 25 : 6:00 pm - 9:00 pm</abbr>\\n+    <br />\\n+  </p>\\n+\\n+  <div class=\\\"vcalendar\\\">\\n+    <div class=\\\"vevent\\\" id=\\\"13-component-vevent-summary-url-property\\\">\\n+      <span class=\\\"summary\\\">\\n+        <a class=\\\"url\\\" href=\\\"http://dps1.travelocity.com/dparcobrand.ctl?smls=Y&amp;Service=YHOE&amp;.intl=us&amp;aln_name=AA&amp;flt_num=1655&amp;dep_arp_name=&amp;arr_arp_name=&amp;dep_dt_dy_1=23&amp;dep_dt_mn_1=Jan&amp;dep_dt_yr_1=2006&amp;dep_tm_1=9:00am\\\">ORD-SFO/AA 1655</a>\\n+      </span>\\n+    </div>\\n+  </div>\\n+\\n+  <div class=\\\"vcalendar\\\">\\n+    <span class=\\\"vevent\\\" id=\\\"15-calendar-xml-lang\\\">\\n+      <a class=\\\"url\\\" href=\\\"http://www.web2con.com/\\\">\\n+      <span class=\\\"summary\\\">Web 2.0 Conference</span>: \\n+      <abbr class=\\\"dtstart\\\" title=\\\"2005-10-05\\\">October 5</abbr>-\\n+      <abbr class=\\\"dtend\\\" title=\\\"2005-10-08\\\">7</abbr>,\\n+      at the <span class=\\\"location\\\">Argent Hotel, San Francisco, CA</span>\\n+      </a>\\n+    </span>\\n+  </div>\\n+\\n+    <div class=\\\"vcalendar\\\">\\n+      <span class=\\\"vevent\\\" id=\\\"16-calendar-force-outlook\\\">\\n+        <a class=\\\"url\\\" href=\\\"http://www.web2con.com/\\\">\\n+          <abbr class=\\\"dtstart\\\" title=\\\"2005-10-05\\\">October 5</abbr>-\\n+          <abbr class=\\\"dtend\\\" title=\\\"2005-10-08\\\">7</abbr>,\\n+          at the <span class=\\\"location\\\">Argent Hotel, San Francisco, CA</span>\\n+        </a>\\n+      </span>\\n+    </div>\\n+\\n+  <p class=\\\"vevent\\\" id=\\\"17-component-vevent-description-value-in-subelements\\\">\\n+    <span class=\\\"description\\\">\\n+      RESOLUTION: to have a\\n+      <b class=\\\"summary\\\">3rd PAW ftf meeting</b> \\n+      <abbr class=\\\"dtstart\\\" title=\\\"2006-01-18\\\">18</abbr>-<abbr class=\\\"dtend\\\" title=\\\"2006-01-20\\\">19 Jan</abbr> in \\n+      <em class=\\\"location\\\">Maryland</em>; location contingent on confirmation from timbl</span>\\n+  </p>\\n+\\n+  <div class=\\\"vevent\\\" id=\\\"18-component-vevent-uid.1\\\">\\n+    <div>UID: <span class=\\\"uid\\\">http://example.com/foo.html</span></div>\\n+  </div>\\n+  <div class=\\\"vevent\\\" id=\\\"18-component-vevent-uid.2\\\">\\n+    UID: <a class=\\\"uid\\\" href=\\\"http://example.com/foo.html\\\">another hcal event</a>\\n+  </div>\\n+  \\n+  <div class=\\\"vevent\\\" id=\\\"18-component-vevent-uid.3\\\">\\n+    UID: <object class=\\\"uid\\\" data=\\\"http://example.com/foo.html\\\">another hcal event</object>\\n+  </div>\\n+  \\n+  <div class=\\\"vevent\\\" id=\\\"18-component-vevent-uid.4\\\">\\n+    UID: <map id=\\\"foo\\\"><area alt=\\\"uid\\\" class=\\\"uid\\\" href=\\\"http://example.com/foo.html\\\" /></map>\\n+  </div>\\n+  \\n+  <div class=\\\"vevent\\\" id=\\\"18-component-vevent-uid.5\\\">\\n+    UID: <img class=\\\"uid\\\" alt=\\\"uid\\\" src=\\\"http://example.com/foo.html\\\" />\\n+  </div>\\n+\\n+  <div class=\\\"vcalendar\\\">\\n+    <div class=\\\"vevent\\\" id=\\\"19-calendar-attachments\\\">\\n+      <div>Start Time: <abbr class=\\\"dtstart\\\" title=\\\"19970324T123000Z\\\">March 24, 1997 12:30 UTC</abbr></div>\\n+      <div class=\\\"summary\\\">Calendaring Interoperability Planning Meeting</div>\\n+      \\n+      <div>Attachments: \\n+          <ul>\\n+              <li><a class=\\\"attach\\\" href=\\\"http://microformats.org/img/logo.gif\\\">microformats logo</a></li>\\n+              <li><a class=\\\"attach\\\" type=\\\"application/postscript\\\" href=\\\"ftp://xyzCorp.com/pub/conf/bkgrnd.ps\\\">ftp://xyzCorp.com/pub/conf/bkgrnd.ps</a></li>\\n+          </ul>\\n+      </div>\\n+    </div>\\n+  </div>\\n+\\n+</div>\\n+\\n+<pre id=\\\"test\\\">\\n+<script class=\\\"testbody\\\" type=\\\"text/javascript\\\">\\n+\\n+test_Microformats();\\n+test_hCard();\\n+\\n+function test_Microformats() {\\n+  netscape.security.PrivilegeManager.enablePrivilege(\\\"UniversalXPConnect\\\");\\n+\\n+  Components.utils.import(\\\"resource://gre/modules/Microformats.js\\\");\\n+\\n+  ok(Microformats, \\\"Check global access to Microformats\\\");\\n+};\\n+\\n+function test_hCard() {\\n+  netscape.security.PrivilegeManager.enablePrivilege(\\\"UniversalXPConnect\\\");\\n+\\n+  Components.utils.import(\\\"resource://gre/modules/Microformats.js\\\");\\n+\\n+  var hcalendar;\\n+\\n+  hcalendar = new hCalendar(document.getElementById(\\\"01-component-vevent-dtstart-date\\\"));\\n+\\n+  is(hcalendar.dtstart, \\\"1997-09-03\\\", \\\"01-component-vevent-dtstart-date - dtstart\\\");\\n+\\n+  hcalendar = new hCalendar(document.getElementById(\\\"02-component-vevent-dtstart-datetime\\\"));\\n+\\n+  is(hcalendar.dtstart, \\\"1997-09-03T16:30:00Z\\\", \\\"02-component-vevent-dtstart-datetime - dtstart\\\");\\n+\\n+  hcalendar = new hCalendar(document.getElementById(\\\"03-component-vevent-dtend-date\\\"));\\n+\\n+  is(hcalendar.dtstart, \\\"1997-09-03\\\", \\\"03-component-vevent-dtend-date - dtstart\\\");\\n+  is(hcalendar.dtend, \\\"1997-09-04\\\", \\\"03-component-vevent-dtend-date - dtend\\\");\\n+\\n+\\n+  hcalendar = new hCalendar(document.getElementById(\\\"04-component-vevent-dtend-datetime\\\"));\\n+\\n+  is(hcalendar.dtstart, \\\"1997-09-03T16:00:00Z\\\", \\\"04-component-vevent-dtend-datetime - dtstart\\\");\\n+  is(hcalendar.dtend, \\\"1997-09-03T18:00:00Z\\\", \\\"04-component-vevent-dtend-datetime - dtend\\\");\\n+\\n+  hcalendar = new hCalendar(document.getElementById(\\\"05-calendar-simple\\\"));\\n+\\n+  is(hcalendar.dtstart, \\\"2005-10-05\\\", \\\"05-calendar-simple - dtstart\\\");\\n+  is(hcalendar.dtend, \\\"2005-10-08\\\", \\\"05-calendar-simple - dtend\\\");\\n+  is(hcalendar.url, \\\"http://www.web2con.com/\\\", \\\"05-calendar-simple - url\\\");\\n+  is(hcalendar.summary, \\\"Web 2.0 Conference\\\", \\\"05-calendar-simple - summary\\\");\\n+  is(hcalendar.location, \\\"Argent Hotel, San Francisco, CA\\\", \\\"05-calendar-simple - location\\\");\\n+\\n+  hcalendar = new hCalendar(document.getElementById(\\\"06-component-vevent-uri-relative\\\"));\\n+  is(hcalendar.url, \\\"http://localhost:8888/squidlist/calendar/12279/2006/1/15\\\", \\\"06-component-vevent-uri-relative - url\\\");\\n+  is(hcalendar.summary, \\\"Bad Movie Night - Gigli (blame mike spiegelman)\\\", \\\"06-component-vevent-uri-relative - summary\\\");\\n+  is(hcalendar.dtstart, \\\"2006-01-15T00:00:00\\\", \\\"06-component-vevent-uri-relative - dtstart\\\");\\n+\\n+  hcalendar = new hCalendar(document.getElementById(\\\"07-component-vevent-description-simple\\\"));\\n+  is(hcalendar.description, \\\"Project xyz Review Meeting Minutes\\\", \\\"07-component-vevent-description-simple - description\\\");\\n+\\n+  hcalendar = new hCalendar(document.getElementById(\\\"08-component-vevent-multiple-classes\\\"));\\n+  is(hcalendar.dtstart, \\\"2005-10-05\\\", \\\"08-component-vevent-multiple-classes - dtstart\\\");\\n+  is(hcalendar.dtend, \\\"2005-10-08\\\", \\\"08-component-vevent-multiple-classes - dtend\\\");\\n+  is(hcalendar.url, \\\"http://www.web2con.com/\\\", \\\"08-component-vevent-multiple-classes - url\\\");\\n+  is(hcalendar.summary, \\\"Web 2.0 Conference\\\", \\\"08-component-vevent-multiple-classes - summary\\\");\\n+  is(hcalendar.location, \\\"Argent Hotel, San Francisco, CA\\\", \\\"08-component-vevent-multiple-classes - location\\\");\\n+\\n+  hcalendar = new hCalendar(document.getElementById(\\\"09-component-vevent-summary-in-img-alt\\\"));\\n+  is(hcalendar.dtstart, \\\"2006-03-06\\\", \\\"09-component-vevent-summary-in-img-alt - dtstart\\\");\\n+  is(hcalendar.dtend, \\\"2006-03-10\\\", \\\"09-component-vevent-summary-in-img-alt - dtend\\\");\\n+  is(hcalendar.url, \\\"http://conferences.oreillynet.com/et2006/\\\", \\\"09-component-vevent-summary-in-img-alt - url\\\");\\n+  is(hcalendar.summary, \\\"O'Reilly Emerging Technology Conference\\\", \\\"09-component-vevent-summary-in-img-alt - summary\\\");\\n+  is(hcalendar.location, \\\"Manchester Grand Hyatt in San Diego, CA\\\", \\\"09-component-vevent-summary-in-img-alt - location\\\");\\n+\\n+  hcalendar = new hCalendar(document.getElementById(\\\"10-component-vevent-entity\\\"));\\n+  is(hcalendar.summary, \\\"Cricket & Tennis Centre\\\", \\\"10-component-vevent-entity - summary\\\");\\n+  is(hcalendar.description, \\\"Melbourne's Cricket & Tennis Centres are in the heart of the city\\\", \\\"10-component-vevent-entity - description\\\");\\n+\\n+  hcalendar = new hCalendar(document.getElementById(\\\"11-component-vevent-summary-in-subelements\\\"));\\n+  is(hcalendar.dtstart, \\\"2005-10-05T16:30:00-0700\\\", \\\"11-component-vevent-summary-in-subelements - dtstart\\\");\\n+  is(hcalendar.dtend, \\\"2005-10-05T16:45:00-0700\\\", \\\"11-component-vevent-summary-in-subelements - dtend\\\");\\n+  is(hcalendar.summary, \\\"Welcome! John Battelle, Tim O'Reilly\\\", \\\"11-component-vevent-summary-in-subelements - summary\\\");\\n+\\n+  hcalendar = new hCalendar(document.getElementById(\\\"12-component-vevent-summary-url-in-same-class\\\"));\\n+  is(hcalendar.dtstart, \\\"2006-01-25T00:00:00\\\", \\\"12-component-vevent-summary-url-in-same-class - dtstart\\\");\\n+  is(hcalendar.summary, \\\"Art Reception for Tom Schultz and Felix Macnee\\\", \\\"12-component-vevent-summary-url-in-same-class - summary\\\");\\n+  is(hcalendar.url, \\\"http://www.laughingsquid.com/squidlist/calendar/12377/2006/1/25\\\", \\\"12-component-vevent-summary-url-in-same-class - url\\\");\\n+\\n+  hcalendar = new hCalendar(document.getElementById(\\\"13-component-vevent-summary-url-property\\\"));\\n+  is(hcalendar.summary, \\\"ORD-SFO/AA 1655\\\", \\\"13-component-vevent-summary-url-property - summary\\\");\\n+  is(hcalendar.url, \\\"http://dps1.travelocity.com/dparcobrand.ctl?smls=Y&Service=YHOE&.intl=us&aln_name=AA&flt_num=1655&dep_arp_name=&arr_arp_name=&dep_dt_dy_1=23&dep_dt_mn_1=Jan&dep_dt_yr_1=2006&dep_tm_1=9:00am\\\", \\\"13-component-vevent-summary-url-property - url\\\");\\n+\\n+  hcalendar = new hCalendar(document.getElementById(\\\"15-calendar-xml-lang\\\"));\\n+  is(hcalendar.dtend, \\\"2005-10-08\\\", \\\"15-calendar-xml-lang - dtend\\\");\\n+  is(hcalendar.dtstart, \\\"2005-10-05\\\", \\\"15-calendar-xml-lang - dtstart\\\");\\n+  is(hcalendar.location, \\\"Argent Hotel, San Francisco, CA\\\", \\\"15-calendar-xml-lang - location\\\");\\n+  is(hcalendar.summary, \\\"Web 2.0 Conference\\\", \\\"15-calendar-xml-lang - summary\\\");\\n+  is(hcalendar.url, \\\"http://www.web2con.com/\\\", \\\"15-calendar-xml-lang - url\\\");\\n+\\n+  hcalendar = new hCalendar(document.getElementById(\\\"16-calendar-force-outlook\\\"));\\n+  is(hcalendar.dtend, \\\"2005-10-08\\\", \\\"16-calendar-force-outlook - dtend\\\");\\n+  is(hcalendar.dtstart, \\\"2005-10-05\\\", \\\"16-calendar-force-outlook - dtstart\\\");\\n+  is(hcalendar.location, \\\"Argent Hotel, San Francisco, CA\\\", \\\"16-calendar-force-outlook - location\\\");\\n+  is(hcalendar.url, \\\"http://www.web2con.com/\\\", \\\"16-calendar-force-outlook - url\\\");\\n+\\n+  hcalendar = new hCalendar(document.getElementById(\\\"17-component-vevent-description-value-in-subelements\\\"));\\n+  is(hcalendar.description, \\\"RESOLUTION: to have a 3rd PAW ftf meeting 18-19 Jan in Maryland; location contingent on confirmation from timbl\\\", \\\"17-component-vevent-description-value-in-subelements - description\\\");\\n+  is(hcalendar.dtstart, \\\"2006-01-18\\\", \\\"17-component-vevent-description-value-in-subelements - dtstart\\\");\\n+  is(hcalendar.dtend, \\\"2006-01-20\\\", \\\"17-component-vevent-description-value-in-subelements - dtend\\\");\\n+  is(hcalendar.location, \\\"Maryland\\\", \\\"17-component-vevent-description-value-in-subelements - location\\\");\\n+  is(hcalendar.summary, \\\"3rd PAW ftf meeting\\\", \\\"17-component-vevent-description-value-in-subelements - summary\\\");\\n+\\n+  hcalendar = new hCalendar(document.getElementById(\\\"18-component-vevent-uid.1\\\"));\\n+\\n+  hcalendar = new hCalendar(document.getElementById(\\\"18-component-vevent-uid.2\\\"));\\n+\\n+  hcalendar = new hCalendar(document.getElementById(\\\"18-component-vevent-uid.3\\\"));\\n+\\n+  hcalendar = new hCalendar(document.getElementById(\\\"18-component-vevent-uid.4\\\"));\\n+\\n+  hcalendar = new hCalendar(document.getElementById(\\\"18-component-vevent-uid.5\\\"));\\n+\\n+  hcalendar = new hCalendar(document.getElementById(\\\"19-calendar-attachments\\\"));\\n+}\\n+\\n+</script>\\n+</pre>\\n+</body>\\n+</html>\\ndiff --git a/toolkit/components/microformats/tests/test_Microformats_hCard.html b/toolkit/components/microformats/tests/test_Microformats_hCard.html\\nnew file mode 100644\\nindex 0000000..9e6fac3\\n--- /dev/null\\n+++ b/toolkit/components/microformats/tests/test_Microformats_hCard.html\\n@@ -0,0 +1,1125 @@\\n+<html>\\n+<head>\\n+  <meta http-equiv=\\\"Content-type\\\" content=\\\"text/html; charset=utf-8\\\" />\\n+  <title>Testing Microformats.js</title>\\n+  <script type=\\\"text/javascript\\\" src=\\\"/MochiKit/MochiKit.js\\\"></script>\\n+  <script type=\\\"text/javascript\\\" src=\\\"/tests/SimpleTest/SimpleTest.js\\\"></script>\\n+  <script type=\\\"text/javascript\\\" src=\\\"/tests/SimpleTest/EventUtils.js\\\"></script>\\n+  <link rel=\\\"stylesheet\\\" type=\\\"text/css\\\" href=\\\"/tests/SimpleTest/test.css\\\"></link>\\n+</head>\\n+<body>\\n+<div id=\\\"content\\\" style=\\\"display: none\\\">\\n+\\n+  From http://microformats.org/tests/hcard/\\n+\\n+  <div class=\\\"vcard\\\" id=\\\"01-tantek-basic\\\">\\n+   <a class=\\\"url fn\\\" href=\\\"http://tantek.com/\\\">Tantek Çelik</a>\\n+   <div class=\\\"org\\\">Technorati</div>\\n+  </div>\\n+  \\n+  <div class=\\\"vcard\\\" id=\\\"02-multiple-class-names-on-vcard.1\\\"><span class=\\\"fn n\\\"><span class=\\\"given-name\\\">Ryan</span> <span class=\\\"family-name\\\">King</span></span></div>\\n+  <p><span class=\\\"attendee vcard\\\" id=\\\"02-multiple-class-names-on-vcard.2\\\"><span class=\\\"fn n\\\"><span class=\\\"given-name\\\">Ryan</span> <span class=\\\"family-name\\\">King</span></span></span></p>\\n+  <address class=\\\"vcard author\\\" id=\\\"02-multiple-class-names-on-vcard.3\\\"><span class=\\\"fn n\\\"><span class=\\\"given-name\\\">Ryan</span> <span class=\\\"family-name\\\">King</span></span></address>\\n+  <ul><li class=\\\"reviewer vcard first\\\" id=\\\"02-multiple-class-names-on-vcard.4\\\"><span class=\\\"fn n\\\"><span class=\\\"given-name\\\">Ryan</span> <span class=\\\"family-name\\\">King</span></span></li></ul>\\n+\\n+  <p class=\\\"vcard\\\" id=\\\"03-implied-n.1\\\">\\n+    <span class=\\\"fn\\\">Ryan King</span>\\n+  </p>\\n+  <p class=\\\"vcard\\\" id=\\\"03-implied-n.2\\\">\\n+    <abbr class=\\\"fn\\\" title=\\\"Ryan King\\\">me</abbr>\\n+  </p>\\n+  <p class=\\\"vcard\\\" id=\\\"03-implied-n.3\\\">\\n+    <img src=\\\"/me.jpg\\\" title=\\\"Brian Suda\\\" alt=\\\"Ryan King\\\" class=\\\"fn\\\" />\\n+  </p>\\n+  <p class=\\\"vcard\\\" id=\\\"03-implied-n.4\\\">\\n+  <a class=\\\"fn\\\" href=\\\"http://suda.co.uk/\\\">Brian Suda</a>\\n+  </p>\\n+  <p class=\\\"vcard\\\" id=\\\"03-implied-n.5\\\">\\n+    <span class=\\\"fn\\\">King, Ryan</span>\\n+  </p>\\n+  <p class=\\\"vcard\\\" id=\\\"03-implied-n.6\\\">\\n+    <span class=\\\"fn\\\">King, R</span>\\n+  </p>\\n+  <p class=\\\"vcard\\\" id=\\\"03-implied-n.7\\\">\\n+    <span class=\\\"fn\\\">King R</span>\\n+  </p>\\n+  <p class=\\\"vcard\\\" id=\\\"03-implied-n.8\\\">\\n+    <span class=\\\"fn\\\">King R.</span>\\n+  </p>\\n+  <p class=\\\"vcard\\\" id=\\\"03-implied-n.9\\\">\\n+    <span class=\\\"fn\\\">Jesse James Garrett</span>\\n+  </p>\\n+  <p class=\\\"vcard\\\" id=\\\"03-implied-n.10\\\">\\n+    <span class=\\\"fn\\\">Thomas Vander Wal</span>\\n+  </p>\\n+\\n+  <p class=\\\"vcard\\\" id=\\\"04-ignore-unknowns\\\">\\n+    <span class=\\\"ignore-me\\\">Some text that shouldn't be in the vCard.</span>\\n+    <span class=\\\"fn n\\\">\\n+      <span class=\\\"given-name\\\">Ryan</span> <span class=\\\"family-name\\\">King</span>\\n+    </span>\\n+  </p>\\n+  <p class=\\\"ignore-me-too\\\">Some more text that shouldn't be in the vCard.</p>  \\n+\\n+  <p class=\\\"vcard\\\" id=\\\"05-mailto-1\\\">\\n+    <!-- fn should be the text node (with implied-n-optimization) and 'email' should be the href, sans scheme -->\\n+    <a class=\\\"fn email\\\" href=\\\"mailto:ryan@technorati.com\\\">Ryan King</a>\\n+  </p>\\n+\\n+  <p class=\\\"vcard\\\" id=\\\"06-mailto-2\\\">\\n+    <!-- ignore the parameters on the addr-spec -->\\n+    <a class=\\\"fn email\\\" href=\\\"mailto:brian@example.com?subject=foo\\\">Brian Suda</a>\\n+  </p>\\n+\\n+  <p class=\\\"vcard\\\" id=\\\"07-relative-url\\\">\\n+    <span class=\\\"fn n\\\"><span class=\\\"given-name\\\">John</span> <span class=\\\"family-name\\\">Doe</span></span>\\n+    <a class=\\\"url\\\" href=\\\"/home/blah\\\">my website</a>\\n+  </p>\\n+\\n+  Tests 8/9/10 involve base tags and must each be self contained\\n+\\n+  <p class=\\\"vcard\\\" id=\\\"11-multiple-urls\\\">\\n+     <span class=\\\"fn n\\\">\\n+      <span class=\\\"given-name\\\">John</span> <span class=\\\"family-name\\\">Doe</span></span>\\n+      <a class=\\\"url\\\" href=\\\"http://example.com/foo\\\">my website</a>\\n+      <a class=\\\"url\\\" href=\\\"http://example.com/bar\\\">my other website</a>\\n+  </p>\\n+\\n+  <p class=\\\"vcard\\\" id=\\\"12-img-src-url\\\">\\n+    <span class=\\\"fn n\\\"><span class=\\\"given-name\\\">John</span> <span class=\\\"family-name\\\">Doe</span></span>\\n+    <!-- take the @src, ignore the @type -->\\n+    <img class=\\\"url\\\" src=\\\"http://example.org/picture.png\\\" type=\\\"image/png\\\" />\\n+  </p>\\n+\\n+  <p class=\\\"vcard\\\" id=\\\"13-photo-logo\\\">\\n+    <span class=\\\"fn n\\\"><span class=\\\"given-name\\\">John</span> <span class=\\\"family-name\\\">Doe</span></span>\\n+    <!-- take the @src, ignore the @type -->\\n+    <img class=\\\"photo logo\\\" src=\\\"http://example.org/picture.png\\\" type=\\\"image/png\\\" />\\n+  </p>\\n+\\n+  <p class=\\\"vcard\\\" id=\\\"14-img-src-data-url\\\">\\n+    <span class=\\\"fn n\\\"><span class=\\\"given-name\\\">John</span> <span class=\\\"family-name\\\">Doe</span></span>\\n+    <img class=\\\"photo logo\\\" src=\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAASUExURf///8zMzJmZmWZmZjMzMwAAAPOPemkAAAM1SURBVHjaYmBgYGBkYQUBFkYWFiCPCchixQAMCCZAACF0MAMVM4K4TFh0IGsBCCAkOxhYmBnAAKaHhZkZmxaAAGJgYIbpYGBihGgBWsTMzMwE4jIhaWGAYoAAYmCECDExYAcwGxkg5oNIgABigDqLARdgZmGB2wICrKwAAcSA3xKgIxlZ0PwCEEAMBCxhgHoWSQtAADFAAxgfYEJ1GEAAQbQw4tUCsocBYQVAADEgu4uRkREeUCwszEwwLhOKLQABhNDCBA4aSDgwwhIAJKqYUPwCEEAMUK/AUwnc9aywJMCI7DAgAAggBohZ8JTBhGIJzCoWZL8ABBCYidAB8RUjWppkYUG2BSCAGMDqEMZiswUtXgACiAHsFYixTMywGGLGpgUWYgABxAA2mQkWCMyMqFoYmdD8ACQAAogBHJHMrCxg1cyIiICmCkYWDFsAAgiihYmZCewFFpR0BfI3LLch+QUggBiQ0iQjEyMDmh54qCBlUIAAYsCRJsElADQvgWKTlRGeKwECiAF3XgGmMEYQYADZzcoA9z5AAMG9RQCAtEC9DxBADFiyFyMjVi0wABBAWLQwQdIiuhYGWJIACCBg+KKUJ9BoBRdS2LQALQMIIGDQIEmwAO1kYcVWHCDZAhBAqFqYmOAxj2YNtAwDAYAAYmDEiBYWzHKKkRERYiwAAYSphZEZwxZGZiZQVEJTJkAAMTCyokc7M5oORlC5wcoEjxeAAAJqQXU0UB6W5WFmABMtEzMi1wEEEFAbE0YyAUuzMMEsYQalMkQSBQggUDmNPU3C9IA4LCxI+QUggEBiKOU8yExgqccCL3chnkPKlQABhGo6ejHBDKmdUHMlQAAhhQvQaGZGkBIkjcAMywLmI+VKgABCSowsTJhZkhlWXiBpAQggYBqBZl9GVOdBcz0LZqEEEEAMqLULMBLg1THWog9IAwQQA0qiZcRW5aPbAhBADCg1El4tMAAQQAxoiZYZXnTh1AIQQAzo2QlYpDDjcBgrxGEAAcSAJTthswmiBUwDBBC2GpkZJTaRvQ+mAQKIAUuuxdZWQvILQABBmSxMjBj5EpcWgACCMoFOYYSpZyHQHgMIMACt2hmoVEikCQAAAABJRU5ErkJggg==\\\"/>\\n+  </p>\\n+\\n+  <p class=\\\"vcard\\\" id=\\\"15-honorific-additional-single\\\">\\n+    <span class=\\\"fn n\\\">\\n+      <span class=\\\"honorific-prefix\\\">Mr.</span>\\n+      <span class=\\\"given-name\\\">John</span>\\n+      <span class=\\\"additional-name\\\">Maurice</span>\\n+      <span class=\\\"family-name\\\">Doe</span>,\\n+      <span class=\\\"honorific-suffix\\\">Ph.D.</span>\\n+    </span>\\n+  </p>\\n+\\n+  <p class=\\\"vcard\\\" id=\\\"16-honorific-additional-multiple\\\">\\n+    <span class=\\\"fn n\\\">\\n+      <span class=\\\"honorific-prefix\\\">Mr.</span>\\n+      <span class=\\\"honorific-prefix\\\">Dr.</span>\\n+      <span class=\\\"given-name\\\">John</span>\\n+      <span class=\\\"additional-name\\\">Maurice</span>\\n+      <span class=\\\"additional-name\\\">Benjamin</span>\\n+      <span class=\\\"family-name\\\">Doe</span>\\n+      <span class=\\\"honorific-suffix\\\">Ph.D.</span>,\\n+      <span class=\\\"honorific-suffix\\\">J.D.</span>\\n+    </span>\\n+  </p>\\n+\\n+  <p class=\\\"vcard\\\" id=\\\"17-email-not-uri\\\">\\n+    <span class=\\\"fn\\\">John Doe</span>\\n+    <span class=\\\"email\\\">john@example.com</span>\\n+  </p>\\n+\\n+  <p class=\\\"vcard\\\" id=\\\"18-object-data-http-uri\\\">\\n+    <span class=\\\"fn\\\">John Doe</span>\\n+    <object class=\\\"url photo logo\\\" data=\\\"http://example.com/foo.png\\\" type=\\\"image/png\\\"></object>\\n+  </p>\\n+\\n+  <p class=\\\"vcard\\\" id=\\\"19-object-data-data-uri\\\">\\n+    <span class=\\\"fn\\\">John Doe</span>\\n+    <object class=\\\"photo logo\\\" data=\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAASUExURf///8zMzJmZmWZmZjMzMwAAAPOPemkAAAM1SURBVHjaYmBgYGBkYQUBFkYWFiCPCchixQAMCCZAACF0MAMVM4K4TFh0IGsBCCAkOxhYmBnAAKaHhZkZmxaAAGJgYIbpYGBihGgBWsTMzMwE4jIhaWGAYoAAYmCECDExYAcwGxkg5oNIgABigDqLARdgZmGB2wICrKwAAcSA3xKgIxlZ0PwCEEAMBCxhgHoWSQtAADFAAxgfYEJ1GEAAQbQw4tUCsocBYQVAADEgu4uRkREeUCwszEwwLhOKLQABhNDCBA4aSDgwwhIAJKqYUPwCEEAMUK/AUwnc9aywJMCI7DAgAAggBohZ8JTBhGIJzCoWZL8ABBCYidAB8RUjWppkYUG2BSCAGMDqEMZiswUtXgACiAHsFYixTMywGGLGpgUWYgABxAA2mQkWCMyMqFoYmdD8ACQAAogBHJHMrCxg1cyIiICmCkYWDFsAAgiihYmZCewFFpR0BfI3LLch+QUggBiQ0iQjEyMDmh54qCBlUIAAYsCRJsElADQvgWKTlRGeKwECiAF3XgGmMEYQYADZzcoA9z5AAMG9RQCAtEC9DxBADFiyFyMjVi0wABBAWLQwQdIiuhYGWJIACCBg+KKUJ9BoBRdS2LQALQMIIGDQIEmwAO1kYcVWHCDZAhBAqFqYmOAxj2YNtAwDAYAAYmDEiBYWzHKKkRERYiwAAYSphZEZwxZGZiZQVEJTJkAAMTCyokc7M5oORlC5wcoEjxeAAAJqQXU0UB6W5WFmABMtEzMi1wEEEFAbE0YyAUuzMMEsYQalMkQSBQggUDmNPU3C9IA4LCxI+QUggEBiKOU8yExgqccCL3chnkPKlQABhGo6ejHBDKmdUHMlQAAhhQvQaGZGkBIkjcAMywLmI+VKgABCSowsTJhZkhlWXiBpAQggYBqBZl9GVOdBcz0LZqEEEEAMqLULMBLg1THWog9IAwQQA0qiZcRW5aPbAhBADCg1El4tMAAQQAxoiZYZXnTh1AIQQAzo2QlYpDDjcBgrxGEAAcSAJTthswmiBUwDBBC2GpkZJTaRvQ+mAQKIAUuuxdZWQvILQABBmSxMjBj5EpcWgACCMoFOYYSpZyHQHgMIMACt2hmoVEikCQAAAABJRU5ErkJggg==\\\" />\\n+  </p>\\n+\\n+  <p class=\\\"vcard\\\" id=\\\"20-image-alt\\\">\\n+<!-- only testing 'fn' here, but you should be able to parse any text value out of the img@alt -->\\n+<!-- also note, the fn should only be used to infer n, when there's no explicit n in the hcard -->\\n+    <img class=\\\"fn photo logo\\\" src=\\\"http://example.com/foo.png\\\" alt=\\\"John Doe\\\" />\\n+  </p>\\n+  \\n+  <div class=\\\"vcard\\\" id=\\\"21-tel\\\">\\n+    <p class=\\\"fn\\\">John Doe</p>v\\n+    <p class=\\\"tel\\\">+1.415.555.1231</p>\\n+    <p class=\\\"tel\\\">\\n+      <span class=\\\"type\\\">home</span>\\n+      <span class=\\\"value\\\">+1 415 555 1232</span>\\n+    </p>\\n+    <div class=\\\"tel\\\">\\n+      types:\\n+      <ul>\\n+        <li class=\\\"type\\\">msg</li>\\n+        <li class=\\\"type\\\">home</li>\\n+        <li class=\\\"type\\\">work</li>\\n+        <li class=\\\"type\\\">pref</li>\\n+        <li class=\\\"type\\\">voice</li>\\n+        <li class=\\\"type\\\">fax</li>\\n+        <li class=\\\"type\\\">cell</li>\\n+        <li class=\\\"type\\\">video</li>\\n+        <li class=\\\"type\\\">pager</li>\\n+        <li class=\\\"type\\\">bbs</li>\\n+        <li class=\\\"type\\\">car</li>\\n+        <li class=\\\"type\\\">isdn</li>\\n+        <li class=\\\"type\\\">pcs</li>\\n+        <li class=\\\"type\\\">invalid</li>\\n+      </ul>\\n+      <span class=\\\"value\\\">+1</span>\\n+      <span class=\\\"value\\\">415</span>\\n+      <span class=\\\"value\\\">555</span>\\n+      <span class=\\\"value\\\">1233</span>\\n+    </div>\\n+    <p class=\\\"tel\\\">\\n+      <abbr class=\\\"type\\\" title=\\\"home\\\">H</abbr>\\n+      <span class=\\\"value\\\">+1 415 555 1234</span>\\n+    </p>      \\n+    <a class=\\\"tel\\\" href=\\\"tel:+1.415.555.1235\\\">call me</a>\\n+    <object class=\\\"tel\\\" data=\\\"tel:+1.415.555.1236\\\">call me</object>\\n+    <area class=\\\"tel\\\" href=\\\"tel:+1.415.555.1237\\\">call me</area>\\n+    <a class=\\\"tel\\\" href=\\\"fax:+1.415.555.1238\\\">call me</a>\\n+    <object class=\\\"tel\\\" data=\\\"fax:+1.415.555.1239\\\">call me</object>\\n+    <area class=\\\"tel\\\" href=\\\"fax:+1.415.555.1240\\\">call me</area>\\n+    <a class=\\\"tel\\\" href=\\\"modem:+1.415.555.1241\\\">call me</a>\\n+    <object class=\\\"tel\\\" data=\\\"modem:+1.415.555.1242\\\">call me</object>\\n+    <area class=\\\"tel\\\" href=\\\"modem:+1.415.555.1243\\\">call me</area>\\n+  </div>\\n+\\n+  <!--     TODO: add test for 'extended' -->\\n+  <div class=\\\"vcard\\\" id=\\\"22-adr\\\">\\n+    <p class=\\\"fn\\\">John Doe</p>\\n+    <p class=\\\"adr\\\">\\n+      <span class=\\\"street-address\\\">1231 Main St.</span>\\n+      <span class=\\\"locality\\\">Beverly Hills</span>\\n+      <span class=\\\"region\\\">California</span>\\n+      <span class=\\\"country-name\\\">United States of America</span>\\n+      <span class=\\\"postal-code\\\">90210</span>\\n+    </p>\\n+<!--       multiple street-addresses, should produce a comma-seperated list -->\\n+    <p class=\\\"adr\\\">\\n+      <span class=\\\"post-office-box\\\">PO Box 1234</span>\\n+      <span class=\\\"street-address\\\">1232 Main St.</span>\\n+      <span class=\\\"street-address\\\">Suite 100</span>\\n+      <span class=\\\"locality\\\">Beverly Hills</span>\\n+      <span class=\\\"region\\\">California</span>\\n+      <span class=\\\"country-name\\\">United States of America</span>\\n+      <span class=\\\"postal-code\\\">90210</span>\\n+    </p>\\n+<!--       one type subproperty -->\\n+    <p class=\\\"adr\\\">\\n+      <span class=\\\"type\\\">home</span>\\n+      <span class=\\\"street-address\\\">1233 Main St.</span>\\n+      <span class=\\\"locality\\\">Beverly Hills</span>\\n+      <span class=\\\"region\\\">California</span>\\n+      <span class=\\\"country-name\\\">United States of America</span>\\n+      <span class=\\\"postal-code\\\">90210</span>\\n+    </p>\\n+<!-- many type subproperties, each with their own class name -->\\n+    <div class=\\\"adr\\\">\\n+      <ul>\\n+        <li class=\\\"type\\\">dom</li>\\n+        <li class=\\\"type\\\">intl</li>\\n+        <li class=\\\"type\\\">postal</li>\\n+        <li class=\\\"type\\\">parcel</li>\\n+        <li class=\\\"type\\\">home</li>\\n+        <li class=\\\"type\\\">work</li>\\n+        <li class=\\\"type\\\">pref</li>\\n+      </ul>\\n+      <span class=\\\"street-address\\\">1234 Main St.</span>\\n+      <span class=\\\"locality\\\">Beverly Hills</span>\\n+      <span class=\\\"region\\\">California</span>\\n+      <span class=\\\"country-name\\\">United States of America</span>\\n+      <span class=\\\"postal-code\\\">90210</span>\\n+    </div>\\n+  </div>\\n+\\n+  <p class=\\\"vcard\\\" id=\\\"23-abbr-title-everything\\\">\\n+<!-- perhaps the most annoying test ever -->\\n+    <abbr class=\\\"fn\\\" title=\\\"John Doe\\\">foo</abbr>\\n+    <span class=\\\"n\\\">\\n+      <abbr class=\\\"honorific-prefix\\\" title=\\\"Mister\\\">Mr.</abbr>\\n+      <abbr class=\\\"given-name\\\" title=\\\"Jonathan\\\">John</abbr>\\n+      <abbr class=\\\"additional-name\\\" title=\\\"John\\\">J</abbr>\\n+      <abbr class=\\\"family-name\\\" title=\\\"Doe-Smith\\\">Doe</abbr>\\n+      <abbr class=\\\"honorific-suffix\\\" title=\\\"Medical Doctor\\\">M.D</abbr>\\n+    </span>\\n+    <abbr class=\\\"nickname\\\" title=\\\"JJ\\\">jj</abbr>\\n+    <abbr class=\\\"bday\\\" title=\\\"2006-04-04\\\">April 4, 2006</abbr>\\n+    <span class=\\\"adr\\\">\\n+      <abbr class=\\\"post-office-box\\\" title=\\\"Box 1234\\\">B. 1234</abbr>\\n+      <abbr class=\\\"extended-address\\\" title=\\\"Suite 100\\\">Ste. 100</abbr>\\n+      <abbr class=\\\"street-address\\\" title=\\\"123 Fake Street\\\">123 Fake St.</abbr>\\n+      <abbr class=\\\"locality\\\" title=\\\"San Francisco\\\">San Fran</abbr>\\n+      <abbr class=\\\"region\\\" title=\\\"California\\\">CA</abbr>\\n+      <abbr class=\\\"postal-code\\\" title=\\\"12345-6789\\\">12345</abbr>\\n+      <abbr class=\\\"country-name\\\" title=\\\"United States of America\\\">USA</abbr>\\n+      <abbr class=\\\"type\\\" title=\\\"work\\\">workplace</abbr>\\n+    </span>\\n+    <abbr class=\\\"tel\\\" title=\\\"415.555.1234\\\">1234</abbr>\\n+    <abbr class=\\\"tel-type-value\\\" title=\\\"work\\\">workplace</abbr>\\n+<!--       mailer  -->\\n+    <abbr class=\\\"tz\\\" title=\\\"-0700\\\">Pacific Time</abbr>\\n+    <span class=\\\"geo\\\">\\n+      <abbr class=\\\"latitude\\\" title=\\\"37.77\\\">Northern</abbr>\\n+      <abbr class=\\\"longitude\\\" title=\\\"-122.41\\\">California</abbr>\\n+    </span>\\n+    <abbr class=\\\"title\\\" title=\\\"President\\\">pres.</abbr> and\\n+    <abbr class=\\\"role\\\" title=\\\"Chief\\\">cat wrangler</abbr>\\n+<!--       <span class=\\\"agent\\\"></span> -->\\n+    <span class=\\\"org\\\">\\n+      <abbr class=\\\"organization-name\\\" title=\\\"Intellicorp\\\">foo</abbr>\\n+      <abbr class=\\\"organization-unit\\\" title=\\\"Intelligence\\\">bar</abbr>\\n+    </span>\\n+<!--       <abbr class=\\\"category\\\" title=\\\"\\\"></abbr> -->\\n+    <abbr class=\\\"note\\\" title=\\\"this is a note\\\">this is not a note</abbr>\\n+<!--       <abbr class=\\\"rev\\\" title=\\\"\\\"></abbr>  (revision datetime) -->\\n+<!--       <abbr class=\\\"sort-string\\\" title=\\\"\\\"></abbr> -->\\n+    <abbr class=\\\"uid\\\" title=\\\"abcdefghijklmnopqrstuvwxyz\\\">alpha</abbr>\\n+    <abbr class=\\\"class\\\" title=\\\"public\\\">pub</abbr>\\n+<!--       <abbr class=\\\"key\\\" title=\\\"\\\"></abbr> -->\\n+  </p>\\n+\\n+  There is no 24\\n+\\n+  <p class=\\\"vcard\\\" id=\\\"25-geo-abbr\\\">\\n+    <abbr class=\\\"geo\\\" title=\\\"30.267991;-97.739568\\\"><span class=\\\"fn org\\\">Paradise</span></abbr>\\n+  </p>\\n+\\n+<!--     This test is to make sure that parsers look at ancestors, not just children.-->\\n+  <div class=\\\"vcard\\\" id=\\\"26-ancestors\\\">\\n+    <!-- perhaps the second most annoying test ever -->\\n+    <div>\\n+      <span class=\\\"fn\\\"><span>John</span> <span>Doe</span></span>\\n+        <span class=\\\"n\\\">\\n+          <span>\\n+            <span class=\\\"honorific-prefix\\\"><strong>Mister</strong></span>\\n+            <span class=\\\"given-name\\\"><i>Jonathan</i></span>\\n+            <span class=\\\"additional-name\\\"><b>John</b></span>\\n+            <span class=\\\"family-name\\\"><em>Doe-Smith</em></span>\\n+            <span class=\\\"honorific-suffix\\\">Medical Doctor</span>\\n+          </span>\\n+        </span>\\n+        <span class=\\\"nickname\\\"><span>JJ</span></span>\\n+        <span class=\\\"bday\\\">2006-04-04</span>\\n+        <span class=\\\"adr\\\">\\n+         <span>\\n+            <span class=\\\"post-office-box\\\"><samp>Box 1234</samp></span>\\n+            <span class=\\\"extended-address\\\"><dfn>Suite 100</dfn></span>\\n+            <span class=\\\"street-address\\\"><span>123 Fake Street</span></span>\\n+            <span class=\\\"locality\\\"><em>San Francisco</em></span>\\n+            <span class=\\\"region\\\"><strong>California</strong></span>\\n+            <span class=\\\"postal-code\\\"><abbr>12345-6789</abbr></span>\\n+            <span class=\\\"country-name\\\"><acronym>United States of America</acronym></span>\\n+            <span class=\\\"type\\\"><span>work</span></span>\\n+          </span>\\n+        </span>\\n+        <span class=\\\"tel\\\"><span>415</span>.<span>555</span>.<span>1234</span></span>\\n+        <span class=\\\"tel-type-value\\\">work</span>\\n+  <!--   @TODO    mailer?  -->\\n+        <span class=\\\"tz\\\"><span>-0700</span></span>\\n+        <span class=\\\"geo\\\">\\n+          <span>\\n+            <span class=\\\"latitude\\\"><code>37.77</code></span>\\n+            <span class=\\\"longitude\\\"><tt>-122.41</tt></span>\\n+          </span>\\n+        </span>\\n+        <span class=\\\"title\\\"><strong>President</strong></span> and\\n+        <span class=\\\"role\\\"><em>Chief</em></span>\\n+  <!--       <span class=\\\"agent</span> @TODO -->\\n+        <span class=\\\"org\\\">\\n+          <span class=\\\"organization-name\\\"><strong>Intellicorp</strong></span>\\n+          <span class=\\\"organization-unit\\\"><em>Intelligence</em></span>\\n+        </span>\\n+  <!--   @TODO    <span class=\\\"category\\\"></span> -->\\n+        <span class=\\\"note\\\"><cite>this is a note</cite></span>\\n+  <!--  @TODO     <span class=\\\"rev\\\"></span>  (revision datetime) -->\\n+  <!--  @TODO     <span class=\\\"sort-string\\\"></span> -->\\n+        <span class=\\\"uid\\\"><kbd>abcdefghijklmnopqrstuvwxyz</kbd></span>\\n+        <span class=\\\"class\\\"><samp>public</samp></span>\\n+  <!--  @TODO     <span class=\\\"key\\\"></span> -->\\n+    </div>\\n+  </div>\\n+\\n+  <p class=\\\"vcard\\\" id=\\\"27-bday-date\\\">\\n+    <span class=\\\"fn\\\">john doe</span>,\\n+    <abbr class=\\\"bday\\\" title=\\\"2000-01-01\\\">January 1st, 2000</abbr>\\n+  </p>\\n+  \\n+  <p class=\\\"vcard\\\" id=\\\"28-bday-datetime\\\">\\n+    <span class=\\\"fn\\\">john doe</span>,\\n+    <abbr class=\\\"bday\\\" title=\\\"2000-01-01T00:00:00\\\">January 1st, 2000 at midnight</abbr>\\n+  </p>\\n+\\n+  <p class=\\\"vcard\\\" id=\\\"29-bday-datetime-timezone\\\">\\n+    <span class=\\\"fn\\\">john doe</span>,\\n+    <abbr class=\\\"bday\\\" title=\\\"2000-01-01T00:00:00-0800\\\">January 1st, 2000 at midnight on the north american west coast</abbr>\\n+  </p>\\n+\\n+  <div class=\\\"vcard\\\" id=\\\"30-fn-org.1\\\">\\n+    <div class=\\\"fn org\\\">W3C</div>\\n+  </div>\\n+  <div class=\\\"vcard\\\" id=\\\"30-fn-org.2\\\">\\n+    <div class=\\\"fn\\\">Dan Connolly</div>\\n+    <div class=\\\"org\\\">W3C</div>\\n+  </div>\\n+  <div class=\\\"vcard\\\" id=\\\"30-fn-org.3\\\">\\n+    <img class=\\\"fn\\\" src=\\\"http://www.w3.org/Icons/w3c_home\\\" alt=\\\"W3C\\\" />\\n+    <div class=\\\"org\\\">W3C</div>\\n+  </div>\\n+  <div class=\\\"vcard\\\" id=\\\"30-fn-org.4\\\">\\n+    <img class=\\\"fn org\\\" src=\\\"http://www.w3.org/Icons/w3c_home\\\"\\n+         alt=\\\"World Wide Web Consortium\\\" />\\n+  </div>\\n+  <div class=\\\"vcard\\\" id=\\\"30-fn-org.5\\\">\\n+    <object data=\\\"http://www.w3.org/Icons/w3c_home\\\">\\n+      <abbr class=\\\"fn org\\\" title=\\\"World Wide Web Consortium\\\">W3C</abbr>\\n+    </object>\\n+  </div>\\n+  \\n+  <p id=\\\"email1\\\"><a href=\\\"mailto:correct@example.com\\\" class=\\\"email\\\">my email</a></p>\\n+  <p id=\\\"email2\\\"><a href=\\\"mailto:incorrect@example.com\\\" class=\\\"email\\\">my email</a></p>\\n+  <div class=\\\"vcard\\\" id=\\\"31-include.1\\\">\\n+    <a class=\\\"url fn\\\" href=\\\"http://suda.co.uk/\\\">Brian Suda</a>\\n+    <object data=\\\"#email1\\\" class=\\\"include\\\" type=\\\"text/html\\\"/>\\n+    <object data=\\\"#email2\\\" type=\\\"text/html\\\"/>\\n+  </div>\\n+  <div class=\\\"vcard\\\" id=\\\"31-include.2\\\">\\n+    <a class=\\\"url fn\\\" href=\\\"http://suda.co.uk/\\\">Brian Suda</a>\\n+    <a href=\\\"#email1\\\" class=\\\"include\\\"></a>\\n+    <a href=\\\"#email2\\\"/>\\n+  </div>\\n+  <div class=\\\"vcard\\\" id=\\\"31-include.3\\\">\\n+    <a class=\\\"url fn\\\" href=\\\"http://suda.co.uk/\\\">Brian Suda</a>\\n+    <a href=\\\"#email1\\\" class=\\\"include\\\"/>\\n+    <a href=\\\"#email2\\\"/>\\n+  </div>\\n+\\n+  <table>\\n+    <tr>\\n+      <th id=\\\"org\\\" ><a class=\\\"url org\\\" href=\\\"http://example.org/\\\">example.org</a></th>\\n+    </tr>\\n+    <tr>\\n+      <td class=\\\"vcard\\\" id=\\\"32-header.1\\\" headers=\\\"org\\\"><span class=\\\"fn\\\">Brian Suda</span></td>\\n+    </tr>\\n+    <tr>\\n+      <td class=\\\"vcard\\\" id=\\\"32-header.2\\\" headers=\\\"org\\\"><span class=\\\"fn\\\">John Doe</span></td>\\n+    </tr>\\n+  </table>\\n+  \\n+  <div class=\\\"vcard\\\" id=\\\"33-area.1\\\">\\n+    <map id=\\\"mailto-test-1\\\">\\n+      <area class=\\\"fn email\\\" href=\\\"mailto:joe@example.com\\\" alt=\\\"Joe Public\\\"/>\\n+      <area class=\\\"url\\\" href=\\\"http://example.com/\\\" alt=\\\"my website!\\\" />\\n+    </map>\\n+  </div>\\n+  <div class=\\\"vcard\\\" id=\\\"33-area.2\\\">\\n+    <map id=\\\"mailto-test-2\\\">\\n+      <area class=\\\"fn email\\\" href=\\\"mailto:joe@example.com\\\" alt=\\\"Joe Public\\\"/>\\n+      <area class=\\\"url\\\" href=\\\"http://example.com/\\\" alt=\\\"my website!\\\" />\\n+      <area class=\\\"org\\\" href=\\\"http://example.com/\\\" alt=\\\"Joe Public\\\" />\\n+    </map>\\n+  </div>\\n+  <div class=\\\"vcard\\\" id=\\\"33-area.3\\\">\\n+    <map id=\\\"mailto-test-3\\\">\\n+      <area class=\\\"fn email\\\" href=\\\"mailto:joe@example.com\\\" alt=\\\"Joe Public\\\"/>\\n+      <area class=\\\"url\\\" href=\\\"http://example.com/\\\" alt=\\\"my website!\\\" />\\n+    </map>\\n+    <img class=\\\"org\\\" src=\\\"http://example.com/\\\" alt=\\\"Joe Public\\\" />\\n+  </div>\\n+  <div class=\\\"vcard\\\" id=\\\"33-area.4\\\">\\n+    <map id=\\\"mailto-test-4\\\">\\n+      <area class=\\\"fn email\\\" href=\\\"mailto:joe@example.com\\\" alt=\\\"Joe Public\\\"/>\\n+      <area class=\\\"url\\\" href=\\\"http://example.com/\\\" alt=\\\"my website!\\\" />\\n+    </map>\\n+    <div class=\\\"org\\\">Joe Public</div>\\n+  </div>\\n+  <div class=\\\"vcard\\\" id=\\\"33-area.5\\\">\\n+    <map id=\\\"mailto-test-5\\\">\\n+      <area class=\\\"fn email\\\" href=\\\"mailto:joe@example.com\\\" alt=\\\"Joe Public\\\"/>\\n+      <area class=\\\"url\\\" href=\\\"http://example.com/\\\" alt=\\\"my website!\\\" />\\n+    </map>\\n+    <abbr class=\\\"org\\\" title=\\\"Joe Public\\\">Joe</abbr>\\n+  </div>\\n+\\n+  <div class=\\\"vcard\\\" id=\\\"34-notes\\\">\\n+    <a class=\\\"fn email\\\" href=\\\"mailto:joe@example.com\\\">Joe Public</a>\\n+    <span class=\\\"note\\\">Note 1</span>\\n+    <span class=\\\"foorbar\\\">Note 2</span>\\n+    <span class=\\\"note foorbar\\\">Note 3</span>\\n+    <span class=\\\"note foorbar\\\">Note 4 with a ; and a , to be escaped<!-- this <strong>should</strong> be ignored--></span>\\n+  </div>\\n+  \\n+  <div class=\\\"vcard\\\" id=\\\"35-include-pattern.1\\\">\\n+    <span class=\\\"fn n\\\" id=\\\"j\\\">\\n+      <span class=\\\"given-name\\\">James</span> <span class=\\\"family-name\\\">Levine</span>\\n+    </span>\\n+  </div>\\n+  <div class=\\\"vcard\\\" id=\\\"35-include-pattern.2\\\">\\n+    <object data=\\\"#j\\\" class=\\\"include\\\" type=\\\"text/html\\\"></object>\\n+    <span class=\\\"org\\\">SimplyHired</span>\\n+    <span class=\\\"title\\\">Microformat Brainstormer</span>\\n+  </div>\\n+  <div class=\\\"vcard\\\" id=\\\"35-include-pattern.3\\\">\\n+    <span class=\\\"fn n\\\" id=\\\"j2\\\">\\n+      <span class=\\\"given-name\\\">James</span> <span class=\\\"family-name\\\">Levine</span>\\n+    </span>\\n+    <span class=\\\"org\\\">SimplyHired</span>\\n+    <span class=\\\"title\\\">Microformat Brainstormer</span>\\n+  </div>\\n+\\n+  <p class=\\\"vcard\\\" id=\\\"36-categories.1\\\">\\n+    <span class=\\\"fn\\\">john doe</span>,\\n+    <abbr class=\\\"category\\\" title=\\\"C1\\\">C1a</abbr>\\n+    <a class=\\\"category\\\" href=\\\"http://example.com\\\" title=\\\"C2\\\">C2a</a>\\n+    <a class=\\\"category\\\" href=\\\"http://example.com/C3\\\" rel=\\\"tag\\\" title=\\\"C3a\\\">C3b</a>\\n+    <img class=\\\"category\\\" src=\\\"http://example.com/\\\" alt=\\\"C4\\\"/>\\n+    <a class=\\\"category\\\" href=\\\"http://example.com/C5/\\\" rel=\\\"tag\\\" title=\\\"C5a\\\">C5b</a>\\n+    <a class=\\\"category\\\" href=\\\"http://example.com/C6?tag=false\\\" rel=\\\"tag\\\" title=\\\"C6a\\\">C6b</a>\\n+    <a class=\\\"category\\\" href=\\\"http://example.com/C7#anchor\\\" rel=\\\"tag\\\" title=\\\"C7a\\\">C7b</a>\\n+    <a class=\\\"category\\\" href=\\\"http://example.com/C8?tag=trailing-slash/\\\" rel=\\\"tag\\\" title=\\\"C8a\\\">C8b</a>\\n+    <a class=\\\"category\\\" href=\\\"http://example.com/C9/?tag=trailing-slash/\\\" rel=\\\"tag\\\" title=\\\"C9a\\\">C9b</a>\\n+  </p>\\n+  <div class=\\\"vcard\\\" id=\\\"36-categories.2\\\">\\n+    <span class=\\\"fn n\\\">\\n+      <span class=\\\"given-name\\\">Joe</span> <span class=\\\"family-name\\\">User</span>\\n+    </span>\\n+    <span class=\\\"category\\\">User</span>\\n+    <a class=\\\"category\\\" rel=\\\"tag\\\" href=\\\"http://example.com/luser\\\">a big luser!</a>\\n+  </div>  \\n+\\n+  <p class=\\\"vcard\\\" id=\\\"37-singleton\\\">\\n+    <span class=\\\"fn n\\\"><span class=\\\"given-name\\\">john</span> <span class=\\\"family-name\\\"><span class=\\\"sort-string\\\">d</span>oe</span> 1</span>\\n+    <span class=\\\"fn n\\\"><span class=\\\"given-name\\\"><span class=\\\"sort-string\\\">j</span>ohn</span> <span class=\\\"family-name\\\">doe</span> 2</span>\\n+    <abbr class=\\\"bday\\\" title=\\\"20060707\\\">today</abbr>\\n+    <abbr class=\\\"bday\\\" title=\\\"20060708\\\">tomorrow</abbr>\\n+    <abbr class=\\\"geo\\\" title=\\\"123.45;67.89\\\">Here</abbr>\\n+    <abbr class=\\\"geo\\\" title=\\\"98.765;43.21\\\">There</abbr>\\n+    <abbr class=\\\"rev\\\" title=\\\"20060707\\\">today</abbr>\\n+    <abbr class=\\\"rev\\\" title=\\\"20060708\\\">tomorrow</abbr>\\n+    <abbr class=\\\"uid\\\" title=\\\"unique-id-1\\\">id-1</abbr>\\n+    <abbr class=\\\"uid\\\" title=\\\"unique-id-2\\\">id-2</abbr>\\n+    <span class=\\\"tz\\\">+0600</span>\\n+    <span class=\\\"tz\\\">+0800</span>\\n+    <span class=\\\"class\\\">public</span>\\n+    <span class=\\\"class\\\">private</span>\\n+  </p>\\n+\\n+  <div class=\\\"vcard\\\" id=\\\"38-uid.1\\\">\\n+    <span class=\\\"fn\\\">Ryan King</span>\\n+    <a class=\\\"url uid\\\" href=\\\"http://theryanking.com/contact/\\\">My other hCard</a>\\n+  </div>\\n+  <div class=\\\"vcard\\\" id=\\\"38-uid.2\\\">\\n+    <span class=\\\"fn\\\">Ryan King</span>\\n+    <object class=\\\"url uid\\\" data=\\\"http://theryanking.com/contact/\\\">My other hCard</object>\\n+  </div>\\n+  <div class=\\\"vcard\\\" id=\\\"38-uid.3\\\">\\n+    <span class=\\\"fn\\\">Ryan King</span>\\n+    <img class=\\\"url uid\\\" src=\\\"http://theryanking.com/contact/\\\" alt=\\\"my other hcard\\\" />\\n+  </div>\\n+  <div class=\\\"vcard\\\" id=\\\"38-uid.4\\\">\\n+    <span class=\\\"fn\\\">Ryan King</span>\\n+    <map id=\\\"foo\\\"><area class=\\\"url uid\\\" href=\\\"http://theryanking.com/contact/\\\" alt=\\\"my other hcard\\\" /></map>\\n+  </div>\\n+  \\n+</div>\\n+<pre id=\\\"test\\\">\\n+<script class=\\\"testbody\\\" type=\\\"text/javascript\\\">\\n+\\n+test_Microformats();\\n+test_hCard();\\n+\\n+function test_Microformats() {\\n+  netscape.security.PrivilegeManager.enablePrivilege(\\\"UniversalXPConnect\\\");\\n+\\n+  Components.utils.import(\\\"resource://gre/modules/Microformats.js\\\");\\n+\\n+  ok(Microformats, \\\"Check global access to Microformats\\\");\\n+};\\n+\\n+function test_hCard() {\\n+  netscape.security.PrivilegeManager.enablePrivilege(\\\"UniversalXPConnect\\\");\\n+\\n+  Components.utils.import(\\\"resource://gre/modules/Microformats.js\\\");\\n+\\n+  var hcard;\\n+\\n+  hcard = new hCard(document.getElementById(\\\"01-tantek-basic\\\"));\\n+\\n+  is(hcard.fn, \\\"Tantek Çelik\\\", \\\"01-tantek-basic - fn\\\");\\n+  is(hcard.url, \\\"http://tantek.com/\\\", \\\"01-tantek-basic - url\\\");\\n+  is(hcard.n[\\\"given-name\\\"], \\\"Tantek\\\", \\\"01-tantek-basic - given-name\\\");\\n+  is(hcard.n[\\\"family-name\\\"], \\\"Çelik\\\", \\\"01-tantek-basic - family-name\\\");\\n+  is(hcard.org[0][\\\"organization-name\\\"], \\\"Technorati\\\", \\\"01-tantek-basic - organization-name\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"02-multiple-class-names-on-vcard.1\\\"));\\n+\\n+  is(hcard.fn, \\\"Ryan King\\\", \\\"02-multiple-class-names-on-vcard.1 - fn\\\");\\n+  is(hcard.n[\\\"given-name\\\"], \\\"Ryan\\\", \\\"02-multiple-class-names-on-vcard.1 - given-name\\\");\\n+  is(hcard.n[\\\"family-name\\\"], \\\"King\\\", \\\"02-multiple-class-names-on-vcard.1 - family-name\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"02-multiple-class-names-on-vcard.2\\\"));\\n+\\n+  is(hcard.fn, \\\"Ryan King\\\", \\\"02-multiple-class-names-on-vcard.2 - fn\\\");\\n+  is(hcard.n[\\\"given-name\\\"], \\\"Ryan\\\", \\\"02-multiple-class-names-on-vcard.2 - given-name\\\");\\n+  is(hcard.n[\\\"family-name\\\"], \\\"King\\\", \\\"02-multiple-class-names-on-vcard.2 - family-name\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"02-multiple-class-names-on-vcard.3\\\"));\\n+\\n+  is(hcard.fn, \\\"Ryan King\\\", \\\"02-multiple-class-names-on-vcard.3 - fn\\\");\\n+  is(hcard.n[\\\"given-name\\\"], \\\"Ryan\\\", \\\"02-multiple-class-names-on-vcard.3 - given-name\\\");\\n+  is(hcard.n[\\\"family-name\\\"], \\\"King\\\", \\\"02-multiple-class-names-on-vcard.3 - family-name\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"03-implied-n.1\\\"));\\n+\\n+  is(hcard.fn, \\\"Ryan King\\\", \\\"03-implied-n.1 - fn\\\");\\n+  is(hcard.n[\\\"given-name\\\"], \\\"Ryan\\\", \\\"03-implied-n.1 - given-name\\\");\\n+  is(hcard.n[\\\"family-name\\\"], \\\"King\\\", \\\"03-implied-n.1 - family-name\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"03-implied-n.2\\\"));\\n+\\n+  is(hcard.fn, \\\"Ryan King\\\", \\\"03-implied-n.2 - fn\\\");\\n+  is(hcard.n[\\\"given-name\\\"], \\\"Ryan\\\", \\\"03-implied-n.2 - given-name\\\");\\n+  is(hcard.n[\\\"family-name\\\"], \\\"King\\\", \\\"03-implied-n.2 - family-name\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"03-implied-n.3\\\"));\\n+\\n+  is(hcard.fn, \\\"Ryan King\\\", \\\"03-implied-n.3 - fn\\\");\\n+  is(hcard.n[\\\"given-name\\\"], \\\"Ryan\\\", \\\"03-implied-n.3 - given-name\\\");\\n+  is(hcard.n[\\\"family-name\\\"], \\\"King\\\", \\\"03-implied-n.3 - family-name\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"03-implied-n.4\\\"));\\n+\\n+  is(hcard.fn, \\\"Brian Suda\\\", \\\"03-implied-n.4 - fn\\\");\\n+  is(hcard.n[\\\"given-name\\\"], \\\"Brian\\\", \\\"03-implied-n.4 - given-name\\\");\\n+  is(hcard.n[\\\"family-name\\\"], \\\"Suda\\\", \\\"03-implied-n.4 - family-name\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"03-implied-n.5\\\"));\\n+\\n+  is(hcard.fn, \\\"King, Ryan\\\", \\\"03-implied-n.5 - fn\\\");\\n+  is(hcard.n[\\\"given-name\\\"], \\\"Ryan\\\", \\\"03-implied-n.5 - given-name\\\");\\n+  is(hcard.n[\\\"family-name\\\"], \\\"King\\\", \\\"03-implied-n.5 - family-name\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"03-implied-n.6\\\"));\\n+\\n+  is(hcard.fn, \\\"King, R\\\", \\\"03-implied-n.6 - fn\\\");\\n+  is(hcard.n[\\\"given-name\\\"], \\\"R\\\", \\\"03-implied-n.6 - given-name\\\");\\n+  is(hcard.n[\\\"family-name\\\"], \\\"King\\\", \\\"03-implied-n.6 - family-name\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"03-implied-n.7\\\"));\\n+\\n+  is(hcard.fn, \\\"King R\\\", \\\"03-implied-n.7 - fn\\\");\\n+  is(hcard.n[\\\"given-name\\\"], \\\"R\\\", \\\"03-implied-n.7 - given-name\\\");\\n+  is(hcard.n[\\\"family-name\\\"], \\\"King\\\", \\\"03-implied-n.7 - family-name\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"03-implied-n.8\\\"));\\n+\\n+  is(hcard.fn, \\\"King R.\\\", \\\"03-implied-n.8 - fn\\\");\\n+  is(hcard.n[\\\"given-name\\\"], \\\"R.\\\", \\\"03-implied-n.8 - given-name\\\");\\n+  is(hcard.n[\\\"family-name\\\"], \\\"King\\\", \\\"03-implied-n.8 - family-name\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"03-implied-n.9\\\"));\\n+\\n+  is(hcard.fn, \\\"Jesse James Garrett\\\", \\\"03-implied-n.9 - fn\\\");\\n+  ok(hcard.n === undefined, \\\"03-implied-n.9 -n\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"03-implied-n.10\\\"));\\n+\\n+  is(hcard.fn, \\\"Thomas Vander Wal\\\", \\\"03-implied-n.10 - fn\\\");\\n+  ok(hcard.n === undefined, \\\"03-implied-n.10 -n\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"04-ignore-unknowns\\\"));\\n+\\n+  is(hcard.fn, \\\"Ryan King\\\", \\\"04-ignore-unknowns - fn\\\");\\n+  is(hcard.n[\\\"given-name\\\"], \\\"Ryan\\\", \\\"04-ignore-unknowns - given-name\\\");\\n+  is(hcard.n[\\\"family-name\\\"], \\\"King\\\", \\\"04-ignore-unknowns - family-name\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"05-mailto-1\\\"));\\n+\\n+  is(hcard.fn, \\\"Ryan King\\\", \\\"05-mailto-1 - fn\\\");\\n+  is(hcard.n[\\\"given-name\\\"], \\\"Ryan\\\", \\\"05-mailto-1 - given-name\\\");\\n+  is(hcard.n[\\\"family-name\\\"], \\\"King\\\", \\\"05-mailto-1 - family-name\\\");\\n+  is(hcard.email[0].value, \\\"ryan@technorati.com\\\", \\\"05-mailto-1 - email\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"06-mailto-2\\\"));\\n+\\n+  is(hcard.fn, \\\"Brian Suda\\\", \\\"06-mailto-2 - fn\\\");\\n+  is(hcard.n[\\\"given-name\\\"], \\\"Brian\\\", \\\"06-mailto-2 - given-name\\\");\\n+  is(hcard.n[\\\"family-name\\\"], \\\"Suda\\\", \\\"06-mailto-2 - family-name\\\");\\n+  is(hcard.email[0].value, \\\"brian@example.com\\\", \\\"06-mailto-2 - email\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"07-relative-url\\\"));\\n+\\n+  is(hcard.fn, \\\"John Doe\\\", \\\"07-relative-url - fn\\\");\\n+  is(hcard.n[\\\"given-name\\\"], \\\"John\\\", \\\"07-relative-url - given-name\\\");\\n+  is(hcard.n[\\\"family-name\\\"], \\\"Doe\\\", \\\"07-relative-url - family-name\\\");\\n+//  is(hcard.url[0], \\\"http://microformats.org/home/blah\\\", \\\"07-relative-url - url\\\");\\n+  is(hcard.url, \\\"http://localhost:8888/home/blah\\\", \\\"07-relative-url - url\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"11-multiple-urls\\\"));\\n+\\n+  is(hcard.fn, \\\"John Doe\\\", \\\"11-multiple-urls - fn\\\");\\n+  is(hcard.n[\\\"given-name\\\"], \\\"John\\\", \\\"11-multiple-urls - given-name\\\");\\n+  is(hcard.n[\\\"family-name\\\"], \\\"Doe\\\", \\\"11-multiple-urls - family-name\\\");\\n+  is(hcard.url[0], \\\"http://example.com/foo\\\", \\\"11-multiple-urls - url\\\");\\n+  is(hcard.url[1], \\\"http://example.com/bar\\\", \\\"11-multiple-urls - url\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"12-img-src-url\\\"));\\n+\\n+  is(hcard.fn, \\\"John Doe\\\", \\\"12-img-src-url - fn\\\");\\n+  is(hcard.n[\\\"given-name\\\"], \\\"John\\\", \\\"12-img-src-url - given-name\\\");\\n+  is(hcard.n[\\\"family-name\\\"], \\\"Doe\\\", \\\"12-img-src-url - family-name\\\");\\n+  is(hcard.url[0], \\\"http://example.org/picture.png\\\", \\\"12-img-src-url - url\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"13-photo-logo\\\"));\\n+\\n+  is(hcard.fn, \\\"John Doe\\\", \\\"13-photo-logo - fn\\\");\\n+  is(hcard.n[\\\"given-name\\\"], \\\"John\\\", \\\"13-photo-logo - given-name\\\");\\n+  is(hcard.n[\\\"family-name\\\"], \\\"Doe\\\", \\\"13-photo-logo - family-name\\\");\\n+  is(hcard.logo, \\\"http://example.org/picture.png\\\", \\\"13-photo-logo - logo\\\");\\n+  is(hcard.photo, \\\"http://example.org/picture.png\\\", \\\"13-photo-logo - photo\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"14-img-src-data-url\\\"));\\n+\\n+  is(hcard.fn, \\\"John Doe\\\", \\\"14-img-src-data-url - fn\\\");\\n+  is(hcard.n[\\\"given-name\\\"], \\\"John\\\", \\\"14-img-src-data-url - given-name\\\");\\n+  is(hcard.n[\\\"family-name\\\"], \\\"Doe\\\", \\\"14-img-src-data-url - family-name\\\");\\n+  is(hcard.logo, \\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAASUExURf///8zMzJmZmWZmZjMzMwAAAPOPemkAAAM1SURBVHjaYmBgYGBkYQUBFkYWFiCPCchixQAMCCZAACF0MAMVM4K4TFh0IGsBCCAkOxhYmBnAAKaHhZkZmxaAAGJgYIbpYGBihGgBWsTMzMwE4jIhaWGAYoAAYmCECDExYAcwGxkg5oNIgABigDqLARdgZmGB2wICrKwAAcSA3xKgIxlZ0PwCEEAMBCxhgHoWSQtAADFAAxgfYEJ1GEAAQbQw4tUCsocBYQVAADEgu4uRkREeUCwszEwwLhOKLQABhNDCBA4aSDgwwhIAJKqYUPwCEEAMUK/AUwnc9aywJMCI7DAgAAggBohZ8JTBhGIJzCoWZL8ABBCYidAB8RUjWppkYUG2BSCAGMDqEMZiswUtXgACiAHsFYixTMywGGLGpgUWYgABxAA2mQkWCMyMqFoYmdD8ACQAAogBHJHMrCxg1cyIiICmCkYWDFsAAgiihYmZCewFFpR0BfI3LLch+QUggBiQ0iQjEyMDmh54qCBlUIAAYsCRJsElADQvgWKTlRGeKwECiAF3XgGmMEYQYADZzcoA9z5AAMG9RQCAtEC9DxBADFiyFyMjVi0wABBAWLQwQdIiuhYGWJIACCBg+KKUJ9BoBRdS2LQALQMIIGDQIEmwAO1kYcVWHCDZAhBAqFqYmOAxj2YNtAwDAYAAYmDEiBYWzHKKkRERYiwAAYSphZEZwxZGZiZQVEJTJkAAMTCyokc7M5oORlC5wcoEjxeAAAJqQXU0UB6W5WFmABMtEzMi1wEEEFAbE0YyAUuzMMEsYQalMkQSBQggUDmNPU3C9IA4LCxI+QUggEBiKOU8yExgqccCL3chnkPKlQABhGo6ejHBDKmdUHMlQAAhhQvQaGZGkBIkjcAMywLmI+VKgABCSowsTJhZkhlWXiBpAQggYBqBZl9GVOdBcz0LZqEEEEAMqLULMBLg1THWog9IAwQQA0qiZcRW5aPbAhBADCg1El4tMAAQQAxoiZYZXnTh1AIQQAzo2QlYpDDjcBgrxGEAAcSAJTthswmiBUwDBBC2GpkZJTaRvQ+mAQKIAUuuxdZWQvILQABBmSxMjBj5EpcWgACCMoFOYYSpZyHQHgMIMACt2hmoVEikCQAAAABJRU5ErkJggg==\\\", \\\"14-img-src-data-url - logo\\\");\\n+  is(hcard.photo, \\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAASUExURf///8zMzJmZmWZmZjMzMwAAAPOPemkAAAM1SURBVHjaYmBgYGBkYQUBFkYWFiCPCchixQAMCCZAACF0MAMVM4K4TFh0IGsBCCAkOxhYmBnAAKaHhZkZmxaAAGJgYIbpYGBihGgBWsTMzMwE4jIhaWGAYoAAYmCECDExYAcwGxkg5oNIgABigDqLARdgZmGB2wICrKwAAcSA3xKgIxlZ0PwCEEAMBCxhgHoWSQtAADFAAxgfYEJ1GEAAQbQw4tUCsocBYQVAADEgu4uRkREeUCwszEwwLhOKLQABhNDCBA4aSDgwwhIAJKqYUPwCEEAMUK/AUwnc9aywJMCI7DAgAAggBohZ8JTBhGIJzCoWZL8ABBCYidAB8RUjWppkYUG2BSCAGMDqEMZiswUtXgACiAHsFYixTMywGGLGpgUWYgABxAA2mQkWCMyMqFoYmdD8ACQAAogBHJHMrCxg1cyIiICmCkYWDFsAAgiihYmZCewFFpR0BfI3LLch+QUggBiQ0iQjEyMDmh54qCBlUIAAYsCRJsElADQvgWKTlRGeKwECiAF3XgGmMEYQYADZzcoA9z5AAMG9RQCAtEC9DxBADFiyFyMjVi0wABBAWLQwQdIiuhYGWJIACCBg+KKUJ9BoBRdS2LQALQMIIGDQIEmwAO1kYcVWHCDZAhBAqFqYmOAxj2YNtAwDAYAAYmDEiBYWzHKKkRERYiwAAYSphZEZwxZGZiZQVEJTJkAAMTCyokc7M5oORlC5wcoEjxeAAAJqQXU0UB6W5WFmABMtEzMi1wEEEFAbE0YyAUuzMMEsYQalMkQSBQggUDmNPU3C9IA4LCxI+QUggEBiKOU8yExgqccCL3chnkPKlQABhGo6ejHBDKmdUHMlQAAhhQvQaGZGkBIkjcAMywLmI+VKgABCSowsTJhZkhlWXiBpAQggYBqBZl9GVOdBcz0LZqEEEEAMqLULMBLg1THWog9IAwQQA0qiZcRW5aPbAhBADCg1El4tMAAQQAxoiZYZXnTh1AIQQAzo2QlYpDDjcBgrxGEAAcSAJTthswmiBUwDBBC2GpkZJTaRvQ+mAQKIAUuuxdZWQvILQABBmSxMjBj5EpcWgACCMoFOYYSpZyHQHgMIMACt2hmoVEikCQAAAABJRU5ErkJggg==\\\", \\\"14-img-src-data-url - photo\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"15-honorific-additional-single\\\"));\\n+\\n+  is(hcard.fn, \\\"Mr. John Maurice Doe, Ph.D.\\\", \\\"15-honorific-additional-single - fn\\\");\\n+  is(hcard.n[\\\"given-name\\\"], \\\"John\\\", \\\"15-honorific-additional-single - given-name\\\");\\n+  is(hcard.n[\\\"family-name\\\"], \\\"Doe\\\", \\\"15-honorific-additional-single - family-name\\\");\\n+  is(hcard.n[\\\"honorific-prefix\\\"], \\\"Mr.\\\", \\\"15-honorific-additional-single - honorific-prefix\\\");\\n+  is(hcard.n[\\\"additional-name\\\"], \\\"Maurice\\\", \\\"15-honorific-additional-single - additional-name\\\");\\n+  is(hcard.n[\\\"honorific-suffix\\\"], \\\"Ph.D.\\\", \\\"15-honorific-additional-single - honorific-suffix\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"16-honorific-additional-multiple\\\"));\\n+\\n+  is(hcard.fn, \\\"Mr. Dr. John Maurice Benjamin Doe Ph.D., J.D.\\\", \\\"16-honorific-additional-multiple - fn\\\");\\n+  is(hcard.n[\\\"given-name\\\"], \\\"John\\\", \\\"16-honorific-additional-multiple - given-name\\\");\\n+  is(hcard.n[\\\"family-name\\\"], \\\"Doe\\\", \\\"16-honorific-additional-multiple - family-name\\\");\\n+  is(hcard.n[\\\"honorific-prefix\\\"][0], \\\"Mr.\\\", \\\"16-honorific-additional-multiple - honorific-prefix\\\");\\n+  is(hcard.n[\\\"honorific-prefix\\\"][1], \\\"Dr.\\\", \\\"16-honorific-additional-multiple - honorific-prefix\\\");\\n+  is(hcard.n[\\\"additional-name\\\"][0], \\\"Maurice\\\", \\\"16-honorific-additional-multiple - additional-name\\\");\\n+  is(hcard.n[\\\"additional-name\\\"][1], \\\"Benjamin\\\", \\\"16-honorific-additional-multiple - additional-name\\\");\\n+  is(hcard.n[\\\"honorific-suffix\\\"][0], \\\"Ph.D.\\\", \\\"16-honorific-additional-multiple - honorific-suffix\\\");\\n+  is(hcard.n[\\\"honorific-suffix\\\"][1], \\\"J.D.\\\", \\\"16-honorific-additional-multiple - honorific-suffix\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"17-email-not-uri\\\"));\\n+\\n+  is(hcard.fn, \\\"John Doe\\\", \\\"17-email-not-uri - fn\\\");\\n+  is(hcard.n[\\\"given-name\\\"], \\\"John\\\", \\\"17-email-not-uri - given-name\\\");\\n+  is(hcard.n[\\\"family-name\\\"], \\\"Doe\\\", \\\"17-email-not-uri - family-name\\\");\\n+  is(hcard.email[0].value, \\\"john@example.com\\\", \\\"17-email-not-uri - email\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"18-object-data-http-uri\\\"));\\n+\\n+  is(hcard.fn, \\\"John Doe\\\", \\\"18-object-data-http-uri - fn\\\");\\n+  is(hcard.n[\\\"given-name\\\"], \\\"John\\\", \\\"18-object-data-http-uri - given-name\\\");\\n+  is(hcard.n[\\\"family-name\\\"], \\\"Doe\\\", \\\"18-object-data-http-uri - family-name\\\");\\n+  is(hcard.logo, \\\"http://example.com/foo.png\\\", \\\"18-object-data-http-uri - logo\\\");\\n+  is(hcard.photo, \\\"http://example.com/foo.png\\\", \\\"18-object-data-http-uri - photo\\\");\\n+  is(hcard.url, \\\"http://example.com/foo.png\\\", \\\"18-object-data-http-uri - url\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"19-object-data-data-uri\\\"));\\n+\\n+  is(hcard.fn, \\\"John Doe\\\", \\\"19-object-data-data-uri - fn\\\");\\n+  is(hcard.n[\\\"given-name\\\"], \\\"John\\\", \\\"19-object-data-data-uri - given-name\\\");\\n+  is(hcard.n[\\\"family-name\\\"], \\\"Doe\\\", \\\"19-object-data-data-uri - family-name\\\");\\n+  is(hcard.logo, \\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAASUExURf///8zMzJmZmWZmZjMzMwAAAPOPemkAAAM1SURBVHjaYmBgYGBkYQUBFkYWFiCPCchixQAMCCZAACF0MAMVM4K4TFh0IGsBCCAkOxhYmBnAAKaHhZkZmxaAAGJgYIbpYGBihGgBWsTMzMwE4jIhaWGAYoAAYmCECDExYAcwGxkg5oNIgABigDqLARdgZmGB2wICrKwAAcSA3xKgIxlZ0PwCEEAMBCxhgHoWSQtAADFAAxgfYEJ1GEAAQbQw4tUCsocBYQVAADEgu4uRkREeUCwszEwwLhOKLQABhNDCBA4aSDgwwhIAJKqYUPwCEEAMUK/AUwnc9aywJMCI7DAgAAggBohZ8JTBhGIJzCoWZL8ABBCYidAB8RUjWppkYUG2BSCAGMDqEMZiswUtXgACiAHsFYixTMywGGLGpgUWYgABxAA2mQkWCMyMqFoYmdD8ACQAAogBHJHMrCxg1cyIiICmCkYWDFsAAgiihYmZCewFFpR0BfI3LLch+QUggBiQ0iQjEyMDmh54qCBlUIAAYsCRJsElADQvgWKTlRGeKwECiAF3XgGmMEYQYADZzcoA9z5AAMG9RQCAtEC9DxBADFiyFyMjVi0wABBAWLQwQdIiuhYGWJIACCBg+KKUJ9BoBRdS2LQALQMIIGDQIEmwAO1kYcVWHCDZAhBAqFqYmOAxj2YNtAwDAYAAYmDEiBYWzHKKkRERYiwAAYSphZEZwxZGZiZQVEJTJkAAMTCyokc7M5oORlC5wcoEjxeAAAJqQXU0UB6W5WFmABMtEzMi1wEEEFAbE0YyAUuzMMEsYQalMkQSBQggUDmNPU3C9IA4LCxI+QUggEBiKOU8yExgqccCL3chnkPKlQABhGo6ejHBDKmdUHMlQAAhhQvQaGZGkBIkjcAMywLmI+VKgABCSowsTJhZkhlWXiBpAQggYBqBZl9GVOdBcz0LZqEEEEAMqLULMBLg1THWog9IAwQQA0qiZcRW5aPbAhBADCg1El4tMAAQQAxoiZYZXnTh1AIQQAzo2QlYpDDjcBgrxGEAAcSAJTthswmiBUwDBBC2GpkZJTaRvQ+mAQKIAUuuxdZWQvILQABBmSxMjBj5EpcWgACCMoFOYYSpZyHQHgMIMACt2hmoVEikCQAAAABJRU5ErkJggg==\\\", \\\"19-object-data-data-uri - logo\\\");\\n+  is(hcard.photo, \\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAASUExURf///8zMzJmZmWZmZjMzMwAAAPOPemkAAAM1SURBVHjaYmBgYGBkYQUBFkYWFiCPCchixQAMCCZAACF0MAMVM4K4TFh0IGsBCCAkOxhYmBnAAKaHhZkZmxaAAGJgYIbpYGBihGgBWsTMzMwE4jIhaWGAYoAAYmCECDExYAcwGxkg5oNIgABigDqLARdgZmGB2wICrKwAAcSA3xKgIxlZ0PwCEEAMBCxhgHoWSQtAADFAAxgfYEJ1GEAAQbQw4tUCsocBYQVAADEgu4uRkREeUCwszEwwLhOKLQABhNDCBA4aSDgwwhIAJKqYUPwCEEAMUK/AUwnc9aywJMCI7DAgAAggBohZ8JTBhGIJzCoWZL8ABBCYidAB8RUjWppkYUG2BSCAGMDqEMZiswUtXgACiAHsFYixTMywGGLGpgUWYgABxAA2mQkWCMyMqFoYmdD8ACQAAogBHJHMrCxg1cyIiICmCkYWDFsAAgiihYmZCewFFpR0BfI3LLch+QUggBiQ0iQjEyMDmh54qCBlUIAAYsCRJsElADQvgWKTlRGeKwECiAF3XgGmMEYQYADZzcoA9z5AAMG9RQCAtEC9DxBADFiyFyMjVi0wABBAWLQwQdIiuhYGWJIACCBg+KKUJ9BoBRdS2LQALQMIIGDQIEmwAO1kYcVWHCDZAhBAqFqYmOAxj2YNtAwDAYAAYmDEiBYWzHKKkRERYiwAAYSphZEZwxZGZiZQVEJTJkAAMTCyokc7M5oORlC5wcoEjxeAAAJqQXU0UB6W5WFmABMtEzMi1wEEEFAbE0YyAUuzMMEsYQalMkQSBQggUDmNPU3C9IA4LCxI+QUggEBiKOU8yExgqccCL3chnkPKlQABhGo6ejHBDKmdUHMlQAAhhQvQaGZGkBIkjcAMywLmI+VKgABCSowsTJhZkhlWXiBpAQggYBqBZl9GVOdBcz0LZqEEEEAMqLULMBLg1THWog9IAwQQA0qiZcRW5aPbAhBADCg1El4tMAAQQAxoiZYZXnTh1AIQQAzo2QlYpDDjcBgrxGEAAcSAJTthswmiBUwDBBC2GpkZJTaRvQ+mAQKIAUuuxdZWQvILQABBmSxMjBj5EpcWgACCMoFOYYSpZyHQHgMIMACt2hmoVEikCQAAAABJRU5ErkJggg==\\\", \\\"19-object-data-data-uri - photo\\\");\\n+\\n+\\n+  hcard = new hCard(document.getElementById(\\\"20-image-alt\\\"));\\n+\\n+  is(hcard.fn, \\\"John Doe\\\", \\\"20-image-alt - fn\\\");\\n+  is(hcard.n[\\\"given-name\\\"], \\\"John\\\", \\\"20-image-alt - given-name\\\");\\n+  is(hcard.n[\\\"family-name\\\"], \\\"Doe\\\", \\\"20-image-alt - family-name\\\");\\n+  is(hcard.logo, \\\"http://example.com/foo.png\\\", \\\"20-image-alt - logo\\\");\\n+  is(hcard.photo, \\\"http://example.com/foo.png\\\", \\\"20-image-alt - photo\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"21-tel\\\"));\\n+\\n+  is(hcard.fn, \\\"John Doe\\\", \\\"21-tel - fn\\\");\\n+  is(hcard.n[\\\"given-name\\\"], \\\"John\\\", \\\"21-tel - given-name\\\");\\n+  is(hcard.n[\\\"family-name\\\"], \\\"Doe\\\", \\\"21-tel - family-name\\\");\\n+  is(hcard.tel[0].value, \\\"+1.415.555.1231\\\", \\\"21-tel - tel\\\");\\n+  is(hcard.tel[1].value, \\\"+1 415 555 1232\\\", \\\"21-tel - tel\\\");\\n+  is(hcard.tel[1].type[0], \\\"home\\\", \\\"21-tel - type\\\");\\n+  is(hcard.tel[2].value, \\\"+14155551233\\\", \\\"21-tel - tel\\\");\\n+  is(hcard.tel[2].type[0], \\\"msg\\\", \\\"21-tel - type\\\");\\n+  is(hcard.tel[2].type[1], \\\"home\\\", \\\"21-tel - type\\\");\\n+  is(hcard.tel[2].type[2], \\\"work\\\", \\\"21-tel - type\\\");\\n+  is(hcard.tel[2].type[3], \\\"pref\\\", \\\"21-tel - type\\\");\\n+  is(hcard.tel[2].type[4], \\\"voice\\\", \\\"21-tel - type\\\");\\n+  is(hcard.tel[2].type[5], \\\"fax\\\", \\\"21-tel - type\\\");\\n+  is(hcard.tel[2].type[6], \\\"cell\\\", \\\"21-tel - type\\\");\\n+  is(hcard.tel[2].type[7], \\\"video\\\", \\\"21-tel - type\\\");\\n+  is(hcard.tel[2].type[8], \\\"pager\\\", \\\"21-tel - type\\\");\\n+  is(hcard.tel[2].type[9], \\\"bbs\\\", \\\"21-tel - type\\\");\\n+  is(hcard.tel[2].type[10], \\\"car\\\", \\\"21-tel - type\\\");\\n+  is(hcard.tel[2].type[11], \\\"isdn\\\", \\\"21-tel - type\\\");\\n+  is(hcard.tel[2].type[12], \\\"pcs\\\", \\\"21-tel - type\\\");\\n+  isnot(hcard.tel[2].type[13], \\\"invalid\\\", \\\"21-tel - type\\\");\\n+  is(hcard.tel[3].value, \\\"+1 415 555 1234\\\", \\\"21-tel - tel\\\");\\n+  is(hcard.tel[3].type[0], \\\"home\\\", \\\"21-tel - type\\\");\\n+//  is(hcard.tel[4].value, \\\"+1.415.555.1235\\\", \\\"21-tel - tel\\\");\\n+//  is(hcard.tel[5].value, \\\"+1.415.555.1236\\\", \\\"21-tel - tel\\\");\\n+//  is(hcard.tel[6].value, \\\"+1.415.555.1237\\\", \\\"21-tel - tel\\\");\\n+//  is(hcard.tel[7].value, \\\"+1.415.555.1238\\\", \\\"21-tel - tel\\\");\\n+//  is(hcard.tel[8].value, \\\"+1.415.555.1239\\\", \\\"21-tel - tel\\\");\\n+//  is(hcard.tel[9].value, \\\"+1.415.555.1240\\\", \\\"21-tel - tel\\\");\\n+//  is(hcard.tel[9].value, \\\"+1.415.555.1241\\\", \\\"21-tel - tel\\\");\\n+//  is(hcard.tel[9].value, \\\"+1.415.555.1242\\\", \\\"21-tel - tel\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"22-adr\\\"));\\n+\\n+  is(hcard.fn, \\\"John Doe\\\", \\\"22-adr - fn\\\");\\n+  is(hcard.n[\\\"given-name\\\"], \\\"John\\\", \\\"22-adr - given-name\\\");\\n+  is(hcard.n[\\\"family-name\\\"], \\\"Doe\\\", \\\"22-adr - family-name\\\");\\n+  is(hcard.adr[0][\\\"street-address\\\"][0], \\\"1231 Main St.\\\", \\\"22-adr - street-address\\\");\\n+  is(hcard.adr[0].locality, \\\"Beverly Hills\\\", \\\"22-adr - locality\\\");\\n+  is(hcard.adr[0].region, \\\"California\\\", \\\"22-adr - region\\\");\\n+  is(hcard.adr[0][\\\"postal-code\\\"], \\\"90210\\\", \\\"22-adr - postal-code\\\");\\n+  is(hcard.adr[0][\\\"country-name\\\"], \\\"United States of America\\\", \\\"22-adr - country-name\\\");\\n+  is(hcard.adr[1][\\\"post-office-box\\\"], \\\"PO Box 1234\\\", \\\"22-adr - post-office-box\\\");\\n+  is(hcard.adr[1][\\\"street-address\\\"][0], \\\"1232 Main St.\\\", \\\"22-adr - street-address\\\");\\n+  is(hcard.adr[1][\\\"street-address\\\"][1], \\\"Suite 100\\\", \\\"22-adr - street-address\\\");\\n+  is(hcard.adr[1].locality, \\\"Beverly Hills\\\", \\\"22-adr - locality\\\");\\n+  is(hcard.adr[1].region, \\\"California\\\", \\\"22-adr - region\\\");\\n+  is(hcard.adr[1][\\\"postal-code\\\"], \\\"90210\\\", \\\"22-adr - postal-code\\\");\\n+  is(hcard.adr[1][\\\"country-name\\\"], \\\"United States of America\\\", \\\"22-adr - country-name\\\");\\n+  is(hcard.adr[2][\\\"type\\\"][0], \\\"home\\\", \\\"22-adr - type\\\");\\n+  is(hcard.adr[2][\\\"street-address\\\"][0], \\\"1233 Main St.\\\", \\\"22-adr - street-address\\\");\\n+  is(hcard.adr[2].locality, \\\"Beverly Hills\\\", \\\"22-adr - locality\\\");\\n+  is(hcard.adr[2].region, \\\"California\\\", \\\"22-adr - region\\\");\\n+  is(hcard.adr[2][\\\"postal-code\\\"], \\\"90210\\\", \\\"22-adr - postal-code\\\");\\n+  is(hcard.adr[2][\\\"country-name\\\"], \\\"United States of America\\\", \\\"22-adr - country-name\\\");\\n+  is(hcard.adr[3][\\\"type\\\"][0], \\\"dom\\\", \\\"22-adr - type\\\");\\n+  is(hcard.adr[3][\\\"type\\\"][1], \\\"intl\\\", \\\"22-adr - type\\\");\\n+  is(hcard.adr[3][\\\"type\\\"][2], \\\"postal\\\", \\\"22-adr - type\\\");\\n+  is(hcard.adr[3][\\\"type\\\"][3], \\\"parcel\\\", \\\"22-adr - type\\\");\\n+  is(hcard.adr[3][\\\"type\\\"][4], \\\"home\\\", \\\"22-adr - type\\\");\\n+  is(hcard.adr[3][\\\"type\\\"][5], \\\"work\\\", \\\"22-adr - type\\\");\\n+  is(hcard.adr[3][\\\"type\\\"][6], \\\"pref\\\", \\\"22-adr - type\\\");\\n+  is(hcard.adr[3][\\\"street-address\\\"][0], \\\"1234 Main St.\\\", \\\"22-adr - street-address\\\");\\n+  is(hcard.adr[3].locality, \\\"Beverly Hills\\\", \\\"22-adr - locality\\\");\\n+  is(hcard.adr[3].region, \\\"California\\\", \\\"22-adr - region\\\");\\n+  is(hcard.adr[3][\\\"postal-code\\\"], \\\"90210\\\", \\\"22-adr - postal-code\\\");\\n+  is(hcard.adr[3][\\\"country-name\\\"], \\\"United States of America\\\", \\\"22-adr - country-name\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"23-abbr-title-everything\\\"));\\n+\\n+  is(hcard.fn, \\\"John Doe\\\", \\\"23-abbr-title-everything - fn\\\");\\n+  is(hcard.n[\\\"given-name\\\"], \\\"Jonathan\\\", \\\"23-abbr-title-everything - given-name\\\");\\n+  is(hcard.n[\\\"family-name\\\"], \\\"Doe-Smith\\\", \\\"23-abbr-title-everything - family-name\\\");\\n+  is(hcard.n[\\\"additional-name\\\"], \\\"John\\\", \\\"23-abbr-title-everything - additional-name\\\");\\n+  is(hcard.n[\\\"honorific-prefix\\\"], \\\"Mister\\\", \\\"23-abbr-title-everything - honorific-prefix\\\");\\n+  is(hcard.n[\\\"honorific-suffix\\\"], \\\"Medical Doctor\\\", \\\"23-abbr-title-everything - honorific-suffix\\\");\\n+  is(hcard[\\\"class\\\"], \\\"public\\\", \\\"23-abbr-title-everything - class\\\");\\n+  is(hcard.geo.latitude, \\\"37.77\\\", \\\"23-abbr-title-everything - geo.latitude\\\");\\n+  is(hcard.geo.longitude, \\\"-122.41\\\", \\\"23-abbr-title-everything - geo.longitude\\\");\\n+  is(hcard.bday, \\\"2006-04-04\\\", \\\"23-abbr-title-everything - bday\\\");\\n+  is(hcard.nickname[0], \\\"JJ\\\", \\\"23-abbr-title-everything - nickname\\\");\\n+  is(hcard.note[0], \\\"this is a note\\\", \\\"23-abbr-title-everything - note\\\");\\n+  isnot(hcard.note[0], \\\"this is not a note\\\", \\\"23-abbr-title-everything - note\\\");\\n+  is(hcard.org[0][\\\"organization-name\\\"], \\\"Intellicorp\\\", \\\"23-abbr-title-everything - organization-name\\\");\\n+  is(hcard.org[0][\\\"organization-unit\\\"][0], \\\"Intelligence\\\", \\\"23-abbr-title-everything - organization-unit\\\");\\n+  is(hcard.role, \\\"Chief\\\", \\\"23-abbr-title-everything - role\\\");\\n+  is(hcard.tel[0].value, \\\"415.555.1234\\\", \\\"23-abbr-title-everything - tel\\\");\\n+  is(hcard.title[0], \\\"President\\\", \\\"23-abbr-title-everything - title\\\");\\n+  is(hcard.tz, \\\"-0700\\\", \\\"23-abbr-title-everything - tz\\\");\\n+  is(hcard.uid, \\\"abcdefghijklmnopqrstuvwxyz\\\", \\\"23-abbr-title-everything - uid\\\");\\n+  is(hcard.adr[0][\\\"post-office-box\\\"], \\\"Box 1234\\\", \\\"23-abbr-title-everything - post-office-box\\\");\\n+  is(hcard.adr[0][\\\"street-address\\\"][0], \\\"123 Fake Street\\\", \\\"23-abbr-title-everything - street-address\\\");\\n+  is(hcard.adr[0][\\\"extended-address\\\"], \\\"Suite 100\\\", \\\"23-abbr-title-everything - street-address\\\");\\n+  is(hcard.adr[0].locality, \\\"San Francisco\\\", \\\"23-abbr-title-everything - locality\\\");\\n+  is(hcard.adr[0].region, \\\"California\\\", \\\"23-abbr-title-everything - region\\\");\\n+  is(hcard.adr[0][\\\"postal-code\\\"], \\\"12345-6789\\\", \\\"23-abbr-title-everything - postal-code\\\");\\n+  is(hcard.adr[0][\\\"country-name\\\"], \\\"United States of America\\\", \\\"23-abbr-title-everything - country-name\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"25-geo-abbr\\\"));\\n+\\n+  is(hcard.fn, \\\"Paradise\\\", \\\"25-geo-abbr - fn\\\");\\n+  is(hcard.geo.latitude, \\\"30.267991\\\", \\\"25-geo-abbr - geo.latitude\\\");\\n+  is(hcard.geo.longitude, \\\"-97.739568\\\", \\\"25-geo-abbr - geo.longitude\\\");\\n+  \\n+  hcard = new hCard(document.getElementById(\\\"26-ancestors\\\"));\\n+\\n+  is(hcard.fn, \\\"John Doe\\\", \\\"26-ancestors - fn\\\");\\n+  is(hcard.n[\\\"given-name\\\"], \\\"Jonathan\\\", \\\"26-ancestors - given-name\\\");\\n+  is(hcard.n[\\\"family-name\\\"], \\\"Doe-Smith\\\", \\\"26-ancestors - family-name\\\");\\n+  is(hcard.n[\\\"additional-name\\\"], \\\"John\\\", \\\"26-ancestors - additional-name\\\");\\n+  is(hcard.n[\\\"honorific-prefix\\\"], \\\"Mister\\\", \\\"26-ancestors - honorific-prefix\\\");\\n+  is(hcard.n[\\\"honorific-suffix\\\"], \\\"Medical Doctor\\\", \\\"26-ancestors - honorific-suffix\\\");\\n+  is(hcard[\\\"class\\\"], \\\"public\\\", \\\"26-ancestors - class\\\");\\n+  is(hcard.geo.latitude, \\\"37.77\\\", \\\"26-ancestors - geo.latitude\\\");\\n+  is(hcard.geo.longitude, \\\"-122.41\\\", \\\"26-ancestors - geo.longitude\\\");\\n+  is(hcard.bday, \\\"2006-04-04\\\", \\\"26-ancestors - bday\\\");\\n+  is(hcard.nickname[0], \\\"JJ\\\", \\\"26-ancestors - nickname\\\");\\n+  is(hcard.note[0], \\\"this is a note\\\", \\\"26-ancestors - note\\\");\\n+  isnot(hcard.note[0], \\\"this is not a note\\\", \\\"26-ancestors - note\\\");\\n+  is(hcard.org[0][\\\"organization-name\\\"], \\\"Intellicorp\\\", \\\"26-ancestors - organization-name\\\");\\n+  is(hcard.org[0][\\\"organization-unit\\\"][0], \\\"Intelligence\\\", \\\"26-ancestors - organization-unit\\\");\\n+  is(hcard.role, \\\"Chief\\\", \\\"26-ancestors - role\\\");\\n+  is(hcard.tel[0].value, \\\"415.555.1234\\\", \\\"26-ancestors - tel\\\");\\n+  is(hcard.title[0], \\\"President\\\", \\\"26-ancestors - title\\\");\\n+  is(hcard.tz, \\\"-0700\\\", \\\"26-ancestors - tz\\\");\\n+  is(hcard.uid, \\\"abcdefghijklmnopqrstuvwxyz\\\", \\\"26-ancestors - uid\\\");\\n+  is(hcard.adr[0][\\\"post-office-box\\\"], \\\"Box 1234\\\", \\\"26-ancestors - post-office-box\\\");\\n+  is(hcard.adr[0][\\\"street-address\\\"][0], \\\"123 Fake Street\\\", \\\"26-ancestors - street-address\\\");\\n+  is(hcard.adr[0][\\\"extended-address\\\"], \\\"Suite 100\\\", \\\"26-ancestors - street-address\\\");\\n+  is(hcard.adr[0].locality, \\\"San Francisco\\\", \\\"26-ancestors - locality\\\");\\n+  is(hcard.adr[0].region, \\\"California\\\", \\\"26-ancestors - region\\\");\\n+  is(hcard.adr[0][\\\"postal-code\\\"], \\\"12345-6789\\\", \\\"26-ancestors - postal-code\\\");\\n+  is(hcard.adr[0][\\\"country-name\\\"], \\\"United States of America\\\", \\\"26-ancestors - country-name\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"27-bday-date\\\"));\\n+\\n+  is(hcard.fn, \\\"john doe\\\", \\\"27-bday-date - fn\\\");\\n+  is(hcard.n[\\\"given-name\\\"], \\\"john\\\", \\\"27-bday-date - given-name\\\");\\n+  is(hcard.n[\\\"family-name\\\"], \\\"doe\\\", \\\"27-bday-date - family-name\\\");\\n+  is(hcard.bday, \\\"2000-01-01\\\", \\\"27-bday-date - bday\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"28-bday-datetime\\\"));\\n+\\n+  is(hcard.fn, \\\"john doe\\\", \\\"28-bday-datetime - fn\\\");\\n+  is(hcard.n[\\\"given-name\\\"], \\\"john\\\", \\\"28-bday-datetime - given-name\\\");\\n+  is(hcard.n[\\\"family-name\\\"], \\\"doe\\\", \\\"28-bday-datetime - family-name\\\");\\n+  is(hcard.bday, \\\"2000-01-01T00:00:00\\\", \\\"28-bday-datetime - bday\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"29-bday-datetime-timezone\\\"));\\n+\\n+  is(hcard.fn, \\\"john doe\\\", \\\"29-bday-datetime-timezone - fn\\\");\\n+  is(hcard.n[\\\"given-name\\\"], \\\"john\\\", \\\"29-bday-datetime-timezone - given-name\\\");\\n+  is(hcard.n[\\\"family-name\\\"], \\\"doe\\\", \\\"29-bday-datetime-timezone - family-name\\\");\\n+  is(hcard.bday, \\\"2000-01-01T00:00:00-0800\\\", \\\"29-bday-datetime-timezone - bday\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"30-fn-org.1\\\"));\\n+\\n+  is(hcard.fn, \\\"W3C\\\", \\\"30-fn-org.1 - fn\\\");\\n+  is(hcard.org[0][\\\"organization-name\\\"], \\\"W3C\\\", \\\"30-fn-org.1 - organization-name\\\");\\n+\\n+\\n+  hcard = new hCard(document.getElementById(\\\"30-fn-org.2\\\"));\\n+  \\n+  is(hcard.fn, \\\"Dan Connolly\\\", \\\"30-fn-org.2  - fn\\\");\\n+  is(hcard.n[\\\"given-name\\\"], \\\"Dan\\\", \\\"30-fn-org.2  - given-name\\\");\\n+  is(hcard.n[\\\"family-name\\\"], \\\"Connolly\\\", \\\"30-fn-org.2  - family-name\\\");\\n+  is(hcard.org[0][\\\"organization-name\\\"], \\\"W3C\\\", \\\"30-fn-org.2 - organization-name\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"30-fn-org.3\\\"));\\n+\\n+  is(hcard.fn, \\\"W3C\\\", \\\"30-fn-org.3 - fn\\\");\\n+  is(hcard.org[0][\\\"organization-name\\\"], \\\"W3C\\\", \\\"30-fn-org.3 - organization-name\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"30-fn-org.4\\\"));\\n+\\n+  is(hcard.fn, \\\"World Wide Web Consortium\\\", \\\"30-fn-org.4 - fn\\\");\\n+  is(hcard.org[0][\\\"organization-name\\\"], \\\"World Wide Web Consortium\\\", \\\"30-fn-org.4 - organization-name\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"30-fn-org.5\\\"));\\n+\\n+  is(hcard.fn, \\\"World Wide Web Consortium\\\", \\\"30-fn-org.5 - fn\\\");\\n+  is(hcard.org[0][\\\"organization-name\\\"], \\\"World Wide Web Consortium\\\", \\\"30-fn-org.5 - organization-name\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"31-include.1\\\"));\\n+\\n+  is(hcard.fn, \\\"Brian Suda\\\", \\\"31-include.1 - fn\\\");\\n+  is(hcard.n[\\\"given-name\\\"], \\\"Brian\\\", \\\"31-include.1 - given-name\\\");\\n+  is(hcard.n[\\\"family-name\\\"], \\\"Suda\\\", \\\"31-include.1 - family-name\\\");\\n+  is(hcard.url, \\\"http://suda.co.uk/\\\", \\\"31-include.1 - url\\\");\\n+  is(hcard.email[0].value, \\\"correct@example.com\\\", \\\"31-include.1 - email\\\");\\n+  isnot(hcard.email[0].value, \\\"incorrect@example.com\\\", \\\"31-include.1 - email\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"31-include.2\\\"));\\n+\\n+  is(hcard.fn, \\\"Brian Suda\\\", \\\"31-include.2 - fn\\\");\\n+  is(hcard.n[\\\"given-name\\\"], \\\"Brian\\\", \\\"31-include.2 - given-name\\\");\\n+  is(hcard.n[\\\"family-name\\\"], \\\"Suda\\\", \\\"31-include.2 - family-name\\\");\\n+  is(hcard.url, \\\"http://suda.co.uk/\\\", \\\"31-include.2 - url\\\");\\n+  is(hcard.email[0].value, \\\"correct@example.com\\\", \\\"31-include.2 - email\\\");\\n+  isnot(hcard.email[0].value, \\\"incorrect@example.com\\\", \\\"31-include.2 - email\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"31-include.3\\\"));\\n+\\n+  is(hcard.fn, \\\"Brian Suda\\\", \\\"31-include.3 - fn\\\");\\n+  is(hcard.n[\\\"given-name\\\"], \\\"Brian\\\", \\\"31-include.3 - given-name\\\");\\n+  is(hcard.n[\\\"family-name\\\"], \\\"Suda\\\", \\\"31-include.3 - family-name\\\");\\n+  is(hcard.url, \\\"http://suda.co.uk/\\\", \\\"31-include.3 - url\\\");\\n+  is(hcard.email[0].value, \\\"correct@example.com\\\", \\\"31-include.3 - email\\\");\\n+  isnot(hcard.email[0].value, \\\"incorrect@example.com\\\", \\\"31-include.3 - email\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"32-header.1\\\"));\\n+\\n+  is(hcard.fn, \\\"Brian Suda\\\", \\\"32-header.1 - fn\\\");\\n+  is(hcard.n[\\\"given-name\\\"], \\\"Brian\\\", \\\"32-header.1 - given-name\\\");\\n+  is(hcard.n[\\\"family-name\\\"], \\\"Suda\\\", \\\"32-header.1 - family-name\\\");\\n+  is(hcard.org[0][\\\"organization-name\\\"], \\\"example.org\\\", \\\"32-header.1 - organization-name\\\");\\n+  is(hcard.url, \\\"http://example.org/\\\", \\\"32-header.1 - url\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"32-header.2\\\"));\\n+\\n+  is(hcard.fn, \\\"John Doe\\\", \\\"32-header.2 - fn\\\");\\n+  is(hcard.n[\\\"given-name\\\"], \\\"John\\\", \\\"32-header.2 - given-name\\\");\\n+  is(hcard.n[\\\"family-name\\\"], \\\"Doe\\\", \\\"32-header.2 - family-name\\\");\\n+  is(hcard.org[0][\\\"organization-name\\\"], \\\"example.org\\\", \\\"32-header.2 - organization-name\\\");\\n+  is(hcard.url, \\\"http://example.org/\\\", \\\"32-header.2 - url\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"33-area.1\\\"));\\n+\\n+  is(hcard.fn, \\\"Joe Public\\\", \\\"33-area.1 - fn\\\");\\n+  is(hcard.n[\\\"given-name\\\"], \\\"Joe\\\", \\\"33-area.1 - given-name\\\");\\n+  is(hcard.n[\\\"family-name\\\"], \\\"Public\\\", \\\"33-area.1 - family-name\\\");\\n+  is(hcard.url, \\\"http://example.com/\\\", \\\"33-area.1 - url\\\");\\n+  is(hcard.email[0].value, \\\"joe@example.com\\\", \\\"33-area.1 - email\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"33-area.2\\\"));\\n+\\n+  is(hcard.fn, \\\"Joe Public\\\", \\\"33-area.2 - fn\\\");\\n+  is(hcard.url, \\\"http://example.com/\\\", \\\"33-area.2 - url\\\");\\n+  is(hcard.email[0].value, \\\"joe@example.com\\\", \\\"33-area.2 - email\\\");\\n+  is(hcard.org[0][\\\"organization-name\\\"], \\\"Joe Public\\\", \\\"33-area.2 - organization-name\\\");\\n+  \\n+  hcard = new hCard(document.getElementById(\\\"33-area.3\\\"));\\n+\\n+  is(hcard.fn, \\\"Joe Public\\\", \\\"33-area.3 - fn\\\");\\n+  is(hcard.url, \\\"http://example.com/\\\", \\\"33-area.3 - url\\\");\\n+  is(hcard.email[0].value, \\\"joe@example.com\\\", \\\"33-area.3 - email\\\");\\n+  is(hcard.org[0][\\\"organization-name\\\"], \\\"Joe Public\\\", \\\"33-area.3 - organization-name\\\");\\n+  \\n+  hcard = new hCard(document.getElementById(\\\"33-area.4\\\"));\\n+\\n+  is(hcard.fn, \\\"Joe Public\\\", \\\"33-area.4 - fn\\\");\\n+  is(hcard.url, \\\"http://example.com/\\\", \\\"33-area.4 - url\\\");\\n+  is(hcard.email[0].value, \\\"joe@example.com\\\", \\\"33-area.4 - email\\\");\\n+  is(hcard.org[0][\\\"organization-name\\\"], \\\"Joe Public\\\", \\\"33-area.4 - organization-name\\\");\\n+  \\n+  hcard = new hCard(document.getElementById(\\\"33-area.5\\\"));\\n+\\n+  is(hcard.fn, \\\"Joe Public\\\", \\\"33-area.5 - fn\\\");\\n+  is(hcard.url, \\\"http://example.com/\\\", \\\"33-area.5 - url\\\");\\n+  is(hcard.email[0].value, \\\"joe@example.com\\\", \\\"33-area.5 - email\\\");\\n+  is(hcard.org[0][\\\"organization-name\\\"], \\\"Joe Public\\\", \\\"33-area.5 - organization-name\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"34-notes\\\"));\\n+\\n+  is(hcard.fn, \\\"Joe Public\\\", \\\"34-notes - fn\\\");\\n+  is(hcard.n[\\\"given-name\\\"], \\\"Joe\\\", \\\"34-notes - given-name\\\");\\n+  is(hcard.n[\\\"family-name\\\"], \\\"Public\\\", \\\"34-notes - family-name\\\");\\n+  is(hcard.note[0], \\\"Note 1\\\", \\\"34-notes - note\\\");\\n+  isnot(hcard.note[1], \\\"Note 2\\\", \\\"34-notes - note\\\");\\n+  is(hcard.note[1], \\\"Note 3\\\", \\\"34-notes - note\\\");\\n+  is(hcard.note[2], \\\"Note 4 with a ; and a , to be escaped\\\", \\\"34-notes - note\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"35-include-pattern.1\\\"));\\n+\\n+  is(hcard.fn, \\\"James Levine\\\", \\\"35-include-pattern.1 - fn\\\");\\n+  is(hcard.n[\\\"given-name\\\"], \\\"James\\\", \\\"35-include-pattern.1 - given-name\\\");\\n+  is(hcard.n[\\\"family-name\\\"], \\\"Levine\\\", \\\"35-include-pattern.1 - family-name\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"35-include-pattern.2\\\"));\\n+\\n+  is(hcard.fn, \\\"James Levine\\\", \\\"35-include-pattern.2 - fn\\\");\\n+  is(hcard.n[\\\"given-name\\\"], \\\"James\\\", \\\"35-include-pattern.2 - given-name\\\");\\n+  is(hcard.n[\\\"family-name\\\"], \\\"Levine\\\", \\\"35-include-pattern.2 - family-name\\\");\\n+  is(hcard.org[0][\\\"organization-name\\\"], \\\"SimplyHired\\\", \\\"35-include-pattern.2 - organization-name\\\");\\n+  is(hcard.title[0], \\\"Microformat Brainstormer\\\", \\\"35-include-pattern.2 - title\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"35-include-pattern.3\\\"));\\n+\\n+  is(hcard.fn, \\\"James Levine\\\", \\\"35-include-pattern.3 - fn\\\");\\n+  is(hcard.n[\\\"given-name\\\"], \\\"James\\\", \\\"35-include-pattern.3 - given-name\\\");\\n+  is(hcard.n[\\\"family-name\\\"], \\\"Levine\\\", \\\"35-include-pattern.3 - family-name\\\");\\n+  is(hcard.org[0][\\\"organization-name\\\"], \\\"SimplyHired\\\", \\\"35-include-pattern.3 - organization-name\\\");\\n+  is(hcard.title[0], \\\"Microformat Brainstormer\\\", \\\"35-include-pattern.3 - title\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"36-categories.1\\\"));\\n+\\n+  is(hcard.fn, \\\"john doe\\\", \\\"36-categories.1 - fn\\\");\\n+  is(hcard.n[\\\"given-name\\\"], \\\"john\\\", \\\"36-categories.1 - given-name\\\");\\n+  is(hcard.n[\\\"family-name\\\"], \\\"doe\\\", \\\"36-categories.1 - family-name\\\");\\n+  is(hcard.category[0], \\\"C1\\\", \\\"36-categories.1 - category\\\");\\n+  isnot(hcard.category[0], \\\"C1a\\\", \\\"36-categories.1 - category\\\");\\n+  is(hcard.category[1], \\\"C2a\\\", \\\"36-categories.1 - category\\\");\\n+  isnot(hcard.category[1], \\\"C2\\\", \\\"36-categories.1 - category\\\");\\n+  is(hcard.category[2], \\\"C3\\\", \\\"36-categories.1 - category\\\");\\n+  isnot(hcard.category[2], \\\"C3a\\\", \\\"36-categories.1 - category\\\");\\n+  isnot(hcard.category[2], \\\"C3b\\\", \\\"36-categories.1 - category\\\");\\n+  is(hcard.category[3], \\\"C4\\\", \\\"36-categories.1 - category\\\");\\n+  is(hcard.category[4], \\\"C5\\\", \\\"36-categories.1 - category\\\");\\n+  isnot(hcard.category[4], \\\"C5a\\\", \\\"36-categories.1 - category\\\");\\n+  isnot(hcard.category[4], \\\"C5b\\\", \\\"36-categories.1 - category\\\");\\n+  is(hcard.category[5], \\\"C6\\\", \\\"36-categories.1 - category\\\");\\n+  isnot(hcard.category[4], \\\"C6a\\\", \\\"36-categories.1 - category\\\");\\n+  isnot(hcard.category[4], \\\"C6b\\\", \\\"36-categories.1 - category\\\");\\n+  is(hcard.category[6], \\\"C7\\\", \\\"36-categories.1 - category\\\");\\n+  isnot(hcard.category[4], \\\"C7a\\\", \\\"36-categories.1 - category\\\");\\n+  isnot(hcard.category[4], \\\"C7b\\\", \\\"36-categories.1 - category\\\");\\n+  is(hcard.category[7], \\\"C8\\\", \\\"36-categories.1 - category\\\");\\n+  isnot(hcard.category[4], \\\"C8a\\\", \\\"36-categories.1 - category\\\");\\n+  isnot(hcard.category[4], \\\"C8b\\\", \\\"36-categories.1 - category\\\");\\n+  is(hcard.category[8], \\\"C9\\\", \\\"36-categories.1 - category\\\");\\n+  isnot(hcard.category[4], \\\"C9a\\\", \\\"36-categories.1 - category\\\");\\n+  isnot(hcard.category[4], \\\"C9b\\\", \\\"36-categories.1 - category\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"37-singleton\\\"));\\n+\\n+  is(hcard.fn, \\\"john doe 1\\\", \\\"37-singleton - fn\\\");\\n+  is(hcard.n[\\\"given-name\\\"], \\\"john\\\", \\\"37-singleton - given-name\\\");\\n+  is(hcard.n[\\\"family-name\\\"], \\\"doe\\\", \\\"37-singleton - family-name\\\");\\n+  is(hcard.uid, \\\"unique-id-1\\\", \\\"37-singleton - uid\\\");\\n+  is(hcard.tz, \\\"+0600\\\", \\\"37-singleton - tz\\\");\\n+  is(hcard[\\\"sort-string\\\"], \\\"d\\\", \\\"37-singleton - sort-string\\\");\\n+  is(hcard.geo.latitude, \\\"123.45\\\", \\\"37-singleton - geo.latitude\\\");\\n+  is(hcard.geo.longitude, \\\"67.89\\\", \\\"37-singleton - geo.longitude\\\");\\n+  is(hcard[\\\"class\\\"], \\\"public\\\", \\\"37-singleton - class\\\");\\n+  is(hcard.bday, \\\"2006-07-07\\\", \\\"37-singleton - bday\\\");\\n+  is(hcard.rev, \\\"2006-07-07\\\", \\\"37-singleton - rev\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"38-uid.1\\\"));\\n+\\n+  is(hcard.fn, \\\"Ryan King\\\", \\\"38-uid.1 - fn\\\");\\n+  is(hcard.n[\\\"given-name\\\"], \\\"Ryan\\\", \\\"38-uid.1 - given-name\\\");\\n+  is(hcard.n[\\\"family-name\\\"], \\\"King\\\", \\\"38-uid.1 - family-name\\\");\\n+  is(hcard.uid, \\\"http://theryanking.com/contact/\\\", \\\"38-uid.1 - uid\\\");\\n+  is(hcard.url[0], \\\"http://theryanking.com/contact/\\\", \\\"38-uid.1 - url\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"38-uid.2\\\"));\\n+\\n+  is(hcard.fn, \\\"Ryan King\\\", \\\"38-uid.2 - fn\\\");\\n+  is(hcard.n[\\\"given-name\\\"], \\\"Ryan\\\", \\\"38-uid.2 - given-name\\\");\\n+  is(hcard.n[\\\"family-name\\\"], \\\"King\\\", \\\"38-uid.2 - family-name\\\");\\n+  is(hcard.uid, \\\"http://theryanking.com/contact/\\\", \\\"38-uid.2 - uid\\\");\\n+  is(hcard.url[0], \\\"http://theryanking.com/contact/\\\", \\\"38-uid.2 - url\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"38-uid.3\\\"));\\n+\\n+  is(hcard.fn, \\\"Ryan King\\\", \\\"38-uid.3 - fn\\\");\\n+  is(hcard.n[\\\"given-name\\\"], \\\"Ryan\\\", \\\"38-uid.3 - given-name\\\");\\n+  is(hcard.n[\\\"family-name\\\"], \\\"King\\\", \\\"38-uid.3 - family-name\\\");\\n+  is(hcard.uid, \\\"http://theryanking.com/contact/\\\", \\\"38-uid.3 - uid\\\");\\n+  is(hcard.url[0], \\\"http://theryanking.com/contact/\\\", \\\"38-uid.3 - url\\\");\\n+\\n+  hcard = new hCard(document.getElementById(\\\"38-uid.4\\\"));\\n+\\n+  is(hcard.fn, \\\"Ryan King\\\", \\\"38-uid.4 - fn\\\");\\n+  is(hcard.n[\\\"given-name\\\"], \\\"Ryan\\\", \\\"38-uid.4 - given-name\\\");\\n+  is(hcard.n[\\\"family-name\\\"], \\\"King\\\", \\\"38-uid.4 - family-name\\\");\\n+  is(hcard.uid, \\\"http://theryanking.com/contact/\\\", \\\"38-uid.4 - uid\\\");\\n+  is(hcard.url[0], \\\"http://theryanking.com/contact/\\\", \\\"38-uid.4 - url\\\");\\n+\\n+}\\n+\\n+</script>\\n+</pre>\\n+</body>\\n+</html>\\n\""}