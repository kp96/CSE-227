{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Basf6a587e\""},"diff":"\"f6a587e bug 395640: rename the 'always ask' and 'handle internally' actions for the feed type in the Applications prefpane to 'Preview in &brandShortName;' and 'Live Bookmarks in &brandShortName;', respectively; r=gavin, a=mconnor\\ndiff --git a/browser/components/preferences/applications.js b/browser/components/preferences/applications.js\\nindex b1e79f8..11c65d7 100755\\n--- a/browser/components/preferences/applications.js\\n+++ b/browser/components/preferences/applications.js\\n@@ -699,10 +699,15 @@ var gApplicationsPane = {\\n   // objects, indexed by type.\\n   _handledTypes: {},\\n \\n-  _brandBundle  : null,\\n-  _prefsBundle  : null,\\n-  _list         : null,\\n-  _filter       : null,\\n+\\n+  //**************************************************************************//\\n+  // Convenience & Performance Shortcuts\\n+\\n+  // These get defined by init().\\n+  _brandShortName : null,\\n+  _prefsBundle    : null,\\n+  _list           : null,\\n+  _filter         : null,\\n \\n   // Retrieve this as nsIPrefBranch and then immediately QI to nsIPrefBranch2\\n   // so both interfaces are available to callers.\\n@@ -727,8 +732,9 @@ var gApplicationsPane = {\\n   // Initialization & Destruction\\n \\n   init: function() {\\n-    // Initialize shortcuts to some commonly accessed elements.\\n-    this._brandBundle = document.getElementById(\\\"bundleBrand\\\");\\n+    // Initialize shortcuts to some commonly accessed elements & values.\\n+    this._brandShortName =\\n+      document.getElementById(\\\"bundleBrand\\\").getString(\\\"brandShortName\\\");\\n     this._prefsBundle = document.getElementById(\\\"bundlePreferences\\\");\\n     this._list = document.getElementById(\\\"handlersView\\\");\\n     this._filter = document.getElementById(\\\"filter\\\");\\n@@ -992,7 +998,8 @@ var gApplicationsPane = {\\n     // with alwaysAskBeforeHandling except for the feed type, so here we use\\n     // a feed-specific message to describe the behavior.\\n     if (aHandlerInfo.alwaysAskBeforeHandling)\\n-      return this._prefsBundle.getString(\\\"alwaysAskAboutFeed\\\");\\n+      return this._prefsBundle.getFormattedString(\\\"previewInApp\\\",\\n+                                                  [this._brandShortName]);\\n \\n     switch (aHandlerInfo.preferredAction) {\\n       case Ci.nsIHandlerInfo.saveToDisk:\\n@@ -1004,7 +1011,8 @@ var gApplicationsPane = {\\n       case Ci.nsIHandlerInfo.handleInternally:\\n         // For the feed type, handleInternally means live bookmarks.\\n         if (aHandlerInfo.type == TYPE_MAYBE_FEED)\\n-          return this._prefsBundle.getString(\\\"liveBookmarks\\\");\\n+          return this._prefsBundle.getFormattedString(\\\"liveBookmarksInApp\\\",\\n+                                                      [this._brandShortName]);\\n \\n         // For other types, handleInternally looks like either useHelperApp\\n         // or useSystemDefault depending on whether or not there's a preferred\\n@@ -1023,10 +1031,9 @@ var gApplicationsPane = {\\n         return aHandlerInfo.defaultDescription;\\n \\n       case kActionUsePlugin:\\n-        let brandShortName = this._brandBundle.getString(\\\"brandShortName\\\");\\n         return this._prefsBundle.getFormattedString(\\\"pluginName\\\",\\n                                                     [aHandlerInfo.plugin.name,\\n-                                                     brandShortName]);\\n+                                                     this._brandShortName]);\\n     }\\n   },\\n \\n@@ -1074,15 +1081,18 @@ var gApplicationsPane = {\\n     if (handlerInfo.type == TYPE_MAYBE_FEED) {\\n       let menuItem = document.createElementNS(kXULNS, \\\"menuitem\\\");\\n       menuItem.setAttribute(\\\"alwaysAsk\\\", \\\"true\\\");\\n-      menuItem.setAttribute(\\\"label\\\",\\n-                            this._prefsBundle.getString(\\\"alwaysAskAboutFeed\\\"));\\n+      let label = this._prefsBundle.getFormattedString(\\\"previewInApp\\\",\\n+                                                       [this._brandShortName]);\\n+      menuItem.setAttribute(\\\"label\\\", label);\\n       menuPopup.appendChild(menuItem);\\n       if (handlerInfo.alwaysAskBeforeHandling)\\n         menu.selectedItem = menuItem;\\n \\n       menuItem = document.createElementNS(kXULNS, \\\"menuitem\\\");\\n       menuItem.setAttribute(\\\"action\\\", Ci.nsIHandlerInfo.handleInternally);\\n-      menuItem.setAttribute(\\\"label\\\", this._prefsBundle.getString(\\\"liveBookmarks\\\"));\\n+      label = this._prefsBundle.getFormattedString(\\\"liveBookmarksInApp\\\",\\n+                                                   [this._brandShortName]);\\n+      menuItem.setAttribute(\\\"label\\\", label);\\n       menuItem.setAttribute(\\\"image\\\", \\\"chrome://browser/skin/page-livemarks.png\\\");\\n       menuPopup.appendChild(menuItem);\\n       if (handlerInfo.preferredAction == Ci.nsIHandlerInfo.handleInternally)\\n@@ -1142,10 +1152,9 @@ var gApplicationsPane = {\\n     if (handlerInfo.plugin) {\\n       let menuItem = document.createElementNS(kXULNS, \\\"menuitem\\\");\\n       menuItem.setAttribute(\\\"action\\\", kActionUsePlugin);\\n-      let brandShortName = this._brandBundle.getString(\\\"brandShortName\\\");\\n       let label = this._prefsBundle.getFormattedString(\\\"pluginName\\\",\\n                                                        [handlerInfo.plugin.name,\\n-                                                        brandShortName]);\\n+                                                        this._brandShortName]);\\n       menuItem.setAttribute(\\\"label\\\", label);\\n       menuPopup.appendChild(menuItem);\\n       if (handlerInfo.preferredAction == kActionUsePlugin)\\ndiff --git a/browser/locales/en-US/chrome/browser/preferences/preferences.properties b/browser/locales/en-US/chrome/browser/preferences/preferences.properties\\nindex 3351a7f..20f4e14 100644\\n--- a/browser/locales/en-US/chrome/browser/preferences/preferences.properties\\n+++ b/browser/locales/en-US/chrome/browser/preferences/preferences.properties\\n@@ -50,13 +50,17 @@ saveToDisk=Save to Disk\\n chooseApp=Choose application...\\n fpTitleChooseApp=Select Helper Application\\n webFeed=Web Feed\\n-alwaysAskAboutFeed=Show me a preview and ask me which Feed Reader to use\\n-liveBookmarks=Live Bookmarks\\n+\\n # LOCALIZATION NOTE (pluginName):\\n # %1$S = plugin name (for example \\\"QuickTime Plugin-in 7.2\\\")\\n # %2$S = brandShortName from brand.properties (for example \\\"Minefield\\\")\\n pluginName=%S (in %S)\\n \\n+# LOCALIZATION NOTE (previewInApp, liveBookmarksInApp): %S = brandShortName\\n+previewInApp=Preview in %S\\n+liveBookmarksInApp=Live Bookmarks in %S\\n+\\n+\\n #### Cookie Viewer\\n \\n hostColon=Host:\\n\""}