{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Bas8f5f6ea\""},"diff":"\"8f5f6ea Bug 391894: Make recursive call to CollectFloats on children in overflowList. r=roc sr=roc approval1.9=roc\\ndiff --git a/layout/generic/nsBlockFrame.cpp b/layout/generic/nsBlockFrame.cpp\\nindex a463219..19c964c 100644\\n--- a/layout/generic/nsBlockFrame.cpp\\n+++ b/layout/generic/nsBlockFrame.cpp\\n@@ -6511,7 +6511,7 @@ nsBlockFrame::ReflowBullet(nsBlockReflowState& aState,\\n }\\n \\n // This is used to scan frames for any float placeholders, add their\\n-// floats to the list represented by aHead and aTail, and remove the\\n+// floats to the list represented by aList and aTail, and remove the\\n // floats from whatever list they might be in. We don't search descendants\\n // that are float containing blocks. The floats must be children of 'this'.\\n void nsBlockFrame::CollectFloats(nsIFrame* aFrame, nsFrameList& aList, nsIFrame** aTail,\\n@@ -6537,8 +6537,13 @@ void nsBlockFrame::CollectFloats(nsIFrame* aFrame, nsFrameList& aList, nsIFrame*\\n         *aTail = outOfFlowFrame;\\n       }\\n \\n-      CollectFloats(aFrame->GetFirstChild(nsnull), aList, aTail, aFromOverflow,\\n-                    PR_TRUE);\\n+      CollectFloats(aFrame->GetFirstChild(nsnull), \\n+                    aList, aTail, aFromOverflow, PR_TRUE);\\n+      // Note: Even though we're calling CollectFloats on aFrame's overflow\\n+      // list, we'll pass down aFromOverflow unchanged because we're still\\n+      // traversing the normal-child subtree of the 'this' frame.\\n+      CollectFloats(aFrame->GetFirstChild(nsGkAtoms::overflowList), \\n+                    aList, aTail, aFromOverflow, PR_TRUE);\\n     }\\n     if (!aCollectSiblings)\\n       break;\\n\""}