{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Basbcd455d\""},"diff":"\"bcd455d Bug 387740  move the toolbar items in the organizer to an \\\"Organize\\\" menu in the search bar (r=mano, a=beltzner)\\ndiff --git a/browser/components/places/content/places.js b/browser/components/places/content/places.js\\nindex e042702..e1a7d27 100755\\n--- a/browser/components/places/content/places.js\\n+++ b/browser/components/places/content/places.js\\n@@ -67,7 +67,7 @@ var PlacesOrganizer = {\\n     OptionsFilter.init(Groupers);\\n     Groupers.init();\\n \\n-    // Select the specified place in the places list. \\n+    // Select the specified place in the places list.\\n     var placeURI = \\\"place:\\\";\\n     if (\\\"arguments\\\" in window)\\n       placeURI = window.arguments[0];\\n@@ -91,6 +91,48 @@ var PlacesOrganizer = {\\n     OptionsFilter.destroy();\\n   },\\n \\n+  _location: null,\\n+  get location() {\\n+    return this._location;\\n+  },\\n+\\n+  set location(aLocation) {\\n+    LOG(\\\"Node URI: \\\" + aLocation);\\n+\\n+    if (!aLocation)\\n+      return aLocation;\\n+\\n+    if (this.location)\\n+      this._backHistory.unshift(this.location);\\n+\\n+    this._content.place = this._location = aLocation;\\n+\\n+    // update navigation commands\\n+    if (this._backHistory.length == 0)\\n+      document.getElementById(\\\"OrganizerCommand:Back\\\").setAttribute(\\\"disabled\\\", true);\\n+    else\\n+      document.getElementById(\\\"OrganizerCommand:Back\\\").removeAttribute(\\\"disabled\\\");\\n+    if (this._forwardHistory.length == 0)\\n+      document.getElementById(\\\"OrganizerCommand:Forward\\\").setAttribute(\\\"disabled\\\", true);\\n+    else\\n+      document.getElementById(\\\"OrganizerCommand:Forward\\\").removeAttribute(\\\"disabled\\\");\\n+\\n+    return aLocation;\\n+  },\\n+\\n+  _backHistory: [],\\n+  _forwardHistory: [],\\n+  back: function PO_back() {\\n+    this._forwardHistory.unshift(this.location);\\n+    var historyEntry = this._backHistory.shift();\\n+    this._location = null;\\n+    this.location = historyEntry;\\n+  },\\n+  forward: function PO_forward() {\\n+    var historyEntry = this._forwardHistory.shift();\\n+    this.location = historyEntry;\\n+  },\\n+\\n   HEADER_TYPE_SHOWING: 1,\\n   HEADER_TYPE_SEARCH: 2,\\n   HEADER_TYPE_ADVANCED_SEARCH: 3,\\n@@ -106,6 +148,7 @@ var PlacesOrganizer = {\\n    */\\n   setHeaderText: function PO_setHeaderText(type, text) {\\n     NS_ASSERT(type == 1 || type == 2 || type == 3, \\\"Invalid Header Type\\\");\\n+\\n     var prefix = document.getElementById(\\\"showingPrefix\\\");\\n     prefix.setAttribute(\\\"value\\\",\\n                         PlacesUtils.getString(\\\"headerTextPrefix\\\" + type));\\n@@ -142,11 +185,17 @@ var PlacesOrganizer = {\\n    * Loads the place URI entered in the debug \\n    */\\n   loadPlaceURI: function PO_loadPlaceURI() {\\n+\\n+    // clear forward history\\n+    this._forwardHistory.splice(0);\\n+\\n     var placeURI = document.getElementById(\\\"placeURI\\\");\\n+\\n     var queriesRef = { }, optionsRef = { };\\n     PlacesUtils.history.queryStringToQueries(placeURI.value, \\n                                              queriesRef, { }, optionsRef);\\n     \\n+    // for debug panel\\n     var autoFilterResults = document.getElementById(\\\"autoFilterResults\\\");\\n     if (autoFilterResults.checked) {\\n       var options = \\n@@ -154,7 +203,13 @@ var PlacesOrganizer = {\\n     }\\n     else\\n       options = optionsRef.value;\\n-    this._content.load(queriesRef.value, options);\\n+\\n+    this.location =\\n+      PlacesUtils.history.queriesToQueryString(queriesRef.value,\\n+                                               queriesRef.value.length,\\n+                                               options);\\n+    \\n+    placeURI.value = this.location;\\n \\n     this.setHeaderText(this.HEADER_TYPE_SHOWING, \\\"Debug results for: \\\" + placeURI.value);\\n \\n@@ -185,17 +240,21 @@ var PlacesOrganizer = {\\n   onPlaceSelected: function PO_onPlaceSelected(resetSearchBox) {\\n     if (!this._places.hasSelection)\\n       return;\\n+\\n     var node = asQuery(this._places.selectedNode);\\n-    LOG(\\\"Node URI: \\\" + node.uri);\\n+\\n     var queries = node.getQueries({});\\n \\n     // Items are only excluded on the left pane\\n     var options = node.queryOptions.clone();\\n     options.excludeItems = false;\\n \\n-    this._content.load(queries, \\n-                       OptionsFilter.filter(queries, options, null));\\n-    \\n+    // clear forward history\\n+    this._forwardHistory.splice(0);\\n+\\n+    // update location\\n+    this.location = PlacesUtils.history.queriesToQueryString(queries, queries.length, options);\\n+   \\n     // Make sure the query builder is hidden.\\n     PlacesQueryBuilder.hide();\\n     if (resetSearchBox) {\\n@@ -439,22 +498,6 @@ var PlacesOrganizer = {\\n     }\\n   },\\n \\n-  updateStatusBarForView: function PO_updateStatusBarForView(aView) {\\n-    var statusText = \\\"\\\";\\n-    var selectedNode = aView.selectedNode;\\n-    if (selectedNode) {\\n-      if (PlacesUtils.nodeIsFolder(selectedNode)) {\\n-        var childsCount = \\n-          PlacesUtils.getFolderContents(selectedNode.itemId).root.childCount;\\n-        statusText = PlacesUtils.getFormattedString(\\\"status_foldercount\\\",\\n-                                                    [childsCount]);\\n-      }\\n-      else if (PlacesUtils.nodeIsBookmark(selectedNode))\\n-        statusText = selectedNode.uri;\\n-    }\\n-    document.getElementById(\\\"status\\\").label = statusText;\\n-  },\\n-\\n   onContentTreeSelect: function PO_onContentTreeSelect() {\\n     var contentTree = document.getElementById(\\\"placeContent\\\");\\n     var deck = document.getElementById(\\\"infoDeck\\\");\\n@@ -740,7 +783,7 @@ var PlacesQueryBuilder = {\\n     var advancedSearch = document.getElementById(\\\"advancedSearch\\\");\\n     // Need to collapse the advanced search box.\\n     advancedSearch.collapsed = true;\\n-    \\n+\\n     var titleDeck = document.getElementById(\\\"titleDeck\\\");\\n     titleDeck.setAttribute(\\\"selectedIndex\\\", 0);\\n   },\\n@@ -775,6 +818,7 @@ var PlacesQueryBuilder = {\\n     // Titlebar should show \\\"match any/all\\\" iff there are > 1 queries visible.\\n     var titleDeck = document.getElementById(\\\"titleDeck\\\");\\n     titleDeck.setAttribute(\\\"selectedIndex\\\", (this._numRows <= 1) ? 0 : 1);\\n+\\n     const asType = PlacesOrganizer.HEADER_TYPE_ADVANCED_SEARCH;\\n     PlacesOrganizer.setHeaderText(asType, \\\"\\\");\\n \\n@@ -1260,7 +1304,7 @@ var ViewMenu = {\\n   /**\\n    * Set up the content of the view menu.\\n    */\\n-  populate: function VM_populate(event) {\\n+  populateSortMenu: function VM_populateSortMenu(event) {\\n     this.fillWithColumns(event, \\\"viewUnsorted\\\", \\\"directionSeparator\\\", \\\"radio\\\", \\\"view.sortBy.\\\");\\n \\n     var sortColumn = this._getSortColumn();\\n@@ -1447,7 +1491,7 @@ var Groupers = {\\n   annotationGroupers: [],\\n \\n   /**\\n-   * Initializes groupings for various vie types. \\n+   * Initializes groupings for various view types. \\n    */\\n   init: function G_init() {\\n     this.defaultGrouper = \\ndiff --git a/browser/components/places/content/places.xul b/browser/components/places/content/places.xul\\nindex 4ee3002..117f511 100755\\n--- a/browser/components/places/content/places.xul\\n+++ b/browser/components/places/content/places.xul\\n@@ -44,9 +44,13 @@\\n <?xml-stylesheet href=\\\"chrome://global/skin/\\\"?>\\n <?xml-stylesheet href=\\\"chrome://browser/skin/places/places.css\\\"?>\\n \\n+#ifdef XP_MACOSX\\n+<?xul-overlay href=\\\"chrome://browser/content/macBrowserOverlay.xul\\\"?>\\n+#else\\n <?xul-overlay href=\\\"chrome://browser/content/baseMenuOverlay.xul\\\"?>\\n <?xul-overlay href=\\\"chrome://global/content/editMenuOverlay.xul\\\"?>\\n <?xul-overlay href=\\\"chrome://browser/content/places/placesOverlay.xul\\\"?>\\n+#endif\\n \\n <!DOCTYPE window [\\n <!ENTITY % placesDTD SYSTEM \\\"chrome://browser/locale/places/places.dtd\\\">\\n@@ -56,7 +60,7 @@\\n ]>\\n \\n <window id=\\\"places\\\"\\n-        title=\\\"&places.bm.title;\\\" \\n+        title=\\\"&places.organizer.title;\\\" \\n         windowtype=\\\"Places:Organizer\\\" \\n         xmlns=\\\"http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul\\\"\\n         onload=\\\"PlacesOrganizer.init();\\\"\\n@@ -66,12 +70,13 @@\\n \\n   <script type=\\\"application/x-javascript\\\"\\n           src=\\\"chrome://browser/content/places/places.js\\\"/>\\n-  \\n-  <stringbundleset id=\\\"stringbundleset\\\"/>\\n \\n+#ifdef XP_MACOSX\\n+#include ../../../base/content/browserMountPoints.inc\\n+#else\\n   <commandset id=\\\"editMenuCommands\\\"/>\\n-  <commandset id=\\\"baseMenuCommandSet\\\"/>\\n   <commandset id=\\\"placesCommands\\\"/>\\n+#endif\\n   \\n   <commandset id=\\\"organizerCommandSet\\\">\\n     <command id=\\\"OrganizerCommand_find:all\\\"\\n@@ -94,6 +99,10 @@\\n              oncommand=\\\"PlacesOrganizer.saveSearch();\\\"/>\\n     <command id=\\\"OrganizerCommand_search:moreCriteria\\\"\\n              oncommand=\\\"PlacesQueryBuilder.addRow();\\\"/>\\n+    <command id=\\\"OrganizerCommand:Back\\\"\\n+             oncommand=\\\"PlacesOrganizer.back();\\\"/>\\n+    <command id=\\\"OrganizerCommand:Forward\\\"\\n+             oncommand=\\\"PlacesOrganizer.forward();\\\"/>\\n   </commandset>\\n \\n   <broadcasterset id=\\\"placesGroupingBroadcasters\\\">\\n@@ -102,7 +111,6 @@\\n     <broadcaster id=\\\"placesBC_grouping:separator\\\"/>\\n   </broadcasterset>\\n \\n-  <keyset id=\\\"baseMenuKeyset\\\"/>\\n   <keyset id=\\\"placesOrganizerKeyset\\\">\\n     <!-- Instantiation Keys -->\\n     <key id=\\\"placesKey_close\\\" key=\\\"&cmd.close.key;\\\" modifiers=\\\"accel\\\" \\n@@ -162,27 +170,159 @@\\n     <popup id=\\\"placesContext\\\"/>\\n   </popupset>\\n \\n-  <toolbox>\\n-    <menubar id=\\\"placesMenubar\\\">\\n-      <menu id=\\\"fileMenu\\\" label=\\\"&file.label;\\\" accesskey=\\\"&file.accesskey;\\\">\\n-        <menupopup>\\n-          <menuitem id=\\\"fileNewBookmark\\\"\\n+  <toolbox id=\\\"placesToolbox\\\">\\n+    <toolbar class=\\\"chromeclass-toolbar\\\" id=\\\"placesToolbar\\\">\\n+      <toolbarbutton id=\\\"back-button\\\" class=\\\"toolbarbutton-1 chromeclass-toolbar-additional\\\"\\n+                     command=\\\"OrganizerCommand:Back\\\"\\n+                     tooltiptext=\\\"&backButton.tooltip;\\\"\\n+                     accesskey=\\\"&backCmd.accesskey;\\\"\\n+                     disabled=\\\"true\\\"/>\\n+    \\n+      <toolbarbutton id=\\\"forward-button\\\" class=\\\"toolbarbutton-1 chromeclass-toolbar-additional\\\"\\n+                     command=\\\"OrganizerCommand:Forward\\\"\\n+                     tooltiptext=\\\"&forwardButton.tooltip;\\\"\\n+                     accesskey=\\\"&forwardCmd.accesskey;\\\"\\n+                     disabled=\\\"true\\\"/>\\n+\\n+      <toolbarbutton id=\\\"organizeButton\\\" type=\\\"menu\\\" label=\\\"&organize.label;\\\">\\n+        <menupopup id=\\\"organizeButtonPopup\\\">\\n+          <menuitem id=\\\"newbookmark\\\"\\n                     command=\\\"placesCmd_new:bookmark\\\"\\n                     label=\\\"&cmd.new_bookmark.label;\\\"\\n                     accesskey=\\\"&cmd.new_bookmark.accesskey;\\\"/>\\n-          <menuitem id=\\\"fileNewLivemark\\\"\\n-                    command=\\\"placesCmd_new:livemark\\\"\\n-                    label=\\\"&cmd.new_livemark.label;\\\"\\n-                    accesskey=\\\"&cmd.new_livemark.accesskey;\\\"/>\\n-          <menuitem id=\\\"fileNewFolder\\\"\\n+          <menuitem id=\\\"newfolder\\\"\\n                     command=\\\"placesCmd_new:folder\\\"\\n                     label=\\\"&cmd.new_folder.label;\\\"\\n                     accesskey=\\\"&cmd.new_folder.accesskey;\\\"/>\\n-          <menuitem id=\\\"fileNewSeparator\\\"\\n+          <menuitem id=\\\"newseparator\\\"\\n                     command=\\\"placesCmd_new:separator\\\"\\n                     label=\\\"&cmd.new_separator.label;\\\"\\n                     accesskey=\\\"&cmd.new_separator.accesskey;\\\"/>\\n-          <menuseparator/>\\n+\\n+          <menuseparator id=\\\"orgCutSeparator\\\"/>\\n+          \\n+          <menuitem id=\\\"orgCut\\\"\\n+                    command=\\\"cmd_cut\\\"\\n+                    label=\\\"&cutCmd.label;\\\"\\n+                    key=\\\"key_cut\\\"\\n+                    accesskey=\\\"&cutCmd.accesskey;\\\"\\n+                    selection=\\\"separator|link|folder|mixed\\\"/>\\n+          <menuitem id=\\\"orgCopy\\\"\\n+                    command=\\\"cmd_copy\\\"\\n+                    label=\\\"&copyCmd.label;\\\"\\n+                    key=\\\"key_copy\\\"\\n+                    accesskey=\\\"&copyCmd.accesskey;\\\"\\n+                    selection=\\\"separator|link|folder|mixed\\\"/>\\n+          <menuitem id=\\\"orgPaste\\\"\\n+                    command=\\\"cmd_paste\\\"\\n+                    label=\\\"&pasteCmd.label;\\\"\\n+                    key=\\\"key_paste\\\"\\n+                    accesskey=\\\"&pasteCmd.accesskey;\\\"\\n+                    selection=\\\"mutable\\\"/>\\n+          <menuitem id=\\\"orgUndo\\\"\\n+                    command=\\\"cmd_undo\\\"\\n+                    label=\\\"&undoCmd.label;\\\"\\n+                    key=\\\"key_undo\\\"\\n+                    accesskey=\\\"&undoCmd.accesskey;\\\"/>\\n+          <menuitem id=\\\"orgRedo\\\"\\n+                    command=\\\"cmd_redo\\\"\\n+                    label=\\\"&redoCmd.label;\\\"\\n+                    key=\\\"key_redo\\\"\\n+                    accesskey=\\\"&redoCmd.accesskey;\\\"/>\\n+\\n+          <menuseparator id=\\\"selectAllSeparator\\\"/>\\n+          \\n+          <menuitem id=\\\"orgSelectAll\\\"\\n+                    command=\\\"cmd_selectAll\\\"\\n+                    label=\\\"&selectAllCmd.label;\\\"\\n+                    key=\\\"key_selectAll\\\"\\n+                    accesskey=\\\"&selectAllCmd.accesskey;\\\"/>\\n+\\n+          <menuseparator id=\\\"orgMoveSeparator\\\"/>\\n+          \\n+          <menuitem id=\\\"orgDelete\\\"\\n+                    command=\\\"cmd_delete\\\"\\n+                    label=\\\"&deleteCmd.label;\\\"\\n+                    key=\\\"key_delete\\\"\\n+                    accesskey=\\\"&deleteCmd.accesskey;\\\"/>\\n+          <menuitem id=\\\"orgRename\\\"\\n+                    command=\\\"placesCmd_rename\\\"\\n+                    label=\\\"&cmd.rename.label;\\\"\\n+                    accesskey=\\\"&cmd.rename.accesskey;\\\"/>\\n+          <menuitem id=\\\"orgProperties\\\"\\n+                    command=\\\"placesCmd_show:info\\\"\\n+                    label=\\\"&cmd.properties.label;\\\"\\n+                    key=\\\"placesKey_show:info\\\"\\n+                    accesskey=\\\"&cmd.properties.accesskey;\\\"/>\\n+          \\n+          <menuseparator id=\\\"orgCloseSeparator\\\"/>\\n+\\n+          <menuitem id=\\\"orgClose\\\"\\n+                    key=\\\"placesKey_close\\\" \\n+                    label=\\\"&file.close.label;\\\"\\n+                    accesskey=\\\"&file.close.accesskey;\\\" \\n+                    oncommand=\\\"close();\\\"/>\\n+        </menupopup>\\n+      </toolbarbutton>\\n+\\n+      <toolbarbutton id=\\\"viewMenu\\\" type=\\\"menu\\\"\\n+                     label=\\\"&views.label;\\\"\\n+                     accesskey=\\\"&view.accesskey;\\\">\\n+        <menupopup id=\\\"viewMenuPopup\\\">\\n+          <menuitem id=\\\"viewDetails\\\"\\n+                    type=\\\"radio\\\"\\n+#ifdef MACOSX\\n+                    label=\\\"&view.detailsMacOSX.label;\\\"\\n+#else\\n+                    label=\\\"&view.details.label;\\\"\\n+#endif\\n+                    accesskey=\\\"&view.details.label;\\\">\\n+          </menuitem>\\n+\\n+          <menuseparator id=\\\"addonsSeparator\\\"/>\\n+\\n+          <!--\\n+          <menuitem id=\\\"viewAddons\\\"\\n+                    command=\\\"\\\"\\n+                    label=\\\"&view.addons.label;\\\"\\n+                    accesskey=\\\"&view.addons.label;\\\"/>\\n+          <menuseparator id=\\\"sortingSeparator\\\"/>\\n+          -->\\n+          <menu id=\\\"viewColumns\\\" \\n+                label=\\\"&view.columns.label;\\\" accesskey=\\\"&view.columns.accesskey;\\\">\\n+            <menupopup onpopupshowing=\\\"ViewMenu.fillWithColumns(event, null, null, 'checkbox', null);\\\"\\n+                       oncommand=\\\"ViewMenu.showHideColumn(event.target); event.stopPropagation();\\\"/>\\n+          </menu>\\n+          <menu id=\\\"viewSort\\\" label=\\\"&view.sort.label;\\\"\\n+                accesskey=\\\"&view.sort.accesskey;\\\">\\n+            <menupopup onpopupshowing=\\\"ViewMenu.populateSortMenu(event);\\\"\\n+                       oncommand=\\\"ViewMenu.setSortColumn(event.target.getAttribute('column'), null);\\\">\\n+              <menuitem id=\\\"viewUnsorted\\\" type=\\\"radio\\\" name=\\\"columns\\\" \\n+                        label=\\\"&view.unsorted.label;\\\" accesskey=\\\"&view.unsorted.accesskey;\\\"\\n+                        oncommand=\\\"ViewMenu.setSortColumn(null, null);\\\"/>\\n+              <menuseparator id=\\\"directionSeparator\\\"/>\\n+              <menuitem id=\\\"viewSortAscending\\\" type=\\\"radio\\\" name=\\\"direction\\\" \\n+                        label=\\\"&view.sortAscending.label;\\\" accesskey=\\\"&view.sortAscending.accesskey;\\\"\\n+                        oncommand=\\\"ViewMenu.setSortColumn(null, 'ascending'); event.stopPropagation();\\\"/>\\n+              <menuitem id=\\\"viewSortDescending\\\" type=\\\"radio\\\" name=\\\"direction\\\" \\n+                        label=\\\"&view.sortDescending.label;\\\" accesskey=\\\"&view.sortDescending.accesskey;\\\"\\n+                        oncommand=\\\"ViewMenu.setSortColumn(null, 'descending'); event.stopPropagation();\\\"/>\\n+            </menupopup>\\n+          </menu>\\n+          <!--\\n+          <menuseparator id=\\\"groupingSeparator\\\" observes=\\\"placesBC_grouping:separator\\\"/>\\n+\\n+          <menuitem id=\\\"viewGroupNone\\\" type=\\\"radio\\\" name=\\\"group\\\"\\n+                    observes=\\\"placesBC_grouping:off\\\"/>\\n+          <menuitem id=\\\"viewGroupGroup\\\" type=\\\"radio\\\" name=\\\"group\\\"\\n+                    observes=\\\"placesBC_grouping:on\\\"/>\\n+          -->\\n+        </menupopup>\\n+      </toolbarbutton>\\n+\\n+      <toolbarbutton id=\\\"maintenanceButton\\\" style=\\\"min-width:0px !important;\\\"\\n+                     type=\\\"menu\\\" label=\\\"&maintenance.label;\\\">\\n+        <menupopup id=\\\"maintenanceButtonPopup\\\">\\n           <menuitem id=\\\"fileImport\\\"\\n                     command=\\\"OrganizerCommand_import\\\"\\n                     label=\\\"&cmd.import.label;\\\"\\n@@ -205,142 +345,19 @@\\n                         accesskey=\\\"&cmd.restoreFromFile.accesskey;\\\"/>\\n             </menupopup>\\n           </menu>\\n-          <menuseparator/>\\n-          <menuitem id=\\\"fileClose\\\"\\n-                    key=\\\"placesKey_close\\\" \\n-                    label=\\\"&file.close.label;\\\"\\n-                    accesskey=\\\"&file.close.accesskey;\\\" \\n-                    oncommand=\\\"close();\\\"/>\\n-        </menupopup>\\n-      </menu>\\n-      <menu id=\\\"editMenu\\\" label=\\\"&edit.label;\\\" accesskey=\\\"&edit.accesskey;\\\">\\n-        <menupopup>\\n-          <menuitem id=\\\"menu_undo\\\"/>\\n-          <menuitem id=\\\"menu_redo\\\"/>\\n-          <menuseparator/>\\n-          <menuitem id=\\\"menu_cut\\\"/>\\n-          <menuitem id=\\\"menu_copy\\\"/>\\n-          <menuitem id=\\\"menu_paste\\\"/>\\n-          <menuitem id=\\\"menu_delete\\\"/>\\n-          <menuseparator/>\\n-          <menuitem id=\\\"menu_selectAll\\\"/>\\n-          <menuseparator/>\\n-          <menuitem id=\\\"editFindAll\\\"\\n-                    command=\\\"OrganizerCommand_find:all\\\"\\n-                    key=\\\"placesKey_find:all\\\"/>\\n-          <menuitem id=\\\"editFindCurrent\\\"\\n-                    command=\\\"OrganizerCommand_find:current\\\"\\n-                    key=\\\"placesKey_find:current\\\"/>\\n-          <menuseparator/>\\n-          <menuitem command=\\\"placesCmd_moveBookmarks\\\"\\n-                    label=\\\"&cmd.moveBookmarks.menuLabel;\\\"\\n-                    accesskey=\\\"&cmd.moveBookmarks.menuAccesskey;\\\"/>\\n-          <menuitem command=\\\"placesCmd_setAsBookmarksToolbarFolder\\\"\\n-                    label=\\\"&cmd.personalToolbarFolder.menuLabel;\\\"\\n-                    accesskey=\\\"&cmd.personalToolbarFolder.menuAccesskey;\\\"/>\\n-          <menuseparator/>\\n-          <menuitem id=\\\"editReload\\\"\\n-                    command=\\\"placesCmd_reload\\\"\\n-                    label=\\\"&cmd.reloadLivebookmark.label;\\\"\\n-                    accesskey=\\\"&cmd.reloadLivebookmark.accesskey;\\\"/>\\n-          <menuitem id=\\\"editReloadMicrosummary\\\"\\n-                    command=\\\"placesCmd_reloadMicrosummary\\\"\\n-                    label=\\\"&cmd.reloadMicrosummary.label;\\\"\\n-                    accesskey=\\\"&cmd.reloadMicrosummary.accesskey;\\\"/>\\n-          <menuseparator/>\\n-          <menuitem id=\\\"properties\\\"\\n-                    command=\\\"placesCmd_show:info\\\"\\n-                    key=\\\"placesKey_show:info\\\"\\n-                    label=\\\"&cmd.properties.label;\\\" \\n-                    accesskey=\\\"&cmd.properties.accesskey;\\\"/>\\n         </menupopup>\\n-      </menu>\\n-      <menu id=\\\"viewMenu\\\" label=\\\"&view.label;\\\" accesskey=\\\"&view.accesskey;\\\"\\n-            onpopupshowing=\\\"ViewMenu.populate(event);\\\"\\n-            oncommand=\\\"ViewMenu.setSortColumn(event.target.getAttribute('column'), null);\\\">\\n-        <menupopup>\\n-          <menuitem id=\\\"viewToolbar\\\"\\n-                    type=\\\"checkbox\\\"\\n-                    label=\\\"&view.toolbar.label;\\\"\\n-                    accesskey=\\\"&view.toolbar.accesskey;\\\"\\n-                    oncommand=\\\"goToggleToolbar('mainToolbar', 'viewToolbar'); event.stopPropagation();\\\"\\n-                    checked=\\\"true\\\"/>/>\\n-          <menu id=\\\"viewColumns\\\" \\n-                label=\\\"&view.columns.label;\\\" accesskey=\\\"&view.columns.accesskey;\\\">\\n-            <menupopup onpopupshowing=\\\"ViewMenu.fillWithColumns(event, null, null, 'checkbox', null);\\\"\\n-                       oncommand=\\\"ViewMenu.showHideColumn(event.target); event.stopPropagation();\\\"/>\\n-          </menu>\\n-          <menuseparator id=\\\"groupingSeparator\\\" observes=\\\"placesBC_grouping:separator\\\"/>\\n-          <menuitem id=\\\"viewGroupNone\\\" type=\\\"radio\\\" name=\\\"group\\\"\\n-                    observes=\\\"placesBC_grouping:off\\\"/>\\n-          <menuitem id=\\\"viewGroupGroup\\\" type=\\\"radio\\\" name=\\\"group\\\"\\n-                    observes=\\\"placesBC_grouping:on\\\"/>\\n-          <menuseparator id=\\\"columnSeparator\\\"/>\\n-          <menuitem id=\\\"viewUnsorted\\\" type=\\\"radio\\\" name=\\\"columns\\\" \\n-                    label=\\\"&view.unsorted.label;\\\" accesskey=\\\"&view.unsorted.accesskey;\\\"\\n-                    oncommand=\\\"ViewMenu.setSortColumn(null, null);\\\"/>\\n-          <menuseparator id=\\\"directionSeparator\\\"/>\\n-          <menuitem id=\\\"viewSortAscending\\\" type=\\\"radio\\\" name=\\\"direction\\\" \\n-                    label=\\\"&view.sortAscending.label;\\\" accesskey=\\\"&view.sortAscending.accesskey;\\\"\\n-                    oncommand=\\\"ViewMenu.setSortColumn(null, 'ascending'); event.stopPropagation();\\\"/>\\n-          <menuitem id=\\\"viewSortDescending\\\" type=\\\"radio\\\" name=\\\"direction\\\" \\n-                    label=\\\"&view.sortDescending.label;\\\" accesskey=\\\"&view.sortDescending.accesskey;\\\"\\n-                    oncommand=\\\"ViewMenu.setSortColumn(null, 'descending'); event.stopPropagation();\\\"/>\\n-        </menupopup>\\n-      </menu>\\n-#ifdef XP_MACOSX\\n-      <menu id=\\\"windowMenu\\\"/>\\n-      <menupopup id=\\\"menu_ToolsPopup\\\"/>\\n-#endif\\n-      <menu id=\\\"helpMenu\\\"/>\\n-    </menubar>\\n+      </toolbarbutton>\\n \\n-    <toolbar id=\\\"mainToolbar\\\" class=\\\"chromeclass-toolbar\\\">\\n-      <toolbarbutton id=\\\"newbookmark\\\"\\n-                     command=\\\"placesCmd_new:bookmark\\\"\\n-                     label=\\\"&cmd.new_bookmark.label;\\\"\\n-                     accesskey=\\\"&cmd.new_bookmark.accesskey;\\\"/>\\n-      <toolbarbutton id=\\\"newfolder\\\"\\n-                     command=\\\"placesCmd_new:folder\\\"\\n-                     label=\\\"&cmd.new_folder.label;\\\"\\n-                     accesskey=\\\"&cmd.new_folder.accesskey;\\\"/>\\n-      <toolbarbutton id=\\\"newseparator\\\"\\n-                     command=\\\"placesCmd_new:separator\\\"\\n-                     label=\\\"&cmd.new_separator.label;\\\"\\n-                     accesskey=\\\"&cmd.new_separator.accesskey;\\\"/>\\n-      <toolbarseparator/>\\n-      <toolbarbutton id=\\\"moveBookmark\\\"\\n-                     command=\\\"placesCmd_moveBookmarks\\\"\\n-                     label=\\\"&cmd.moveBookmarks.label;\\\"\\n-                     accesskey=\\\"&cmd.moveBookmarks.accesskey;\\\"/>\\n-      <toolbarseparator/>\\n-      <toolbarbutton id=\\\"properties\\\"\\n-                     command=\\\"placesCmd_show:info\\\"\\n-                     label=\\\"&cmd.properties.label;\\\" \\n-                     accesskey=\\\"&cmd.properties.accesskey;\\\"/>\\n-      <toolbarbutton id=\\\"rename\\\"\\n-                     command=\\\"placesCmd_rename\\\"\\n-                     label=\\\"&cmd.rename.label;\\\"\\n-                     accesskey=\\\"&cmd.rename.accesskey;\\\"/>\\n-      <toolbarbutton id=\\\"delete\\\"\\n-                     command=\\\"cmd_delete\\\"\\n-                     label=\\\"&deleteCmd.label;\\\"\\n-                     accesskey=\\\"&deleteCmd.accesskey;\\\" />\\n-    </toolbar>\\n+      <spacer flex=\\\"1\\\"/>\\n \\n-    <toolbar class=\\\"chromeclass-toolbar\\\">\\n       <textbox id=\\\"searchFilter\\\" style=\\\"width: 23em;\\\" timeout=\\\"500\\\"\\n                oncommand=\\\"PlacesSearchBox.search(this.value);\\\" \\n                onreset=\\\"PlacesOrganizer.onPlaceSelected(false); return true;\\\" \\n                collection=\\\"bookmarks\\\">\\n       </textbox>\\n-      <spacer flex=\\\"1\\\"/>\\n-      <toolbarbutton id=\\\"toolbarGroupOff\\\" type=\\\"radio\\\" group=\\\"grouping\\\" \\n-                     observes=\\\"placesBC_grouping:off\\\"/>\\n-      <toolbarbutton id=\\\"toolbarGroupOn\\\" type=\\\"radio\\\" group=\\\"grouping\\\" \\n-                     observes=\\\"placesBC_grouping:on\\\" />\\n     </toolbar>\\n   </toolbox>\\n+\\n   <hbox flex=\\\"1\\\" id=\\\"placesView\\\">\\n     <tree id=\\\"placesList\\\"\\n           class=\\\"placesTree\\\"\\n@@ -348,11 +365,11 @@\\n           showRoot=\\\"true\\\"\\n           place=\\\"place:folder=2&amp;group=3&amp;excludeItems=1&amp;queryType=1\\\"\\n           hidecolumnpicker=\\\"true\\\" context=\\\"placesContext\\\"\\n-          onselect=\\\"PlacesOrganizer.onPlaceSelected(true);\\n-                    PlacesOrganizer.updateStatusBarForView(this);\\\"\\n+          onselect=\\\"PlacesOrganizer.onPlaceSelected(true);\\\"\\n           onclick=\\\"PlacesOrganizer.onTreeClick(event);\\\"\\n           seltype=\\\"single\\\"\\n-          persist=\\\"width\\\">\\n+          persist=\\\"width\\\"\\n+          width=\\\"160\\\">\\n       <treecols>\\n         <treecol id=\\\"title\\\" flex=\\\"1\\\" primary=\\\"true\\\" hideheader=\\\"true\\\"/>\\n       </treecols>\\n@@ -363,7 +380,7 @@\\n     </splitter>\\n     <vbox id=\\\"contentView\\\" flex=\\\"4\\\">\\n       <deck id=\\\"contentDeck\\\" flex=\\\"1\\\">\\n-        <vbox flex=\\\"1\\\">\\n+        <vbox id=\\\"defaultView\\\" flex=\\\"1\\\">\\n           <hbox id=\\\"titlebar\\\" align=\\\"center\\\">\\n             <label id=\\\"showingPrefix\\\"/>\\n             <deck id=\\\"titleDeck\\\" flex=\\\"1\\\">\\n@@ -394,8 +411,7 @@\\n           <tree id=\\\"placeContent\\\" class=\\\"placesTree\\\" context=\\\"placesContext\\\" \\n                 flex=\\\"1\\\" type=\\\"places\\\" \\n                 ondblclick=\\\"this.controller.openSelectedNodeWithEvent(event);\\\"\\n-                onclick=\\\"PlacesOrganizer.onTreeClick(event);\\\"\\n-                onselect=\\\"PlacesOrganizer.updateStatusBarForView(this);\\\">\\n+                onclick=\\\"PlacesOrganizer.onTreeClick(event);\\\">\\n             <treecols id=\\\"placeContentColumns\\\">\\n               <treecol label=\\\"&col.name.label;\\\" id=\\\"title\\\" flex=\\\"5\\\" primary=\\\"true\\\" \\n                        persist=\\\"width hidden ordinal sortActive sortDirection\\\"/>\\n@@ -406,7 +422,7 @@\\n               <treecol label=\\\"&col.url.label;\\\" id=\\\"url\\\" flex=\\\"5\\\" \\n                        persist=\\\"width hidden ordinal sortActive sortDirection\\\"/>\\n               <splitter class=\\\"tree-splitter\\\"/>\\n-              <treecol label=\\\"&col.lastvisit.label;\\\" id=\\\"date\\\" flex=\\\"1\\\"\\n+              <treecol label=\\\"&col.lastvisit.label;\\\" id=\\\"date\\\" flex=\\\"1\\\" hidden=\\\"true\\\"\\n                        persist=\\\"width hidden ordinal sortActive sortDirection\\\"/>\\n               <splitter class=\\\"tree-splitter\\\"/>\\n               <treecol label=\\\"&col.visitcount.label;\\\" id=\\\"visitCount\\\" flex=\\\"1\\\" hidden=\\\"true\\\"\\n@@ -463,7 +479,4 @@\\n       </deck>\\n     </vbox>\\n   </hbox>\\n-  <statusbar>\\n-    <statusbarpanel id=\\\"status\\\" flex=\\\"1\\\"/>\\n-  </statusbar>\\n </window>\\ndiff --git a/browser/components/sessionstore/src/nsSessionStore.js b/browser/components/sessionstore/src/nsSessionStore.js\\nindex 45cff98..8ec4f77 100644\\n--- a/browser/components/sessionstore/src/nsSessionStore.js\\n+++ b/browser/components/sessionstore/src/nsSessionStore.js\\n@@ -657,6 +657,8 @@ SessionStoreService.prototype = {\\n   getClosedTabCount: function sss_getClosedTabCount(aWindow) {\\n     if (!aWindow.__SSi && aWindow.__SS_dyingCache)\\n       return aWindow.__SS_dyingCache._closedTabs.length;\\n+    if (!aWindow.__SSi)\\n+      return 0; // not a browser window, or not otherwise tracked by SS.\\n     \\n     return this._windows[aWindow.__SSi]._closedTabs.length;\\n   },\\ndiff --git a/browser/locales/en-US/chrome/browser/places/places.dtd b/browser/locales/en-US/chrome/browser/places/places.dtd\\nindex 3d6e9b0..f8cc6fc9 100644\\n--- a/browser/locales/en-US/chrome/browser/places/places.dtd\\n+++ b/browser/locales/en-US/chrome/browser/places/places.dtd\\n@@ -1,7 +1,7 @@\\n-<!ENTITY places.bm.title\\n-  \\\"Bookmarks Manager\\\">\\n-<!ENTITY file.label\\n-  \\\"File\\\">\\n+<!ENTITY places.organizer.title\\n+  \\\"Places Organizer\\\">\\n+<!ENTITY organize.label\\n+  \\\"Organize\\\">\\n <!ENTITY file.accesskey\\n   \\\"F\\\">\\n <!ENTITY file.close.label\\n@@ -14,8 +14,8 @@\\n   \\\"Edit\\\">\\n <!ENTITY edit.accesskey\\n   \\\"E\\\">\\n-<!ENTITY view.label\\n-  \\\"View\\\">\\n+<!ENTITY views.label\\n+  \\\"Views\\\">\\n <!ENTITY view.accesskey\\n   \\\"V\\\">\\n <!ENTITY view.toolbar.label\\n@@ -26,6 +26,10 @@\\n   \\\"Show Columns\\\">\\n <!ENTITY view.columns.accesskey\\n   \\\"S\\\">\\n+<!ENTITY view.sort.label\\n+  \\\"Sort\\\">\\n+<!ENTITY view.sort.accesskey\\n+  \\\"s\\\">\\n <!ENTITY view.unsorted.label\\n   \\\"Unsorted\\\">\\n <!ENTITY view.unsorted.accesskey\\n@@ -314,3 +318,28 @@\\n   \\\"Feed\\\">\\n <!ENTITY feed.subscribe.tooltip\\n   \\\"Subscribe\\\">\\n+<!ENTITY view.detailsMacOSX.label\\n+  \\\"List\\\">\\n+<!ENTITY view.details.label\\n+  \\\"Details\\\">\\n+<!ENTITY view.details.accesskey\\n+  \\\"\\\">\\n+<!ENTITY view.addons.label\\n+  \\\"Get View Add-ons\\\">\\n+<!ENTITY view.columns.label\\n+  \\\"Columns\\\">\\n+<!ENTITY maintenance.label\\n+  \\\"Import and Backup\\\">\\n+\\n+<!ENTITY backCmd.label\\n+  \\\"Back\\\">\\n+<!ENTITY backCmd.accesskey\\n+  \\\"B\\\">\\n+<!ENTITY backButton.tooltip\\n+  \\\"Go back\\\">\\n+<!ENTITY forwardCmd.label\\n+  \\\"Forward\\\">\\n+<!ENTITY forwardCmd.accesskey\\n+  \\\"F\\\">\\n+<!ENTITY forwardButton.tooltip\\n+  \\\"Go forward\\\">\\ndiff --git a/browser/themes/pinstripe/browser/jar.mn b/browser/themes/pinstripe/browser/jar.mn\\nindex e0944fc..d46c452 100644\\n--- a/browser/themes/pinstripe/browser/jar.mn\\n+++ b/browser/themes/pinstripe/browser/jar.mn\\n@@ -33,6 +33,7 @@ classic.jar:\\n   skin/classic/browser/setDesktopBackground.css\\n   skin/classic/browser/monitor.png\\n   skin/classic/browser/monitor_16-10.png\\n+  skin/classic/browser/wrench.png\\n   skin/classic/browser/places/places.css                    (places/places.css)\\n   skin/classic/browser/places/query.png                     (places/query.png)\\n   skin/classic/browser/places/livemarkItem.png              (places/livemarkItem.png)\\ndiff --git a/browser/themes/pinstripe/browser/places/places.css b/browser/themes/pinstripe/browser/places/places.css\\nindex 6938640..2605a04 100755\\n--- a/browser/themes/pinstripe/browser/places/places.css\\n+++ b/browser/themes/pinstripe/browser/places/places.css\\n@@ -1,12 +1,52 @@\\n+/* Toolbar */\\n+#placesToolbar {\\n+  border-bottom: none;\\n+}\\n+\\n+/* back button */\\n+\\n+#back-button {\\n+  list-style-image: url(\\\"chrome://browser/skin/Toolbar.png\\\");\\n+  -moz-image-region: rect(0px, 24px, 24px, 0px);\\n+}\\n+#back-button[disabled=\\\"true\\\"] {\\n+ -moz-image-region: rect(48px, 24px, 72px, 0px) !important;\\n+}\\n+\\n+/* forward button */\\n+\\n+#forward-button {\\n+  list-style-image: url(\\\"chrome://browser/skin/Toolbar.png\\\");\\n+  -moz-image-region: rect(0px, 48px, 24px, 24px);\\n+}\\n+#forward-button[disabled=\\\"true\\\"] {\\n+ -moz-image-region: rect(48px, 48px, 72px, 24px) !important;\\n+}\\n+\\n+/* organize button */\\n+#organizeButton {\\n+  list-style-image: url(\\\"chrome://browser/skin/wrench.png\\\");\\n+}\\n+\\n+/* view button */\\n+#viewMenu {\\n+  list-style-image: url(\\\"chrome://browser/skin/wrench.png\\\");\\n+}\\n+\\n+/* maintenance button */\\n+#maintenanceButton {\\n+  list-style-image: url(\\\"chrome://browser/skin/wrench.png\\\");\\n+}\\n+\\n /* Root View */\\n #placesView {\\n-  padding: 8px 6px 6px 8px;\\n+  border-top: 1px solid ThreeDDarkShadow;\\n   -moz-user-focus: ignore;\\n }\\n \\n #splitter {\\n   border: 0px;\\n-  width: 10px;\\n+  width: 3px;\\n   background-color: transparent;\\n }\\n \\n@@ -22,9 +62,7 @@\\n   border: 0px;\\n }\\n \\n-#placesListContainer {\\n-  -moz-appearance: listbox;\\n-  margin: 7px 0px 7px 6px;\\n+#contentView {\\n }\\n \\n #placeContent {\\n@@ -32,11 +70,6 @@\\n   border: 0px;\\n }\\n \\n-#content {\\n-  margin: 7px 6px 7px 0px;\\n-  -moz-appearance: listbox;\\n-}\\n-\\n treechildren::-moz-tree-image(title) {\\n   padding-right: 2px;\\n   margin: 0px 2px;\\n@@ -81,29 +114,12 @@ treechildren::-moz-tree-twisty(title, separator) {\\n   padding: 0px;\\n }\\n \\n-/* Command Bar */\\n-.commands {\\n-  padding-bottom: 5px;  \\n-}\\n-\\n-.commandGroupButton {\\n-  margin-left: 0px;\\n-  margin-top: 0px;\\n-}\\n-\\n-.commandGroupButton.first {\\n-  margin-right: -10px;\\n-}\\n-\\n-.commandGroupButton.last {\\n-  margin-left: 20px;\\n-}\\n-\\n /* Title Bar */\\n #titlebar {\\n   background-color: -moz-Dialog;\\n   border-bottom: 2px solid;\\n   -moz-border-bottom-colors: ThreeDHighlight ThreeDShadow;\\n+  padding: 0;\\n }\\n \\n #showingPrefix {\\n@@ -256,109 +272,3 @@ treechildren::-moz-tree-twisty(title, separator) {\\n   min-width:0em;\\n }\\n \\n-/**\\n- * mainToolbar\\n- * style rules are (mostly) copied over from bookmarkManager.css.\\n- */\\n-#mainToolbar toolbarbutton {\\n-  list-style-image: url(\\\"chrome://browser/skin/places/organizer-toolbar.png\\\");\\n-  -moz-box-orient: vertical;\\n-}\\n-\\n-/* new bookmark */\\n-#newbookmark {\\n-  -moz-image-region: rect(0px, 168px, 24px, 144px);\\n-}\\n-#newbookmark:not([disabled=\\\"true\\\"]):hover {\\n-  -moz-image-region: rect(24px, 168px, 48px, 144px);\\n-}\\n-#newbookmark[disabled=\\\"true\\\"] {\\n-  -moz-image-region: rect(48px, 168px, 72px, 144px);\\n-}\\n-#newbookmark:not([disabled=\\\"true\\\"]):hover:active {\\n-  -moz-image-region: rect(72px, 168px, 96px, 144px);\\n-}\\n-\\n-/* new folder */\\n-#newfolder {\\n-  -moz-image-region: rect(0px, 24px, 24px, 0px);\\n-}\\n-#newfolder:not([disabled=\\\"true\\\"]):hover {\\n-  -moz-image-region: rect(24px, 24px, 48px, 0px);\\n-}\\n-#newfolder[disabled=\\\"true\\\"] {\\n-  -moz-image-region: rect(48px, 24px, 72px, 0px);\\n-}\\n-#newfolder:not([disabled=\\\"true\\\"]):hover:active {\\n-  -moz-image-region: rect(72px, 24px, 96px, 0px);\\n-}\\n-\\n-/* new separator */\\n-#newseparator {\\n-  -moz-image-region: rect(0px, 48px, 24px, 24px);\\n-}\\n-#newseparator:not([disabled=\\\"true\\\"]):hover {\\n-  -moz-image-region: rect(24px, 48px, 48px, 24px);\\n-}\\n-#newseparator[disabled=\\\"true\\\"] {\\n-  -moz-image-region: rect(48px, 48px, 72px, 24px);\\n-}\\n-#newseparator:not([disabled=\\\"true\\\"]):hover:active {\\n-  -moz-image-region: rect(72px, 48px, 96px, 24px);\\n-}\\n-\\n-/* moveBookmark */\\n-#moveBookmark {\\n-  -moz-image-region: rect(0px, 72px, 24px, 48px);\\n-}\\n-#moveBookmark:not([disabled=\\\"true\\\"]):hover {\\n-  -moz-image-region: rect(24px, 72px, 48px, 48px);\\n-}\\n-#moveBookmark[disabled=\\\"true\\\"] {\\n-  -moz-image-region: rect(48px, 72px, 72px, 48px);\\n-}\\n-#moveBookmark:not([disabled=\\\"true\\\"]):hover:active {\\n-  -moz-image-region: rect(72px, 72px, 96px, 48px);\\n-}\\n-\\n-/* properties */\\n-#properties {\\n-  -moz-image-region: rect(0px, 96px, 24px, 72px);\\n-}\\n-#properties:not([disabled=\\\"true\\\"]):hover {\\n-  -moz-image-region: rect(24px, 96px, 48px, 72px);\\n-}\\n-#properties[disabled=\\\"true\\\"] {\\n-  -moz-image-region: rect(48px, 96px, 72px, 72px);\\n-}\\n-#properties:not([disabled=\\\"true\\\"]):hover:active {\\n-  -moz-image-region: rect(72px, 96px, 96px, 72px);\\n-}\\n-\\n-/* rename */\\n-#rename {\\n-  -moz-image-region: rect(0px, 120px, 24px, 96px);\\n-}\\n-#rename:not([disabled=\\\"true\\\"]):hover {\\n-  -moz-image-region: rect(24px, 120px, 48px, 96px);\\n-}\\n-#rename[disabled=\\\"true\\\"] {\\n-  -moz-image-region: rect(48px, 120px, 72px, 96px);\\n-}\\n-#rename:not([disabled=\\\"true\\\"]):hover:active {\\n-  -moz-image-region: rect(72px, 120px, 96px, 96px);\\n-}\\n-\\n-/* delete */\\n-#delete {\\n-  -moz-image-region: rect(0px, 144px, 24px, 120px);\\n-}\\n-#delete:not([disabled=\\\"true\\\"]):hover {\\n-  -moz-image-region: rect(24px, 144px, 48px, 120px);\\n-}\\n-#delete[disabled=\\\"true\\\"] {\\n-  -moz-image-region: rect(48px, 144px, 72px, 120px);\\n-}\\n-#delete:not([disabled=\\\"true\\\"]):hover:active {\\n-  -moz-image-region: rect(72px, 144px, 96px, 120px);\\n-}\\ndiff --git a/browser/themes/pinstripe/browser/wrench.png b/browser/themes/pinstripe/browser/wrench.png\\nnew file mode 100644\\nindex 0000000..5c8213f\\nBinary files /dev/null and b/browser/themes/pinstripe/browser/wrench.png differ\\ndiff --git a/browser/themes/winstripe/browser/jar.mn b/browser/themes/winstripe/browser/jar.mn\\nindex 87f27d3..cf9c1bf 100644\\n--- a/browser/themes/winstripe/browser/jar.mn\\n+++ b/browser/themes/winstripe/browser/jar.mn\\n@@ -31,6 +31,7 @@ classic.jar:\\n         skin/classic/browser/setDesktopBackground.css\\n         skin/classic/browser/monitor.png\\n         skin/classic/browser/monitor_16-10.png\\n+        skin/classic/browser/wrench.png\\n         skin/classic/browser/feeds/feedIcon.png                 (feeds/feedIcon.png)\\n         skin/classic/browser/feeds/feedIcon16.png               (feeds/feedIcon16.png)\\n         skin/classic/browser/feeds/subscribe.css                (feeds/subscribe.css)\\ndiff --git a/browser/themes/winstripe/browser/places/places.css b/browser/themes/winstripe/browser/places/places.css\\nindex e5de303..0f69aa6 100755\\n--- a/browser/themes/winstripe/browser/places/places.css\\n+++ b/browser/themes/winstripe/browser/places/places.css\\n@@ -1,12 +1,52 @@\\n+/* Toolbar */\\n+#placesToolbar {\\n+  border: none;\\n+}\\n+\\n+/* back button */\\n+\\n+#back-button {\\n+  list-style-image: url(\\\"chrome://browser/skin/Toolbar.png\\\");\\n+  -moz-image-region: rect(0px, 24px, 24px, 0px);\\n+}\\n+#back-button[disabled=\\\"true\\\"] {\\n+ -moz-image-region: rect(48px, 24px, 72px, 0px) !important;\\n+}\\n+\\n+/* forward button */\\n+\\n+#forward-button {\\n+  list-style-image: url(\\\"chrome://browser/skin/Toolbar.png\\\");\\n+  -moz-image-region: rect(0px, 48px, 24px, 24px);\\n+}\\n+#forward-button[disabled=\\\"true\\\"] {\\n+ -moz-image-region: rect(48px, 48px, 72px, 24px) !important;\\n+}\\n+\\n+/* organize button */\\n+#organizeButton {\\n+  list-style-image: url(\\\"chrome://browser/skin/wrench.png\\\");\\n+}\\n+\\n+/* view button */\\n+#viewMenu {\\n+  list-style-image: url(\\\"chrome://browser/skin/wrench.png\\\");\\n+}\\n+\\n+/* maintenance button */\\n+#maintenanceButton {\\n+  list-style-image: url(\\\"chrome://browser/skin/wrench.png\\\");\\n+}\\n+\\n /* Root View */\\n #placesView {\\n+  border-top: 1px solid ThreeDDarkShadow;\\n   background-color: Window;\\n }\\n \\n #splitter {\\n   border: 0px;\\n   width: 3px;\\n-  background-color: transparent;\\n }\\n \\n /* Place List, Place Content */\\n@@ -15,9 +55,10 @@\\n }\\n \\n #placesList {\\n-  -moz-appearance: listbox;\\n-  margin: 6px 0px 7px 6px;\\n-  width: 160px;\\n+  -moz-appearance: none;\\n+  margin: 0px;\\n+  border: none;\\n+  padding: 0;\\n }\\n \\n #placeContent {\\n@@ -26,8 +67,6 @@\\n }\\n \\n #contentView {\\n-  margin: 6px 6px 7px 0px;\\n-  -moz-appearance: listbox;\\n }\\n \\n treechildren::-moz-tree-image(title) {\\n@@ -65,29 +104,12 @@ treechildren::-moz-tree-cell-text(date, session-continue) {\\n   color: -moz-Field;\\n }\\n \\n-/* Command Bar */\\n-.commands {\\n-  padding-bottom: 5px;  \\n-}\\n-\\n-.commandGroupButton {\\n-  margin-left: 0px;\\n-  margin-top: 0px;\\n-}\\n-\\n-.commandGroupButton.first {\\n-  margin-right: -10px;\\n-}\\n-\\n-.commandGroupButton.last {\\n-  margin-left: 20px;\\n-}\\n-\\n /* Title Bar */\\n #titlebar {\\n   background-color: -moz-Dialog;\\n   border-bottom: 2px solid;\\n   -moz-border-bottom-colors: ThreeDHighlight ThreeDShadow;\\n+  padding: 0;\\n }\\n \\n #showingPrefix {\\n@@ -257,116 +279,3 @@ treechildren::-moz-tree-cell-text(date, session-continue) {\\n   border-top: 2px solid; \\n   -moz-border-top-colors: ThreeDShadow ThreeDHighlight;\\n }\\n-\\n-/**\\n- * mainToolbar\\n- * style rules are (mostly) copied over from bookmarkManager.css.\\n- */\\n-#mainToolbar toolbarbutton {\\n-  list-style-image: url(\\\"chrome://browser/skin/places/organizer-toolbar.png\\\");\\n-  -moz-box-orient: vertical;\\n-  min-width: 57px;\\n-  padding: 5px;\\n-}\\n-\\n-#mainToolbar toolbarbutton > .toolbarbutton-icon {\\n-  -moz-margin-end: 0px;\\n-}\\n-\\n-/* new bookmark */\\n-#newbookmark {\\n-  -moz-image-region: rect(0px 24px 24px 0px);\\n-}\\n-#newbookmark:not([disabled=\\\"true\\\"]):hover {\\n-  -moz-image-region: rect(24px 24px 48px 0px);\\n-}\\n-#newbookmark[disabled=\\\"true\\\"] {\\n-  -moz-image-region: rect(72px 24px 96px 0px);\\n-}\\n-#newbookmark:not([disabled=\\\"true\\\"]):hover:active {\\n-  -moz-image-region: rect(48px 24px 72px 0px);\\n-}\\n-\\n-/* new folder */\\n-#newfolder {\\n-  -moz-image-region: rect(0px 48px 24px 24px);\\n-}\\n-#newfolder:not([disabled=\\\"true\\\"]):hover {\\n-  -moz-image-region: rect(24px 48px 48px 24px);\\n-}\\n-#newfolder[disabled=\\\"true\\\"] {\\n-   -moz-image-region: rect(72px 48px 96px 24px);\\n-}\\n-#newfolder:not([disabled=\\\"true\\\"]):hover:active {\\n-  -moz-image-region: rect(48px 48px 72px 24px);\\n-}\\n-\\n-/* new separator */\\n-#newseparator {\\n-  -moz-image-region: rect(0px 72px 24px 48px);\\n-}\\n-#newseparator:not([disabled=\\\"true\\\"]):hover {\\n-  -moz-image-region: rect(24px 72px 48px 48px);\\n-}\\n-#newseparator[disabled=\\\"true\\\"] {\\n-  -moz-image-region: rect(72px 72px 96px 48px);\\n-}\\n-#newseparator:not([disabled=\\\"true\\\"]):hover:active {\\n-  -moz-image-region: rect(48px 72px 72px 48px);\\n-}\\n-\\n-/* move bookmark */\\n-#moveBookmark {\\n-  -moz-image-region: rect(0px 96px 24px 72px);\\n-}\\n-#moveBookmark:not([disabled=\\\"true\\\"]):hover {\\n-  -moz-image-region: rect(24px 96px 48px 72px);\\n-}\\n-#moveBookmark[disabled=\\\"true\\\"] {\\n-  -moz-image-region: rect(72px 96px 96px 72px);\\n-}\\n-#moveBookmark:not([disabled=\\\"true\\\"]):hover:active {\\n-  -moz-image-region: rect(48px 96px 72px 72px);\\n-}\\n-\\n-/* properties */\\n-#properties {\\n-  -moz-image-region: rect(0px 120px 24px 96px);\\n-}\\n-#properties:not([disabled=\\\"true\\\"]):hover {\\n-  -moz-image-region: rect(24px 120px 48px 96px);\\n-}\\n-#properties[disabled=\\\"true\\\"] {\\n-  -moz-image-region: rect(72px 120px 96px 96px);\\n-}\\n-#properties:not([disabled=\\\"true\\\"]):hover:active {\\n-  -moz-image-region: rect(48px 120px 72px 96px);\\n-}\\n-\\n-/* rename */\\n-#rename {\\n-  -moz-image-region: rect(0px 144px 24px 120px);\\n-}\\n-#rename:not([disabled=\\\"true\\\"]):hover {\\n-  -moz-image-region: rect(24px 144px 48px 120px);\\n-}\\n-#rename[disabled=\\\"true\\\"] {\\n-  -moz-image-region: rect(72px 144px 96px 120px);\\n-}\\n-#rename:not([disabled=\\\"true\\\"]):hover:active {\\n-  -moz-image-region: rect(48px 144px 72px 120px);\\n-}\\n-\\n-/* delete */\\n-#delete {\\n-  -moz-image-region: rect(0px 168px 24px 144px);\\n-}\\n-#delete:not([disabled=\\\"true\\\"]):hover {\\n-  -moz-image-region: rect(24px 168px 48px 144px);\\n-}\\n-#delete[disabled=\\\"true\\\"] {\\n-  -moz-image-region: rect(72px 168px 96px 144px);\\n-}\\n-#delete:not([disabled=\\\"true\\\"]):hover:active {\\n-  -moz-image-region: rect(48px 168px 72px 144px);\\n-}\\ndiff --git a/browser/themes/winstripe/browser/wrench.png b/browser/themes/winstripe/browser/wrench.png\\nnew file mode 100644\\nindex 0000000..5c8213f\\nBinary files /dev/null and b/browser/themes/winstripe/browser/wrench.png differ\\n\""}