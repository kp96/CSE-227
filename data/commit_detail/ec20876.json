{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Basec20876\""},"diff":"\"ec20876 Bug 393819 Assertion: What's this case?: 'result == 0 || result == 1' in gfxFontconfigUtils when different fonts have a common family name. patch by Karl Tomlinson <mozbugz@karlt.net> r+a=pavlov\\ndiff --git a/gfx/thebes/src/gfxFontconfigUtils.cpp b/gfx/thebes/src/gfxFontconfigUtils.cpp\\nindex 7d8091e..1cf878c 100755\\n--- a/gfx/thebes/src/gfxFontconfigUtils.cpp\\n+++ b/gfx/thebes/src/gfxFontconfigUtils.cpp\\n@@ -445,13 +445,14 @@ gfxFontconfigUtils::IsExistingFont(const nsACString &aFontName)\\n     if (!fs)\\n         goto end;\\n \\n-    result = fs->nfont;\\n-    NS_ASSERTION(result == 0 || result == 1, \\\"What's this case?\\\");\\n-\\n-    if (result > 0)\\n+    // There can be more than one matching set of family names: see bug 393819.\\n+    if (fs->nfont > 0) {\\n         mAliasForSingleFont.AppendCString(aFontName);\\n-    else\\n+        result = 1;\\n+    } else {\\n         mNonExistingFonts.AppendCString(aFontName);\\n+        result = 0;\\n+    }\\n \\n   end:\\n     if (pat)\\n\""}