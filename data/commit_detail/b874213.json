{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Basb874213\""},"diff":"\"b874213 tweak Stage.pm to use public key from mofo repo p=joduinn r=preed\\ndiff --git a/tools/release/Bootstrap/Step/Stage.pm b/tools/release/Bootstrap/Step/Stage.pm\\nindex d92171a..63a3101 100644\\n--- a/tools/release/Bootstrap/Step/Stage.pm\\n+++ b/tools/release/Bootstrap/Step/Stage.pm\\n@@ -196,6 +196,7 @@ sub Execute {\\n     my $stageHome = $config->Get(var => 'stageHome');\\n     my $appName = $config->Get(var => 'appName');\\n     my $mozillaCvsroot = $config->Get(var => 'mozillaCvsroot');\\n+    my $mofoCvsroot = $config->Get(var => 'mofoCvsroot');\\n     my $releaseTag = $config->Get(var => 'productTag') . '_RELEASE';\\n  \\n     ## Prepare the staging directory for the release.\\n@@ -238,11 +239,26 @@ sub Execute {\\n         $this->Log(msg => \\\"Changed group of $fullDir to $product\\\");\\n     }\\n \\n-    # TODO - should have a standard \\\"master\\\" copy somewhere else\\n-    # Copy the KEY file from the previous release directory.\\n-    my $keyFile = catfile('/home', 'ftp', 'pub', $product, 'releases', '1.5',\\n-                          'KEY');\\n-    copy($keyFile, $skelDir) or die(\\\"Could not copy $keyFile to $skelDir: $!\\\");\\n+    # Copy the PUBLIC KEY file from the cvs repo.\\n+    $this->Shell(\\n+      cmd => 'cvs',\\n+      cmdArgs => [ '-d', $mofoCvsroot, \\n+                   'co', '-d', 'key-checkout',\\n+                   CvsCatfile('release', 'keys', 'pgp',\\n+                              'PUBLIC-KEY')],\\n+      logFile => catfile($logDir, 'stage_publickey_checkout.log'),\\n+      dir => catfile($stageDir, 'batch1'),\\n+    );\\n+    $this->Shell(\\n+      cmd => 'cvs',\\n+      cmdArgs => [ 'status' ],\\n+      logFile => catfile($logDir, 'stage_publickey_checkout.log'),\\n+      dir => catfile($stageDir, 'batch1', 'key-checkout'),\\n+    );\\n+\\n+    my $keyFile = catfile($stageDir, 'batch1', 'key-checkout', 'PUBLIC-KEY');\\n+    my $keyFileDest = catfile($skelDir, 'KEY');\\n+    copy($keyFile, $keyFileDest) or die(\\\"Could not copy $keyFile to $keyFileDest: $!\\\");\\n \\n     ## Prepare the merging directory.\\n     $this->Shell(\\n\""}