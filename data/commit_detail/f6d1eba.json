{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Basf6d1eba\""},"diff":"\"f6d1eba 301119 allow error pages to load favicons xpfe: dveditz: second-review+ benjamin: first-review+ asa: approval1.8b4+ toolkit: benjamin: first-review+ benjamin: approval1.8b4+ patch by me, ported to toolkit by Henrik Skupin <hskupin@gmail.com>\\ndiff --git a/browser/base/content/tabbrowser.xml b/browser/base/content/tabbrowser.xml\\nindex 11f4908..6b0dc35 100644\\n--- a/browser/base/content/tabbrowser.xml\\n+++ b/browser/base/content/tabbrowser.xml\\n@@ -783,8 +783,13 @@\\n               Components.interfaces.nsIScriptSecurityManager;\\n \\n             try {\\n-              secMan.checkLoadURI(origURI, uri,\\n-                                  nsIScriptSecMan.DISALLOW_SCRIPT);\\n+              // error pages can load their favicon\\n+              // to be on the safe side, only allow chrome:// favicons\\n+              const aboutNeterr = \\\"about:neterror?\\\";\\n+              if (origURI.spec.substr(0, aboutNeterr.length) != aboutNeterr ||\\n+                  !uri.schemeIs(\\\"chrome\\\"))\\n+                secMan.checkLoadURI(origURI, uri,\\n+                                    nsIScriptSecMan.DISALLOW_SCRIPT);\\n             } catch(e) {\\n               return;\\n             }\\n\""}