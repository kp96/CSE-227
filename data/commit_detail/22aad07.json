{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Bas22aad07\""},"diff":"\"22aad07 reconciliation of changes between branches.\\n\\ndiff --cc services/sync/nsBookmarksSyncService.js\\nindex e62778b,736f250..ec16dbd\\n--- a/services/sync/nsBookmarksSyncService.js\\n+++ b/services/sync/nsBookmarksSyncService.js\\n@@@ -1118,9 -1215,9 +1215,9 @@@ DAVCollection.prototype = \\n        let lm = Cc[\\\"@mozilla.org/login-manager;1\\\"].getService(Ci.nsILoginManager);\\n        let logins = lm.findLogins({}, uri.hostPort, null,\\n                                   'Use your ldap username/password - dotmoz');\\n-       LOG(\\\"Found \\\" + logins.length + \\\" logins\\\");\\n+       //notice(\\\"Found \\\" + logins.length + \\\" logins\\\");\\n  \\n -      for (let i = 0; i < logins.length; i++) {\\n +          for (let i = 0; i < logins.length; i++) {\\n          if (logins[i].username == username) {\\n            password = logins[i].password;\\n            break;\\n@@@ -1154,30 -1251,14 +1251,27 @@@\\n      }\\n  \\n      // fixme: hacktastic\\n -    let hello = /Hello (.+)@mozilla.com/.exec(event.target.responseText)\\n -    if (hello) {\\n -      this._currentUserPath = hello[1];\\t\\n -      this._currentUser = this._currentUserPath + \\\"@mozilla.com\\\";\\n -      this._baseURL = \\\"http://dotmoz.mozilla.org/~\\\" +\\n -        this._currentUserPath + \\\"/\\\";\\n -    }\\n -\\n +//    let hello = /Hello (.+)@mozilla.com/.exec(event.target.responseText)\\n +//    let hello = /Index of/.exec(event.target.responseText)\\n +//    if (hello) {\\n +//      this._currentUserPath = hello[1];\\t\\n +//      this._currentUser = this._currentUserPath + \\\"@mozilla.com\\\";\\n +//      this._baseURL = \\\"http://dotmoz.mozilla.org/~\\\" +\\n +//        this._currentUserPath + \\\"/\\\";\\n +//    }\\n +\\n +      // XXX we need to refine some server response codes\\n-       let branch = Cc[\\\"@mozilla.org/preferences-service;1\\\"].\\n-         getService(Ci.nsIPrefBranch);\\n-       this._currentUser = branch.getCharPref(\\\"browser.places.sync.username\\\");\\n- \\n-       // XXX\\n-       let path = this._currentUser.split(\\\"@\\\");\\n-       this._currentUserPath = path[0];\\n++    let branch = Cc[\\\"@mozilla.org/preferences-service;1\\\"].\\n++      getService(Ci.nsIPrefBranch);\\n++    this._currentUser = branch.getCharPref(\\\"browser.places.sync.username\\\");\\n +\\n- LOG(\\\"currentUser: \\\"+this._currentUser);\\n- LOG(\\\"currentUSerPath: \\\"+this._currentUserPath);\\n++    // XXX\\n++    let path = this._currentUser.split(\\\"@\\\");\\n++    this._currentUserPath = path[0];\\n +\\n-       let serverURL = branch.getCharPref(\\\"browser.places.sync.serverURL\\\");\\n-       this._baseURL = serverURL + this._currentUserPath + \\\"/\\\";\\n++    let serverURL = branch.getCharPref(\\\"browser.places.sync.serverURL\\\");\\n++    this._baseURL = serverURL + this._currentUserPath + \\\"/\\\";\\n +    \\n      this._loggedIn = true;\\n  \\n      if (this._loginHandlers && this._loginHandlers.load)\\n\""}