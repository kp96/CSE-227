{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Bas8cc64e8\""},"diff":"\"8cc64e8 Bug 392760, Provide keyboard-accessibility for sorting headers FTP/File/Jar/Gopher dir listing, p=dao@design-noir.de, r+sr+a=bz\\ndiff --git a/netwerk/streamconv/converters/nsIndexedToHTML.cpp b/netwerk/streamconv/converters/nsIndexedToHTML.cpp\\nindex 3f83996..71aadc0 100644\\n--- a/netwerk/streamconv/converters/nsIndexedToHTML.cpp\\n+++ b/netwerk/streamconv/converters/nsIndexedToHTML.cpp\\n@@ -290,6 +290,9 @@ nsIndexedToHTML::OnStartRequest(nsIRequest* request, nsISupports *aContext) {\\n                          \\\"  text-align: left;\\\\n\\\"\\n                          \\\"  white-space: nowrap;\\\\n\\\"\\n                          \\\"}\\\\n\\\"\\n+                         \\\"th > a {\\\\n\\\"\\n+                         \\\"  color: inherit;\\\\n\\\"\\n+                         \\\"}\\\\n\\\"\\n                          \\\"table[order] th {\\\\n\\\"\\n                          \\\"  cursor: pointer;\\\\n\\\"\\n                          \\\"}\\\\n\\\"\\n@@ -369,18 +372,26 @@ nsIndexedToHTML::OnStartRequest(nsIRequest* request, nsISupports *aContext) {\\n                              \\\"var gTable, gOrderBy, gTBody, gRows, gUI_showHidden;\\\\n\\\"\\n                              \\\"document.addEventListener(\\\\\\\"DOMContentLoaded\\\\\\\", function() {\\\\n\\\"\\n                              \\\"  gTable = document.getElementsByTagName(\\\\\\\"table\\\\\\\")[0];\\\\n\\\"\\n+                             \\\"  gTBody = gTable.tBodies[0];\\\\n\\\"\\n+                             \\\"  if (gTBody.rows.length < 2)\\\\n\\\"\\n+                             \\\"    return;\\\\n\\\"\\n                              \\\"  gUI_showHidden = document.getElementById(\\\\\\\"UI_showHidden\\\\\\\");\\\\n\\\"\\n                              \\\"  var headCells = gTable.tHead.rows[0].cells,\\\\n\\\"\\n                              \\\"      hiddenObjects = false;\\\\n\\\"\\n                              \\\"  function rowAction(i) {\\\\n\\\"\\n-                             \\\"    return function() {\\\\n\\\"\\n+                             \\\"    return function(event) {\\\\n\\\"\\n+                             \\\"      event.preventDefault();\\\\n\\\"\\n                              \\\"      orderBy(i);\\\\n\\\"\\n                              \\\"    }\\\\n\\\"\\n                              \\\"  }\\\\n\\\"\\n-                             \\\"  for (var i = headCells.length - 1; i >= 0; i--)\\\\n\\\"\\n-                             \\\"    headCells[i].addEventListener(\\\\\\\"click\\\\\\\", rowAction(i), false);\\\\n\\\"\\n+                             \\\"  for (var i = headCells.length - 1; i >= 0; i--) {\\\\n\\\"\\n+                             \\\"    var anchor = document.createElement(\\\\\\\"a\\\\\\\");\\\\n\\\"\\n+                             \\\"    anchor.href = \\\\\\\"\\\\\\\";\\\\n\\\"\\n+                             \\\"    anchor.appendChild(headCells[i].firstChild);\\\\n\\\"\\n+                             \\\"    headCells[i].appendChild(anchor);\\\\n\\\"\\n+                             \\\"    headCells[i].addEventListener(\\\\\\\"click\\\\\\\", rowAction(i), true);\\\\n\\\"\\n+                             \\\"  }\\\\n\\\"\\n                              \\\"  gOrderBy = gTable.getAttribute(\\\\\\\"order-by\\\\\\\");\\\\n\\\"\\n-                             \\\"  gTBody = gTable.tBodies[0];\\\\n\\\"\\n                              \\\"  gRows = [];\\\\n\\\"\\n                              \\\"  for (var row, i = gTBody.rows.length - 1; i >= 0; i--) {\\\\n\\\"\\n                              \\\"    row = gTBody.rows[i];\\\\n\\\"\\n\""}