{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Bas9a239a7\""},"diff":"\"9a239a7 Better fix for the Seamokey, Thunderbird, and Calendar build breakage from landing of bug 392303\\ndiff --git a/toolkit/mozapps/installer/windows/nsis/overrides.nsh b/toolkit/mozapps/installer/windows/nsis/overrides.nsh\\nindex 1142882..fd76e5b 100755\\n--- a/toolkit/mozapps/installer/windows/nsis/overrides.nsh\\n+++ b/toolkit/mozapps/installer/windows/nsis/overrides.nsh\\n@@ -4,19 +4,36 @@\\n !ifndef OVERRIDES_INCLUDED\\n !define OVERRIDES_INCLUDED\\n \\n-!include TextFunc.nsh\\n-!include FileFunc.nsh\\n-\\n ; Modified version of Locate from the NSIS File Functions Header v3.2\\n ; This version has the calls to SetDetailsPrint and DetailsPrint commented out.\\n ; See <NSIS App Dir>/include/FileFunc.nsh for more information\\n+\\n+!verbose push\\n+!verbose 3\\n+!ifndef _OVERRIDEFUNC_VERBOSE\\n+  !define _OVERRIDEFUNC_VERBOSE 3\\n+!endif\\n+!verbose ${_OVERRIDEFUNC_VERBOSE}\\n+!define OVERRIDEFUNC_VERBOSE \\\"!insertmacro OVERRIDEFUNC_VERBOSE\\\"\\n+!define _OVERRIDEFUNC_UN\\n+!define _OVERRIDEFUNC_S\\n+!verbose pop\\n+\\n+!macro OVERRIDEFUNC_VERBOSE _VERBOSE\\n+  !verbose push\\n+  !verbose 3\\n+  !undef _OVERRIDEFUNC_VERBOSE\\n+  !define _OVERRIDEFUNC_VERBOSE ${_VERBOSE}\\n+  !verbose pop\\n+!macroend\\n+\\n !macro LocateNoDetails\\n-  !ifndef ${_FILEFUNC_UN}LocateNoDetails\\n+  !ifndef ${_OVERRIDEFUNC_UN}LocateNoDetails\\n     !verbose push\\n-    !verbose ${_FILEFUNC_VERBOSE}\\n-    !define ${_FILEFUNC_UN}LocateNoDetails `!insertmacro ${_FILEFUNC_UN}LocateNoDetailsCall`\\n+    !verbose ${_OVERRIDEFUNC_VERBOSE}\\n+    !define ${_OVERRIDEFUNC_UN}LocateNoDetails `!insertmacro ${_OVERRIDEFUNC_UN}LocateNoDetailsCall`\\n \\n-    Function ${_FILEFUNC_UN}LocateNoDetails\\n+    Function ${_OVERRIDEFUNC_UN}LocateNoDetails\\n       Exch $2\\n       Exch\\n       Exch $1\\n@@ -298,7 +315,7 @@\\n \\n !macro LocateNoDetailsCall _PATH _OPTIONS _FUNC\\n   !verbose push\\n-  !verbose ${_FILEFUNC_VERBOSE}\\n+  !verbose ${_OVERRIDEFUNC_VERBOSE}\\n   Push $0\\n   Push `${_PATH}`\\n   Push `${_OPTIONS}`\\n@@ -311,7 +328,7 @@\\n \\n !macro un.LocateNoDetailsCall _PATH _OPTIONS _FUNC\\n   !verbose push\\n-  !verbose ${_FILEFUNC_VERBOSE}\\n+  !verbose ${_OVERRIDEFUNC_VERBOSE}\\n   Push $0\\n   Push `${_PATH}`\\n   Push `${_OPTIONS}`\\n@@ -325,14 +342,14 @@\\n !macro un.LocateNoDetails\\n   !ifndef un.LocateNoDetails\\n     !verbose push\\n-    !verbose ${_FILEFUNC_VERBOSE}\\n-    !undef _FILEFUNC_UN\\n-    !define _FILEFUNC_UN `un.`\\n+    !verbose ${_OVERRIDEFUNC_VERBOSE}\\n+    !undef _OVERRIDEFUNC_UN\\n+    !define _OVERRIDEFUNC_UN `un.`\\n \\n     !insertmacro LocateNoDetails\\n \\n-    !undef _FILEFUNC_UN\\n-    !define _FILEFUNC_UN\\n+    !undef _OVERRIDEFUNC_UN\\n+    !define _OVERRIDEFUNC_UN\\n     !verbose pop\\n   !endif\\n !macroend\\n@@ -341,12 +358,12 @@\\n ; This version has the calls to SetDetailsPrint and DetailsPrint commented out.\\n ; See <NSIS App Dir>/include/TextFunc.nsh for more information\\n !macro TextCompareNoDetails\\n-  !ifndef ${_TEXTFUNC_UN}TextCompareNoDetails${_TEXTFUNC_S}\\n+  !ifndef ${_OVERRIDEFUNC_UN}TextCompareNoDetails${_OVERRIDEFUNC_S}\\n     !verbose push\\n-    !verbose ${_TEXTFUNC_VERBOSE}\\n-    !define ${_TEXTFUNC_UN}TextCompareNoDetails${_TEXTFUNC_S} `!insertmacro ${_TEXTFUNC_UN}TextCompareNoDetails${_TEXTFUNC_S}Call`\\n+    !verbose ${_OVERRIDEFUNC_VERBOSE}\\n+    !define ${_OVERRIDEFUNC_UN}TextCompareNoDetails${_OVERRIDEFUNC_S} `!insertmacro ${_OVERRIDEFUNC_UN}TextCompareNoDetails${_OVERRIDEFUNC_S}Call`\\n \\n-    Function ${_TEXTFUNC_UN}TextCompareNoDetails${_TEXTFUNC_S}\\n+    Function ${_OVERRIDEFUNC_UN}TextCompareNoDetails${_OVERRIDEFUNC_S}\\n       Exch $3\\n       Exch\\n       Exch $2\\n@@ -383,31 +400,31 @@\\n       StrCpy $8 0\\n \\n       nextline:\\n-      StrCmp${_TEXTFUNC_S} $4 '' fast\\n+      StrCmp${_OVERRIDEFUNC_S} $4 '' fast\\n       IntOp $8 $8 + 1\\n       FileRead $4 $9\\n       IfErrors 0 +4\\n       FileClose $4\\n       StrCpy $4 ''\\n-      StrCmp${_TEXTFUNC_S} $5 '' end\\n+      StrCmp${_OVERRIDEFUNC_S} $5 '' end\\n       StrCmp $2 'FastDiff' fast\\n       StrCmp $2 'FastEqual' fast slow\\n \\n       fast:\\n-      StrCmp${_TEXTFUNC_S} $5 '' call\\n+      StrCmp${_OVERRIDEFUNC_S} $5 '' call\\n       IntOp $6 $6 + 1\\n       FileRead $5 $7\\n       IfErrors 0 +5\\n       FileClose $5\\n       StrCpy $5 ''\\n-      StrCmp${_TEXTFUNC_S} $4 '' end\\n+      StrCmp${_OVERRIDEFUNC_S} $4 '' end\\n       StrCmp $2 'FastDiff' call close\\n       StrCmp $2 'FastDiff' 0 +2\\n-      StrCmp${_TEXTFUNC_S} $7 $9 nextline call\\n-      StrCmp${_TEXTFUNC_S} $7 $9 call nextline\\n+      StrCmp${_OVERRIDEFUNC_S} $7 $9 nextline call\\n+      StrCmp${_OVERRIDEFUNC_S} $7 $9 call nextline\\n \\n       slow:\\n-      StrCmp${_TEXTFUNC_S} $4 '' close\\n+      StrCmp${_OVERRIDEFUNC_S} $4 '' close\\n       StrCpy $6 ''\\n ;      DetailPrint '$8. $9'\\n       FileSeek $5 0\\n@@ -417,9 +434,9 @@\\n       IfErrors 0 +2\\n       StrCmp $2 'SlowDiff' call nextline\\n       StrCmp $2 'SlowDiff' 0 +2\\n-      StrCmp${_TEXTFUNC_S} $7 $9 nextline slownext\\n+      StrCmp${_OVERRIDEFUNC_S} $7 $9 nextline slownext\\n       IntOp $6 $6 + 1\\n-      StrCmp${_TEXTFUNC_S} $7 $9 0 slownext\\n+      StrCmp${_OVERRIDEFUNC_S} $7 $9 0 slownext\\n \\n       call:\\n       Push $2\\n@@ -471,21 +488,21 @@\\n !macro TextCompareNoDetailsS\\n   !ifndef TextCompareNoDetailsS\\n     !verbose push\\n-    !verbose ${_TEXTFUNC_VERBOSE}\\n-    !undef _TEXTFUNC_S\\n-    !define _TEXTFUNC_S `S`\\n+    !verbose ${_OVERRIDEFUNC_VERBOSE}\\n+    !undef _OVERRIDEFUNC_S\\n+    !define _OVERRIDEFUNC_S `S`\\n \\n     !insertmacro TextCompareNoDetails\\n \\n-    !undef _TEXTFUNC_S\\n-    !define _TEXTFUNC_S\\n+    !undef _OVERRIDEFUNC_S\\n+    !define _OVERRIDEFUNC_S\\n     !verbose pop\\n   !endif\\n !macroend\\n \\n !macro TextCompareNoDetailsCall _FILE1 _FILE2 _OPTION _FUNC\\n   !verbose push\\n-  !verbose ${_TEXTFUNC_VERBOSE}\\n+  !verbose ${_OVERRIDEFUNC_VERBOSE}\\n   Push $0\\n   Push `${_FILE1}`\\n   Push `${_FILE2}`\\n@@ -499,7 +516,7 @@\\n \\n !macro TextCompareNoDetailsSCall _FILE1 _FILE2 _OPTION _FUNC\\n   !verbose push\\n-  !verbose ${_TEXTFUNC_VERBOSE}\\n+  !verbose ${_OVERRIDEFUNC_VERBOSE}\\n   Push $0\\n   Push `${_FILE1}`\\n   Push `${_FILE2}`\\n@@ -513,7 +530,7 @@\\n \\n !macro un.TextCompareNoDetailsCall _FILE1 _FILE2 _OPTION _FUNC\\n   !verbose push\\n-  !verbose ${_TEXTFUNC_VERBOSE}\\n+  !verbose ${_OVERRIDEFUNC_VERBOSE}\\n   Push $0\\n   Push `${_FILE1}`\\n   Push `${_FILE2}`\\n@@ -527,7 +544,7 @@\\n \\n !macro un.TextCompareNoDetailsSCall _FILE1 _FILE2 _OPTION _FUNC\\n   !verbose push\\n-  !verbose ${_TEXTFUNC_VERBOSE}\\n+  !verbose ${_OVERRIDEFUNC_VERBOSE}\\n   Push $0\\n   Push `${_FILE1}`\\n   Push `${_FILE2}`\\n@@ -542,14 +559,14 @@\\n !macro un.TextCompareNoDetails\\n   !ifndef un.TextCompareNoDetails\\n     !verbose push\\n-    !verbose ${_TEXTFUNC_VERBOSE}\\n-    !undef _TEXTFUNC_UN\\n-    !define _TEXTFUNC_UN `un.`\\n+    !verbose ${_OVERRIDEFUNC_VERBOSE}\\n+    !undef _OVERRIDEFUNC_UN\\n+    !define _OVERRIDEFUNC_UN `un.`\\n \\n     !insertmacro TextCompareNoDetails\\n \\n-    !undef _TEXTFUNC_UN\\n-    !define _TEXTFUNC_UN\\n+    !undef _OVERRIDEFUNC_UN\\n+    !define _OVERRIDEFUNC_UN\\n     !verbose pop\\n   !endif\\n !macroend\\n@@ -557,18 +574,18 @@\\n !macro un.TextCompareNoDetailsS\\n   !ifndef un.TextCompareNoDetailsS\\n     !verbose push\\n-    !verbose ${_TEXTFUNC_VERBOSE}\\n-    !undef _TEXTFUNC_UN\\n-    !define _TEXTFUNC_UN `un.`\\n-    !undef _TEXTFUNC_S\\n-    !define _TEXTFUNC_S `S`\\n+    !verbose ${_OVERRIDEFUNC_VERBOSE}\\n+    !undef _OVERRIDEFUNC_UN\\n+    !define _OVERRIDEFUNC_UN `un.`\\n+    !undef _OVERRIDEFUNC_S\\n+    !define _OVERRIDEFUNC_S `S`\\n \\n     !insertmacro TextCompareNoDetails\\n \\n-    !undef _TEXTFUNC_UN\\n-    !define _TEXTFUNC_UN\\n-    !undef _TEXTFUNC_S\\n-    !define _TEXTFUNC_S\\n+    !undef _OVERRIDEFUNC_UN\\n+    !define _OVERRIDEFUNC_UN\\n+    !undef _OVERRIDEFUNC_S\\n+    !define _OVERRIDEFUNC_S\\n     !verbose pop\\n   !endif\\n !macroend\\n\""}