{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Bas7a4ce65\""},"diff":"\"7a4ce65 Null check after CheckLineOrder. Bug 388175, patch by Uri Bernstein <uriber@gmail.com>, r=me, sr+a=roc\\ndiff --git a/layout/generic/nsFrame.cpp b/layout/generic/nsFrame.cpp\\nindex 60691d14..14d7f84 100644\\n--- a/layout/generic/nsFrame.cpp\\n+++ b/layout/generic/nsFrame.cpp\\n@@ -4817,11 +4817,13 @@ nsIFrame::PeekOffset(nsPeekOffsetStruct* aPos)\\n         nsIFrame *lastFrame;\\n         result = it->CheckLineOrder(thisLine, &isReordered, &firstFrame, &lastFrame);\\n         baseFrame = endOfLine ? lastFrame : firstFrame;\\n-        nsBidiLevel embeddingLevel = nsBidiPresUtils::GetFrameEmbeddingLevel(baseFrame);\\n-        // If the direction of the frame on the edge is opposite to that of the line,\\n-        // we'll need to drill down to its opposite end, so reverse endOfLine.\\n-        if ((embeddingLevel & 1) == !lineIsRTL)\\n-          endOfLine = !endOfLine;\\n+        if (baseFrame) {\\n+          nsBidiLevel embeddingLevel = nsBidiPresUtils::GetFrameEmbeddingLevel(baseFrame);\\n+          // If the direction of the frame on the edge is opposite to that of the line,\\n+          // we'll need to drill down to its opposite end, so reverse endOfLine.\\n+          if ((embeddingLevel & 1) == !lineIsRTL)\\n+            endOfLine = !endOfLine;\\n+        }\\n       } else\\n #endif\\n       {\\n\""}