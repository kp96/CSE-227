{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Basb878e1d\""},"diff":"\"b878e1d fix for bug #333791: Tab drag indicator (arrow) vanishes/flickers when cursor passes over parts of the tab fix for bug #345524: hide the tab dnd indicator when it's over the original tab thanks to Wayne Woods <w.woods@optusnet.com.au> for these fixes. r=sspitzer, sr=mconnor\\ndiff --git a/browser/base/content/tabbrowser.xml b/browser/base/content/tabbrowser.xml\\nindex 7adb943..a6ac65e 100644\\n--- a/browser/base/content/tabbrowser.xml\\n+++ b/browser/base/content/tabbrowser.xml\\n@@ -1630,13 +1630,33 @@\\n         </body>\\n       </method>\\n \\n+      <method name=\\\"canDrop\\\">\\n+        <parameter name=\\\"aEvent\\\"/>\\n+        <parameter name=\\\"aDragSession\\\"/>\\n+        <body>\\n+          <![CDATA[\\n+            if (aDragSession.sourceNode.parentNode == this.mTabContainer &&\\n+                (aEvent.screenX >= aDragSession.sourceNode.boxObject.screenX &&\\n+                 aEvent.screenX <= (aDragSession.sourceNode.boxObject.screenX +\\n+                                    aDragSession.sourceNode.boxObject.width)))\\n+                return false;\\n+            return true;\\n+          ]]>\\n+        </body>\\n+      </method>\\n+\\n       <method name=\\\"onDragOver\\\">\\n         <parameter name=\\\"aEvent\\\"/>\\n         <parameter name=\\\"aFlavour\\\"/>\\n         <parameter name=\\\"aDragSession\\\"/>\\n         <body>\\n           <![CDATA[\\n-            if (aDragSession.canDrop && aDragSession.sourceNode) {\\n+            if (aDragSession.sourceNode) {\\n+              if (!aDragSession.canDrop) {\\n+                this.mTabDropIndicatorBar.setAttribute('dragging','false');\\n+                return;\\n+              }\\n+\\n               var tabStrip = this.mTabContainer.mTabstrip;\\n \\n               // autoscroll the tab strip if we drag over the scroll\\n@@ -1814,6 +1834,15 @@\\n         <parameter name=\\\"aDragSession\\\"/>\\n         <body>\\n           <![CDATA[\\n+            if (aDragSession.sourceNode &&\\n+                aDragSession.sourceNode.parentNode == this.mTabContainer &&\\n+                aDragSession.canDrop) {\\n+              var target = aEvent.relatedTarget;\\n+              while (target && target != this.mStrip)\\n+                target = target.parentNode;\\n+              if (target)\\n+                return;\\n+            }\\n             this.mTabDropIndicatorBar.setAttribute('dragging','false');\\n           ]]>\\n         </body>\\n\""}