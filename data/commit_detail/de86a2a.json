{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Basde86a2a\""},"diff":"\"de86a2a #52455 r=pedemonte, a=blizzard OK, here's the major font checkin. There's some debug code in here.\\ndiff --git a/widget/src/os2/nsGfxDefs.h b/widget/src/os2/nsGfxDefs.h\\nindex 2519ede..b2b77ee 100644\\n--- a/widget/src/os2/nsGfxDefs.h\\n+++ b/widget/src/os2/nsGfxDefs.h\\n@@ -39,6 +39,33 @@ void PMERROR(const char *str);\\n class nsString;\\n class nsIDeviceContext;\\n \\n+struct nsUconvInfo\\n+{\\n+  char*    mCharset;\\n+  PRUint16 mCodePage;\\n+  UconvObject  mConverter;\\n+};\\n+\\n+static nsUconvInfo gUconvInfo[15  /* eCharSet_COUNT from nsFontMetricsOS2.cpp */ ] = \\n+{\\n+  { \\\"DEFAULT\\\",     0,    NULL },\\n+  { \\\"ANSI\\\",        1252, NULL },\\n+  { \\\"EASTEUROPE\\\",  1250, NULL },\\n+  { \\\"RUSSIAN\\\",     1251, NULL },\\n+  { \\\"GREEK\\\",       1253, NULL },\\n+  { \\\"TURKISH\\\",     1254, NULL },\\n+  { \\\"HEBREW\\\",      1255, NULL },\\n+  { \\\"ARABIC\\\",      1256, NULL },\\n+  { \\\"BALTIC\\\",      1257, NULL },\\n+  { \\\"THAI\\\",        874,  NULL },\\n+  { \\\"SHIFTJIS\\\",    932,  NULL },\\n+  { \\\"GB2312\\\",      936,  NULL },\\n+  { \\\"HANGEUL\\\",     949,  NULL },\\n+  { \\\"CHINESEBIG5\\\", 950,  NULL },\\n+  { \\\"JOHAB\\\",       1361, NULL }\\n+};\\n+\\n+\\n // Module data\\n struct nsGfxModuleData\\n {\\n@@ -49,25 +76,11 @@ struct nsGfxModuleData\\n    nsGfxModuleData();\\n   ~nsGfxModuleData();\\n \\n-   // XXX XXX XXX this is a hack copied from the widget library (where it's\\n-   //             not a hack but perfectly valid) until font-switching comes\\n-   //             on-line.\\n-   // Unicode->local cp. conversions\\n-   char *ConvertFromUcs( const PRUnichar *pText, ULONG ulLength, char *szBuffer, ULONG ulSize);\\n-   char *ConvertFromUcs( const nsString &aStr, char *szBuffer, ULONG ulSize);\\n-   // these methods use a single static buffer\\n-   const char *ConvertFromUcs( const PRUnichar *pText, ULONG ulLength);\\n-   const char *ConvertFromUcs( const nsString &aStr);\\n-\\n-   UconvObject  converter;\\n-   BOOL         supplantConverter;\\n-   PRUint32     renderingHints;\\n-   ULONG        ulCodepage;\\n-   // XXX XXX XXX end hack\\n-\\n    void Init();\\n };\\n \\n+int WideCharToMultiByte( int CodePage, const PRUnichar *pText, ULONG ulLength, char* szBuffer, ULONG ulSize );\\n+\\n extern nsGfxModuleData gModuleData;\\n \\n #ifndef min\\n\""}