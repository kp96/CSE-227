{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Basae36f23\""},"diff":"\"ae36f23 fix major font problem when using the Mac OS X 10.5 SDK. Patch by John Daggett. b=397454 r=roc/vlad sr=roc a=pav\\ndiff --git a/gfx/cairo/cairo/src/cairo-atsui-font.c b/gfx/cairo/cairo/src/cairo-atsui-font.c\\nindex 1e174ec..1de5e7e 100644\\n--- a/gfx/cairo/cairo/src/cairo-atsui-font.c\\n+++ b/gfx/cairo/cairo/src/cairo-atsui-font.c\\n@@ -40,6 +40,12 @@\\n #include \\\"cairo-atsui.h\\\"\\n #include \\\"cairo-quartz-private.h\\\"\\n \\n+/* 10.5 SDK includes a funky new definition of FloatToFixed, so reset to old-style definition */\\n+#ifdef FloatToFixed\\n+#undef FloatToFixed\\n+#define FloatToFixed(a)     ((Fixed)((float)(a) * fixed1))\\n+#endif\\n+\\n /*\\n  * FixedToFloat/FloatToFixed are 10.3+ SDK items - include definitions\\n  * here so we can use older SDKs.\\ndiff --git a/gfx/thebes/src/gfxAtsuiFonts.cpp b/gfx/thebes/src/gfxAtsuiFonts.cpp\\nindex f6de6aa..c4e4fc2 100644\\n--- a/gfx/thebes/src/gfxAtsuiFonts.cpp\\n+++ b/gfx/thebes/src/gfxAtsuiFonts.cpp\\n@@ -67,6 +67,12 @@\\n \\n #define ROUND(x) (floor((x) + 0.5))\\n \\n+/* 10.5 SDK includes a funky new definition of FloatToFixed, so reset to old-style definition */\\n+#ifdef FloatToFixed\\n+#undef FloatToFixed\\n+#define FloatToFixed(a)     ((Fixed)((float)(a) * fixed1))\\n+#endif\\n+\\n /* We might still need this for fast-pathing, but we'll see */\\n #if 0\\n OSStatus ATSUGetStyleGroup(ATSUStyle style, void **styleGroup);\\n\""}