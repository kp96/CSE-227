{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Basff9980a\""},"diff":"\"ff9980a Bug 396828. 'Assertion failure: (cx)->requestDepth || (cx)->thread == (cx)->runtime->gcThread' within ns4xPluginInstance::Stop. r=jst, sr=brendan, a=jst\\ndiff --git a/modules/plugin/base/src/nsJSNPRuntime.cpp b/modules/plugin/base/src/nsJSNPRuntime.cpp\\nindex 1bb3f5c..bbe511e 100644\\n--- a/modules/plugin/base/src/nsJSNPRuntime.cpp\\n+++ b/modules/plugin/base/src/nsJSNPRuntime.cpp\\n@@ -818,6 +818,8 @@ nsJSObjWrapper::NP_Enumerate(NPObject *npobj, NPIdentifier **identifier,\\n \\n   AutoCXPusher pusher(cx);\\n \\n+  JSAutoRequest ar(cx);\\n+\\n   JSIdArray *ida = ::JS_Enumerate(cx, npjsobj->mJSObj);\\n   if (!ida) {\\n     return PR_FALSE;\\n@@ -1669,6 +1671,8 @@ nsJSNPRuntime::OnPluginDestroy(NPP npp)\\n     return;\\n   }\\n \\n+  JSAutoRequest ar(cx);\\n+\\n   if (sNPObjWrappers.ops) {\\n     NppAndCx nppcx = { npp, cx };\\n     PL_DHashTableEnumerate(&sNPObjWrappers,\\n\""}