{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Bas3c215ff\""},"diff":"\"3c215ff Bug 395539 - FTP TransportStatus's progressMax reports the full file size for REST retrieval (resuming partial download).  Patch by Edward Lee <edilee@gmail.com>.  r=cbiesinger, sr=cbiesinger, a=bzbarsky\\ndiff --git a/netwerk/protocol/ftp/src/nsFtpConnectionThread.cpp b/netwerk/protocol/ftp/src/nsFtpConnectionThread.cpp\\nindex a85c72f..cb7a43e 100644\\n--- a/netwerk/protocol/ftp/src/nsFtpConnectionThread.cpp\\n+++ b/netwerk/protocol/ftp/src/nsFtpConnectionThread.cpp\\n@@ -1907,8 +1907,10 @@ nsFtpState::OnTransportStatus(nsITransport *transport, nsresult status,\\n     }\\n \\n     // Ignore the progressMax value from the socket.  We know the true size of\\n-    // the file based on the response from our SIZE request.\\n-    mChannel->OnTransportStatus(nsnull, status, progress, mFileSize);\\n+    // the file based on the response from our SIZE request. Additionally, only\\n+    // report the max progress based on where we started/resumed.\\n+    mChannel->OnTransportStatus(nsnull, status, progress,\\n+                                mFileSize - mChannel->StartPos());\\n     return NS_OK;\\n }\\n \\n\""}