{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Basd8cb1e0\""},"diff":"\"d8cb1e0 #45872 r=mkaply, a=brendan Port of nsDeviceContextOS2 to be more like Windows and removal of nsPaletteOS2\\ndiff --git a/widget/src/os2/nsGfxDefs.h b/widget/src/os2/nsGfxDefs.h\\nnew file mode 100644\\nindex 0000000..2519ede\\n--- /dev/null\\n+++ b/widget/src/os2/nsGfxDefs.h\\n@@ -0,0 +1,79 @@\\n+/*\\n+ * The contents of this file are subject to the Mozilla Public License\\n+ * Version 1.1 (the \\\"License\\\"); you may not use this file except in\\n+ * compliance with the License. You may obtain a copy of the License at\\n+ * http://www.mozilla.org/MPL/\\n+ *\\n+ * Software distributed under the License is distributed on an \\\"AS IS\\\"\\n+ * basis, WITHOUT WARRANTY OF ANY KIND, either express or implied. See the\\n+ * License for the specific language governing rights and limitations\\n+ * under the License.\\n+ *\\n+ * The Original Code is the Mozilla OS/2 libraries.\\n+ *\\n+ * The Initial Developer of the Original Code is John Fairhurst,\\n+ * <john_fairhurst@iname.com>.  Portions created by John Fairhurst are\\n+ * Copyright (C) 1999 John Fairhurst. All Rights Reserved.\\n+ *\\n+ * Contributor(s): \\n+ *\\n+ */\\n+\\n+#ifndef _nsgfxdefs_h\\n+#define _nsgfxdefs_h\\n+\\n+// nsGfxDefs.h - common includes etc. for gfx library\\n+\\n+#include \\\"nscore.h\\\"\\n+\\n+#define INCL_PM\\n+#define INCL_DOS\\n+#include <os2.h>\\n+\\n+#include <uconv.h> // XXX hack XXX\\n+\\n+#define COLOR_CUBE_SIZE 216\\n+\\n+void PMERROR(const char *str);\\n+\\n+class nsString;\\n+class nsIDeviceContext;\\n+\\n+// Module data\\n+struct nsGfxModuleData\\n+{\\n+   HMODULE hModResources;\\n+   HPS     hpsScreen;\\n+   LONG    lDisplayDepth;\\n+\\n+   nsGfxModuleData();\\n+  ~nsGfxModuleData();\\n+\\n+   // XXX XXX XXX this is a hack copied from the widget library (where it's\\n+   //             not a hack but perfectly valid) until font-switching comes\\n+   //             on-line.\\n+   // Unicode->local cp. conversions\\n+   char *ConvertFromUcs( const PRUnichar *pText, ULONG ulLength, char *szBuffer, ULONG ulSize);\\n+   char *ConvertFromUcs( const nsString &aStr, char *szBuffer, ULONG ulSize);\\n+   // these methods use a single static buffer\\n+   const char *ConvertFromUcs( const PRUnichar *pText, ULONG ulLength);\\n+   const char *ConvertFromUcs( const nsString &aStr);\\n+\\n+   UconvObject  converter;\\n+   BOOL         supplantConverter;\\n+   PRUint32     renderingHints;\\n+   ULONG        ulCodepage;\\n+   // XXX XXX XXX end hack\\n+\\n+   void Init();\\n+};\\n+\\n+extern nsGfxModuleData gModuleData;\\n+\\n+#ifndef min\\n+#define min(a,b) (((a) < (b)) ? (a) : (b))\\n+#endif\\n+\\n+#define MK_RGB(r,g,b) ((r) * 65536) + ((g) * 256) + (b)\\n+\\n+#endif\\n\""}