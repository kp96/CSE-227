{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Bas9901c0e\""},"diff":"\"9901c0e Bug 292865 Throbber/\\\"Loading\\\" doesn't appear when tab bar gets displayed r=mconnor\\ndiff --git a/browser/base/content/tabbrowser.xml b/browser/base/content/tabbrowser.xml\\nindex 7be972c..73ac7b5 100644\\n--- a/browser/base/content/tabbrowser.xml\\n+++ b/browser/base/content/tabbrowser.xml\\n@@ -326,7 +326,7 @@\\n                 if (!this.mBlank) {\\n                   this.mTab.setAttribute(\\\"busy\\\", \\\"true\\\");\\n                   this.mTabBrowser.updateIcon(this.mTab);\\n-                  this.mTab.label = this.mTabBrowser.mStringBundle.getString(\\\"tabs.loading\\\");\\n+                  this.mTabBrowser.setTabTitleLoading(this.mTab);\\n \\n                   if (this.mTabBrowser.mCurrentTab == this.mTab)\\n                     this.mTabBrowser.mIsBusy = true;\\n@@ -850,6 +850,16 @@\\n         </body>\\n       </method>\\n \\n+      <method name=\\\"setTabTitleLoading\\\">\\n+        <parameter name=\\\"aTab\\\"/>\\n+        <body>\\n+          <![CDATA[\\n+            aTab.label = this.mStringBundle.getString(\\\"tabs.loading\\\");\\n+            aTab.setAttribute(\\\"crop\\\", \\\"end\\\");\\n+          ]]>\\n+        </body>\\n+      </method>\\n+\\n       <method name=\\\"setTabTitle\\\">\\n         <parameter name=\\\"aTab\\\"/>\\n         <body>\\n@@ -925,8 +935,16 @@\\n             // Get the first tab all hooked up with a title listener and popup blocking listener.\\n             this.mCurrentBrowser.addEventListener(\\\"DOMTitleChanged\\\", this.onTitleChanged, false);\\n \\n-            this.setTabTitle(this.mCurrentTab);\\n-            this.setIcon(this.mCurrentTab, this.mCurrentBrowser.mIconURL);\\n+            var throbberElement = document.getElementById(\\\"navigator-throbber\\\");\\n+            if (throbberElement && throbberElement.hasAttribute(\\\"busy\\\")) {\\n+              this.mCurrentTab.setAttribute(\\\"busy\\\", \\\"true\\\");\\n+              this.mIsBusy = true;\\n+              this.setTabTitleLoading(this.mCurrentTab);\\n+              this.updateIcon(this.mCurrentTab);\\n+            } else {\\n+              this.setTabTitle(this.mCurrentTab);\\n+              this.setIcon(this.mCurrentTab, this.mCurrentBrowser.mIconURL);\\n+            }\\n \\n             var filter;\\n             if (this.mTabFilters.length > 0) {\\n\""}