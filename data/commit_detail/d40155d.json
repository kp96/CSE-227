{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Basd40155d\""},"diff":"\"d40155d Bug 311607: \\\"Select new tabs opened from links\\\" pref isn't obeyed for links dragged to existing tabs, r=mano\\ndiff --git a/browser/base/content/tabbrowser.xml b/browser/base/content/tabbrowser.xml\\nindex 1dce5be..4cdeaa6 100644\\n--- a/browser/base/content/tabbrowser.xml\\n+++ b/browser/base/content/tabbrowser.xml\\n@@ -1536,23 +1536,26 @@\\n \\n               this.dragDropSecurityCheck(aEvent, aDragSession, url);\\n \\n+              var bgLoad = true;\\n+              try {\\n+                bgLoad = this.mPrefs.getBoolPref(\\\"browser.tabs.loadInBackground\\\");\\n+              }\\n+              catch (e) { }\\n+\\n+              if (aEvent.shiftKey)\\n+                bgLoad = !bgLoad;\\n+\\n               if (aEvent.originalTarget.localName != \\\"tab\\\") {\\n                 // We're adding a new tab.\\n-                var bgLoad = true;\\n-                try {\\n-                  bgLoad = this.mPrefs.getBoolPref(\\\"browser.tabs.loadInBackground\\\");\\n-                }\\n-                catch (e) { }\\n-    \\n-                if (aEvent.shiftKey)\\n-                  bgLoad = !bgLoad;\\n-\\n                 this.loadOneTab(getShortcutOrURI(url), null, null, null, bgLoad);\\n               }\\n               else {\\n                 // Load in an existing tab.\\n                 var tab = aEvent.originalTarget;\\n                 this.getBrowserForTab(tab).loadURI(getShortcutOrURI(url));\\n+\\n+                if (this.mCurrentTab != tab && !bgLoad)\\n+                  this.selectedTab = tab;\\n               }\\n             }\\n           ]]>\\n\""}