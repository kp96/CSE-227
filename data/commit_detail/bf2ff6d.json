{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Basbf2ff6d\""},"diff":"\"bf2ff6d Bug 386537. Provide a reliable way for plugins to detect whether windowless mode is available. patch by karlt, r+sr=jst, a=jonas\\ndiff --git a/modules/plugin/base/public/npapi.h b/modules/plugin/base/public/npapi.h\\nindex 806dbae..c5565b1 100644\\n--- a/modules/plugin/base/public/npapi.h\\n+++ b/modules/plugin/base/public/npapi.h\\n@@ -37,7 +37,7 @@\\n \\n \\n /*\\n- *  npapi.h $Revision: 3.46 $\\n+ *  npapi.h $Revision: 3.47 $\\n  *  Netscape client plug-in API spec\\n  */\\n \\n@@ -436,7 +436,9 @@ typedef enum {\\n   NPNVWindowNPObject = 15,\\n \\n   /* Get the NPObject wrapper for the plugins DOM element. */\\n-  NPNVPluginElementNPObject = 16\\n+  NPNVPluginElementNPObject = 16,\\n+\\n+  NPNVSupportsWindowless = 17\\n \\n #ifdef XP_MACOSX\\n   /* Used for negotiating drawing models */\\ndiff --git a/modules/plugin/base/src/ns4xPlugin.cpp b/modules/plugin/base/src/ns4xPlugin.cpp\\nindex 64adeb9..cc67032 100644\\n--- a/modules/plugin/base/src/ns4xPlugin.cpp\\n+++ b/modules/plugin/base/src/ns4xPlugin.cpp\\n@@ -1985,6 +1985,15 @@ _getvalue(NPP npp, NPNVariable variable, void *result)\\n     return NPERR_NO_ERROR;\\n   }\\n \\n+  case NPNVSupportsWindowless: {\\n+#if defined(XP_WIN) || defined(XP_MACOSX) || (defined(MOZ_X11) && defined(MOZ_WIDGET_GTK2))\\n+    *(NPBool*)result = PR_TRUE;\\n+#else\\n+    *(NPBool*)result = PR_FALSE;\\n+#endif\\n+    return NPERR_NO_ERROR;\\n+  }\\n+\\n #ifdef XP_MACOSX\\n   case NPNVpluginDrawingModel: {\\n     if (npp) {\\n\""}