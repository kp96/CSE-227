{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Bas3c7d492\""},"diff":"\"3c7d492 Bug 367829 - not possible to build w/o MOZ_ENABLE_POSTSCRIPT p=romaxa <romaxa@gmail.com> r=roc, a=stuart\\ndiff --git a/widget/src/gtk2/Makefile.in b/widget/src/gtk2/Makefile.in\\nindex bce6a7a..88332aa 100644\\n--- a/widget/src/gtk2/Makefile.in\\n+++ b/widget/src/gtk2/Makefile.in\\n@@ -108,11 +108,16 @@ CPPSRCS\\t\\t= \\\\\\n \\t\\tnsPrintOptionsGTK.cpp \\\\\\n \\t\\tnsImageToPixbuf.cpp \\\\\\n \\t\\tnsAccessibilityHelper.cpp \\\\\\n-\\t\\tnsPrintJobFactoryGTK.cpp \\\\\\n-\\t\\tnsPrintJobGTK.cpp \\\\\\n \\t\\tnsIdleServiceGTK.cpp \\\\\\n \\t\\t$(NULL)\\n \\n+ifdef MOZ_ENABLE_POSTSCRIPT\\n+CPPSRCS        += \\\\\\n+\\t\\tnsPrintJobFactoryGTK.cpp \\\\\\n+\\t\\tnsPrintJobGTK.cpp \\\\\\n+\\t  $(NULL)\\n+endif\\n+\\n # build our subdirs, too\\n ifdef ACCESSIBILITY\\n REQUIRES\\t+= accessibility\\ndiff --git a/widget/src/gtk2/nsDeviceContextSpecG.cpp b/widget/src/gtk2/nsDeviceContextSpecG.cpp\\nindex 6165515..915b95e 100644\\n--- a/widget/src/gtk2/nsDeviceContextSpecG.cpp\\n+++ b/widget/src/gtk2/nsDeviceContextSpecG.cpp\\n@@ -412,7 +412,10 @@ NS_IMETHODIMP nsDeviceContextSpecGTK::GetSurfaceForPrinter(gfxASurface **aSurfac\\n \\n   DO_PR_DEBUG_LOG((\\\"\\\\\\\"%s\\\\\\\", %f, %f\\\\n\\\", path, width, height));\\n \\n-  nsresult rv = nsPrintJobFactoryGTK::CreatePrintJob(this, mPrintJob);\\n+  nsresult rv = NS_ERROR_FAILURE;\\n+#ifndef MOZ_ENABLE_POSTSCRIPT\\n+  nsPrintJobFactoryGTK::CreatePrintJob(this, mPrintJob);\\n+#endif\\n   if (NS_FAILED(rv))\\n     return rv;\\n \\n\""}