{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Bas0e9c764\""},"diff":"\"0e9c764 Bug 393681 - \\\"New file listing makes very poor use of space, truncates filenames all over\\\" [p=dao@design-noir.de (DÃ£o Gottwald) r=bzbarsky r=Mano sr=bzbarsky a=blocking1.9]\\ndiff --git a/netwerk/streamconv/converters/nsIndexedToHTML.cpp b/netwerk/streamconv/converters/nsIndexedToHTML.cpp\\nindex eff353b..45ccfac 100644\\n--- a/netwerk/streamconv/converters/nsIndexedToHTML.cpp\\n+++ b/netwerk/streamconv/converters/nsIndexedToHTML.cpp\\n@@ -293,36 +293,36 @@ nsIndexedToHTML::OnStartRequest(nsIRequest* request, nsISupports *aContext) {\\n                          \\\"th > a {\\\\n\\\"\\n                          \\\"  color: inherit;\\\\n\\\"\\n                          \\\"}\\\\n\\\"\\n-                         \\\"table[order] th {\\\\n\\\"\\n+                         \\\"table[order] > thead > tr > th {\\\\n\\\"\\n                          \\\"  cursor: pointer;\\\\n\\\"\\n                          \\\"}\\\\n\\\"\\n-                         \\\"table[order] th::after {\\\\n\\\"\\n+                         \\\"table[order] > thead > tr > th::after {\\\\n\\\"\\n                          \\\"  display: none;\\\\n\\\"\\n                          \\\"  width: .8em;\\\\n\\\"\\n                          \\\"  margin-right: -.8em;\\\\n\\\"\\n                          \\\"  text-align: right;\\\\n\\\"\\n                          \\\"}\\\\n\\\"\\n-                         \\\"table[order=\\\\\\\"asc\\\\\\\"] th::after {\\\\n\\\"\\n+                         \\\"table[order=\\\\\\\"asc\\\\\\\"] > thead > tr > th::after {\\\\n\\\"\\n                          \\\"  content: \\\\\\\"\\\\\\\\2193\\\\\\\"; /* DOWNWARDS ARROW (U+2193) */\\\\n\\\"\\n                          \\\"}\\\\n\\\"\\n-                         \\\"table[order=\\\\\\\"desc\\\\\\\"] th::after {\\\\n\\\"\\n+                         \\\"table[order=\\\\\\\"desc\\\\\\\"] > thead > tr > th::after {\\\\n\\\"\\n                          \\\"  content: \\\\\\\"\\\\\\\\2191\\\\\\\"; /* UPWARDS ARROW (U+2191) */\\\\n\\\"\\n                          \\\"}\\\\n\\\"\\n-                         \\\"table[order][order-by=\\\\\\\"0\\\\\\\"] th:first-child ,\\\\n\\\"\\n-                         \\\"table[order][order-by=\\\\\\\"1\\\\\\\"] th:first-child + th ,\\\\n\\\"\\n-                         \\\"table[order][order-by=\\\\\\\"2\\\\\\\"] th:first-child + th + th {\\\\n\\\"\\n+                         \\\"table[order][order-by=\\\\\\\"0\\\\\\\"] > thead > tr > th:first-child ,\\\\n\\\"\\n+                         \\\"table[order][order-by=\\\\\\\"1\\\\\\\"] > thead > tr > th:first-child + th ,\\\\n\\\"\\n+                         \\\"table[order][order-by=\\\\\\\"2\\\\\\\"] > thead > tr > th:first-child + th + th {\\\\n\\\"\\n                          \\\"  text-decoration: underline;\\\\n\\\"\\n                          \\\"}\\\\n\\\"\\n-                         \\\"table[order][order-by=\\\\\\\"0\\\\\\\"] th:first-child::after ,\\\\n\\\"\\n-                         \\\"table[order][order-by=\\\\\\\"1\\\\\\\"] th:first-child + th::after ,\\\\n\\\"\\n-                         \\\"table[order][order-by=\\\\\\\"2\\\\\\\"] th:first-child + th + th::after {\\\\n\\\"\\n+                         \\\"table[order][order-by=\\\\\\\"0\\\\\\\"] > thead > tr > th:first-child::after ,\\\\n\\\"\\n+                         \\\"table[order][order-by=\\\\\\\"1\\\\\\\"] > thead > tr > th:first-child + th::after ,\\\\n\\\"\\n+                         \\\"table[order][order-by=\\\\\\\"2\\\\\\\"] > thead > tr > th:first-child + th + th::after {\\\\n\\\"\\n                          \\\"  display: inline-block;\\\\n\\\"\\n                          \\\"}\\\\n\\\"\\n                          \\\"table.remove-hidden > tbody > tr.hidden-object {\\\\n\\\"\\n                          \\\"  display: none;\\\\n\\\"\\n                          \\\"}\\\\n\\\"\\n-                         \\\"td {\\\\n\\\"\\n-                         \\\"  white-space: nowrap;\\\\n\\\"\\n+                         \\\"td > a {\\\\n\\\"\\n+                         \\\"  display: block;\\\\n\\\"\\n                          \\\"}\\\\n\\\"\\n                          \\\"/* size */\\\\n\\\"\\n                          \\\"td:first-child + td {\\\\n\\\"\\n@@ -807,7 +807,7 @@ nsIndexedToHTML::OnIndexAvailable(nsIRequest *aRequest,\\n     // Truncate long names to not stretch the table\\n     //XXX this should be left to the stylesheet (bug 391471)\\n     nsString escapedShort;\\n-    if (description.Length() > 46) {\\n+    if (description.Length() > 71) {\\n         nsCOMPtr<nsIChannel> channel = do_QueryInterface(aRequest);\\n         nsCOMPtr<nsIURI> uri;\\n         rv = channel->GetURI(getter_AddRefs(uri));\\n@@ -819,10 +819,10 @@ nsIndexedToHTML::OnIndexAvailable(nsIRequest *aRequest,\\n             //XXX this potentially truncates after a combining char (bug 391472)\\n             nsXPIDLString descriptionAffix;\\n             descriptionAffix.Assign(description);\\n-            descriptionAffix.Cut(0, descriptionAffix.Length() - 15);\\n+            descriptionAffix.Cut(0, descriptionAffix.Length() - 25);\\n             if (NS_IS_LOW_SURROGATE(descriptionAffix.First()))\\n                 descriptionAffix.Cut(0, 1);\\n-            description.Truncate(30);\\n+            description.Truncate(PR_MIN(71, description.Length() - 28));\\n             if (NS_IS_HIGH_SURROGATE(description.Last()))\\n                 description.Truncate(description.Length() - 1);\\n \\ndiff --git a/toolkit/themes/pinstripe/global/dirListing/dirListing.css b/toolkit/themes/pinstripe/global/dirListing/dirListing.css\\nindex 3c81ce5..92339dc 100755\\n--- a/toolkit/themes/pinstripe/global/dirListing/dirListing.css\\n+++ b/toolkit/themes/pinstripe/global/dirListing/dirListing.css\\n@@ -38,14 +38,16 @@\\n   background-color: -moz-dialog;\\n   color: -moz-dialogtext;\\n   font: message-box;\\n+  padding-left: 2em;\\n+  padding-right: 2em;\\n }\\n \\n body {\\n   border: 1px solid ThreeDShadow;\\n   -moz-border-radius: 10px;\\n   padding: 3em;\\n-  min-width: 13em;\\n-  max-width: 52em;\\n+  min-width: 30em;\\n+  max-width: 65em;\\n   margin: 4em auto;\\n   background-color: -moz-field;\\n   color: -moz-fieldtext;\\n@@ -103,7 +105,7 @@ th:first-child + th {\\n   padding-right: 2em;\\n }\\n \\n-table[order] th:hover {\\n+table[order] > thead > tr > th:hover {\\n   text-decoration: underline;\\n }\\n \\n@@ -112,9 +114,7 @@ tbody > tr:not(:hover) > td:not(:first-child) {\\n }\\n \\n /* let 'Size' and 'Last Modified' take only as much space as they need and 'Name' all the rest */\\n-td:first-child + td ,\\n-td:first-child + td + td ,\\n-td:last-child {\\n+td:not(:first-child) {\\n   width: 0;\\n }\\n \\ndiff --git a/toolkit/themes/winstripe/global/dirListing/dirListing.css b/toolkit/themes/winstripe/global/dirListing/dirListing.css\\nindex d2adf70..462d6e1 100755\\n--- a/toolkit/themes/winstripe/global/dirListing/dirListing.css\\n+++ b/toolkit/themes/winstripe/global/dirListing/dirListing.css\\n@@ -38,14 +38,16 @@\\n   background-color: -moz-dialog;\\n   color: -moz-dialogtext;\\n   font: message-box;\\n+  padding-left: 2em;\\n+  padding-right: 2em;\\n }\\n \\n body {\\n   border: 1px solid ThreeDShadow;\\n   -moz-border-radius: 10px;\\n   padding: 3em;\\n-  min-width: 13em;\\n-  max-width: 52em;\\n+  min-width: 30em;\\n+  max-width: 65em;\\n   margin: 4em auto;\\n   background-color: -moz-field;\\n   color: -moz-fieldtext;\\n@@ -103,7 +105,7 @@ th:first-child + th {\\n   padding-right: 2em;\\n }\\n \\n-table[order] th:hover {\\n+table[order] > thead > tr > th:hover {\\n   text-decoration: underline;\\n }\\n \\n@@ -112,9 +114,7 @@ tbody > tr:not(:hover) > td:not(:first-child) {\\n }\\n \\n /* let 'Size' and 'Last Modified' take only as much space as they need and 'Name' all the rest */\\n-td:first-child + td ,\\n-td:first-child + td + td ,\\n-td:last-child {\\n+td:not(:first-child) {\\n   width: 0;\\n }\\n \\n\""}