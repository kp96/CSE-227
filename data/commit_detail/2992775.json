{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Bas2992775\""},"diff":"\"2992775 Bug 331522. By default, do not allow keyword searches when navigating to URLs; modify browser UI code to enable keyword searches only on selected URL input mechanisms (e.g., typed into the URL bar). r+sr=darin,r=mconnor\\ndiff --git a/browser/base/content/tabbrowser.xml b/browser/base/content/tabbrowser.xml\\nindex 7c09850..d03568e 100644\\n--- a/browser/base/content/tabbrowser.xml\\n+++ b/browser/base/content/tabbrowser.xml\\n@@ -1038,10 +1038,12 @@\\n         <parameter name=\\\"aCharset\\\"/>\\n         <parameter name=\\\"aPostData\\\"/>\\n         <parameter name=\\\"aLoadInBackground\\\"/>\\n+        <parameter name=\\\"aAllowThirdPartyFixup\\\"/>\\n         <body>\\n           <![CDATA[\\n             var owner = aLoadInBackground ? null : this.selectedTab;\\n-            var tab = this.addTab(aURI, aReferrerURI, aCharset, aPostData, owner);\\n+            var tab = this.addTab(aURI, aReferrerURI, aCharset, aPostData, owner,\\n+                                  aAllowThirdPartyFixup);\\n             var bgLoad = (typeof(aLoadInBackground) != \\\"undefined\\\") ? aLoadInBackground :\\n                          this.mPrefs.getBoolPref(\\\"browser.tabs.loadInBackground\\\");\\n             // Set newly selected tab after quick timeout, otherwise hideous focus problems\\n@@ -1080,7 +1082,7 @@\\n           if (aReplace)\\n             this.loadURI(aURIs[0], null, null);\\n           else\\n-            firstTabAdded = gBrowser.addTab(aURIs[0], null, null, null, owner);\\n+            firstTabAdded = gBrowser.addTab(aURIs[0], null, null, null, owner, false);\\n \\n           for (var i = 1; i < aURIs.length; ++i)\\n             gBrowser.addTab(aURIs[i]);\\n@@ -1101,6 +1103,7 @@\\n         <parameter name=\\\"aCharset\\\"/>\\n         <parameter name=\\\"aPostData\\\"/>\\n         <parameter name=\\\"aOwner\\\"/>\\n+        <parameter name=\\\"aAllowThirdPartyFixup\\\"/>\\n         <body>\\n           <![CDATA[\\n             if (!this.mTabbedMode)\\n@@ -1194,8 +1197,12 @@\\n \\n               if (aPostData === undefined)\\n                 aPostData = null;\\n-              b.loadURIWithFlags(aURI, Components.interfaces.nsIWebNavigation.LOAD_FLAGS_NONE,\\n-                                 aReferrerURI, aCharset, aPostData);\\n+              const nsIWebNavigation = Components.interfaces.nsIWebNavigation;\\n+              var flags = nsIWebNavigation.LOAD_FLAGS_NONE;\\n+              if (aAllowThirdPartyFixup) {\\n+                flags = nsIWebNavigation.LOAD_FLAGS_ALLOW_THIRD_PARTY_FIXUP;\\n+              }\\n+              b.loadURIWithFlags(aURI, flags, aReferrerURI, aCharset, aPostData);\\n             }\\n \\n             return t;\\n@@ -1663,7 +1670,7 @@\\n \\n               if (document.getBindingParent(aEvent.originalTarget).localName != \\\"tab\\\") {\\n                 // We're adding a new tab.\\n-                this.loadOneTab(getShortcutOrURI(url), null, null, null, bgLoad);\\n+                this.loadOneTab(getShortcutOrURI(url), null, null, null, bgLoad, false);\\n               }\\n               else {\\n                 // Load in an existing tab.\\n\""}