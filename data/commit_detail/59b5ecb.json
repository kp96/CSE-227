{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Bas59b5ecb\""},"diff":"\"59b5ecb Fixing bug 262887. Make dialogs opened through the DOM make the opening tab the current tab. r=ben@mozilla.org, dveditz@cruzio.com, sr=bryner@brianryner.com\\ndiff --git a/browser/base/content/tabbrowser.xml b/browser/base/content/tabbrowser.xml\\nindex 300e1ed..1955ee7 100644\\n--- a/browser/base/content/tabbrowser.xml\\n+++ b/browser/base/content/tabbrowser.xml\\n@@ -151,6 +151,9 @@\\n       <field name=\\\"mContextTab\\\">\\n         null\\n       </field>\\n+      <field name=\\\"mModalDialogShowing\\\">\\n+        false\\n+      </field>\\n \\n       <!-- A web progress listener object definition for a given tab. -->\\n       <method name=\\\"mTabProgressListener\\\">\\n@@ -1376,6 +1379,9 @@\\n                 onget=\\\"return this.mCurrentBrowser.userTypedValue;\\\"\\n                 onset=\\\"return this.mCurrentBrowser.userTypedValue = val;\\\"/>\\n \\n+      <property name=\\\"forceSyncURLBarUpdate\\\"\\n+                onget=\\\"return this.mModalDialogShowing;\\\"/>\\n+\\n       <constructor>\\n         <![CDATA[\\n           this.mCurrentBrowser = this.mPanelContainer.firstChild;\\n@@ -1423,6 +1429,32 @@\\n           event.preventDefault();\\n         ]]>\\n       </handler>\\n+      <handler event=\\\"DOMWillOpenModalDialog\\\">\\n+        <![CDATA[\\n+          if (!event.isTrusted)\\n+            return;\\n+\\n+          // We're about to open a modal dialog, make sure the opening\\n+          // tab is brought to the front.\\n+\\n+          for (var i = 0; i < browsers.length; ++i) {\\n+            if (this.getBrowserAtIndex(i).contentWindow == event.target) {\\n+              this.mModalDialogShowing = true;\\n+              this.selectedTab = this.mTabContainer.childNodes[i];\\n+\\n+              break;\\n+            }\\n+          }\\n+        ]]>\\n+      </handler>\\n+      <handler event=\\\"DOMModalDialogClosed\\\">\\n+        <![CDATA[\\n+          if (!event.isTrusted)\\n+            return;\\n+\\n+          this.mModalDialogShowing = false;\\n+        ]]>\\n+      </handler>\\n     </handlers>\\n   </binding>\\n \\n\""}