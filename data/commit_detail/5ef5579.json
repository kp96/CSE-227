{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Bas5ef5579\""},"diff":"\"5ef5579 fix build failure with logging disabled. b=389114 r=shebs sr=roc\\ndiff --git a/widget/src/cocoa/nsChildView.h b/widget/src/cocoa/nsChildView.h\\nindex 86d2663..f0680bb 100644\\n--- a/widget/src/cocoa/nsChildView.h\\n+++ b/widget/src/cocoa/nsChildView.h\\n@@ -69,12 +69,6 @@\\n #import <Carbon/Carbon.h>\\n #import <Cocoa/Cocoa.h>\\n \\n-#ifdef MOZ_LOGGING\\n-// make sure that logging is enabled before including prlog.h\\n-#define FORCE_PR_LOG\\n-#include \\\"prlog.h\\\"\\n-#endif\\n-\\n class gfxASurface;\\n class nsChildView;\\n union nsPluginPort;\\ndiff --git a/widget/src/cocoa/nsChildView.mm b/widget/src/cocoa/nsChildView.mm\\nindex 6a866cf..808f112 100644\\n--- a/widget/src/cocoa/nsChildView.mm\\n+++ b/widget/src/cocoa/nsChildView.mm\\n@@ -78,6 +78,11 @@\\n #undef DEBUG_UPDATE\\n #undef INVALIDATE_DEBUGGING  // flash areas as they are invalidated\\n \\n+#ifdef MOZ_LOGGING\\n+#define FORCE_PR_LOG\\n+#endif\\n+#include \\\"prlog.h\\\"\\n+\\n #ifdef PR_LOGGING\\n PRLogModuleInfo* sCocoaLog = nsnull;\\n #endif\\n@@ -342,14 +347,13 @@ nsChildView::nsChildView() : nsBaseWidget()\\n , mPluginIsCG(PR_FALSE)\\n , mVisRgn(nsnull)\\n {\\n-  SetBackgroundColor(NS_RGB(255, 255, 255));\\n-  SetForegroundColor(NS_RGB(0, 0, 0));\\n-\\n #ifdef PR_LOGGING\\n   if (!sCocoaLog)\\n     sCocoaLog = PR_NewLogModule(\\\"nsCocoaWidgets\\\");\\n #endif\\n \\n+  SetBackgroundColor(NS_RGB(255, 255, 255));\\n+  SetForegroundColor(NS_RGB(0, 0, 0));\\n }\\n \\n \\ndiff --git a/widget/src/cocoa/nsClipboard.h b/widget/src/cocoa/nsClipboard.h\\nindex 441fa2e..356be84 100644\\n--- a/widget/src/cocoa/nsClipboard.h\\n+++ b/widget/src/cocoa/nsClipboard.h\\n@@ -43,16 +43,6 @@\\n \\n #import <Cocoa/Cocoa.h>\\n \\n-#ifdef MOZ_LOGGING\\n-// make sure that logging is enabled before including prlog.h\\n-#define FORCE_PR_LOG\\n-#include \\\"prlog.h\\\"\\n-#endif\\n-\\n-#ifdef PR_LOGGING\\n-extern PRLogModuleInfo* sCocoaLog;\\n-#endif\\n-\\n class nsITransferable;\\n \\n \\ndiff --git a/widget/src/cocoa/nsClipboard.mm b/widget/src/cocoa/nsClipboard.mm\\nindex d53e084..b8b31ea 100644\\n--- a/widget/src/cocoa/nsClipboard.mm\\n+++ b/widget/src/cocoa/nsClipboard.mm\\n@@ -46,6 +46,16 @@\\n #include \\\"nsIImage.h\\\"\\n #include \\\"nsILocalFile.h\\\"\\n \\n+#ifdef MOZ_LOGGING\\n+#define FORCE_PR_LOG\\n+#endif\\n+#include \\\"prlog.h\\\"\\n+\\n+#ifdef PR_LOGGING\\n+extern PRLogModuleInfo* sCocoaLog;\\n+#endif\\n+\\n+\\n nsClipboard::nsClipboard() : nsBaseClipboard()\\n {\\n   mChangeCount = 0;\\ndiff --git a/widget/src/cocoa/nsDragService.h b/widget/src/cocoa/nsDragService.h\\nindex ba25faf..67f5df4 100644\\n--- a/widget/src/cocoa/nsDragService.h\\n+++ b/widget/src/cocoa/nsDragService.h\\n@@ -43,16 +43,6 @@\\n \\n #include <Cocoa/Cocoa.h>\\n \\n-#ifdef MOZ_LOGGING\\n-// make sure that logging is enabled before including prlog.h\\n-#define FORCE_PR_LOG\\n-#include \\\"prlog.h\\\"\\n-#endif\\n-\\n-#ifdef PR_LOGGING\\n-extern PRLogModuleInfo* sCocoaLog;\\n-#endif\\n-\\n extern NSString* const kWildcardPboardType;\\n \\n class nsDragService : public nsBaseDragService\\ndiff --git a/widget/src/cocoa/nsDragService.mm b/widget/src/cocoa/nsDragService.mm\\nindex 59e5d72..f91d9d5 100644\\n--- a/widget/src/cocoa/nsDragService.mm\\n+++ b/widget/src/cocoa/nsDragService.mm\\n@@ -65,6 +65,15 @@\\n \\n #import <Cocoa/Cocoa.h>\\n \\n+#ifdef MOZ_LOGGING\\n+#define FORCE_PR_LOG\\n+#endif\\n+#include \\\"prlog.h\\\"\\n+\\n+#ifdef PR_LOGGING\\n+extern PRLogModuleInfo* sCocoaLog;\\n+#endif\\n+\\n extern NSPasteboard* globalDragPboard;\\n extern NSView* globalDragView;\\n extern NSEvent* globalDragEvent;\\n\""}