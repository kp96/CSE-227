{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Bas18ccb0d\""},"diff":"\"18ccb0d Bug 387584 - \\\"ASSERTION: should not have buffer of zero size [@nsTArray_base::EnsureCapacity]\\\". Patch by Sergey Yanovich <ynvich@gmail.com>. r+a=bsmedberg.\\ndiff --git a/xpcom/glue/nsTArray.cpp b/xpcom/glue/nsTArray.cpp\\nindex f54849f..7902772 100644\\n--- a/xpcom/glue/nsTArray.cpp\\n+++ b/xpcom/glue/nsTArray.cpp\\n@@ -43,7 +43,6 @@\\n \\n nsTArray_base::Header nsTArray_base::sEmptyHdr = { 0, 0, 0 };\\n \\n-#ifdef NS_BUILD_REFCNT_LOGGING\\n nsTArray_base::nsTArray_base()\\n   : mHdr(&sEmptyHdr) {\\n   MOZ_COUNT_CTOR(nsTArray_base);\\n@@ -52,7 +51,6 @@ nsTArray_base::nsTArray_base()\\n nsTArray_base::~nsTArray_base() {\\n   MOZ_COUNT_DTOR(nsTArray_base);\\n }\\n-#endif // NS_BUILD_REFCNT_LOGGING\\n \\n PRBool\\n nsTArray_base::EnsureCapacity(size_type capacity, size_type elemSize) {\\ndiff --git a/xpcom/glue/nsTArray.h b/xpcom/glue/nsTArray.h\\nindex b599698..372995e 100644\\n--- a/xpcom/glue/nsTArray.h\\n+++ b/xpcom/glue/nsTArray.h\\n@@ -85,14 +85,8 @@ class NS_COM_GLUE nsTArray_base {\\n #endif\\n \\n   protected:\\n-#ifndef NS_BUILD_REFCNT_LOGGING\\n-    nsTArray_base()\\n-      : mHdr(&sEmptyHdr) {\\n-    }\\n-#else\\n     nsTArray_base();\\n     ~nsTArray_base();  \\n-#endif // NS_BUILD_REFCNT_LOGGING\\n \\n     // Resize the storage if necessary to achieve the requested capacity.\\n     // @param capacity     The requested number of array elements.\\n\""}