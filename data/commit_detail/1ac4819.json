{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Bas1ac4819\""},"diff":"\"1ac4819 Propagate exceptions from the evalcx context to the outer context so they can be caught. bug 353737, r+a=brendan\\ndiff --git a/js/src/js.c b/js/src/js.c\\nindex 0cb3126..5ab41ea 100644\\n--- a/js/src/js.c\\n+++ b/js/src/js.c\\n@@ -2402,10 +2402,17 @@ EvalInContext(JSContext *cx, JSObject *obj, uintN argc, jsval *argv,\\n     } else {\\n         fp = JS_GetScriptedCaller(cx, NULL);\\n         JS_SetGlobalObject(scx, sobj);\\n+        JS_ToggleOptions(scx, JSOPTION_DONT_REPORT_UNCAUGHT);\\n         ok = JS_EvaluateUCScript(scx, sobj, src, srclen,\\n                                  fp->script->filename,\\n                                  JS_PCToLineNumber(cx, fp->script, fp->pc),\\n                                  rval);\\n+        if (!ok) {\\n+            if (JS_GetPendingException(scx, &v))\\n+                JS_SetPendingException(cx, v);\\n+            else\\n+                JS_ReportOutOfMemory(cx);\\n+        }\\n     }\\n \\n out:\\n\""}