{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Bas7315291\""},"diff":"\"7315291 Bug 316059: Clean up use of userTypedClear, patch by Yoni Gilad <yonigilad@gmail.com>, r=mconnor\\ndiff --git a/browser/base/content/tabbrowser.xml b/browser/base/content/tabbrowser.xml\\nindex 3d39c1a..124bb534 100644\\n--- a/browser/base/content/tabbrowser.xml\\n+++ b/browser/base/content/tabbrowser.xml\\n@@ -377,7 +377,7 @@\\n             onLocationChange : function(aWebProgress, aRequest, aLocation)\\n             {\\n               // The document loaded correctly, clear the value if we should\\n-              if (this.mBrowser.userTypedClear > 0)\\n+              if (this.mBrowser.userTypedClear > 0 && aRequest)\\n                 this.mBrowser.userTypedValue = null;\\n \\n               if (aWebProgress.DOMWindow == this.mBrowser.contentWindow &&\\n@@ -677,11 +677,7 @@\\n \\n             var webProgress = this.mCurrentBrowser.webProgress;\\n             var securityUI = this.mCurrentBrowser.securityUI;\\n-            // Remember the current clear state, then set it to zero\\n-            // so we don't clear the userTypedValue when just switching\\n-            // tabs. Set it back to its old state after we're done.\\n-            var userTypedClear = this.mCurrentBrowser.userTypedClear;\\n-            this.mCurrentBrowser.userTypedClear = 0;\\n+\\n             var i, p;\\n             for (i = 0; i < this.mProgressListeners.length; i++) {\\n               p = this.mProgressListeners[i];\\n@@ -691,8 +687,7 @@\\n                   p.onSecurityChange(webProgress, null, securityUI.state);\\n               }\\n             }\\n-            this.mCurrentBrowser.userTypedClear = userTypedClear;\\n-            \\n+\\n             this._fastFind.setDocShell(this.mCurrentBrowser.docShell);\\n \\n             // Update the window title.\\n\""}