{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Bas98338be\""},"diff":"\"98338be Bug 395862: About dialog broken. r=gavin.sharp, a=beltzner\\ndiff --git a/browser/base/content/aboutDialog.js b/browser/base/content/aboutDialog.js\\nindex 216efd0..72ac959 100644\\n--- a/browser/base/content/aboutDialog.js\\n+++ b/browser/base/content/aboutDialog.js\\n@@ -42,22 +42,26 @@ function init(aEvent)\\n   if (aEvent.target != document)\\n     return;\\n \\n-  var prefSvc = Cc[\\\"@mozilla.org/preferences-service;1\\\"].\\n-    getService(Ci.nsIPrefService);\\n-  var prefs = prefSvc.getBranch(null);\\n+  var prefs = Components.classes[\\\"@mozilla.org/preferences-service;1\\\"]\\n+                        .getService(Components.interfaces.nsIPrefBranch);\\n \\n-  var distroId = prefs.getCharPref(\\\"distribution.id\\\");\\n-  if (distroId) {\\n-    var distroVersion = prefs.getCharPref(\\\"distribution.version\\\");\\n-    var distroAbout = prefs.getComplexValue(\\\"distribution.about\\\", Ci.nsISupportsString);\\n+  try {\\n+    var distroId = prefs.getCharPref(\\\"distribution.id\\\");\\n+    if (distroId) {\\n+      var distroVersion = prefs.getCharPref(\\\"distribution.version\\\");\\n+      var distroAbout = prefs.getComplexValue(\\\"distribution.about\\\", Ci.nsISupportsString);\\n   \\n-    var distroField = document.getElementById(\\\"distribution\\\");\\n-    distroField.value = distroAbout;\\n-    distroField.style.display = \\\"block\\\";\\n-  \\n-    var distroIdField = document.getElementById(\\\"distributionId\\\");\\n-    distroIdField.value = distroId + \\\" - \\\" + distroVersion;\\n-    distroIdField.style.display = \\\"block\\\";\\n+      var distroField = document.getElementById(\\\"distribution\\\");\\n+      distroField.value = distroAbout;\\n+      distroField.style.display = \\\"block\\\";\\n+    \\n+      var distroIdField = document.getElementById(\\\"distributionId\\\");\\n+      distroIdField.value = distroId + \\\" - \\\" + distroVersion;\\n+      distroIdField.style.display = \\\"block\\\";\\n+    }\\n+  }\\n+  catch (e) {\\n+    // Pref is unset\\n   }\\n \\n   var userAgentField = document.getElementById(\\\"userAgent\\\");\\n\""}