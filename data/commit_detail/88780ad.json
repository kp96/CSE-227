{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Bas88780ad\""},"diff":"\"88780ad Bug 393652 - Trunk builds on Mac do not quit from menu after first window is closed. r=benjamin@smedbergs.us (Benjamin Smedberg) Toolkit Only, no approval.\\ndiff --git a/toolkit/components/startup/src/nsAppStartup.cpp b/toolkit/components/startup/src/nsAppStartup.cpp\\nindex b91b7a2..5b89c61 100644\\n--- a/toolkit/components/startup/src/nsAppStartup.cpp\\n+++ b/toolkit/components/startup/src/nsAppStartup.cpp\\n@@ -203,10 +203,6 @@ nsAppStartup::Quit(PRUint32 aMode)\\n     // it will be treated the same as eAttemptQuit, below\\n   }\\n \\n-  mShuttingDown = PR_TRUE;\\n-  if (!mRestart) \\n-    mRestart = aMode & eRestart;\\n-\\n   // If we're considering quitting, we will only do so if:\\n   if (ferocity == eConsiderQuit) {\\n     if (mConsiderQuitStopper == 0) {\\n@@ -236,6 +232,10 @@ nsAppStartup::Quit(PRUint32 aMode)\\n #endif\\n   }\\n \\n+  mShuttingDown = PR_TRUE;\\n+  if (!mRestart) \\n+      mRestart = aMode & eRestart;\\n+\\n   /* Currently ferocity can never have the value of eForceQuit here.\\n      That's temporary (in an unscheduled kind of way) and logically\\n      this code is part of the eForceQuit case, so I'm checking against\\n\""}