{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Basa6946f2\""},"diff":"\"a6946f2 Fixing bug 353460. SVG image has no horizontal scrollbar. r=bzbarsky@mit.edu, sr=roc@ocallahan.org, a=auto (blocking1.9+)\\ndiff --git a/layout/svg/base/src/nsSVGOuterSVGFrame.cpp b/layout/svg/base/src/nsSVGOuterSVGFrame.cpp\\nindex 28b2194..23af9ad 100644\\n--- a/layout/svg/base/src/nsSVGOuterSVGFrame.cpp\\n+++ b/layout/svg/base/src/nsSVGOuterSVGFrame.cpp\\n@@ -200,12 +200,16 @@ nsSVGOuterSVGFrame::Reflow(nsPresContext*          aPresContext,\\n                            nsReflowStatus&          aStatus)\\n {\\n   if (!aReflowState.ShouldReflowAllKids()) {\\n-    // We're not the target of the incremental reflow, so just bail.\\n-    // This means that something happened to one of our descendants\\n-    // (excluding those inside svg:foreignObject, since\\n-    // nsSVGForeignObjectFrame is a reflow root).\\n+    // We're not the target of the incremental reflow, so just bail. We get\\n+    // here when our containing block has changed size (e.g. when the browser\\n+    // window is resized). We could in principal also get here if something\\n+    // happened to one of our descendants, but since nsSVGForeignObjectFrame is\\n+    // a reflow root, and since no other SVG elements participate in CSS\\n+    // layout, that currently should never happen.\\n     aDesiredSize.width = mRect.width;\\n     aDesiredSize.height = mRect.height;\\n+    aDesiredSize.mOverflowArea.SetRect(0, 0, mRect.width, mRect.height);\\n+    FinishAndStoreOverflow(&aDesiredSize);\\n     aStatus = NS_FRAME_COMPLETE;\\n     return NS_OK;\\n   }\\n@@ -248,6 +252,11 @@ nsSVGOuterSVGFrame::Reflow(nsPresContext*          aPresContext,\\n \\n   // XXX add in CSS borders ??\\n \\n+  // Make sure we scroll if we're too big:\\n+  // XXX Use the bounding box of our descendants? (See bug 353460 comment 14.)\\n+  aDesiredSize.mOverflowArea.SetRect(0, 0, aDesiredSize.width, aDesiredSize.height);\\n+  FinishAndStoreOverflow(&aDesiredSize);\\n+\\n   aStatus = NS_FRAME_COMPLETE;\\n   NS_FRAME_SET_TRUNCATION(aStatus, aReflowState, aDesiredSize);\\n \\n\""}