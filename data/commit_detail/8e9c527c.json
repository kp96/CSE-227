{"sha":"\"47e7bc67f932866e4467f7ab8a23bb167405bebd\"","commit":{"author":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"committer":{"name":"\"Nicolas Silva\"","email":"\"nsilva@mozilla.com\"","date":"\"2016-09-01T15:51:09+02:00\""},"message":"\"Bug 1298345 - Refactor CanvasRenderingContext2D's texture allocation code. r=Bas8e9c527c\""},"diff":"\"8e9c527c fix for bug #387718:  the location bar dropdown should show a star next to bookmarked results r=gavin\\ndiff --git a/browser/base/content/browser.xul b/browser/base/content/browser.xul\\nindex 406f30a..f6e162c 100644\\n--- a/browser/base/content/browser.xul\\n+++ b/browser/base/content/browser.xul\\n@@ -224,6 +224,7 @@\\n                      completeselectedindex=\\\"true\\\"\\n                      tabscrolling=\\\"true\\\"\\n                      showcommentcolumn=\\\"true\\\"\\n+                     showimagecolumn=\\\"true\\\" \\n                      enablehistory=\\\"true\\\"\\n                      maxrows=\\\"10\\\"\\n                      newlines=\\\"stripsurroundingwhitespace\\\"\\ndiff --git a/browser/themes/pinstripe/browser/browser.css b/browser/themes/pinstripe/browser/browser.css\\nindex 9de75f6e..bd91045 100755\\n--- a/browser/themes/pinstripe/browser/browser.css\\n+++ b/browser/themes/pinstripe/browser/browser.css\\n@@ -977,6 +977,23 @@ statusbarpanel#statusbar-display {\\n   height: 16px;\\n }\\n \\n+#treecolAutoCompleteImage {\\n+ max-width : 36px; \\n+ padding-end: 18px;\\n+}\\n+\\n+.autocomplete-treebody::-moz-tree-image(favicon, treecolAutoCompleteImage) {\\n+  list-style-image: url(\\\"chrome://browser/skin/places/starPage.png\\\");\\n+  width: 16px;\\n+  height: 16px;\\n+}\\n+\\n+.autocomplete-treebody::-moz-tree-image(bookmark, treecolAutoCompleteImage) {\\n+  list-style-image: url(\\\"chrome://browser/skin/places/pageStarred.png\\\");\\n+  width: 16px;\\n+  height: 16px;\\n+}\\n+\\n .autocomplete-treebody::-moz-tree-cell-text(treecolAutoCompleteComment) {\\n   color: #555566;\\n }\\ndiff --git a/browser/themes/winstripe/browser/browser.css b/browser/themes/winstripe/browser/browser.css\\nindex db53a66..129ab34 100644\\n--- a/browser/themes/winstripe/browser/browser.css\\n+++ b/browser/themes/winstripe/browser/browser.css\\n@@ -970,6 +970,23 @@ statusbarpanel#statusbar-display {\\n   height: 16px;\\n }\\n \\n+#treecolAutoCompleteImage {\\n+ max-width : 36px; \\n+ padding-end: 18px;\\n+}\\n+\\n+.autocomplete-treebody::-moz-tree-image(favicon, treecolAutoCompleteImage) {\\n+  list-style-image: url(\\\"chrome://browser/skin/places/starPage.png\\\");\\n+  width: 16px;\\n+  height: 16px;\\n+}\\n+\\n+.autocomplete-treebody::-moz-tree-image(bookmark, treecolAutoCompleteImage) {\\n+  list-style-image: url(\\\"chrome://browser/skin/places/pageStarred.png\\\");\\n+  width: 16px;\\n+  height: 16px;\\n+}\\n+\\n .autocomplete-treebody::-moz-tree-cell-text(treecolAutoCompleteComment) {\\n   color: #555566;\\n }\\ndiff --git a/toolkit/components/autocomplete/public/nsIAutoCompleteInput.idl b/toolkit/components/autocomplete/public/nsIAutoCompleteInput.idl\\nindex c365233..97ba504 100644\\n--- a/toolkit/components/autocomplete/public/nsIAutoCompleteInput.idl\\n+++ b/toolkit/components/autocomplete/public/nsIAutoCompleteInput.idl\\n@@ -40,7 +40,7 @@\\n \\n interface nsIAutoCompletePopup;\\n \\n-[scriptable, uuid(AC029254-06DD-4dff-878C-A292117DE2D3)]\\n+[scriptable, uuid(8a5918dc-89ba-4bd0-934c-90e9c21568b8)]\\n interface nsIAutoCompleteInput : nsISupports\\n {  \\n   /*\\n@@ -96,7 +96,13 @@ interface nsIAutoCompleteInput : nsISupports\\n    * Option to show a second column in the popup which contains\\n    * the comment for each autocomplete result\\n    */\\n-  attribute unsigned long showCommentColumn;\\n+  attribute boolean showCommentColumn;\\n+\\n+  /*\\n+   * Option to show a third column in the popup which contains\\n+   * an additional image for each autocomplete result\\n+   */\\n+  attribute boolean showImageColumn;\\n \\n   /* \\n    * Number of milliseconds after a keystroke before a search begins\\ndiff --git a/toolkit/components/satchel/src/nsFormFillController.cpp b/toolkit/components/satchel/src/nsFormFillController.cpp\\nindex 7280d9f..b362701 100644\\n--- a/toolkit/components/satchel/src/nsFormFillController.cpp\\n+++ b/toolkit/components/satchel/src/nsFormFillController.cpp\\n@@ -339,13 +339,26 @@ nsFormFillController::SetMaxRows(PRUint32 aMaxRows)\\n }\\n \\n NS_IMETHODIMP\\n-nsFormFillController::GetShowCommentColumn(PRUint32 *aShowCommentColumn)\\n+nsFormFillController::GetShowImageColumn(PRBool *aShowImageColumn)\\n+{\\n+  *aShowImageColumn = PR_FALSE;\\n+  return NS_OK;\\n+}\\n+\\n+NS_IMETHODIMP nsFormFillController::SetShowImageColumn(PRBool aShowImageColumn)\\n+{\\n+  return NS_ERROR_NOT_IMPLEMENTED;\\n+}\\n+\\n+\\n+NS_IMETHODIMP\\n+nsFormFillController::GetShowCommentColumn(PRBool *aShowCommentColumn)\\n {\\n   *aShowCommentColumn = PR_FALSE;\\n   return NS_OK;\\n }\\n \\n-NS_IMETHODIMP nsFormFillController::SetShowCommentColumn(PRUint32 aShowCommentColumn)\\n+NS_IMETHODIMP nsFormFillController::SetShowCommentColumn(PRBool aShowCommentColumn)\\n {\\n   return NS_ERROR_NOT_IMPLEMENTED;\\n }\\ndiff --git a/toolkit/content/widgets/autocomplete.xml b/toolkit/content/widgets/autocomplete.xml\\nindex aa80891..1792a05 100644\\n--- a/toolkit/content/widgets/autocomplete.xml\\n+++ b/toolkit/content/widgets/autocomplete.xml\\n@@ -151,6 +151,10 @@\\n                 onset=\\\"this.setAttribute('showcommentcolumn', val); return val;\\\"\\n                 onget=\\\"return this.getAttribute('showcommentcolumn') == 'true';\\\"/>\\n \\n+      <property name=\\\"showImageColumn\\\"\\n+                onset=\\\"this.setAttribute('showimagecolumn', val); return val;\\\"\\n+                onget=\\\"return this.getAttribute('showimagecolumn') == 'true';\\\"/>\\n+\\n       <property name=\\\"timeout\\\"\\n                 onset=\\\"this.setAttribute('timeout', val); return val;\\\"\\n                 onget=\\\"return parseInt(this.getAttribute('timeout')) || 50;\\\"/>\\n@@ -533,7 +537,8 @@\\n       <field name=\\\"mInput\\\">null</field>\\n       <field name=\\\"mPopupOpen\\\">false</field>\\n       <field name=\\\"mShowCommentCol\\\">false</field>\\n-      \\n+      <field name=\\\"mShowImageCol\\\">false</field>\\n+\\n       <constructor><![CDATA[\\n         this.setAttribute(\\\"ignorekeys\\\", \\\"true\\\");\\n       ]]></constructor>\\n@@ -576,7 +581,8 @@\\n             this.invalidate();\\n             \\n             this.showCommentColumn = this.mInput.showCommentColumn;\\n-            \\n+            this.showImageColumn = this.mInput.showImageColumn;\\n+\\n             this.setAttribute(\\\"width\\\", aWidth < 100 ? 100 : aWidth);\\n \\n             document.popupNode = null;\\n@@ -674,7 +680,7 @@\\n                 onget=\\\"return this.mShowCommentColumn;\\\">\\n         <setter><![CDATA[\\n           if (!val && this.mShowCommentColumn) {\\n-            // reset the flex on the value column and add the comment column\\n+            // reset the flex on the value column and remove the comment column\\n             document.getElementById(\\\"treecolAutoCompleteValue\\\").setAttribute(\\\"flex\\\", 1);\\n             this.removeColumn(\\\"treecolAutoCompleteComment\\\");\\n           } else if (val && !this.mShowCommentColumn) {\\n@@ -687,6 +693,23 @@\\n         ]]></setter>\\n       </property>\\n \\n+      <property name=\\\"showImageColumn\\\"\\n+                onget=\\\"return this.mShowImageColumn;\\\">\\n+        <setter>\\n+          <![CDATA[\\n+          if (!val && this.mShowImageColumn) {\\n+            // remove the image column\\n+            this.removeColumn(\\\"treecolAutoCompleteImage\\\");\\n+          } else if (val && !this.mShowImageColumn) {\\n+            // add the image column\\n+            this.addColumn({id: \\\"treecolAutoCompleteImage\\\", flex: 1});\\n+          }\\n+          this.mShowImageColumn = val;\\n+          return val;\\n+        ]]>\\n+        </setter>\\n+      </property>\\n+\\n       <method name=\\\"addColumn\\\">\\n         <parameter name=\\\"aAttrs\\\"/>\\n         <body><![CDATA[\\n\""}